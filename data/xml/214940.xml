<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.1"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>214940</bug_id>
          
          <creation_ts>2008-01-10 14:16:00 -0500</creation_ts>
          <short_desc>[prov] Use ECF to get repository files</short_desc>
          <delta_ts>2008-01-22 16:58:45 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>12</classification_id>
          <classification>RT</classification>
          <product>Equinox</product>
          <component>Incubator</component>
          <version>3.4</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows XP</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>3.4 M5</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Pascal Rapicault">pascal</reporter>
          <assigned_to name="equinox.incubator-inbox">equinox.incubator-inbox</assigned_to>
          <cc>timothym</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="5173"
          type_id="1"
          status="+"
          setter="pascal"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1129143</commentid>
    <comment_count>0</comment_count>
    <who name="Pascal Rapicault">pascal</who>
    <bug_when>2008-01-10 14:16:23 -0500</bug_when>
    <thetext>If my memory don&apos;t fail me, content.xml and artifacts.xml are currently obtained by directly opening the URL on the file. In order to bring consistency across all our transport operation, the metadata repo and artifact repo need to use ECF to get files.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1131605</commentid>
    <comment_count>1</comment_count>
      <attachid>86955</attachid>
    <who name="Tim Mok">timothym</who>
    <bug_when>2008-01-15 12:07:12 -0500</bug_when>
    <thetext>Created attachment 86955
ECF Metadata Transport v01

Patch changes:

+Added ECFMetadataTransport to handle file downloading for metadata repositories.

Artifact repositories already use ECF for downloading the artifacts.xml</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1134621</commentid>
    <comment_count>2</comment_count>
    <who name="Pascal Rapicault">pascal</who>
    <bug_when>2008-01-20 21:00:32 -0500</bug_when>
    <thetext>Is this patch ready for commit, or are you still working on it for timestamp support?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1134887</commentid>
    <comment_count>3</comment_count>
    <who name="Tim Mok">timothym</who>
    <bug_when>2008-01-21 08:50:27 -0500</bug_when>
    <thetext>I just did some testing with it and there&apos;s a bug in it with reading local repos.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1134904</commentid>
    <comment_count>4</comment_count>
      <attachid>87397</attachid>
    <who name="Tim Mok">timothym</who>
    <bug_when>2008-01-21 09:02:30 -0500</bug_when>
    <thetext>Created attachment 87397
ECF Metadata Transport v02

Fixed the error when reading an uncompressed index file.

This should be ready to commit. I&apos;ll make my submission for timestamp support in the metadata caching bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1134918</commentid>
    <comment_count>5</comment_count>
    <who name="Pascal Rapicault">pascal</who>
    <bug_when>2008-01-21 09:11:29 -0500</bug_when>
    <thetext>Just to be clear, does this code depend on the ECF timestamp support?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1134943</commentid>
    <comment_count>6</comment_count>
    <who name="Tim Mok">timothym</who>
    <bug_when>2008-01-21 09:22:32 -0500</bug_when>
    <thetext>No, it doesn&apos;t need timestamp support. It just uses ECF to retrieve the index file. I can add in the timestamp check separately.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1136193</commentid>
    <comment_count>7</comment_count>
      <attachid>87561</attachid>
    <who name="Tim Mok">timothym</who>
    <bug_when>2008-01-22 16:00:59 -0500</bug_when>
    <thetext>Created attachment 87561
ECF Metadata Transport v03

I fixed the manifest to use the correct version of ECF. I looked at ECFTransport and it uses IStateful, which is from ...p2.artifact.repository. I&apos;ll think about how moving ECFTransport to a different location and using it for metadata transfers as well.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1136241</commentid>
    <comment_count>8</comment_count>
    <who name="Pascal Rapicault">pascal</who>
    <bug_when>2008-01-22 16:58:45 -0500</bug_when>
    <thetext>I have released the latest patch.
When you get a chance please fix up the externalization warning in the ECFMetadataTransport.
Also please open a bug about merging the ECFTransport and ECFMetadataTransport classes.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>86955</attachid>
            <date>2008-01-15 12:07:00 -0500</date>
            <delta_ts>2008-01-21 09:02:30 -0500</delta_ts>
            <desc>ECF Metadata Transport v01</desc>
            <filename>patch-ECFMetadataTransport.txt</filename>
            <type>text/plain</type>
            <size>10653</size>
            <attacher name="Tim Mok">timothym</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuZXF1aW5veC5w
Mi5tZXRhZGF0YS5yZXBvc2l0b3J5DQpJbmRleDogc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvaW50
ZXJuYWwvcDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9TaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlGYWN0
b3J5LmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL2VxdWlub3gt
aW5jdWJhdG9yL3Byb3Zpc2lvbmluZy9vcmcuZWNsaXBzZS5lcXVpbm94LnAyLm1ldGFkYXRhLnJl
cG9zaXRvcnkvc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvaW50ZXJuYWwvcDIvbWV0YWRhdGEvcmVw
b3NpdG9yeS9TaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlGYWN0b3J5LmphdmEsdg0KcmV0cmlldmlu
ZyByZXZpc2lvbiAxLjE2DQpkaWZmIC11IC1yMS4xNiBTaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlG
YWN0b3J5LmphdmENCi0tLSBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRh
ZGF0YS9yZXBvc2l0b3J5L1NpbXBsZU1ldGFkYXRhUmVwb3NpdG9yeUZhY3RvcnkuamF2YQkxMSBK
YW4gMjAwOCAyMToxMDoxNiAtMDAwMAkxLjE2DQorKysgc3JjL29yZy9lY2xpcHNlL2VxdWlub3gv
aW50ZXJuYWwvcDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9TaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlG
YWN0b3J5LmphdmEJMTUgSmFuIDIwMDggMTQ6MzQ6NDUgLTAwMDANCkBAIC0yNCw3ICsyNCw4IEBA
DQogcHVibGljIGNsYXNzIFNpbXBsZU1ldGFkYXRhUmVwb3NpdG9yeUZhY3RvcnkgaW1wbGVtZW50
cyBJTWV0YWRhdGFSZXBvc2l0b3J5RmFjdG9yeSB7DQogDQogCXByaXZhdGUgc3RhdGljIGZpbmFs
IFN0cmluZyBKQVJfRVhURU5TSU9OID0gIi5qYXIiOyAvLyROT04tTkxTLTEkDQotCXByaXZhdGUg
c3RhdGljIGZpbmFsIFN0cmluZyBYTUxfRVhURU5TSU9OID0gIi54bWwiOw0KKwlwcml2YXRlIHN0
YXRpYyBmaW5hbCBTdHJpbmcgWE1MX0VYVEVOU0lPTiA9ICIueG1sIjsgLy8kTk9OLU5MUy0xJA0K
Kwlwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ09OVEVOVF9GSUxFTkFNRSA9ICJjb250ZW50
IjsgLy8kTk9OLU5MUy0xJA0KIA0KIAlwdWJsaWMgSU1ldGFkYXRhUmVwb3NpdG9yeSBjcmVhdGUo
VVJMIGxvY2F0aW9uLCBTdHJpbmcgbmFtZSwgU3RyaW5nIHR5cGUpIHsNCiAJCWlmIChsb2NhdGlv
bi5nZXRQcm90b2NvbCgpLmVxdWFscygiZmlsZSIpKSAvLyROT04tTkxTLTEkDQpAQCAtMzMsMjgg
KzM0LDM0IEBADQogCX0NCiANCiAJcHVibGljIElNZXRhZGF0YVJlcG9zaXRvcnkgbG9hZChVUkwg
bG9jYXRpb24sIElQcm9ncmVzc01vbml0b3IgbW9uaXRvcikgdGhyb3dzIFByb3Zpc2lvbkV4Y2Vw
dGlvbiB7DQotCQlpZiAobW9uaXRvciA9PSBudWxsKQ0KLQkJCW1vbml0b3IgPSBuZXcgTnVsbFBy
b2dyZXNzTW9uaXRvcigpOw0KLQkJLy8gbG9hZCB0aGUgamFyDQotCQlJTWV0YWRhdGFSZXBvc2l0
b3J5IHJlc3VsdCA9IGxvYWQobG9jYXRpb24sIEpBUl9FWFRFTlNJT04sIG1vbml0b3IpOw0KLQkJ
Ly8gY29tcHJlc3NlZCBmaWxlIGlzIG5vdCBhdmFpbGFibGUsIGxvYWQgdGhlIHhtbA0KLQkJaWYg
KHJlc3VsdCA9PSBudWxsKSB7DQotCQkJcmVzdWx0ID0gbG9hZChsb2NhdGlvbiwgWE1MX0VYVEVO
U0lPTiwgbW9uaXRvcik7DQotCQl9DQotCQlyZXR1cm4gcmVzdWx0Ow0KLQl9DQotDQotCXByaXZh
dGUgSU1ldGFkYXRhUmVwb3NpdG9yeSBsb2FkKFVSTCBsb2NhdGlvbiwgU3RyaW5nIGV4dGVuc2lv
biwgSVByb2dyZXNzTW9uaXRvciBtb25pdG9yKSB0aHJvd3MgUHJvdmlzaW9uRXhjZXB0aW9uIHsN
CiAJCWxvbmcgdGltZSA9IDA7DQorCQlib29sZWFuIGNvbXByZXNzID0gdHJ1ZTsNCiAJCWZpbmFs
IFN0cmluZyBkZWJ1Z01zZyA9ICJSZXN0b3JpbmcgbWV0YWRhdGEgcmVwb3NpdG9yeSAiOyAvLyRO
T04tTkxTLTEkDQorCQlGaWxlIHRlbXAgPSBudWxsOw0KIAkJaWYgKFRyYWNpbmcuREVCVUdfTUVU
QURBVEFfUEFSU0lORykgew0KIAkJCVRyYWNpbmcuZGVidWcoZGVidWdNc2cgKyBsb2NhdGlvbik7
DQogCQkJdGltZSA9IC1TeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsNCiAJCX0NCiAJCXRyeSB7
DQorCQkJdGVtcCA9IEZpbGUuY3JlYXRlVGVtcEZpbGUoQ09OVEVOVF9GSUxFTkFNRSwgSkFSX0VY
VEVOU0lPTik7DQorCQkJU3ViTW9uaXRvciBzdWIgPSBTdWJNb25pdG9yLmNvbnZlcnQobW9uaXRv
ciwgMzAwKTsNCisJCQlPdXRwdXRTdHJlYW0gbWV0YWRhdGEgPSBuZXcgQnVmZmVyZWRPdXRwdXRT
dHJlYW0obmV3IEZpbGVPdXRwdXRTdHJlYW0odGVtcCkpOw0KKwkJCUlTdGF0dXMgc3RhdHVzID0g
Z2V0VHJhbnNwb3J0KCkuZG93bmxvYWQoVVJMTWV0YWRhdGFSZXBvc2l0b3J5LmdldEFjdHVhbExv
Y2F0aW9uKGxvY2F0aW9uLCBKQVJfRVhURU5TSU9OKS50b0V4dGVybmFsRm9ybSgpLCBtZXRhZGF0
YSwgc3ViKTsNCiAJCQlVUkwgYWN0dWFsRmlsZSA9IFVSTE1ldGFkYXRhUmVwb3NpdG9yeS5nZXRB
Y3R1YWxMb2NhdGlvbihsb2NhdGlvbik7DQotCQkJSW5wdXRTdHJlYW0gaW5TdHJlYW0gPSBVUkxN
ZXRhZGF0YVJlcG9zaXRvcnkuZ2V0QWN0dWFsTG9jYXRpb24obG9jYXRpb24sIGV4dGVuc2lvbiku
b3BlblN0cmVhbSgpOw0KLQkJCWlmIChKQVJfRVhURU5TSU9OLmVxdWFsc0lnbm9yZUNhc2UoZXh0
ZW5zaW9uKSkgew0KKwkJCWlmICghc3RhdHVzLmlzT0soKSkgew0KKwkJCQkvLyByZXRyeSB1bmNv
bXByZXNzZWQNCisJCQkJaWYgKCF0ZW1wLmRlbGV0ZSgpKSB7DQorCQkJCQl0ZW1wLmRlbGV0ZU9u
RXhpdCgpOw0KKwkJCQl9DQorCQkJCXRlbXAgPSBGaWxlLmNyZWF0ZVRlbXBGaWxlKENPTlRFTlRf
RklMRU5BTUUsIFhNTF9FWFRFTlNJT04pOw0KKwkJCQljb21wcmVzcyA9IGZhbHNlOw0KKwkJCQlz
dGF0dXMgPSBnZXRUcmFuc3BvcnQoKS5kb3dubG9hZChVUkxNZXRhZGF0YVJlcG9zaXRvcnkuZ2V0
QWN0dWFsTG9jYXRpb24obG9jYXRpb24sIFhNTF9FWFRFTlNJT04pLnRvRXh0ZXJuYWxGb3JtKCks
IG1ldGFkYXRhLCBzdWIpOw0KKwkJCX0NCisJCQlpZiAobWV0YWRhdGEgIT0gbnVsbCkgew0KKwkJ
CQltZXRhZGF0YS5jbG9zZSgpOw0KKwkJCX0NCisJCQlJbnB1dFN0cmVhbSBpblN0cmVhbSA9IG5l
dyBCdWZmZXJlZElucHV0U3RyZWFtKG5ldyBGaWxlSW5wdXRTdHJlYW0odGVtcCkpOw0KKwkJCWlm
IChjb21wcmVzcykgew0KIAkJCQlKYXJJbnB1dFN0cmVhbSBqSW5TdHJlYW0gPSBuZXcgSmFySW5w
dXRTdHJlYW0oaW5TdHJlYW0pOw0KIAkJCQlKYXJFbnRyeSBqYXJFbnRyeSA9IGpJblN0cmVhbS5n
ZXROZXh0SmFyRW50cnkoKTsNCiAJCQkJU3RyaW5nIGVudHJ5TmFtZSA9IG5ldyBQYXRoKGFjdHVh
bEZpbGUuZ2V0UGF0aCgpKS5sYXN0U2VnbWVudCgpOw0KQEAgLTYyLDEzICs2OSwxMyBAQA0KIAkJ
CQkJamFyRW50cnkgPSBqSW5TdHJlYW0uZ2V0TmV4dEphckVudHJ5KCk7DQogCQkJCX0NCiAJCQkJ
aWYgKGphckVudHJ5ID09IG51bGwpIHsNCi0JCQkJCXRocm93IG5ldyBGaWxlTm90Rm91bmRFeGNl
cHRpb24oIlJlcG9zaXRvcnkgbm90IGZvdW5kIGluICIgKyBhY3R1YWxGaWxlLmdldFBhdGgoKSAr
IGV4dGVuc2lvbik7IC8vJE5PTi1OTFMtMSQNCisJCQkJCXRocm93IG5ldyBGaWxlTm90Rm91bmRF
eGNlcHRpb24oIlJlcG9zaXRvcnkgbm90IGZvdW5kIGluIGNvbXByZXNzZWQgZmlsZS4iKTsgLy8k
Tk9OLU5MUy0xJA0KIAkJCQl9DQogCQkJCWluU3RyZWFtID0gakluU3RyZWFtOw0KIAkJCX0NCiAJ
CQlJbnB1dFN0cmVhbSBkZXNjcmlwdG9yU3RyZWFtID0gbmV3IEJ1ZmZlcmVkSW5wdXRTdHJlYW0o
aW5TdHJlYW0pOw0KIAkJCXRyeSB7DQotCQkJCUlNZXRhZGF0YVJlcG9zaXRvcnkgcmVzdWx0ID0g
bmV3IE1ldGFkYXRhUmVwb3NpdG9yeUlPKCkucmVhZChhY3R1YWxGaWxlLCBkZXNjcmlwdG9yU3Ry
ZWFtLCBtb25pdG9yKTsNCisJCQkJSU1ldGFkYXRhUmVwb3NpdG9yeSByZXN1bHQgPSBuZXcgTWV0
YWRhdGFSZXBvc2l0b3J5SU8oKS5yZWFkKHRlbXAudG9VUkwoKSwgZGVzY3JpcHRvclN0cmVhbSwg
c3ViLm5ld0NoaWxkKDEwMCkpOw0KIAkJCQlpZiAocmVzdWx0IGluc3RhbmNlb2YgTG9jYWxNZXRh
ZGF0YVJlcG9zaXRvcnkpDQogCQkJCQkoKExvY2FsTWV0YWRhdGFSZXBvc2l0b3J5KSByZXN1bHQp
LmluaXRpYWxpemVBZnRlckxvYWQobG9jYXRpb24pOw0KIAkJCQlpZiAocmVzdWx0IGluc3RhbmNl
b2YgVVJMTWV0YWRhdGFSZXBvc2l0b3J5KQ0KQEAgLTg2LDEwICs5MywxOCBAQA0KIAkJCS8vaWYg
dGhlIHJlcG9zaXRvcnkgZG9lc24ndCBleGlzdCwgdGhlbiBpdCdzIGZpbmUgdG8gcmV0dXJuIG51
bGwNCiAJCX0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsNCiAJCQlsb2coZGVidWdNc2csIGUpOw0K
KwkJfSBmaW5hbGx5IHsNCisJCQlpZiAodGVtcCAhPSBudWxsICYmICF0ZW1wLmRlbGV0ZSgpKSB7
DQorCQkJCXRlbXAuZGVsZXRlT25FeGl0KCk7DQorCQkJfQ0KIAkJfQ0KIAkJcmV0dXJuIG51bGw7
DQogCX0NCiANCisJcHJpdmF0ZSBFQ0ZNZXRhZGF0YVRyYW5zcG9ydCBnZXRUcmFuc3BvcnQoKSB7
DQorCQlyZXR1cm4gRUNGTWV0YWRhdGFUcmFuc3BvcnQuZ2V0SW5zdGFuY2UoKTsNCisJfQ0KKw0K
IAlwcml2YXRlIHZvaWQgbG9nKFN0cmluZyBtZXNzYWdlLCBFeGNlcHRpb24gZSkgew0KIAkJTG9n
SGVscGVyLmxvZyhuZXcgU3RhdHVzKElTdGF0dXMuRVJST1IsIEFjdGl2YXRvci5QSV9NRVRBREFU
QV9SRVBPU0lUT1JZLCBtZXNzYWdlLCBlKSk7DQogCX0NCkluZGV4OiBNRVRBLUlORi9NQU5JRkVT
VC5NRg0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2UvZXF1aW5veC1pbmN1
YmF0b3IvcHJvdmlzaW9uaW5nL29yZy5lY2xpcHNlLmVxdWlub3gucDIubWV0YWRhdGEucmVwb3Np
dG9yeS9NRVRBLUlORi9NQU5JRkVTVC5NRix2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuOQ0KZGlm
ZiAtdSAtcjEuOSBNQU5JRkVTVC5NRg0KLS0tIE1FVEEtSU5GL01BTklGRVNULk1GCTIgSmFuIDIw
MDggMjE6MTc6NTUgLTAwMDAJMS45DQorKysgTUVUQS1JTkYvTUFOSUZFU1QuTUYJMTUgSmFuIDIw
MDggMTQ6MzQ6NDUgLTAwMDANCkBAIC0zMiw1ICszMiw4IEBADQogQnVuZGxlLVJlcXVpcmVkRXhl
Y3V0aW9uRW52aXJvbm1lbnQ6IENEQy0xLjEvRm91bmRhdGlvbi0xLjEsDQogIEoyU0UtMS40DQog
UmVxdWlyZS1CdW5kbGU6IG9yZy5lY2xpcHNlLmVxdWlub3guY29tbW9uLA0KLSBvcmcuZWNsaXBz
ZS5lcXVpbm94LnJlZ2lzdHJ5DQorIG9yZy5lY2xpcHNlLmVxdWlub3gucmVnaXN0cnksDQorIG9y
Zy5lY2xpcHNlLm9zZ2k7YnVuZGxlLXZlcnNpb249IjMuNC4wIiwNCisgb3JnLmVjbGlwc2UuZWNm
O2J1bmRsZS12ZXJzaW9uPSIxLjIuMCIsDQorIG9yZy5lY2xpcHNlLmVjZi5maWxldHJhbnNmZXI7
YnVuZGxlLXZlcnNpb249IjIuMC4wIg0KIEVjbGlwc2UtQnVkZHlQb2xpY3k6IHJlZ2lzdGVyZWQN
CkluZGV4OiBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRhZGF0YS9yZXBv
c2l0b3J5L0VDRk1ldGFkYXRhVHJhbnNwb3J0LmphdmENCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiBz
cmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRhZGF0YS9yZXBvc2l0b3J5L0VD
Rk1ldGFkYXRhVHJhbnNwb3J0LmphdmENCmRpZmYgLU4gc3JjL29yZy9lY2xpcHNlL2VxdWlub3gv
aW50ZXJuYWwvcDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9FQ0ZNZXRhZGF0YVRyYW5zcG9ydC5qYXZh
DQotLS0gL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCisrKyBzcmMvb3JnL2Vj
bGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRhZGF0YS9yZXBvc2l0b3J5L0VDRk1ldGFkYXRh
VHJhbnNwb3J0LmphdmEJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KQEAgLTAsMCArMSwxMTgg
QEANCisvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KKyAqIENvcHlyaWdodCAoYykgMjAwNywgMjAw
OCBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4NCisgKiBBbGwgcmlnaHRzIHJlc2VydmVkLiBU
aGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzDQorICogYXJlIG1hZGUg
YXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2
MS4wDQorICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBhdmFp
bGFibGUgYXQNCisgKiBodHRwOi8vd3d3LmVjbGlwc2Uub3JnL2xlZ2FsL2VwbC12MTAuaHRtbA0K
KyAqDQorICogQ29udHJpYnV0b3JzOg0KKyAqICAgICBJQk0gQ29ycG9yYXRpb24gLSBpbml0aWFs
IEFQSSBhbmQgaW1wbGVtZW50YXRpb24NCisgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8NCitwYWNr
YWdlIG9yZy5lY2xpcHNlLmVxdWlub3guaW50ZXJuYWwucDIubWV0YWRhdGEucmVwb3NpdG9yeTsN
CisNCitpbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsNCitpbXBvcnQgamF2YS5pby5PdXRwdXRT
dHJlYW07DQoraW1wb3J0IG9yZy5lY2xpcHNlLmNvcmUucnVudGltZS4qOw0KK2ltcG9ydCBvcmcu
ZWNsaXBzZS5lY2YuZmlsZXRyYW5zZmVyLio7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmVjZi5maWxl
dHJhbnNmZXIuZXZlbnRzLio7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmVjZi5maWxldHJhbnNmZXIu
aWRlbnRpdHkuRmlsZUNyZWF0ZUV4Y2VwdGlvbjsNCitpbXBvcnQgb3JnLmVjbGlwc2UuZWNmLmZp
bGV0cmFuc2Zlci5pZGVudGl0eS5GaWxlSURGYWN0b3J5Ow0KK2ltcG9ydCBvcmcuZWNsaXBzZS5l
Y2YuZmlsZXRyYW5zZmVyLnNlcnZpY2UuSVJldHJpZXZlRmlsZVRyYW5zZmVyRmFjdG9yeTsNCitp
bXBvcnQgb3JnLmVjbGlwc2UuZXF1aW5veC5pbnRlcm5hbC5wMi5jb3JlLmhlbHBlcnMuTG9nSGVs
cGVyOw0KK2ltcG9ydCBvcmcub3NnaS51dGlsLnRyYWNrZXIuU2VydmljZVRyYWNrZXI7DQorDQor
cHVibGljIGNsYXNzIEVDRk1ldGFkYXRhVHJhbnNwb3J0IHsNCisNCisJLyoqDQorCSAqIFRoZSBz
aW5nbGV0b24gdHJhbnNwb3J0IGluc3RhbmNlLg0KKwkgKi8NCisJcHJpdmF0ZSBzdGF0aWMgRUNG
TWV0YWRhdGFUcmFuc3BvcnQgaW5zdGFuY2U7DQorDQorCXByaXZhdGUgZmluYWwgU2VydmljZVRy
YWNrZXIgcmV0cmlldmFsRmFjdG9yeVRyYWNrZXI7DQorDQorCXB1YmxpYyBzdGF0aWMgc3luY2hy
b25pemVkIEVDRk1ldGFkYXRhVHJhbnNwb3J0IGdldEluc3RhbmNlKCkgew0KKwkJaWYgKGluc3Rh
bmNlID09IG51bGwpIHsNCisJCQlpbnN0YW5jZSA9IG5ldyBFQ0ZNZXRhZGF0YVRyYW5zcG9ydCgp
Ow0KKwkJfQ0KKwkJcmV0dXJuIGluc3RhbmNlOw0KKwl9DQorDQorCXByaXZhdGUgRUNGTWV0YWRh
dGFUcmFuc3BvcnQoKSB7DQorCQlyZXRyaWV2YWxGYWN0b3J5VHJhY2tlciA9IG5ldyBTZXJ2aWNl
VHJhY2tlcihBY3RpdmF0b3IuZ2V0Q29udGV4dCgpLCBJUmV0cmlldmVGaWxlVHJhbnNmZXJGYWN0
b3J5LmNsYXNzLmdldE5hbWUoKSwgbnVsbCk7DQorCQlyZXRyaWV2YWxGYWN0b3J5VHJhY2tlci5v
cGVuKCk7DQorCX0NCisNCisJcHVibGljIElTdGF0dXMgZG93bmxvYWQoU3RyaW5nIHRvRG93bmxv
YWQsIE91dHB1dFN0cmVhbSB0YXJnZXQsIElQcm9ncmVzc01vbml0b3IgbW9uaXRvcikgew0KKwkJ
SVJldHJpZXZlRmlsZVRyYW5zZmVyRmFjdG9yeSBmYWN0b3J5ID0gKElSZXRyaWV2ZUZpbGVUcmFu
c2ZlckZhY3RvcnkpIHJldHJpZXZhbEZhY3RvcnlUcmFja2VyLmdldFNlcnZpY2UoKTsNCisJCWlm
IChmYWN0b3J5ID09IG51bGwpDQorCQkJcmV0dXJuIG51bGw7DQorDQorCQlyZXR1cm4gdHJhbnNm
ZXIoZmFjdG9yeS5uZXdJbnN0YW5jZSgpLCB0b0Rvd25sb2FkLCB0YXJnZXQsIG1vbml0b3IpOw0K
Kwl9DQorDQorCXByaXZhdGUgSVN0YXR1cyB0cmFuc2ZlcihmaW5hbCBJUmV0cmlldmVGaWxlVHJh
bnNmZXJDb250YWluZXJBZGFwdGVyIHJldHJpZXZhbENvbnRhaW5lciwgZmluYWwgU3RyaW5nIHRv
RG93bmxvYWQsIGZpbmFsIE91dHB1dFN0cmVhbSB0YXJnZXQsIGZpbmFsIElQcm9ncmVzc01vbml0
b3IgbW9uaXRvcikgew0KKwkJZmluYWwgSVN0YXR1c1tdIHJlc3VsdCA9IG5ldyBJU3RhdHVzWzFd
Ow0KKwkJSUZpbGVUcmFuc2Zlckxpc3RlbmVyIGxpc3RlbmVyID0gbmV3IElGaWxlVHJhbnNmZXJM
aXN0ZW5lcigpIHsNCisNCisJCQlwdWJsaWMgdm9pZCBoYW5kbGVUcmFuc2ZlckV2ZW50KElGaWxl
VHJhbnNmZXJFdmVudCBldmVudCkgew0KKwkJCQlpZiAoZXZlbnQgaW5zdGFuY2VvZiBJSW5jb21p
bmdGaWxlVHJhbnNmZXJSZWNlaXZlU3RhcnRFdmVudCkgew0KKwkJCQkJSUluY29taW5nRmlsZVRy
YW5zZmVyUmVjZWl2ZVN0YXJ0RXZlbnQgcnNlID0gKElJbmNvbWluZ0ZpbGVUcmFuc2ZlclJlY2Vp
dmVTdGFydEV2ZW50KSBldmVudDsNCisJCQkJCWlmICh0YXJnZXQgIT0gbnVsbCkgew0KKwkJCQkJ
CXRyeSB7DQorCQkJCQkJCXJzZS5yZWNlaXZlKHRhcmdldCk7DQorCQkJCQkJfSBjYXRjaCAoSU9F
eGNlcHRpb24gZSkgew0KKwkJCQkJCQlJU3RhdHVzIHN0YXR1cyA9IGNvbnZlcnRUb1N0YXR1cyhl
KTsNCisJCQkJCQkJc3luY2hyb25pemVkIChyZXN1bHQpIHsNCisJCQkJCQkJCXJlc3VsdFswXSA9
IHN0YXR1czsNCisJCQkJCQkJCXJlc3VsdC5ub3RpZnkoKTsNCisJCQkJCQkJfQ0KKwkJCQkJCX0N
CisJCQkJCX0NCisJCQkJfQ0KKwkJCQlpZiAoZXZlbnQgaW5zdGFuY2VvZiBJSW5jb21pbmdGaWxl
VHJhbnNmZXJSZWNlaXZlRGF0YUV2ZW50KSB7DQorCQkJCQlJSW5jb21pbmdGaWxlVHJhbnNmZXIg
c291cmNlID0gKChJSW5jb21pbmdGaWxlVHJhbnNmZXJSZWNlaXZlRGF0YUV2ZW50KSBldmVudCku
Z2V0U291cmNlKCk7DQorCQkJCQlpZiAobW9uaXRvciAhPSBudWxsKSB7DQorCQkJCQkJaWYgKG1v
bml0b3IuaXNDYW5jZWxlZCgpKQ0KKwkJCQkJCQlzb3VyY2UuY2FuY2VsKCk7DQorCQkJCQl9DQor
CQkJCX0NCisJCQkJaWYgKGV2ZW50IGluc3RhbmNlb2YgSUluY29taW5nRmlsZVRyYW5zZmVyUmVj
ZWl2ZURvbmVFdmVudCkgew0KKwkJCQkJSVN0YXR1cyBzdGF0dXMgPSBjb252ZXJ0VG9TdGF0dXMo
KChJSW5jb21pbmdGaWxlVHJhbnNmZXJSZWNlaXZlRG9uZUV2ZW50KSBldmVudCkuZ2V0RXhjZXB0
aW9uKCkpOw0KKwkJCQkJc3luY2hyb25pemVkIChyZXN1bHQpIHsNCisJCQkJCQlyZXN1bHRbMF0g
PSBzdGF0dXM7DQorCQkJCQkJcmVzdWx0Lm5vdGlmeSgpOw0KKwkJCQkJfQ0KKwkJCQl9DQorCQkJ
fQ0KKwkJfTsNCisNCisJCXRyeSB7DQorCQkJcmV0cmlldmFsQ29udGFpbmVyLnNlbmRSZXRyaWV2
ZVJlcXVlc3QoRmlsZUlERmFjdG9yeS5nZXREZWZhdWx0KCkuY3JlYXRlRmlsZUlEKHJldHJpZXZh
bENvbnRhaW5lci5nZXRSZXRyaWV2ZU5hbWVzcGFjZSgpLCB0b0Rvd25sb2FkKSwgbGlzdGVuZXIs
IG51bGwpOw0KKwkJfSBjYXRjaCAoSW5jb21pbmdGaWxlVHJhbnNmZXJFeGNlcHRpb24gZSkgew0K
KwkJCXJldHVybiBuZXcgU3RhdHVzKElTdGF0dXMuRVJST1IsIEFjdGl2YXRvci5JRCwgImVycm9y
IGR1cmluZyB0cmFuc2ZlciIsIGUpOw0KKwkJfSBjYXRjaCAoRmlsZUNyZWF0ZUV4Y2VwdGlvbiBl
KSB7DQorCQkJcmV0dXJuIG5ldyBTdGF0dXMoSVN0YXR1cy5FUlJPUiwgQWN0aXZhdG9yLklELCAi
ZXJyb3IgZHVyaW5nIHRyYW5zZmVyIC0gY291bGQgbm90IGNyZWF0ZSBmaWxlIiwgZSk7DQorCQl9
DQorCQlzeW5jaHJvbml6ZWQgKHJlc3VsdCkgew0KKwkJCXdoaWxlIChyZXN1bHRbMF0gPT0gbnVs
bCkgew0KKwkJCQlib29sZWFuIGxvZ2dlZCA9IGZhbHNlOw0KKwkJCQl0cnkgew0KKwkJCQkJcmVz
dWx0LndhaXQoKTsNCisJCQkJfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgew0KKwkJ
CQkJaWYgKCFsb2dnZWQpDQorCQkJCQkJTG9nSGVscGVyLmxvZyhuZXcgU3RhdHVzKElTdGF0dXMu
V0FSTklORywgQWN0aXZhdG9yLklELCAiVW5leHBlY3RlZCBpbnRlcnJ1cHQgd2hpbGUgd2FpdGlu
ZyBvbiBFQ0YgdHJhbnNmZXIiLCBlKSk7IC8vJE5PTi1OTFMtMSQNCisJCQkJfQ0KKwkJCX0NCisJ
CX0NCisNCisJCXJldHVybiByZXN1bHRbMF07DQorCX0NCisNCisJcHJvdGVjdGVkIElTdGF0dXMg
Y29udmVydFRvU3RhdHVzKEV4Y2VwdGlvbiBlKSB7DQorCQlpZiAoZSA9PSBudWxsKQ0KKwkJCXJl
dHVybiBTdGF0dXMuT0tfU1RBVFVTOw0KKwkJaWYgKGUgaW5zdGFuY2VvZiBVc2VyQ2FuY2VsbGVk
RXhjZXB0aW9uKQ0KKwkJCXJldHVybiBuZXcgU3RhdHVzKElTdGF0dXMuQ0FOQ0VMLCBBY3RpdmF0
b3IuSUQsIGUuZ2V0TWVzc2FnZSgpLCBlKTsNCisJCXJldHVybiBuZXcgU3RhdHVzKElTdGF0dXMu
RVJST1IsIEFjdGl2YXRvci5JRCwgZS5nZXRNZXNzYWdlKCksIGUpOw0KKwl9DQorfQ0K
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>87397</attachid>
            <date>2008-01-21 09:02:00 -0500</date>
            <delta_ts>2008-01-22 16:00:59 -0500</delta_ts>
            <desc>ECF Metadata Transport v02</desc>
            <filename>patch-ECFMetadataTransport_v02.txt</filename>
            <type>text/plain</type>
            <size>10748</size>
            <attacher name="Tim Mok">timothym</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuZXF1aW5veC5w
Mi5tZXRhZGF0YS5yZXBvc2l0b3J5DQpJbmRleDogc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvaW50
ZXJuYWwvcDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9TaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlGYWN0
b3J5LmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL2VxdWlub3gt
aW5jdWJhdG9yL3Byb3Zpc2lvbmluZy9vcmcuZWNsaXBzZS5lcXVpbm94LnAyLm1ldGFkYXRhLnJl
cG9zaXRvcnkvc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvaW50ZXJuYWwvcDIvbWV0YWRhdGEvcmVw
b3NpdG9yeS9TaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlGYWN0b3J5LmphdmEsdg0KcmV0cmlldmlu
ZyByZXZpc2lvbiAxLjE2DQpkaWZmIC11IC1yMS4xNiBTaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlG
YWN0b3J5LmphdmENCi0tLSBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRh
ZGF0YS9yZXBvc2l0b3J5L1NpbXBsZU1ldGFkYXRhUmVwb3NpdG9yeUZhY3RvcnkuamF2YQkxMSBK
YW4gMjAwOCAyMToxMDoxNiAtMDAwMAkxLjE2DQorKysgc3JjL29yZy9lY2xpcHNlL2VxdWlub3gv
aW50ZXJuYWwvcDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9TaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlG
YWN0b3J5LmphdmEJMjEgSmFuIDIwMDggMTQ6MDA6MTMgLTAwMDANCkBAIC0yNCw3ICsyNCw4IEBA
DQogcHVibGljIGNsYXNzIFNpbXBsZU1ldGFkYXRhUmVwb3NpdG9yeUZhY3RvcnkgaW1wbGVtZW50
cyBJTWV0YWRhdGFSZXBvc2l0b3J5RmFjdG9yeSB7DQogDQogCXByaXZhdGUgc3RhdGljIGZpbmFs
IFN0cmluZyBKQVJfRVhURU5TSU9OID0gIi5qYXIiOyAvLyROT04tTkxTLTEkDQotCXByaXZhdGUg
c3RhdGljIGZpbmFsIFN0cmluZyBYTUxfRVhURU5TSU9OID0gIi54bWwiOw0KKwlwcml2YXRlIHN0
YXRpYyBmaW5hbCBTdHJpbmcgWE1MX0VYVEVOU0lPTiA9ICIueG1sIjsgLy8kTk9OLU5MUy0xJA0K
Kwlwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ09OVEVOVF9GSUxFTkFNRSA9ICJjb250ZW50
IjsgLy8kTk9OLU5MUy0xJA0KIA0KIAlwdWJsaWMgSU1ldGFkYXRhUmVwb3NpdG9yeSBjcmVhdGUo
VVJMIGxvY2F0aW9uLCBTdHJpbmcgbmFtZSwgU3RyaW5nIHR5cGUpIHsNCiAJCWlmIChsb2NhdGlv
bi5nZXRQcm90b2NvbCgpLmVxdWFscygiZmlsZSIpKSAvLyROT04tTkxTLTEkDQpAQCAtMzMsMjgg
KzM0LDM2IEBADQogCX0NCiANCiAJcHVibGljIElNZXRhZGF0YVJlcG9zaXRvcnkgbG9hZChVUkwg
bG9jYXRpb24sIElQcm9ncmVzc01vbml0b3IgbW9uaXRvcikgdGhyb3dzIFByb3Zpc2lvbkV4Y2Vw
dGlvbiB7DQotCQlpZiAobW9uaXRvciA9PSBudWxsKQ0KLQkJCW1vbml0b3IgPSBuZXcgTnVsbFBy
b2dyZXNzTW9uaXRvcigpOw0KLQkJLy8gbG9hZCB0aGUgamFyDQotCQlJTWV0YWRhdGFSZXBvc2l0
b3J5IHJlc3VsdCA9IGxvYWQobG9jYXRpb24sIEpBUl9FWFRFTlNJT04sIG1vbml0b3IpOw0KLQkJ
Ly8gY29tcHJlc3NlZCBmaWxlIGlzIG5vdCBhdmFpbGFibGUsIGxvYWQgdGhlIHhtbA0KLQkJaWYg
KHJlc3VsdCA9PSBudWxsKSB7DQotCQkJcmVzdWx0ID0gbG9hZChsb2NhdGlvbiwgWE1MX0VYVEVO
U0lPTiwgbW9uaXRvcik7DQotCQl9DQotCQlyZXR1cm4gcmVzdWx0Ow0KLQl9DQotDQotCXByaXZh
dGUgSU1ldGFkYXRhUmVwb3NpdG9yeSBsb2FkKFVSTCBsb2NhdGlvbiwgU3RyaW5nIGV4dGVuc2lv
biwgSVByb2dyZXNzTW9uaXRvciBtb25pdG9yKSB0aHJvd3MgUHJvdmlzaW9uRXhjZXB0aW9uIHsN
CiAJCWxvbmcgdGltZSA9IDA7DQorCQlib29sZWFuIGNvbXByZXNzID0gdHJ1ZTsNCiAJCWZpbmFs
IFN0cmluZyBkZWJ1Z01zZyA9ICJSZXN0b3JpbmcgbWV0YWRhdGEgcmVwb3NpdG9yeSAiOyAvLyRO
T04tTkxTLTEkDQorCQlGaWxlIHRlbXAgPSBudWxsOw0KIAkJaWYgKFRyYWNpbmcuREVCVUdfTUVU
QURBVEFfUEFSU0lORykgew0KIAkJCVRyYWNpbmcuZGVidWcoZGVidWdNc2cgKyBsb2NhdGlvbik7
DQogCQkJdGltZSA9IC1TeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsNCiAJCX0NCiAJCXRyeSB7
DQorCQkJdGVtcCA9IEZpbGUuY3JlYXRlVGVtcEZpbGUoQ09OVEVOVF9GSUxFTkFNRSwgSkFSX0VY
VEVOU0lPTik7DQorCQkJU3ViTW9uaXRvciBzdWIgPSBTdWJNb25pdG9yLmNvbnZlcnQobW9uaXRv
ciwgMzAwKTsNCisJCQlPdXRwdXRTdHJlYW0gbWV0YWRhdGEgPSBuZXcgQnVmZmVyZWRPdXRwdXRT
dHJlYW0obmV3IEZpbGVPdXRwdXRTdHJlYW0odGVtcCkpOw0KKwkJCUlTdGF0dXMgc3RhdHVzID0g
Z2V0VHJhbnNwb3J0KCkuZG93bmxvYWQoVVJMTWV0YWRhdGFSZXBvc2l0b3J5LmdldEFjdHVhbExv
Y2F0aW9uKGxvY2F0aW9uLCBKQVJfRVhURU5TSU9OKS50b0V4dGVybmFsRm9ybSgpLCBtZXRhZGF0
YSwgc3ViKTsNCiAJCQlVUkwgYWN0dWFsRmlsZSA9IFVSTE1ldGFkYXRhUmVwb3NpdG9yeS5nZXRB
Y3R1YWxMb2NhdGlvbihsb2NhdGlvbik7DQotCQkJSW5wdXRTdHJlYW0gaW5TdHJlYW0gPSBVUkxN
ZXRhZGF0YVJlcG9zaXRvcnkuZ2V0QWN0dWFsTG9jYXRpb24obG9jYXRpb24sIGV4dGVuc2lvbiku
b3BlblN0cmVhbSgpOw0KLQkJCWlmIChKQVJfRVhURU5TSU9OLmVxdWFsc0lnbm9yZUNhc2UoZXh0
ZW5zaW9uKSkgew0KKwkJCWlmICghc3RhdHVzLmlzT0soKSkgew0KKwkJCQkvLyByZXRyeSB1bmNv
bXByZXNzZWQNCisJCQkJbWV0YWRhdGEuY2xvc2UoKTsNCisJCQkJaWYgKCF0ZW1wLmRlbGV0ZSgp
KSB7DQorCQkJCQl0ZW1wLmRlbGV0ZU9uRXhpdCgpOw0KKwkJCQl9DQorCQkJCXRlbXAgPSBGaWxl
LmNyZWF0ZVRlbXBGaWxlKENPTlRFTlRfRklMRU5BTUUsIFhNTF9FWFRFTlNJT04pOw0KKwkJCQlt
ZXRhZGF0YSA9IG5ldyBCdWZmZXJlZE91dHB1dFN0cmVhbShuZXcgRmlsZU91dHB1dFN0cmVhbSh0
ZW1wKSk7DQorCQkJCWNvbXByZXNzID0gZmFsc2U7DQorCQkJCXN0YXR1cyA9IGdldFRyYW5zcG9y
dCgpLmRvd25sb2FkKFVSTE1ldGFkYXRhUmVwb3NpdG9yeS5nZXRBY3R1YWxMb2NhdGlvbihsb2Nh
dGlvbiwgWE1MX0VYVEVOU0lPTikudG9FeHRlcm5hbEZvcm0oKSwgbWV0YWRhdGEsIHN1Yik7DQor
CQkJfQ0KKwkJCWlmIChtZXRhZGF0YSAhPSBudWxsKSB7DQorCQkJCW1ldGFkYXRhLmNsb3NlKCk7
DQorCQkJfQ0KKwkJCUlucHV0U3RyZWFtIGluU3RyZWFtID0gbmV3IEJ1ZmZlcmVkSW5wdXRTdHJl
YW0obmV3IEZpbGVJbnB1dFN0cmVhbSh0ZW1wKSk7DQorCQkJaWYgKGNvbXByZXNzKSB7DQogCQkJ
CUphcklucHV0U3RyZWFtIGpJblN0cmVhbSA9IG5ldyBKYXJJbnB1dFN0cmVhbShpblN0cmVhbSk7
DQogCQkJCUphckVudHJ5IGphckVudHJ5ID0gakluU3RyZWFtLmdldE5leHRKYXJFbnRyeSgpOw0K
IAkJCQlTdHJpbmcgZW50cnlOYW1lID0gbmV3IFBhdGgoYWN0dWFsRmlsZS5nZXRQYXRoKCkpLmxh
c3RTZWdtZW50KCk7DQpAQCAtNjIsMTMgKzcxLDEzIEBADQogCQkJCQlqYXJFbnRyeSA9IGpJblN0
cmVhbS5nZXROZXh0SmFyRW50cnkoKTsNCiAJCQkJfQ0KIAkJCQlpZiAoamFyRW50cnkgPT0gbnVs
bCkgew0KLQkJCQkJdGhyb3cgbmV3IEZpbGVOb3RGb3VuZEV4Y2VwdGlvbigiUmVwb3NpdG9yeSBu
b3QgZm91bmQgaW4gIiArIGFjdHVhbEZpbGUuZ2V0UGF0aCgpICsgZXh0ZW5zaW9uKTsgLy8kTk9O
LU5MUy0xJA0KKwkJCQkJdGhyb3cgbmV3IEZpbGVOb3RGb3VuZEV4Y2VwdGlvbigiUmVwb3NpdG9y
eSBub3QgZm91bmQgaW4gY29tcHJlc3NlZCBmaWxlLiIpOyAvLyROT04tTkxTLTEkDQogCQkJCX0N
CiAJCQkJaW5TdHJlYW0gPSBqSW5TdHJlYW07DQogCQkJfQ0KIAkJCUlucHV0U3RyZWFtIGRlc2Ny
aXB0b3JTdHJlYW0gPSBuZXcgQnVmZmVyZWRJbnB1dFN0cmVhbShpblN0cmVhbSk7DQogCQkJdHJ5
IHsNCi0JCQkJSU1ldGFkYXRhUmVwb3NpdG9yeSByZXN1bHQgPSBuZXcgTWV0YWRhdGFSZXBvc2l0
b3J5SU8oKS5yZWFkKGFjdHVhbEZpbGUsIGRlc2NyaXB0b3JTdHJlYW0sIG1vbml0b3IpOw0KKwkJ
CQlJTWV0YWRhdGFSZXBvc2l0b3J5IHJlc3VsdCA9IG5ldyBNZXRhZGF0YVJlcG9zaXRvcnlJTygp
LnJlYWQodGVtcC50b1VSTCgpLCBkZXNjcmlwdG9yU3RyZWFtLCBzdWIubmV3Q2hpbGQoMTAwKSk7
DQogCQkJCWlmIChyZXN1bHQgaW5zdGFuY2VvZiBMb2NhbE1ldGFkYXRhUmVwb3NpdG9yeSkNCiAJ
CQkJCSgoTG9jYWxNZXRhZGF0YVJlcG9zaXRvcnkpIHJlc3VsdCkuaW5pdGlhbGl6ZUFmdGVyTG9h
ZChsb2NhdGlvbik7DQogCQkJCWlmIChyZXN1bHQgaW5zdGFuY2VvZiBVUkxNZXRhZGF0YVJlcG9z
aXRvcnkpDQpAQCAtODYsMTAgKzk1LDE4IEBADQogCQkJLy9pZiB0aGUgcmVwb3NpdG9yeSBkb2Vz
bid0IGV4aXN0LCB0aGVuIGl0J3MgZmluZSB0byByZXR1cm4gbnVsbA0KIAkJfSBjYXRjaCAoSU9F
eGNlcHRpb24gZSkgew0KIAkJCWxvZyhkZWJ1Z01zZywgZSk7DQorCQl9IGZpbmFsbHkgew0KKwkJ
CWlmICh0ZW1wICE9IG51bGwgJiYgIXRlbXAuZGVsZXRlKCkpIHsNCisJCQkJdGVtcC5kZWxldGVP
bkV4aXQoKTsNCisJCQl9DQogCQl9DQogCQlyZXR1cm4gbnVsbDsNCiAJfQ0KIA0KKwlwcml2YXRl
IEVDRk1ldGFkYXRhVHJhbnNwb3J0IGdldFRyYW5zcG9ydCgpIHsNCisJCXJldHVybiBFQ0ZNZXRh
ZGF0YVRyYW5zcG9ydC5nZXRJbnN0YW5jZSgpOw0KKwl9DQorDQogCXByaXZhdGUgdm9pZCBsb2co
U3RyaW5nIG1lc3NhZ2UsIEV4Y2VwdGlvbiBlKSB7DQogCQlMb2dIZWxwZXIubG9nKG5ldyBTdGF0
dXMoSVN0YXR1cy5FUlJPUiwgQWN0aXZhdG9yLlBJX01FVEFEQVRBX1JFUE9TSVRPUlksIG1lc3Nh
Z2UsIGUpKTsNCiAJfQ0KSW5kZXg6IE1FVEEtSU5GL01BTklGRVNULk1GDQo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpS
Q1MgZmlsZTogL2N2c3Jvb3QvZWNsaXBzZS9lcXVpbm94LWluY3ViYXRvci9wcm92aXNpb25pbmcv
b3JnLmVjbGlwc2UuZXF1aW5veC5wMi5tZXRhZGF0YS5yZXBvc2l0b3J5L01FVEEtSU5GL01BTklG
RVNULk1GLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS45DQpkaWZmIC11IC1yMS45IE1BTklGRVNU
Lk1GDQotLS0gTUVUQS1JTkYvTUFOSUZFU1QuTUYJMiBKYW4gMjAwOCAyMToxNzo1NSAtMDAwMAkx
LjkNCisrKyBNRVRBLUlORi9NQU5JRkVTVC5NRgkyMSBKYW4gMjAwOCAxNDowMDoxMyAtMDAwMA0K
QEAgLTMyLDUgKzMyLDggQEANCiBCdW5kbGUtUmVxdWlyZWRFeGVjdXRpb25FbnZpcm9ubWVudDog
Q0RDLTEuMS9Gb3VuZGF0aW9uLTEuMSwNCiAgSjJTRS0xLjQNCiBSZXF1aXJlLUJ1bmRsZTogb3Jn
LmVjbGlwc2UuZXF1aW5veC5jb21tb24sDQotIG9yZy5lY2xpcHNlLmVxdWlub3gucmVnaXN0cnkN
Cisgb3JnLmVjbGlwc2UuZXF1aW5veC5yZWdpc3RyeSwNCisgb3JnLmVjbGlwc2Uub3NnaTtidW5k
bGUtdmVyc2lvbj0iMy40LjAiLA0KKyBvcmcuZWNsaXBzZS5lY2Y7YnVuZGxlLXZlcnNpb249IjEu
Mi4wIiwNCisgb3JnLmVjbGlwc2UuZWNmLmZpbGV0cmFuc2ZlcjtidW5kbGUtdmVyc2lvbj0iMi4w
LjAiDQogRWNsaXBzZS1CdWRkeVBvbGljeTogcmVnaXN0ZXJlZA0KSW5kZXg6IHNyYy9vcmcvZWNs
aXBzZS9lcXVpbm94L2ludGVybmFsL3AyL21ldGFkYXRhL3JlcG9zaXRvcnkvRUNGTWV0YWRhdGFU
cmFuc3BvcnQuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IHNyYy9vcmcvZWNsaXBzZS9lcXVp
bm94L2ludGVybmFsL3AyL21ldGFkYXRhL3JlcG9zaXRvcnkvRUNGTWV0YWRhdGFUcmFuc3BvcnQu
amF2YQ0KZGlmZiAtTiBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRhZGF0
YS9yZXBvc2l0b3J5L0VDRk1ldGFkYXRhVHJhbnNwb3J0LmphdmENCi0tLSAvZGV2L251bGwJMSBK
YW4gMTk3MCAwMDowMDowMCAtMDAwMA0KKysrIHNyYy9vcmcvZWNsaXBzZS9lcXVpbm94L2ludGVy
bmFsL3AyL21ldGFkYXRhL3JlcG9zaXRvcnkvRUNGTWV0YWRhdGFUcmFuc3BvcnQuamF2YQkxIEph
biAxOTcwIDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDExOCBAQA0KKy8qKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqDQorICogQ29weXJpZ2h0IChjKSAyMDA3LCAyMDA4IElCTSBDb3Jwb3JhdGlvbiBh
bmQgb3RoZXJzLg0KKyAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhl
IGFjY29tcGFueWluZyBtYXRlcmlhbHMNCisgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhl
IHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYxLjANCisgKiB3aGljaCBhY2Nv
bXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdA0KKyAqIGh0dHA6
Ly93d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYxMC5odG1sDQorICoNCisgKiBDb250cmlidXRv
cnM6DQorICogICAgIElCTSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwgQVBJIGFuZCBpbXBsZW1lbnRh
dGlvbg0KKyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KK3BhY2thZ2Ugb3JnLmVjbGlwc2UuZXF1
aW5veC5pbnRlcm5hbC5wMi5tZXRhZGF0YS5yZXBvc2l0b3J5Ow0KKw0KK2ltcG9ydCBqYXZhLmlv
LklPRXhjZXB0aW9uOw0KK2ltcG9ydCBqYXZhLmlvLk91dHB1dFN0cmVhbTsNCitpbXBvcnQgb3Jn
LmVjbGlwc2UuY29yZS5ydW50aW1lLio7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmVjZi5maWxldHJh
bnNmZXIuKjsNCitpbXBvcnQgb3JnLmVjbGlwc2UuZWNmLmZpbGV0cmFuc2Zlci5ldmVudHMuKjsN
CitpbXBvcnQgb3JnLmVjbGlwc2UuZWNmLmZpbGV0cmFuc2Zlci5pZGVudGl0eS5GaWxlQ3JlYXRl
RXhjZXB0aW9uOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5lY2YuZmlsZXRyYW5zZmVyLmlkZW50aXR5
LkZpbGVJREZhY3Rvcnk7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmVjZi5maWxldHJhbnNmZXIuc2Vy
dmljZS5JUmV0cmlldmVGaWxlVHJhbnNmZXJGYWN0b3J5Ow0KK2ltcG9ydCBvcmcuZWNsaXBzZS5l
cXVpbm94LmludGVybmFsLnAyLmNvcmUuaGVscGVycy5Mb2dIZWxwZXI7DQoraW1wb3J0IG9yZy5v
c2dpLnV0aWwudHJhY2tlci5TZXJ2aWNlVHJhY2tlcjsNCisNCitwdWJsaWMgY2xhc3MgRUNGTWV0
YWRhdGFUcmFuc3BvcnQgew0KKw0KKwkvKioNCisJICogVGhlIHNpbmdsZXRvbiB0cmFuc3BvcnQg
aW5zdGFuY2UuDQorCSAqLw0KKwlwcml2YXRlIHN0YXRpYyBFQ0ZNZXRhZGF0YVRyYW5zcG9ydCBp
bnN0YW5jZTsNCisNCisJcHJpdmF0ZSBmaW5hbCBTZXJ2aWNlVHJhY2tlciByZXRyaWV2YWxGYWN0
b3J5VHJhY2tlcjsNCisNCisJcHVibGljIHN0YXRpYyBzeW5jaHJvbml6ZWQgRUNGTWV0YWRhdGFU
cmFuc3BvcnQgZ2V0SW5zdGFuY2UoKSB7DQorCQlpZiAoaW5zdGFuY2UgPT0gbnVsbCkgew0KKwkJ
CWluc3RhbmNlID0gbmV3IEVDRk1ldGFkYXRhVHJhbnNwb3J0KCk7DQorCQl9DQorCQlyZXR1cm4g
aW5zdGFuY2U7DQorCX0NCisNCisJcHJpdmF0ZSBFQ0ZNZXRhZGF0YVRyYW5zcG9ydCgpIHsNCisJ
CXJldHJpZXZhbEZhY3RvcnlUcmFja2VyID0gbmV3IFNlcnZpY2VUcmFja2VyKEFjdGl2YXRvci5n
ZXRDb250ZXh0KCksIElSZXRyaWV2ZUZpbGVUcmFuc2ZlckZhY3RvcnkuY2xhc3MuZ2V0TmFtZSgp
LCBudWxsKTsNCisJCXJldHJpZXZhbEZhY3RvcnlUcmFja2VyLm9wZW4oKTsNCisJfQ0KKw0KKwlw
dWJsaWMgSVN0YXR1cyBkb3dubG9hZChTdHJpbmcgdG9Eb3dubG9hZCwgT3V0cHV0U3RyZWFtIHRh
cmdldCwgSVByb2dyZXNzTW9uaXRvciBtb25pdG9yKSB7DQorCQlJUmV0cmlldmVGaWxlVHJhbnNm
ZXJGYWN0b3J5IGZhY3RvcnkgPSAoSVJldHJpZXZlRmlsZVRyYW5zZmVyRmFjdG9yeSkgcmV0cmll
dmFsRmFjdG9yeVRyYWNrZXIuZ2V0U2VydmljZSgpOw0KKwkJaWYgKGZhY3RvcnkgPT0gbnVsbCkN
CisJCQlyZXR1cm4gbnVsbDsNCisNCisJCXJldHVybiB0cmFuc2ZlcihmYWN0b3J5Lm5ld0luc3Rh
bmNlKCksIHRvRG93bmxvYWQsIHRhcmdldCwgbW9uaXRvcik7DQorCX0NCisNCisJcHJpdmF0ZSBJ
U3RhdHVzIHRyYW5zZmVyKGZpbmFsIElSZXRyaWV2ZUZpbGVUcmFuc2ZlckNvbnRhaW5lckFkYXB0
ZXIgcmV0cmlldmFsQ29udGFpbmVyLCBmaW5hbCBTdHJpbmcgdG9Eb3dubG9hZCwgZmluYWwgT3V0
cHV0U3RyZWFtIHRhcmdldCwgZmluYWwgSVByb2dyZXNzTW9uaXRvciBtb25pdG9yKSB7DQorCQlm
aW5hbCBJU3RhdHVzW10gcmVzdWx0ID0gbmV3IElTdGF0dXNbMV07DQorCQlJRmlsZVRyYW5zZmVy
TGlzdGVuZXIgbGlzdGVuZXIgPSBuZXcgSUZpbGVUcmFuc2Zlckxpc3RlbmVyKCkgew0KKw0KKwkJ
CXB1YmxpYyB2b2lkIGhhbmRsZVRyYW5zZmVyRXZlbnQoSUZpbGVUcmFuc2ZlckV2ZW50IGV2ZW50
KSB7DQorCQkJCWlmIChldmVudCBpbnN0YW5jZW9mIElJbmNvbWluZ0ZpbGVUcmFuc2ZlclJlY2Vp
dmVTdGFydEV2ZW50KSB7DQorCQkJCQlJSW5jb21pbmdGaWxlVHJhbnNmZXJSZWNlaXZlU3RhcnRF
dmVudCByc2UgPSAoSUluY29taW5nRmlsZVRyYW5zZmVyUmVjZWl2ZVN0YXJ0RXZlbnQpIGV2ZW50
Ow0KKwkJCQkJaWYgKHRhcmdldCAhPSBudWxsKSB7DQorCQkJCQkJdHJ5IHsNCisJCQkJCQkJcnNl
LnJlY2VpdmUodGFyZ2V0KTsNCisJCQkJCQl9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7DQorCQkJ
CQkJCUlTdGF0dXMgc3RhdHVzID0gY29udmVydFRvU3RhdHVzKGUpOw0KKwkJCQkJCQlzeW5jaHJv
bml6ZWQgKHJlc3VsdCkgew0KKwkJCQkJCQkJcmVzdWx0WzBdID0gc3RhdHVzOw0KKwkJCQkJCQkJ
cmVzdWx0Lm5vdGlmeSgpOw0KKwkJCQkJCQl9DQorCQkJCQkJfQ0KKwkJCQkJfQ0KKwkJCQl9DQor
CQkJCWlmIChldmVudCBpbnN0YW5jZW9mIElJbmNvbWluZ0ZpbGVUcmFuc2ZlclJlY2VpdmVEYXRh
RXZlbnQpIHsNCisJCQkJCUlJbmNvbWluZ0ZpbGVUcmFuc2ZlciBzb3VyY2UgPSAoKElJbmNvbWlu
Z0ZpbGVUcmFuc2ZlclJlY2VpdmVEYXRhRXZlbnQpIGV2ZW50KS5nZXRTb3VyY2UoKTsNCisJCQkJ
CWlmIChtb25pdG9yICE9IG51bGwpIHsNCisJCQkJCQlpZiAobW9uaXRvci5pc0NhbmNlbGVkKCkp
DQorCQkJCQkJCXNvdXJjZS5jYW5jZWwoKTsNCisJCQkJCX0NCisJCQkJfQ0KKwkJCQlpZiAoZXZl
bnQgaW5zdGFuY2VvZiBJSW5jb21pbmdGaWxlVHJhbnNmZXJSZWNlaXZlRG9uZUV2ZW50KSB7DQor
CQkJCQlJU3RhdHVzIHN0YXR1cyA9IGNvbnZlcnRUb1N0YXR1cygoKElJbmNvbWluZ0ZpbGVUcmFu
c2ZlclJlY2VpdmVEb25lRXZlbnQpIGV2ZW50KS5nZXRFeGNlcHRpb24oKSk7DQorCQkJCQlzeW5j
aHJvbml6ZWQgKHJlc3VsdCkgew0KKwkJCQkJCXJlc3VsdFswXSA9IHN0YXR1czsNCisJCQkJCQly
ZXN1bHQubm90aWZ5KCk7DQorCQkJCQl9DQorCQkJCX0NCisJCQl9DQorCQl9Ow0KKw0KKwkJdHJ5
IHsNCisJCQlyZXRyaWV2YWxDb250YWluZXIuc2VuZFJldHJpZXZlUmVxdWVzdChGaWxlSURGYWN0
b3J5LmdldERlZmF1bHQoKS5jcmVhdGVGaWxlSUQocmV0cmlldmFsQ29udGFpbmVyLmdldFJldHJp
ZXZlTmFtZXNwYWNlKCksIHRvRG93bmxvYWQpLCBsaXN0ZW5lciwgbnVsbCk7DQorCQl9IGNhdGNo
IChJbmNvbWluZ0ZpbGVUcmFuc2ZlckV4Y2VwdGlvbiBlKSB7DQorCQkJcmV0dXJuIG5ldyBTdGF0
dXMoSVN0YXR1cy5FUlJPUiwgQWN0aXZhdG9yLklELCAiZXJyb3IgZHVyaW5nIHRyYW5zZmVyIiwg
ZSk7DQorCQl9IGNhdGNoIChGaWxlQ3JlYXRlRXhjZXB0aW9uIGUpIHsNCisJCQlyZXR1cm4gbmV3
IFN0YXR1cyhJU3RhdHVzLkVSUk9SLCBBY3RpdmF0b3IuSUQsICJlcnJvciBkdXJpbmcgdHJhbnNm
ZXIgLSBjb3VsZCBub3QgY3JlYXRlIGZpbGUiLCBlKTsNCisJCX0NCisJCXN5bmNocm9uaXplZCAo
cmVzdWx0KSB7DQorCQkJd2hpbGUgKHJlc3VsdFswXSA9PSBudWxsKSB7DQorCQkJCWJvb2xlYW4g
bG9nZ2VkID0gZmFsc2U7DQorCQkJCXRyeSB7DQorCQkJCQlyZXN1bHQud2FpdCgpOw0KKwkJCQl9
IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7DQorCQkJCQlpZiAoIWxvZ2dlZCkNCisJ
CQkJCQlMb2dIZWxwZXIubG9nKG5ldyBTdGF0dXMoSVN0YXR1cy5XQVJOSU5HLCBBY3RpdmF0b3Iu
SUQsICJVbmV4cGVjdGVkIGludGVycnVwdCB3aGlsZSB3YWl0aW5nIG9uIEVDRiB0cmFuc2ZlciIs
IGUpKTsgLy8kTk9OLU5MUy0xJA0KKwkJCQl9DQorCQkJfQ0KKwkJfQ0KKw0KKwkJcmV0dXJuIHJl
c3VsdFswXTsNCisJfQ0KKw0KKwlwcm90ZWN0ZWQgSVN0YXR1cyBjb252ZXJ0VG9TdGF0dXMoRXhj
ZXB0aW9uIGUpIHsNCisJCWlmIChlID09IG51bGwpDQorCQkJcmV0dXJuIFN0YXR1cy5PS19TVEFU
VVM7DQorCQlpZiAoZSBpbnN0YW5jZW9mIFVzZXJDYW5jZWxsZWRFeGNlcHRpb24pDQorCQkJcmV0
dXJuIG5ldyBTdGF0dXMoSVN0YXR1cy5DQU5DRUwsIEFjdGl2YXRvci5JRCwgZS5nZXRNZXNzYWdl
KCksIGUpOw0KKwkJcmV0dXJuIG5ldyBTdGF0dXMoSVN0YXR1cy5FUlJPUiwgQWN0aXZhdG9yLklE
LCBlLmdldE1lc3NhZ2UoKSwgZSk7DQorCX0NCit9DQo=
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>87561</attachid>
            <date>2008-01-22 16:00:00 -0500</date>
            <delta_ts>2008-01-22 16:00:59 -0500</delta_ts>
            <desc>ECF Metadata Transport v03</desc>
            <filename>patch-ECFMetadataTransport_v03.txt</filename>
            <type>text/plain</type>
            <size>10748</size>
            <attacher name="Tim Mok">timothym</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuZXF1aW5veC5w
Mi5tZXRhZGF0YS5yZXBvc2l0b3J5DQpJbmRleDogc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvaW50
ZXJuYWwvcDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9TaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlGYWN0
b3J5LmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL2VxdWlub3gt
aW5jdWJhdG9yL3Byb3Zpc2lvbmluZy9vcmcuZWNsaXBzZS5lcXVpbm94LnAyLm1ldGFkYXRhLnJl
cG9zaXRvcnkvc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvaW50ZXJuYWwvcDIvbWV0YWRhdGEvcmVw
b3NpdG9yeS9TaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlGYWN0b3J5LmphdmEsdg0KcmV0cmlldmlu
ZyByZXZpc2lvbiAxLjE2DQpkaWZmIC11IC1yMS4xNiBTaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlG
YWN0b3J5LmphdmENCi0tLSBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRh
ZGF0YS9yZXBvc2l0b3J5L1NpbXBsZU1ldGFkYXRhUmVwb3NpdG9yeUZhY3RvcnkuamF2YQkxMSBK
YW4gMjAwOCAyMToxMDoxNiAtMDAwMAkxLjE2DQorKysgc3JjL29yZy9lY2xpcHNlL2VxdWlub3gv
aW50ZXJuYWwvcDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9TaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlG
YWN0b3J5LmphdmEJMjIgSmFuIDIwMDggMjA6NTc6MTcgLTAwMDANCkBAIC0yNCw3ICsyNCw4IEBA
DQogcHVibGljIGNsYXNzIFNpbXBsZU1ldGFkYXRhUmVwb3NpdG9yeUZhY3RvcnkgaW1wbGVtZW50
cyBJTWV0YWRhdGFSZXBvc2l0b3J5RmFjdG9yeSB7DQogDQogCXByaXZhdGUgc3RhdGljIGZpbmFs
IFN0cmluZyBKQVJfRVhURU5TSU9OID0gIi5qYXIiOyAvLyROT04tTkxTLTEkDQotCXByaXZhdGUg
c3RhdGljIGZpbmFsIFN0cmluZyBYTUxfRVhURU5TSU9OID0gIi54bWwiOw0KKwlwcml2YXRlIHN0
YXRpYyBmaW5hbCBTdHJpbmcgWE1MX0VYVEVOU0lPTiA9ICIueG1sIjsgLy8kTk9OLU5MUy0xJA0K
Kwlwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ09OVEVOVF9GSUxFTkFNRSA9ICJjb250ZW50
IjsgLy8kTk9OLU5MUy0xJA0KIA0KIAlwdWJsaWMgSU1ldGFkYXRhUmVwb3NpdG9yeSBjcmVhdGUo
VVJMIGxvY2F0aW9uLCBTdHJpbmcgbmFtZSwgU3RyaW5nIHR5cGUpIHsNCiAJCWlmIChsb2NhdGlv
bi5nZXRQcm90b2NvbCgpLmVxdWFscygiZmlsZSIpKSAvLyROT04tTkxTLTEkDQpAQCAtMzMsMjgg
KzM0LDM2IEBADQogCX0NCiANCiAJcHVibGljIElNZXRhZGF0YVJlcG9zaXRvcnkgbG9hZChVUkwg
bG9jYXRpb24sIElQcm9ncmVzc01vbml0b3IgbW9uaXRvcikgdGhyb3dzIFByb3Zpc2lvbkV4Y2Vw
dGlvbiB7DQotCQlpZiAobW9uaXRvciA9PSBudWxsKQ0KLQkJCW1vbml0b3IgPSBuZXcgTnVsbFBy
b2dyZXNzTW9uaXRvcigpOw0KLQkJLy8gbG9hZCB0aGUgamFyDQotCQlJTWV0YWRhdGFSZXBvc2l0
b3J5IHJlc3VsdCA9IGxvYWQobG9jYXRpb24sIEpBUl9FWFRFTlNJT04sIG1vbml0b3IpOw0KLQkJ
Ly8gY29tcHJlc3NlZCBmaWxlIGlzIG5vdCBhdmFpbGFibGUsIGxvYWQgdGhlIHhtbA0KLQkJaWYg
KHJlc3VsdCA9PSBudWxsKSB7DQotCQkJcmVzdWx0ID0gbG9hZChsb2NhdGlvbiwgWE1MX0VYVEVO
U0lPTiwgbW9uaXRvcik7DQotCQl9DQotCQlyZXR1cm4gcmVzdWx0Ow0KLQl9DQotDQotCXByaXZh
dGUgSU1ldGFkYXRhUmVwb3NpdG9yeSBsb2FkKFVSTCBsb2NhdGlvbiwgU3RyaW5nIGV4dGVuc2lv
biwgSVByb2dyZXNzTW9uaXRvciBtb25pdG9yKSB0aHJvd3MgUHJvdmlzaW9uRXhjZXB0aW9uIHsN
CiAJCWxvbmcgdGltZSA9IDA7DQorCQlib29sZWFuIGNvbXByZXNzID0gdHJ1ZTsNCiAJCWZpbmFs
IFN0cmluZyBkZWJ1Z01zZyA9ICJSZXN0b3JpbmcgbWV0YWRhdGEgcmVwb3NpdG9yeSAiOyAvLyRO
T04tTkxTLTEkDQorCQlGaWxlIHRlbXAgPSBudWxsOw0KIAkJaWYgKFRyYWNpbmcuREVCVUdfTUVU
QURBVEFfUEFSU0lORykgew0KIAkJCVRyYWNpbmcuZGVidWcoZGVidWdNc2cgKyBsb2NhdGlvbik7
DQogCQkJdGltZSA9IC1TeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsNCiAJCX0NCiAJCXRyeSB7
DQorCQkJdGVtcCA9IEZpbGUuY3JlYXRlVGVtcEZpbGUoQ09OVEVOVF9GSUxFTkFNRSwgSkFSX0VY
VEVOU0lPTik7DQorCQkJU3ViTW9uaXRvciBzdWIgPSBTdWJNb25pdG9yLmNvbnZlcnQobW9uaXRv
ciwgMzAwKTsNCisJCQlPdXRwdXRTdHJlYW0gbWV0YWRhdGEgPSBuZXcgQnVmZmVyZWRPdXRwdXRT
dHJlYW0obmV3IEZpbGVPdXRwdXRTdHJlYW0odGVtcCkpOw0KKwkJCUlTdGF0dXMgc3RhdHVzID0g
Z2V0VHJhbnNwb3J0KCkuZG93bmxvYWQoVVJMTWV0YWRhdGFSZXBvc2l0b3J5LmdldEFjdHVhbExv
Y2F0aW9uKGxvY2F0aW9uLCBKQVJfRVhURU5TSU9OKS50b0V4dGVybmFsRm9ybSgpLCBtZXRhZGF0
YSwgc3ViKTsNCiAJCQlVUkwgYWN0dWFsRmlsZSA9IFVSTE1ldGFkYXRhUmVwb3NpdG9yeS5nZXRB
Y3R1YWxMb2NhdGlvbihsb2NhdGlvbik7DQotCQkJSW5wdXRTdHJlYW0gaW5TdHJlYW0gPSBVUkxN
ZXRhZGF0YVJlcG9zaXRvcnkuZ2V0QWN0dWFsTG9jYXRpb24obG9jYXRpb24sIGV4dGVuc2lvbiku
b3BlblN0cmVhbSgpOw0KLQkJCWlmIChKQVJfRVhURU5TSU9OLmVxdWFsc0lnbm9yZUNhc2UoZXh0
ZW5zaW9uKSkgew0KKwkJCWlmICghc3RhdHVzLmlzT0soKSkgew0KKwkJCQkvLyByZXRyeSB1bmNv
bXByZXNzZWQNCisJCQkJbWV0YWRhdGEuY2xvc2UoKTsNCisJCQkJaWYgKCF0ZW1wLmRlbGV0ZSgp
KSB7DQorCQkJCQl0ZW1wLmRlbGV0ZU9uRXhpdCgpOw0KKwkJCQl9DQorCQkJCXRlbXAgPSBGaWxl
LmNyZWF0ZVRlbXBGaWxlKENPTlRFTlRfRklMRU5BTUUsIFhNTF9FWFRFTlNJT04pOw0KKwkJCQlt
ZXRhZGF0YSA9IG5ldyBCdWZmZXJlZE91dHB1dFN0cmVhbShuZXcgRmlsZU91dHB1dFN0cmVhbSh0
ZW1wKSk7DQorCQkJCWNvbXByZXNzID0gZmFsc2U7DQorCQkJCXN0YXR1cyA9IGdldFRyYW5zcG9y
dCgpLmRvd25sb2FkKFVSTE1ldGFkYXRhUmVwb3NpdG9yeS5nZXRBY3R1YWxMb2NhdGlvbihsb2Nh
dGlvbiwgWE1MX0VYVEVOU0lPTikudG9FeHRlcm5hbEZvcm0oKSwgbWV0YWRhdGEsIHN1Yik7DQor
CQkJfQ0KKwkJCWlmIChtZXRhZGF0YSAhPSBudWxsKSB7DQorCQkJCW1ldGFkYXRhLmNsb3NlKCk7
DQorCQkJfQ0KKwkJCUlucHV0U3RyZWFtIGluU3RyZWFtID0gbmV3IEJ1ZmZlcmVkSW5wdXRTdHJl
YW0obmV3IEZpbGVJbnB1dFN0cmVhbSh0ZW1wKSk7DQorCQkJaWYgKGNvbXByZXNzKSB7DQogCQkJ
CUphcklucHV0U3RyZWFtIGpJblN0cmVhbSA9IG5ldyBKYXJJbnB1dFN0cmVhbShpblN0cmVhbSk7
DQogCQkJCUphckVudHJ5IGphckVudHJ5ID0gakluU3RyZWFtLmdldE5leHRKYXJFbnRyeSgpOw0K
IAkJCQlTdHJpbmcgZW50cnlOYW1lID0gbmV3IFBhdGgoYWN0dWFsRmlsZS5nZXRQYXRoKCkpLmxh
c3RTZWdtZW50KCk7DQpAQCAtNjIsMTMgKzcxLDEzIEBADQogCQkJCQlqYXJFbnRyeSA9IGpJblN0
cmVhbS5nZXROZXh0SmFyRW50cnkoKTsNCiAJCQkJfQ0KIAkJCQlpZiAoamFyRW50cnkgPT0gbnVs
bCkgew0KLQkJCQkJdGhyb3cgbmV3IEZpbGVOb3RGb3VuZEV4Y2VwdGlvbigiUmVwb3NpdG9yeSBu
b3QgZm91bmQgaW4gIiArIGFjdHVhbEZpbGUuZ2V0UGF0aCgpICsgZXh0ZW5zaW9uKTsgLy8kTk9O
LU5MUy0xJA0KKwkJCQkJdGhyb3cgbmV3IEZpbGVOb3RGb3VuZEV4Y2VwdGlvbigiUmVwb3NpdG9y
eSBub3QgZm91bmQgaW4gY29tcHJlc3NlZCBmaWxlLiIpOyAvLyROT04tTkxTLTEkDQogCQkJCX0N
CiAJCQkJaW5TdHJlYW0gPSBqSW5TdHJlYW07DQogCQkJfQ0KIAkJCUlucHV0U3RyZWFtIGRlc2Ny
aXB0b3JTdHJlYW0gPSBuZXcgQnVmZmVyZWRJbnB1dFN0cmVhbShpblN0cmVhbSk7DQogCQkJdHJ5
IHsNCi0JCQkJSU1ldGFkYXRhUmVwb3NpdG9yeSByZXN1bHQgPSBuZXcgTWV0YWRhdGFSZXBvc2l0
b3J5SU8oKS5yZWFkKGFjdHVhbEZpbGUsIGRlc2NyaXB0b3JTdHJlYW0sIG1vbml0b3IpOw0KKwkJ
CQlJTWV0YWRhdGFSZXBvc2l0b3J5IHJlc3VsdCA9IG5ldyBNZXRhZGF0YVJlcG9zaXRvcnlJTygp
LnJlYWQodGVtcC50b1VSTCgpLCBkZXNjcmlwdG9yU3RyZWFtLCBzdWIubmV3Q2hpbGQoMTAwKSk7
DQogCQkJCWlmIChyZXN1bHQgaW5zdGFuY2VvZiBMb2NhbE1ldGFkYXRhUmVwb3NpdG9yeSkNCiAJ
CQkJCSgoTG9jYWxNZXRhZGF0YVJlcG9zaXRvcnkpIHJlc3VsdCkuaW5pdGlhbGl6ZUFmdGVyTG9h
ZChsb2NhdGlvbik7DQogCQkJCWlmIChyZXN1bHQgaW5zdGFuY2VvZiBVUkxNZXRhZGF0YVJlcG9z
aXRvcnkpDQpAQCAtODYsMTAgKzk1LDE4IEBADQogCQkJLy9pZiB0aGUgcmVwb3NpdG9yeSBkb2Vz
bid0IGV4aXN0LCB0aGVuIGl0J3MgZmluZSB0byByZXR1cm4gbnVsbA0KIAkJfSBjYXRjaCAoSU9F
eGNlcHRpb24gZSkgew0KIAkJCWxvZyhkZWJ1Z01zZywgZSk7DQorCQl9IGZpbmFsbHkgew0KKwkJ
CWlmICh0ZW1wICE9IG51bGwgJiYgIXRlbXAuZGVsZXRlKCkpIHsNCisJCQkJdGVtcC5kZWxldGVP
bkV4aXQoKTsNCisJCQl9DQogCQl9DQogCQlyZXR1cm4gbnVsbDsNCiAJfQ0KIA0KKwlwcml2YXRl
IEVDRk1ldGFkYXRhVHJhbnNwb3J0IGdldFRyYW5zcG9ydCgpIHsNCisJCXJldHVybiBFQ0ZNZXRh
ZGF0YVRyYW5zcG9ydC5nZXRJbnN0YW5jZSgpOw0KKwl9DQorDQogCXByaXZhdGUgdm9pZCBsb2co
U3RyaW5nIG1lc3NhZ2UsIEV4Y2VwdGlvbiBlKSB7DQogCQlMb2dIZWxwZXIubG9nKG5ldyBTdGF0
dXMoSVN0YXR1cy5FUlJPUiwgQWN0aXZhdG9yLlBJX01FVEFEQVRBX1JFUE9TSVRPUlksIG1lc3Nh
Z2UsIGUpKTsNCiAJfQ0KSW5kZXg6IE1FVEEtSU5GL01BTklGRVNULk1GDQo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpS
Q1MgZmlsZTogL2N2c3Jvb3QvZWNsaXBzZS9lcXVpbm94LWluY3ViYXRvci9wcm92aXNpb25pbmcv
b3JnLmVjbGlwc2UuZXF1aW5veC5wMi5tZXRhZGF0YS5yZXBvc2l0b3J5L01FVEEtSU5GL01BTklG
RVNULk1GLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS45DQpkaWZmIC11IC1yMS45IE1BTklGRVNU
Lk1GDQotLS0gTUVUQS1JTkYvTUFOSUZFU1QuTUYJMiBKYW4gMjAwOCAyMToxNzo1NSAtMDAwMAkx
LjkNCisrKyBNRVRBLUlORi9NQU5JRkVTVC5NRgkyMiBKYW4gMjAwOCAyMDo1NzoxNyAtMDAwMA0K
QEAgLTMyLDUgKzMyLDggQEANCiBCdW5kbGUtUmVxdWlyZWRFeGVjdXRpb25FbnZpcm9ubWVudDog
Q0RDLTEuMS9Gb3VuZGF0aW9uLTEuMSwNCiAgSjJTRS0xLjQNCiBSZXF1aXJlLUJ1bmRsZTogb3Jn
LmVjbGlwc2UuZXF1aW5veC5jb21tb24sDQotIG9yZy5lY2xpcHNlLmVxdWlub3gucmVnaXN0cnkN
Cisgb3JnLmVjbGlwc2UuZXF1aW5veC5yZWdpc3RyeSwNCisgb3JnLmVjbGlwc2UuZWNmO2J1bmRs
ZS12ZXJzaW9uPSIxLjIuMCIsDQorIG9yZy5lY2xpcHNlLmVjZi5maWxldHJhbnNmZXI7YnVuZGxl
LXZlcnNpb249IjEuMi4wIiwNCisgb3JnLmVjbGlwc2Uub3NnaTtidW5kbGUtdmVyc2lvbj0iMy40
LjAiDQogRWNsaXBzZS1CdWRkeVBvbGljeTogcmVnaXN0ZXJlZA0KSW5kZXg6IHNyYy9vcmcvZWNs
aXBzZS9lcXVpbm94L2ludGVybmFsL3AyL21ldGFkYXRhL3JlcG9zaXRvcnkvRUNGTWV0YWRhdGFU
cmFuc3BvcnQuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IHNyYy9vcmcvZWNsaXBzZS9lcXVp
bm94L2ludGVybmFsL3AyL21ldGFkYXRhL3JlcG9zaXRvcnkvRUNGTWV0YWRhdGFUcmFuc3BvcnQu
amF2YQ0KZGlmZiAtTiBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRhZGF0
YS9yZXBvc2l0b3J5L0VDRk1ldGFkYXRhVHJhbnNwb3J0LmphdmENCi0tLSAvZGV2L251bGwJMSBK
YW4gMTk3MCAwMDowMDowMCAtMDAwMA0KKysrIHNyYy9vcmcvZWNsaXBzZS9lcXVpbm94L2ludGVy
bmFsL3AyL21ldGFkYXRhL3JlcG9zaXRvcnkvRUNGTWV0YWRhdGFUcmFuc3BvcnQuamF2YQkxIEph
biAxOTcwIDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDExOCBAQA0KKy8qKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqDQorICogQ29weXJpZ2h0IChjKSAyMDA3LCAyMDA4IElCTSBDb3Jwb3JhdGlvbiBh
bmQgb3RoZXJzLg0KKyAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhl
IGFjY29tcGFueWluZyBtYXRlcmlhbHMNCisgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhl
IHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYxLjANCisgKiB3aGljaCBhY2Nv
bXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdA0KKyAqIGh0dHA6
Ly93d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYxMC5odG1sDQorICoNCisgKiBDb250cmlidXRv
cnM6DQorICogICAgIElCTSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwgQVBJIGFuZCBpbXBsZW1lbnRh
dGlvbg0KKyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KK3BhY2thZ2Ugb3JnLmVjbGlwc2UuZXF1
aW5veC5pbnRlcm5hbC5wMi5tZXRhZGF0YS5yZXBvc2l0b3J5Ow0KKw0KK2ltcG9ydCBqYXZhLmlv
LklPRXhjZXB0aW9uOw0KK2ltcG9ydCBqYXZhLmlvLk91dHB1dFN0cmVhbTsNCitpbXBvcnQgb3Jn
LmVjbGlwc2UuY29yZS5ydW50aW1lLio7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmVjZi5maWxldHJh
bnNmZXIuKjsNCitpbXBvcnQgb3JnLmVjbGlwc2UuZWNmLmZpbGV0cmFuc2Zlci5ldmVudHMuKjsN
CitpbXBvcnQgb3JnLmVjbGlwc2UuZWNmLmZpbGV0cmFuc2Zlci5pZGVudGl0eS5GaWxlQ3JlYXRl
RXhjZXB0aW9uOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5lY2YuZmlsZXRyYW5zZmVyLmlkZW50aXR5
LkZpbGVJREZhY3Rvcnk7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmVjZi5maWxldHJhbnNmZXIuc2Vy
dmljZS5JUmV0cmlldmVGaWxlVHJhbnNmZXJGYWN0b3J5Ow0KK2ltcG9ydCBvcmcuZWNsaXBzZS5l
cXVpbm94LmludGVybmFsLnAyLmNvcmUuaGVscGVycy5Mb2dIZWxwZXI7DQoraW1wb3J0IG9yZy5v
c2dpLnV0aWwudHJhY2tlci5TZXJ2aWNlVHJhY2tlcjsNCisNCitwdWJsaWMgY2xhc3MgRUNGTWV0
YWRhdGFUcmFuc3BvcnQgew0KKw0KKwkvKioNCisJICogVGhlIHNpbmdsZXRvbiB0cmFuc3BvcnQg
aW5zdGFuY2UuDQorCSAqLw0KKwlwcml2YXRlIHN0YXRpYyBFQ0ZNZXRhZGF0YVRyYW5zcG9ydCBp
bnN0YW5jZTsNCisNCisJcHJpdmF0ZSBmaW5hbCBTZXJ2aWNlVHJhY2tlciByZXRyaWV2YWxGYWN0
b3J5VHJhY2tlcjsNCisNCisJcHVibGljIHN0YXRpYyBzeW5jaHJvbml6ZWQgRUNGTWV0YWRhdGFU
cmFuc3BvcnQgZ2V0SW5zdGFuY2UoKSB7DQorCQlpZiAoaW5zdGFuY2UgPT0gbnVsbCkgew0KKwkJ
CWluc3RhbmNlID0gbmV3IEVDRk1ldGFkYXRhVHJhbnNwb3J0KCk7DQorCQl9DQorCQlyZXR1cm4g
aW5zdGFuY2U7DQorCX0NCisNCisJcHJpdmF0ZSBFQ0ZNZXRhZGF0YVRyYW5zcG9ydCgpIHsNCisJ
CXJldHJpZXZhbEZhY3RvcnlUcmFja2VyID0gbmV3IFNlcnZpY2VUcmFja2VyKEFjdGl2YXRvci5n
ZXRDb250ZXh0KCksIElSZXRyaWV2ZUZpbGVUcmFuc2ZlckZhY3RvcnkuY2xhc3MuZ2V0TmFtZSgp
LCBudWxsKTsNCisJCXJldHJpZXZhbEZhY3RvcnlUcmFja2VyLm9wZW4oKTsNCisJfQ0KKw0KKwlw
dWJsaWMgSVN0YXR1cyBkb3dubG9hZChTdHJpbmcgdG9Eb3dubG9hZCwgT3V0cHV0U3RyZWFtIHRh
cmdldCwgSVByb2dyZXNzTW9uaXRvciBtb25pdG9yKSB7DQorCQlJUmV0cmlldmVGaWxlVHJhbnNm
ZXJGYWN0b3J5IGZhY3RvcnkgPSAoSVJldHJpZXZlRmlsZVRyYW5zZmVyRmFjdG9yeSkgcmV0cmll
dmFsRmFjdG9yeVRyYWNrZXIuZ2V0U2VydmljZSgpOw0KKwkJaWYgKGZhY3RvcnkgPT0gbnVsbCkN
CisJCQlyZXR1cm4gbnVsbDsNCisNCisJCXJldHVybiB0cmFuc2ZlcihmYWN0b3J5Lm5ld0luc3Rh
bmNlKCksIHRvRG93bmxvYWQsIHRhcmdldCwgbW9uaXRvcik7DQorCX0NCisNCisJcHJpdmF0ZSBJ
U3RhdHVzIHRyYW5zZmVyKGZpbmFsIElSZXRyaWV2ZUZpbGVUcmFuc2ZlckNvbnRhaW5lckFkYXB0
ZXIgcmV0cmlldmFsQ29udGFpbmVyLCBmaW5hbCBTdHJpbmcgdG9Eb3dubG9hZCwgZmluYWwgT3V0
cHV0U3RyZWFtIHRhcmdldCwgZmluYWwgSVByb2dyZXNzTW9uaXRvciBtb25pdG9yKSB7DQorCQlm
aW5hbCBJU3RhdHVzW10gcmVzdWx0ID0gbmV3IElTdGF0dXNbMV07DQorCQlJRmlsZVRyYW5zZmVy
TGlzdGVuZXIgbGlzdGVuZXIgPSBuZXcgSUZpbGVUcmFuc2Zlckxpc3RlbmVyKCkgew0KKw0KKwkJ
CXB1YmxpYyB2b2lkIGhhbmRsZVRyYW5zZmVyRXZlbnQoSUZpbGVUcmFuc2ZlckV2ZW50IGV2ZW50
KSB7DQorCQkJCWlmIChldmVudCBpbnN0YW5jZW9mIElJbmNvbWluZ0ZpbGVUcmFuc2ZlclJlY2Vp
dmVTdGFydEV2ZW50KSB7DQorCQkJCQlJSW5jb21pbmdGaWxlVHJhbnNmZXJSZWNlaXZlU3RhcnRF
dmVudCByc2UgPSAoSUluY29taW5nRmlsZVRyYW5zZmVyUmVjZWl2ZVN0YXJ0RXZlbnQpIGV2ZW50
Ow0KKwkJCQkJaWYgKHRhcmdldCAhPSBudWxsKSB7DQorCQkJCQkJdHJ5IHsNCisJCQkJCQkJcnNl
LnJlY2VpdmUodGFyZ2V0KTsNCisJCQkJCQl9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7DQorCQkJ
CQkJCUlTdGF0dXMgc3RhdHVzID0gY29udmVydFRvU3RhdHVzKGUpOw0KKwkJCQkJCQlzeW5jaHJv
bml6ZWQgKHJlc3VsdCkgew0KKwkJCQkJCQkJcmVzdWx0WzBdID0gc3RhdHVzOw0KKwkJCQkJCQkJ
cmVzdWx0Lm5vdGlmeSgpOw0KKwkJCQkJCQl9DQorCQkJCQkJfQ0KKwkJCQkJfQ0KKwkJCQl9DQor
CQkJCWlmIChldmVudCBpbnN0YW5jZW9mIElJbmNvbWluZ0ZpbGVUcmFuc2ZlclJlY2VpdmVEYXRh
RXZlbnQpIHsNCisJCQkJCUlJbmNvbWluZ0ZpbGVUcmFuc2ZlciBzb3VyY2UgPSAoKElJbmNvbWlu
Z0ZpbGVUcmFuc2ZlclJlY2VpdmVEYXRhRXZlbnQpIGV2ZW50KS5nZXRTb3VyY2UoKTsNCisJCQkJ
CWlmIChtb25pdG9yICE9IG51bGwpIHsNCisJCQkJCQlpZiAobW9uaXRvci5pc0NhbmNlbGVkKCkp
DQorCQkJCQkJCXNvdXJjZS5jYW5jZWwoKTsNCisJCQkJCX0NCisJCQkJfQ0KKwkJCQlpZiAoZXZl
bnQgaW5zdGFuY2VvZiBJSW5jb21pbmdGaWxlVHJhbnNmZXJSZWNlaXZlRG9uZUV2ZW50KSB7DQor
CQkJCQlJU3RhdHVzIHN0YXR1cyA9IGNvbnZlcnRUb1N0YXR1cygoKElJbmNvbWluZ0ZpbGVUcmFu
c2ZlclJlY2VpdmVEb25lRXZlbnQpIGV2ZW50KS5nZXRFeGNlcHRpb24oKSk7DQorCQkJCQlzeW5j
aHJvbml6ZWQgKHJlc3VsdCkgew0KKwkJCQkJCXJlc3VsdFswXSA9IHN0YXR1czsNCisJCQkJCQly
ZXN1bHQubm90aWZ5KCk7DQorCQkJCQl9DQorCQkJCX0NCisJCQl9DQorCQl9Ow0KKw0KKwkJdHJ5
IHsNCisJCQlyZXRyaWV2YWxDb250YWluZXIuc2VuZFJldHJpZXZlUmVxdWVzdChGaWxlSURGYWN0
b3J5LmdldERlZmF1bHQoKS5jcmVhdGVGaWxlSUQocmV0cmlldmFsQ29udGFpbmVyLmdldFJldHJp
ZXZlTmFtZXNwYWNlKCksIHRvRG93bmxvYWQpLCBsaXN0ZW5lciwgbnVsbCk7DQorCQl9IGNhdGNo
IChJbmNvbWluZ0ZpbGVUcmFuc2ZlckV4Y2VwdGlvbiBlKSB7DQorCQkJcmV0dXJuIG5ldyBTdGF0
dXMoSVN0YXR1cy5FUlJPUiwgQWN0aXZhdG9yLklELCAiZXJyb3IgZHVyaW5nIHRyYW5zZmVyIiwg
ZSk7DQorCQl9IGNhdGNoIChGaWxlQ3JlYXRlRXhjZXB0aW9uIGUpIHsNCisJCQlyZXR1cm4gbmV3
IFN0YXR1cyhJU3RhdHVzLkVSUk9SLCBBY3RpdmF0b3IuSUQsICJlcnJvciBkdXJpbmcgdHJhbnNm
ZXIgLSBjb3VsZCBub3QgY3JlYXRlIGZpbGUiLCBlKTsNCisJCX0NCisJCXN5bmNocm9uaXplZCAo
cmVzdWx0KSB7DQorCQkJd2hpbGUgKHJlc3VsdFswXSA9PSBudWxsKSB7DQorCQkJCWJvb2xlYW4g
bG9nZ2VkID0gZmFsc2U7DQorCQkJCXRyeSB7DQorCQkJCQlyZXN1bHQud2FpdCgpOw0KKwkJCQl9
IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7DQorCQkJCQlpZiAoIWxvZ2dlZCkNCisJ
CQkJCQlMb2dIZWxwZXIubG9nKG5ldyBTdGF0dXMoSVN0YXR1cy5XQVJOSU5HLCBBY3RpdmF0b3Iu
SUQsICJVbmV4cGVjdGVkIGludGVycnVwdCB3aGlsZSB3YWl0aW5nIG9uIEVDRiB0cmFuc2ZlciIs
IGUpKTsgLy8kTk9OLU5MUy0xJA0KKwkJCQl9DQorCQkJfQ0KKwkJfQ0KKw0KKwkJcmV0dXJuIHJl
c3VsdFswXTsNCisJfQ0KKw0KKwlwcm90ZWN0ZWQgSVN0YXR1cyBjb252ZXJ0VG9TdGF0dXMoRXhj
ZXB0aW9uIGUpIHsNCisJCWlmIChlID09IG51bGwpDQorCQkJcmV0dXJuIFN0YXR1cy5PS19TVEFU
VVM7DQorCQlpZiAoZSBpbnN0YW5jZW9mIFVzZXJDYW5jZWxsZWRFeGNlcHRpb24pDQorCQkJcmV0
dXJuIG5ldyBTdGF0dXMoSVN0YXR1cy5DQU5DRUwsIEFjdGl2YXRvci5JRCwgZS5nZXRNZXNzYWdl
KCksIGUpOw0KKwkJcmV0dXJuIG5ldyBTdGF0dXMoSVN0YXR1cy5FUlJPUiwgQWN0aXZhdG9yLklE
LCBlLmdldE1lc3NhZ2UoKSwgZSk7DQorCX0NCit9DQo=
</data>

          </attachment>
      

    </bug>

</bugzilla>