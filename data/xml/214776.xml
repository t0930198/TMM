<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.1"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>214776</bug_id>
          
          <creation_ts>2008-01-09 12:13:00 -0500</creation_ts>
          <short_desc>[prov] System property not persisted by repository manager</short_desc>
          <delta_ts>2008-01-10 17:19:54 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>12</classification_id>
          <classification>RT</classification>
          <product>Equinox</product>
          <component>Incubator</component>
          <version>3.4</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows XP</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>3.4 M5</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="John Arthorne">john_arthorne</reporter>
          <assigned_to name="equinox.incubator-inbox">equinox.incubator-inbox</assigned_to>
          
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1128257</commentid>
    <comment_count>0</comment_count>
    <who name="John Arthorne">john_arthorne</who>
    <bug_when>2008-01-09 12:13:20 -0500</bug_when>
    <thetext>Build: I20080108-1320

- download and start the p2 agent
-&gt; Notice the &quot;download cache&quot; appears in the artifacts view. It appears that it is missing the &quot;implementation only&quot; property, or the UI is not correctly hiding it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1128259</commentid>
    <comment_count>1</comment_count>
    <who name="John Arthorne">john_arthorne</who>
    <bug_when>2008-01-09 12:14:30 -0500</bug_when>
    <thetext>The Agent Metadata Cache is also appearing after I perform an install. All other system repositories are hidden, so it doesn&apos;t look like a UI problem.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1128364</commentid>
    <comment_count>2</comment_count>
    <who name="John Arthorne">john_arthorne</who>
    <bug_when>2008-01-09 14:24:59 -0500</bug_when>
    <thetext>The problem here is that if someone calls IArtifactRepository.setProperty(PROP_SYSTEM, &quot;true&quot;), the preference data in the artifact repository manager is not updated. So, the repository knows it is a system repo, but the artifact repository manager doesn&apos;t.  When the UI goes to query the repositories to show, it is filtering on a stale value of the system property. The same problem exists for metadata repositories.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1128991</commentid>
    <comment_count>3</comment_count>
      <attachid>86572</attachid>
    <who name="John Arthorne">john_arthorne</who>
    <bug_when>2008-01-10 11:50:18 -0500</bug_when>
    <thetext>Created attachment 86572
Test case</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1129283</commentid>
    <comment_count>4</comment_count>
      <attachid>86613</attachid>
    <who name="John Arthorne">john_arthorne</who>
    <bug_when>2008-01-10 16:21:13 -0500</bug_when>
    <thetext>Created attachment 86613
Test case

Previous attachment was the wrong patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1129342</commentid>
    <comment_count>5</comment_count>
    <who name="John Arthorne">john_arthorne</who>
    <bug_when>2008-01-10 17:19:54 -0500</bug_when>
    <thetext>Fix and tests released.

It&apos;s a bit awkward, but the fix was to ask the repository manager to re-load the repository when a repository property has changed. The repository manager doesn&apos;t actually load the repository again because it has a cached instance, but it updates its own cache of the repository properties at that time.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>86572</attachid>
            <date>2008-01-10 11:50:00 -0500</date>
            <delta_ts>2008-01-10 16:21:13 -0500</delta_ts>
            <desc>Test case</desc>
            <filename>patch.txt</filename>
            <type>text/plain</type>
            <size>16708</size>
            <attacher name="John Arthorne">john_arthorne</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuZXF1aW5veC5w
Mi5tZXRhZGF0YS5nZW5lcmF0b3INCkluZGV4OiBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRl
cm5hbC9wMi9tZXRhZGF0YS9nZW5lcmF0b3IvRWNsaXBzZUdlbmVyYXRvckFwcGxpY2F0aW9uLmph
dmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL2VxdWlub3gtaW5jdWJh
dG9yL3Byb3Zpc2lvbmluZy9vcmcuZWNsaXBzZS5lcXVpbm94LnAyLm1ldGFkYXRhLmdlbmVyYXRv
ci9zcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRhZGF0YS9nZW5lcmF0b3Iv
RWNsaXBzZUdlbmVyYXRvckFwcGxpY2F0aW9uLmphdmEsdg0KcmV0cmlldmluZyByZXZpc2lvbiAx
LjEwDQpkaWZmIC11IC1yMS4xMCBFY2xpcHNlR2VuZXJhdG9yQXBwbGljYXRpb24uamF2YQ0KLS0t
IHNyYy9vcmcvZWNsaXBzZS9lcXVpbm94L2ludGVybmFsL3AyL21ldGFkYXRhL2dlbmVyYXRvci9F
Y2xpcHNlR2VuZXJhdG9yQXBwbGljYXRpb24uamF2YQk1IERlYyAyMDA3IDE3OjEwOjIwIC0wMDAw
CTEuMTANCisrKyBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRhZGF0YS9n
ZW5lcmF0b3IvRWNsaXBzZUdlbmVyYXRvckFwcGxpY2F0aW9uLmphdmEJOCBKYW4gMjAwOCAxODo1
NTo0NyAtMDAwMA0KQEAgLTIyLDYgKzIyLDcgQEANCiBpbXBvcnQgb3JnLmVjbGlwc2UuZXF1aW5v
eC5wMi5hcnRpZmFjdC5yZXBvc2l0b3J5LklBcnRpZmFjdFJlcG9zaXRvcnk7DQogaW1wb3J0IG9y
Zy5lY2xpcHNlLmVxdWlub3gucDIuYXJ0aWZhY3QucmVwb3NpdG9yeS5JQXJ0aWZhY3RSZXBvc2l0
b3J5TWFuYWdlcjsNCiBpbXBvcnQgb3JnLmVjbGlwc2UuZXF1aW5veC5wMi5jb3JlLmV2ZW50YnVz
LlByb3Zpc2lvbmluZ0V2ZW50QnVzOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5lcXVpbm94LnAyLmNv
cmUucmVwb3NpdG9yeS5JUmVwb3NpdG9yeTsNCiBpbXBvcnQgb3JnLmVjbGlwc2UuZXF1aW5veC5w
Mi5tZXRhZGF0YS5nZW5lcmF0b3IuRWNsaXBzZUluc3RhbGxHZW5lcmF0b3JJbmZvUHJvdmlkZXI7
DQogaW1wb3J0IG9yZy5lY2xpcHNlLmVxdWlub3gucDIubWV0YWRhdGEuZ2VuZXJhdG9yLkdlbmVy
YXRvcjsNCiBpbXBvcnQgb3JnLmVjbGlwc2UuZXF1aW5veC5wMi5tZXRhZGF0YS5yZXBvc2l0b3J5
LklNZXRhZGF0YVJlcG9zaXRvcnk7DQpAQCAtNTEsNiArNTIsOCBAQA0KIAlwcml2YXRlIFN0cmlu
ZyBmZWF0dXJlczsNCiAJcHJpdmF0ZSBTdHJpbmcgYnVuZGxlczsNCiAJcHJpdmF0ZSBTdHJpbmcg
YmFzZTsNCisJLy93aGV0aGVyIHJlcG9zaXRvcnkgeG1sIGZpbGVzIHNob3VsZCBiZSBjb21wcmVz
c2VkDQorCXByaXZhdGUgU3RyaW5nIGNvbXByZXNzID0gImZhbHNlIjsgLy8kTk9OLU5MUy0xJA0K
IA0KIAlwcml2YXRlIEZpbGUgZ2V0RXhlY3V0YWJsZU5hbWUoU3RyaW5nIGJhc2UsIEVjbGlwc2VJ
bnN0YWxsR2VuZXJhdG9ySW5mb1Byb3ZpZGVyIHByb3ZpZGVyKSB7DQogCQlGaWxlIGxvY2F0aW9u
ID0gcHJvdmlkZXIuZ2V0RXhlY3V0YWJsZUxvY2F0aW9uKCk7DQpAQCAtMTMxLDYgKzEzNCw3IEBA
DQogCQlJTWV0YWRhdGFSZXBvc2l0b3J5TWFuYWdlciBtYW5hZ2VyID0gKElNZXRhZGF0YVJlcG9z
aXRvcnlNYW5hZ2VyKSBTZXJ2aWNlSGVscGVyLmdldFNlcnZpY2UoQWN0aXZhdG9yLmNvbnRleHQs
IElNZXRhZGF0YVJlcG9zaXRvcnlNYW5hZ2VyLmNsYXNzLmdldE5hbWUoKSk7DQogCQlJTWV0YWRh
dGFSZXBvc2l0b3J5IHJlcG9zaXRvcnkgPSBtYW5hZ2VyLmxvYWRSZXBvc2l0b3J5KGxvY2F0aW9u
LCBudWxsKTsNCiAJCWlmIChyZXBvc2l0b3J5ICE9IG51bGwpIHsNCisJCQlyZXBvc2l0b3J5LnNl
dFByb3BlcnR5KElSZXBvc2l0b3J5LlBST1BfQ09NUFJFU1NFRCwgY29tcHJlc3MpOw0KIAkJCWlm
ICghcmVwb3NpdG9yeS5pc01vZGlmaWFibGUoKSkNCiAJCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1
bWVudEV4Y2VwdGlvbigiTWV0YWRhdGEgcmVwb3NpdG9yeSBub3Qgd3JpdGVhYmxlOiAiICsgbG9j
YXRpb24pOyAvLyROT04tTkxTLTEkDQogCQkJcHJvdmlkZXIuc2V0TWV0YWRhdGFSZXBvc2l0b3J5
KHJlcG9zaXRvcnkpOw0KQEAgLTE0Myw2ICsxNDcsNyBAQA0KIAkJLy8gVE9ETyBmb3Igbm93IGNy
ZWF0ZSBhIHJhbmRvbSByZXBvIGJ5IGRlZmF1bHQuDQogCQlTdHJpbmcgcmVwb3NpdG9yeU5hbWUg
PSBtZXRhZGF0YUxvY2F0aW9uICsgIiAtIG1ldGFkYXRhIjsgLy8kTk9OLU5MUy0xJA0KIAkJSU1l
dGFkYXRhUmVwb3NpdG9yeSByZXN1bHQgPSBtYW5hZ2VyLmNyZWF0ZVJlcG9zaXRvcnkobG9jYXRp
b24sIHJlcG9zaXRvcnlOYW1lLCBJTWV0YWRhdGFSZXBvc2l0b3J5TWFuYWdlci5UWVBFX1NJTVBM
RV9SRVBPU0lUT1JZKTsNCisJCXJlc3VsdC5zZXRQcm9wZXJ0eShJUmVwb3NpdG9yeS5QUk9QX0NP
TVBSRVNTRUQsIGNvbXByZXNzKTsNCiAJCWlmIChyZXN1bHQgIT0gbnVsbCkNCiAJCQlwcm92aWRl
ci5zZXRNZXRhZGF0YVJlcG9zaXRvcnkocmVzdWx0KTsNCiAJfQ0KQEAgLTE3MCw2ICsxNzUsOSBA
QA0KIAkJCWlmIChhcmdzW2ldLmVxdWFsc0lnbm9yZUNhc2UoIi1ub0RlZmF1bHRJVXMiKSkNCiAJ
CQkJcHJvdmlkZXIuc2V0QWRkRGVmYXVsdElVcyhmYWxzZSk7DQogDQorCQkJaWYgKGFyZ3NbaV0u
ZXF1YWxzSWdub3JlQ2FzZSgiLWNvbXByZXNzIikpDQorCQkJCWNvbXByZXNzID0gInRydWUiOyAv
LyROT04tTkxTLTEkDQorDQogCQkJLy8gY2hlY2sgZm9yIGFyZ3Mgd2l0aCBwYXJhbWV0ZXJzLiBJ
ZiB3ZSBhcmUgYXQgdGhlIGxhc3QgYXJndW1lbnQgb3IgaWYgdGhlIG5leHQgb25lDQogCQkJLy8g
aGFzIGEgJy0nIGFzIHRoZSBmaXJzdCBjaGFyYWN0ZXIsIHRoZW4gd2UgY2FuJ3QgaGF2ZSBhbiBh
cmcgd2l0aCBhIHBhcm0gc28gY29udGludWUuDQogCQkJaWYgKGkgPT0gYXJncy5sZW5ndGggLSAx
IHx8IGFyZ3NbaSArIDFdLnN0YXJ0c1dpdGgoIi0iKSkgLy8kTk9OLU5MUy0xJA0KI1Agb3JnLmVj
bGlwc2UuZXF1aW5veC5wMi5jb3JlDQpJbmRleDogc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvcDIv
Y29yZS9yZXBvc2l0b3J5L0lSZXBvc2l0b3J5LmphdmENCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAv
Y3Zzcm9vdC9lY2xpcHNlL2VxdWlub3gtaW5jdWJhdG9yL3Byb3Zpc2lvbmluZy9vcmcuZWNsaXBz
ZS5lcXVpbm94LnAyLmNvcmUvc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvcDIvY29yZS9yZXBvc2l0
b3J5L0lSZXBvc2l0b3J5LmphdmEsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjUNCmRpZmYgLXUg
LXIxLjUgSVJlcG9zaXRvcnkuamF2YQ0KLS0tIHNyYy9vcmcvZWNsaXBzZS9lcXVpbm94L3AyL2Nv
cmUvcmVwb3NpdG9yeS9JUmVwb3NpdG9yeS5qYXZhCTIgSmFuIDIwMDggMTY6MDY6MzIgLTAwMDAJ
MS41DQorKysgc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvcDIvY29yZS9yZXBvc2l0b3J5L0lSZXBv
c2l0b3J5LmphdmEJOCBKYW4gMjAwOCAxODo1NTo0OCAtMDAwMA0KQEAgLTIxLDEyICsyMSwyMiBA
QA0KICAqIFRoaXMgaW50ZXJmYWNlIGlzIG5vdCBpbnRlbmRlZCB0byBiZSBpbXBsZW1lbnRlZCBi
eSBjbGllbnRzLg0KICAqLw0KIHB1YmxpYyBpbnRlcmZhY2UgSVJlcG9zaXRvcnkgZXh0ZW5kcyBJ
QWRhcHRhYmxlIHsNCi0JLy8gVGhlIHByb3BlcnR5IGtleSBmb3IgYSBib29sZWFuIHByb3BlcnR5
IGluZGljYXRpbmcgdGhhdCB0aGUgcmVwb3NpdG9yeQ0KLQkvLyBpcyBhbiBpbXBsZW1lbnRhdGlv
biBkZXRhaWwsIG5vdCBzdWJqZWN0IHRvIGdlbmVyYWwgYWNjZXNzLCBoaWRkZW4NCi0JLy8gZnJv
bSB0aGUgdHlwaWNhbCB1c2VyLCBldGMuDQorCS8qKiANCisJICogVGhlIHByb3BlcnR5IGtleSBm
b3IgYSBib29sZWFuIHByb3BlcnR5IGluZGljYXRpbmcgdGhhdCB0aGUgcmVwb3NpdG9yeQ0KKwkg
KiBpcyBhbiBpbXBsZW1lbnRhdGlvbiBkZXRhaWwsIG5vdCBzdWJqZWN0IHRvIGdlbmVyYWwgYWNj
ZXNzLCBoaWRkZW4NCisJICogZnJvbSB0aGUgdHlwaWNhbCB1c2VyLCBldGMuDQorCSAqLw0KIAlz
dGF0aWMgcHVibGljIFN0cmluZyBJTVBMRU1FTlRBVElPTl9PTkxZX0tFWSA9ICJpbXBsZW1lbnRh
dGlvbk9ubHkiOyAvLyROT04tTkxTLTEkDQogDQogCS8qKg0KKwkgKiBUaGUga2V5IGZvciBhIGJv
b2xlYW4gcHJvcGVydHkgaW5kaWNhdGluZyB0aGF0IHJlcG9zaXRvcnkgbWV0YWRhdGEgaXMNCisJ
ICogc3RvcmVkIGluIGNvbXByZXNzZWQgZm9ybS4gIEEgY29tcHJlc3NlZCByZXBvc2l0b3J5IHdp
bGwgaGF2ZSBsb3dlcg0KKwkgKiBiYW5kd2lkdGggY29zdCB0byByZWFkIHdoZW4gcmVtb3RlLCBi
dXQgaGlnaGVyIHByb2Nlc3NpbmcgY29zdCB0bw0KKwkgKiB1bmNvbXByZXNzIHdoZW4gcmVhZGlu
Zy4NCisJICovDQorCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFBST1BfQ09NUFJFU1NFRCA9
ICJwMi5jb21wcmVzc2VkIjsgLy8kTk9OLU5MUy0xJA0KKw0KKwkvKioNCiAJICogUmV0dXJucyB0
aGUgVVJMIG9mIHRoZSByZXBvc2l0b3J5Lg0KIAkgKiBUT0RPOiBTaG91bGQgd2UgdXNlIFVSTCBv
ciBVUkk/IFVSTCByZXF1aXJlcyBhIHByb3RvY29sIGhhbmRsZXINCiAJICogdG8gYmUgaW5zdGFs
bGVkIGluIEphdmEuICBDYW4gdGhlIFVSTCBoYXZlIGFueSBwcm90b2NvbD8NCiNQIG9yZy5lY2xp
cHNlLmVxdWlub3gucDIubWV0YWRhdGEucmVwb3NpdG9yeQ0KSW5kZXg6IHNyYy9vcmcvZWNsaXBz
ZS9lcXVpbm94L2ludGVybmFsL3AyL21ldGFkYXRhL3JlcG9zaXRvcnkvU2ltcGxlTWV0YWRhdGFS
ZXBvc2l0b3J5RmFjdG9yeS5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvZWNs
aXBzZS9lcXVpbm94LWluY3ViYXRvci9wcm92aXNpb25pbmcvb3JnLmVjbGlwc2UuZXF1aW5veC5w
Mi5tZXRhZGF0YS5yZXBvc2l0b3J5L3NyYy9vcmcvZWNsaXBzZS9lcXVpbm94L2ludGVybmFsL3Ay
L21ldGFkYXRhL3JlcG9zaXRvcnkvU2ltcGxlTWV0YWRhdGFSZXBvc2l0b3J5RmFjdG9yeS5qYXZh
LHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS4xMA0KZGlmZiAtdSAtcjEuMTAgU2ltcGxlTWV0YWRh
dGFSZXBvc2l0b3J5RmFjdG9yeS5qYXZhDQotLS0gc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvaW50
ZXJuYWwvcDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9TaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlGYWN0
b3J5LmphdmEJNiBEZWMgMjAwNyAxNzowNDoxMyAtMDAwMAkxLjEwDQorKysgc3JjL29yZy9lY2xp
cHNlL2VxdWlub3gvaW50ZXJuYWwvcDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9TaW1wbGVNZXRhZGF0
YVJlcG9zaXRvcnlGYWN0b3J5LmphdmEJOCBKYW4gMjAwOCAxODo1NTo0OSAtMDAwMA0KQEAgLTEy
LDYgKzEyLDggQEANCiANCiBpbXBvcnQgamF2YS5pby4qOw0KIGltcG9ydCBqYXZhLm5ldC5VUkw7
DQoraW1wb3J0IGphdmEudXRpbC5qYXIuSmFyRW50cnk7DQoraW1wb3J0IGphdmEudXRpbC5qYXIu
SmFySW5wdXRTdHJlYW07DQogaW1wb3J0IG9yZy5lY2xpcHNlLmNvcmUucnVudGltZS5JU3RhdHVz
Ow0KIGltcG9ydCBvcmcuZWNsaXBzZS5jb3JlLnJ1bnRpbWUuU3RhdHVzOw0KIGltcG9ydCBvcmcu
ZWNsaXBzZS5lcXVpbm94LmludGVybmFsLnAyLmNvcmUuaGVscGVycy5Mb2dIZWxwZXI7DQpAQCAt
MjMsNiArMjUsOCBAQA0KIA0KIHB1YmxpYyBjbGFzcyBTaW1wbGVNZXRhZGF0YVJlcG9zaXRvcnlG
YWN0b3J5IGltcGxlbWVudHMgSU1ldGFkYXRhUmVwb3NpdG9yeUZhY3Rvcnkgew0KIA0KKwlwcml2
YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgSkFSX0VYVEVOU0lPTiA9ICIuamFyIjsgLy8kTk9OLU5M
Uy0xJA0KKw0KIAlwdWJsaWMgSU1ldGFkYXRhUmVwb3NpdG9yeSBjcmVhdGUoVVJMIGxvY2F0aW9u
LCBTdHJpbmcgbmFtZSwgU3RyaW5nIHR5cGUpIHsNCiAJCWlmIChsb2NhdGlvbi5nZXRQcm90b2Nv
bCgpLmVxdWFscygiZmlsZSIpKSAvLyROT04tTkxTLTEkDQogCQkJcmV0dXJuIG5ldyBMb2NhbE1l
dGFkYXRhUmVwb3NpdG9yeShsb2NhdGlvbiwgbmFtZSk7DQpAQCAtMzAsNiArMzQsMTYgQEANCiAJ
fQ0KIA0KIAlwdWJsaWMgSU1ldGFkYXRhUmVwb3NpdG9yeSBsb2FkKFVSTCBsb2NhdGlvbikgew0K
KwkJLy8gbG9hZCB0aGUgamFyDQorCQlJTWV0YWRhdGFSZXBvc2l0b3J5IHJlc3VsdCA9IGxvYWQo
bG9jYXRpb24sIEpBUl9FWFRFTlNJT04pOw0KKwkJLy8gY29tcHJlc3NlZCBmaWxlIGlzIG5vdCBh
dmFpbGFibGUsIGxvYWQgdGhlIHhtbA0KKwkJaWYgKHJlc3VsdCA9PSBudWxsKSB7DQorCQkJcmVz
dWx0ID0gbG9hZChsb2NhdGlvbiwgbnVsbCk7DQorCQl9DQorCQlyZXR1cm4gcmVzdWx0Ow0KKwl9
DQorDQorCXByaXZhdGUgSU1ldGFkYXRhUmVwb3NpdG9yeSBsb2FkKFVSTCBsb2NhdGlvbiwgU3Ry
aW5nIHR5cGUpIHsNCiAJCWlmIChsb2NhdGlvbiA9PSBudWxsKQ0KIAkJCXJldHVybiBudWxsOw0K
IAkJbG9uZyB0aW1lID0gMDsNCkBAIC0zOSw3ICs1MywyMSBAQA0KIAkJCXRpbWUgPSAtU3lzdGVt
LmN1cnJlbnRUaW1lTWlsbGlzKCk7DQogCQl9DQogCQl0cnkgew0KLQkJCUlucHV0U3RyZWFtIGRl
c2NyaXB0b3JTdHJlYW0gPSBuZXcgQnVmZmVyZWRJbnB1dFN0cmVhbShVUkxNZXRhZGF0YVJlcG9z
aXRvcnkuZ2V0QWN0dWFsTG9jYXRpb24obG9jYXRpb24pLm9wZW5TdHJlYW0oKSk7DQorCQkJVVJM
IGFjdHVhbEZpbGUgPSBVUkxNZXRhZGF0YVJlcG9zaXRvcnkuZ2V0QWN0dWFsTG9jYXRpb24obG9j
YXRpb24pOw0KKwkJCUlucHV0U3RyZWFtIGluU3RyZWFtID0gVVJMTWV0YWRhdGFSZXBvc2l0b3J5
LmdldEFjdHVhbExvY2F0aW9uKGxvY2F0aW9uLCB0eXBlKS5vcGVuU3RyZWFtKCk7DQorCQkJaWYg
KEpBUl9FWFRFTlNJT04uZXF1YWxzSWdub3JlQ2FzZSh0eXBlKSkgew0KKwkJCQlKYXJJbnB1dFN0
cmVhbSBqSW5TdHJlYW0gPSBuZXcgSmFySW5wdXRTdHJlYW0oaW5TdHJlYW0pOw0KKwkJCQlKYXJF
bnRyeSBqYXJFbnRyeSA9IGpJblN0cmVhbS5nZXROZXh0SmFyRW50cnkoKTsNCisJCQkJRmlsZSBm
ID0gbmV3IEZpbGUoYWN0dWFsRmlsZS5nZXRQYXRoKCkpOw0KKwkJCQl3aGlsZSAoamFyRW50cnkg
IT0gbnVsbCAmJiAoZi5jb21wYXJlVG8obmV3IEZpbGUoamFyRW50cnkuZ2V0TmFtZSgpKSkpICE9
IDApIHsNCisJCQkJCWphckVudHJ5ID0gakluU3RyZWFtLmdldE5leHRKYXJFbnRyeSgpOw0KKwkJ
CQl9DQorCQkJCWlmIChqYXJFbnRyeSA9PSBudWxsKSB7DQorCQkJCQl0aHJvdyBuZXcgRmlsZU5v
dEZvdW5kRXhjZXB0aW9uKCJSZXBvc2l0b3J5IG5vdCBmb3VuZCBpbiAiICsgYWN0dWFsRmlsZS5n
ZXRQYXRoKCkgKyB0eXBlKTsgLy8kTk9OLU5MUy0xJA0KKwkJCQl9DQorCQkJCWluU3RyZWFtID0g
akluU3RyZWFtOw0KKwkJCX0NCisJCQlJbnB1dFN0cmVhbSBkZXNjcmlwdG9yU3RyZWFtID0gbmV3
IEJ1ZmZlcmVkSW5wdXRTdHJlYW0oaW5TdHJlYW0pOw0KIAkJCXRyeSB7DQogCQkJCUlNZXRhZGF0
YVJlcG9zaXRvcnkgcmVzdWx0ID0gbmV3IE1ldGFkYXRhUmVwb3NpdG9yeUlPKCkucmVhZChkZXNj
cmlwdG9yU3RyZWFtKTsNCiAJCQkJaWYgKHJlc3VsdCBpbnN0YW5jZW9mIExvY2FsTWV0YWRhdGFS
ZXBvc2l0b3J5KQ0KSW5kZXg6IHNyYy9vcmcvZWNsaXBzZS9lcXVpbm94L2ludGVybmFsL3AyL21l
dGFkYXRhL3JlcG9zaXRvcnkvTG9jYWxNZXRhZGF0YVJlcG9zaXRvcnkuamF2YQ0KPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQ0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2UvZXF1aW5veC1pbmN1YmF0b3IvcHJvdmlzaW9u
aW5nL29yZy5lY2xpcHNlLmVxdWlub3gucDIubWV0YWRhdGEucmVwb3NpdG9yeS9zcmMvb3JnL2Vj
bGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRhZGF0YS9yZXBvc2l0b3J5L0xvY2FsTWV0YWRh
dGFSZXBvc2l0b3J5LmphdmEsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjEzDQpkaWZmIC11IC1y
MS4xMyBMb2NhbE1ldGFkYXRhUmVwb3NpdG9yeS5qYXZhDQotLS0gc3JjL29yZy9lY2xpcHNlL2Vx
dWlub3gvaW50ZXJuYWwvcDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9Mb2NhbE1ldGFkYXRhUmVwb3Np
dG9yeS5qYXZhCTQgSmFuIDIwMDggMTk6Mzk6NDIgLTAwMDAJMS4xMw0KKysrIHNyYy9vcmcvZWNs
aXBzZS9lcXVpbm94L2ludGVybmFsL3AyL21ldGFkYXRhL3JlcG9zaXRvcnkvTG9jYWxNZXRhZGF0
YVJlcG9zaXRvcnkuamF2YQk4IEphbiAyMDA4IDE4OjU1OjQ5IC0wMDAwDQpAQCAtMTQsNiArMTQs
OCBAQA0KIGltcG9ydCBqYXZhLmlvLio7DQogaW1wb3J0IGphdmEubmV0LlVSTDsNCiBpbXBvcnQg
amF2YS51dGlsLio7DQoraW1wb3J0IGphdmEudXRpbC5qYXIuSmFyRW50cnk7DQoraW1wb3J0IGph
dmEudXRpbC5qYXIuSmFyT3V0cHV0U3RyZWFtOw0KIGltcG9ydCBvcmcuZWNsaXBzZS5jb3JlLnJ1
bnRpbWUuSVByb2dyZXNzTW9uaXRvcjsNCiBpbXBvcnQgb3JnLmVjbGlwc2UuZXF1aW5veC5wMi5t
ZXRhZGF0YS5JSW5zdGFsbGFibGVVbml0Ow0KIGltcG9ydCBvcmcuZWNsaXBzZS5lcXVpbm94LnAy
LnF1ZXJ5LkNvbGxlY3RvcjsNCkBAIC0yOSwxOCArMzEsMjMgQEANCiAJc3RhdGljIGZpbmFsIHBy
aXZhdGUgU3RyaW5nIENPTlRFTlRfRklMRU5BTUUgPSAiY29udGVudC54bWwiOyAvLyROT04tTkxT
LTEkDQogCXN0YXRpYyBmaW5hbCBwcml2YXRlIFN0cmluZyBSRVBPU0lUT1JZX1RZUEUgPSBMb2Nh
bE1ldGFkYXRhUmVwb3NpdG9yeS5jbGFzcy5nZXROYW1lKCk7DQogCXN0YXRpYyBmaW5hbCBwcml2
YXRlIEludGVnZXIgUkVQT1NJVE9SWV9WRVJTSU9OID0gbmV3IEludGVnZXIoMSk7DQorCXN0YXRp
YyBmaW5hbCBwcml2YXRlIFN0cmluZyBKQVJfRVhURU5TSU9OID0gIi5qYXIiOyAvLyROT04tTkxT
LTEkDQogDQogCXByb3RlY3RlZCBIYXNoU2V0IHVuaXRzID0gbmV3IExpbmtlZEhhc2hTZXQoKTsN
CiANCi0JcHVibGljIHN0YXRpYyBGaWxlIGdldEFjdHVhbExvY2F0aW9uKFVSTCBsb2NhdGlvbikg
ew0KKwlwcml2YXRlIHN0YXRpYyBGaWxlIGdldEFjdHVhbExvY2F0aW9uKFVSTCBsb2NhdGlvbiwg
U3RyaW5nIGV4dGVuc2lvbikgew0KIAkJU3RyaW5nIHNwZWMgPSBsb2NhdGlvbi5nZXRGaWxlKCk7
DQotCQlpZiAoc3BlYy5lbmRzV2l0aChDT05URU5UX0ZJTEVOQU1FKSkNCi0JCQlyZXR1cm4gbmV3
IEZpbGUoc3BlYyk7DQorCQlpZiAoc3BlYy5lbmRzV2l0aChDT05URU5UX0ZJTEVOQU1FICsgZXh0
ZW5zaW9uKSkNCisJCQlyZXR1cm4gbmV3IEZpbGUoc3BlYyArIGV4dGVuc2lvbik7DQogCQlpZiAo
c3BlYy5lbmRzV2l0aCgiLyIpKSAvLyROT04tTkxTLTEkDQogCQkJc3BlYyArPSBDT05URU5UX0ZJ
TEVOQU1FOw0KIAkJZWxzZQ0KIAkJCXNwZWMgKz0gIi8iICsgQ09OVEVOVF9GSUxFTkFNRTsgLy8k
Tk9OLU5MUy0xJA0KLQkJcmV0dXJuIG5ldyBGaWxlKHNwZWMpOw0KKwkJcmV0dXJuIG5ldyBGaWxl
KHNwZWMgKyBleHRlbnNpb24pOw0KKwl9DQorDQorCXB1YmxpYyBzdGF0aWMgRmlsZSBnZXRBY3R1
YWxMb2NhdGlvbihVUkwgbG9jYXRpb24pIHsNCisJCXJldHVybiBnZXRBY3R1YWxMb2NhdGlvbihs
b2NhdGlvbiwgIiIpOyAvLyROT04tTkxTLTEkDQogCX0NCiANCiAJLyoqDQpAQCAtMTE5LDEzICsx
MjYsMzMgQEANCiANCiAJcHJpdmF0ZSB2b2lkIHNhdmUoKSB7DQogCQlGaWxlIGZpbGUgPSBnZXRB
Y3R1YWxMb2NhdGlvbihsb2NhdGlvbik7DQorCQlib29sZWFuIGphciA9ICJ0cnVlIi5lcXVhbHNJ
Z25vcmVDYXNlKChTdHJpbmcpIHByb3BlcnRpZXMuZ2V0KFBST1BfQ09NUFJFU1NFRCkpOyAvLyRO
T04tTkxTLTEkDQogCQl0cnkgew0KLQkJCWlmICghZmlsZS5leGlzdHMoKSkgew0KLQkJCQlpZiAo
IWZpbGUuZ2V0UGFyZW50RmlsZSgpLmV4aXN0cygpKQ0KLQkJCQkJZmlsZS5nZXRQYXJlbnRGaWxl
KCkubWtkaXJzKCk7DQotCQkJCWZpbGUuY3JlYXRlTmV3RmlsZSgpOw0KKwkJCU91dHB1dFN0cmVh
bSBvdXRwdXQgPSBudWxsOw0KKwkJCWlmICghamFyKSB7DQorCQkJCWlmICghZmlsZS5leGlzdHMo
KSkgew0KKwkJCQkJaWYgKCFmaWxlLmdldFBhcmVudEZpbGUoKS5leGlzdHMoKSkNCisJCQkJCQlm
aWxlLmdldFBhcmVudEZpbGUoKS5ta2RpcnMoKTsNCisJCQkJCWZpbGUuY3JlYXRlTmV3RmlsZSgp
Ow0KKwkJCQl9DQorCQkJCW91dHB1dCA9IG5ldyBGaWxlT3V0cHV0U3RyZWFtKGZpbGUpOw0KKwkJ
CX0NCisJCQlpZiAoamFyKSB7DQorCQkJCWlmIChmaWxlLmV4aXN0cygpKSB7DQorCQkJCQlmaWxl
LmRlbGV0ZSgpOw0KKwkJCQl9DQorCQkJCUZpbGUgamFyRmlsZSA9IGdldEFjdHVhbExvY2F0aW9u
KGxvY2F0aW9uLCBKQVJfRVhURU5TSU9OKTsNCisJCQkJaWYgKCFqYXJGaWxlLmV4aXN0cygpKSB7
DQorCQkJCQlpZiAoIWphckZpbGUuZ2V0UGFyZW50RmlsZSgpLmV4aXN0cygpKQ0KKwkJCQkJCWph
ckZpbGUuZ2V0UGFyZW50RmlsZSgpLm1rZGlycygpOw0KKwkJCQkJamFyRmlsZS5jcmVhdGVOZXdG
aWxlKCk7DQorCQkJCX0NCisJCQkJSmFyRW50cnkgamFyRW50cnkgPSBuZXcgSmFyRW50cnkoZmls
ZS5nZXRQYXRoKCkpOw0KKwkJCQlKYXJPdXRwdXRTdHJlYW0gak91dHB1dCA9IG5ldyBKYXJPdXRw
dXRTdHJlYW0obmV3IEZpbGVPdXRwdXRTdHJlYW0oamFyRmlsZSkpOw0KKwkJCQlqT3V0cHV0LnB1
dE5leHRFbnRyeShqYXJFbnRyeSk7DQorCQkJCW91dHB1dCA9IGpPdXRwdXQ7DQogCQkJfQ0KLQkJ
CW5ldyBNZXRhZGF0YVJlcG9zaXRvcnlJTygpLndyaXRlKHRoaXMsIG5ldyBGaWxlT3V0cHV0U3Ry
ZWFtKGZpbGUpKTsNCisJCQluZXcgTWV0YWRhdGFSZXBvc2l0b3J5SU8oKS53cml0ZSh0aGlzLCBv
dXRwdXQpOw0KIAkJfSBjYXRjaCAoRmlsZU5vdEZvdW5kRXhjZXB0aW9uIGUpIHsNCiAJCQkvLyBU
T0RPIEF1dG8tZ2VuZXJhdGVkIGNhdGNoIGJsb2NrDQogCQkJZS5wcmludFN0YWNrVHJhY2UoKTsN
CkluZGV4OiBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9tZXRhZGF0YS9yZXBv
c2l0b3J5L1VSTE1ldGFkYXRhUmVwb3NpdG9yeS5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTog
L2N2c3Jvb3QvZWNsaXBzZS9lcXVpbm94LWluY3ViYXRvci9wcm92aXNpb25pbmcvb3JnLmVjbGlw
c2UuZXF1aW5veC5wMi5tZXRhZGF0YS5yZXBvc2l0b3J5L3NyYy9vcmcvZWNsaXBzZS9lcXVpbm94
L2ludGVybmFsL3AyL21ldGFkYXRhL3JlcG9zaXRvcnkvVVJMTWV0YWRhdGFSZXBvc2l0b3J5Lmph
dmEsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjgNCmRpZmYgLXUgLXIxLjggVVJMTWV0YWRhdGFS
ZXBvc2l0b3J5LmphdmENCi0tLSBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9pbnRlcm5hbC9wMi9t
ZXRhZGF0YS9yZXBvc2l0b3J5L1VSTE1ldGFkYXRhUmVwb3NpdG9yeS5qYXZhCTIgSmFuIDIwMDgg
MjE6MTc6NTUgLTAwMDAJMS44DQorKysgc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvaW50ZXJuYWwv
cDIvbWV0YWRhdGEvcmVwb3NpdG9yeS9VUkxNZXRhZGF0YVJlcG9zaXRvcnkuamF2YQk4IEphbiAy
MDA4IDE4OjU1OjQ5IC0wMDAwDQpAQCAtMzMsMTUgKzMzLDI2IEBADQogCXByb3RlY3RlZCBIYXNo
U2V0IHVuaXRzID0gbmV3IExpbmtlZEhhc2hTZXQoKTsNCiANCiAJcHVibGljIHN0YXRpYyBVUkwg
Z2V0QWN0dWFsTG9jYXRpb24oVVJMIGJhc2UpIHsNCisJCXJldHVybiBnZXRBY3R1YWxMb2NhdGlv
bihiYXNlLCBudWxsKTsNCisJfQ0KKw0KKwlwdWJsaWMgc3RhdGljIFVSTCBnZXRBY3R1YWxMb2Nh
dGlvbihVUkwgYmFzZSwgU3RyaW5nIGV4dGVuc2lvbikgew0KKwkJaWYgKGV4dGVuc2lvbiA9PSBu
dWxsKSB7DQorCQkJZXh0ZW5zaW9uID0gIiI7IC8vJE5PTi1OTFMtMSQNCisJCX0NCiAJCVN0cmlu
ZyBzcGVjID0gYmFzZS50b0V4dGVybmFsRm9ybSgpOw0KLQkJaWYgKHNwZWMuZW5kc1dpdGgoQ09O
VEVOVF9GSUxFTkFNRSkpDQotCQkJcmV0dXJuIGJhc2U7DQorCQlpZiAoc3BlYy5lbmRzV2l0aChD
T05URU5UX0ZJTEVOQU1FICsgZXh0ZW5zaW9uKSkNCisJCQl0cnkgew0KKwkJCQlyZXR1cm4gbmV3
IFVSTChzcGVjICsgZXh0ZW5zaW9uKTsNCisJCQl9IGNhdGNoIChNYWxmb3JtZWRVUkxFeGNlcHRp
b24gZTEpIHsNCisJCQkJcmV0dXJuIG51bGw7DQorCQkJfQ0KIAkJaWYgKHNwZWMuZW5kc1dpdGgo
Ii8iKSkgLy8kTk9OLU5MUy0xJA0KIAkJCXNwZWMgKz0gQ09OVEVOVF9GSUxFTkFNRTsNCiAJCWVs
c2UNCiAJCQlzcGVjICs9ICIvIiArIENPTlRFTlRfRklMRU5BTUU7IC8vJE5PTi1OTFMtMSQNCiAJ
CXRyeSB7DQotCQkJcmV0dXJuIG5ldyBVUkwoc3BlYyk7DQorCQkJcmV0dXJuIG5ldyBVUkwoc3Bl
YyArIGV4dGVuc2lvbik7DQogCQl9IGNhdGNoIChNYWxmb3JtZWRVUkxFeGNlcHRpb24gZSkgew0K
IAkJCXJldHVybiBudWxsOw0KIAkJfQ0KI1Agb3JnLmVjbGlwc2UuZXF1aW5veC5wMi50ZXN0cw0K
SW5kZXg6IHNyYy9vcmcvZWNsaXBzZS9lcXVpbm94L3AyL3Rlc3RzL21ldGFkYXRhL3JlcG9zaXRv
cnkvTG9jYWxNZXRhZGF0YVJlcG9zaXRvcnlUZXN0LmphdmENCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxl
OiAvY3Zzcm9vdC9lY2xpcHNlL2VxdWlub3gtaW5jdWJhdG9yL3Byb3Zpc2lvbmluZy9vcmcuZWNs
aXBzZS5lcXVpbm94LnAyLnRlc3RzL3NyYy9vcmcvZWNsaXBzZS9lcXVpbm94L3AyL3Rlc3RzL21l
dGFkYXRhL3JlcG9zaXRvcnkvTG9jYWxNZXRhZGF0YVJlcG9zaXRvcnlUZXN0LmphdmEsdg0KcmV0
cmlldmluZyByZXZpc2lvbiAxLjENCmRpZmYgLXUgLXIxLjEgTG9jYWxNZXRhZGF0YVJlcG9zaXRv
cnlUZXN0LmphdmENCi0tLSBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9wMi90ZXN0cy9tZXRhZGF0
YS9yZXBvc2l0b3J5L0xvY2FsTWV0YWRhdGFSZXBvc2l0b3J5VGVzdC5qYXZhCTIgSmFuIDIwMDgg
MTY6MDY6NDkgLTAwMDAJMS4xDQorKysgc3JjL29yZy9lY2xpcHNlL2VxdWlub3gvcDIvdGVzdHMv
bWV0YWRhdGEvcmVwb3NpdG9yeS9Mb2NhbE1ldGFkYXRhUmVwb3NpdG9yeVRlc3QuamF2YQk4IEph
biAyMDA4IDE4OjU1OjQ5IC0wMDAwDQpAQCAtMTQsNiArMTQsOCBAQA0KIGltcG9ydCBqYXZhLm5l
dC5NYWxmb3JtZWRVUkxFeGNlcHRpb247DQogaW1wb3J0IGphdmEudXRpbC5NYXA7DQogaW1wb3J0
IG9yZy5lY2xpcHNlLmVxdWlub3guaW50ZXJuYWwucDIuY29yZS5oZWxwZXJzLlNlcnZpY2VIZWxw
ZXI7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmVxdWlub3gucDIubWV0YWRhdGEuZ2VuZXJhdG9yLkVj
bGlwc2VJbnN0YWxsR2VuZXJhdG9ySW5mb1Byb3ZpZGVyOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5l
cXVpbm94LnAyLm1ldGFkYXRhLmdlbmVyYXRvci5HZW5lcmF0b3I7DQogaW1wb3J0IG9yZy5lY2xp
cHNlLmVxdWlub3gucDIubWV0YWRhdGEucmVwb3NpdG9yeS5JTWV0YWRhdGFSZXBvc2l0b3J5Ow0K
IGltcG9ydCBvcmcuZWNsaXBzZS5lcXVpbm94LnAyLm1ldGFkYXRhLnJlcG9zaXRvcnkuSU1ldGFk
YXRhUmVwb3NpdG9yeU1hbmFnZXI7DQogaW1wb3J0IG9yZy5lY2xpcHNlLmVxdWlub3gucDIudGVz
dHMuQWJzdHJhY3RQcm92aXNpb25pbmdUZXN0Ow0KQEAgLTI1LDYgKzI3LDcgQEANCiBwdWJsaWMg
Y2xhc3MgTG9jYWxNZXRhZGF0YVJlcG9zaXRvcnlUZXN0IGV4dGVuZHMgQWJzdHJhY3RQcm92aXNp
b25pbmdUZXN0IHsNCiAJcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFRFU1RfVkFMVUUgPSAi
VGVzdFZhbHVlIjsNCiAJcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFRFU1RfS0VZID0gIlRl
c3RLZXkiOw0KKwlwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgSkFSX0tFWSA9ICJqYXIiOw0K
IAlwcm90ZWN0ZWQgRmlsZSByZXBvTG9jYXRpb247DQogDQogCXByaXZhdGUgSU1ldGFkYXRhUmVw
b3NpdG9yeU1hbmFnZXIgZ2V0TWV0YWRhdGFSZXBvc2l0b3J5TWFuYWdlcigpIHsNCkBAIC03OSw0
ICs4Miw2MiBAQA0KIAkJcHJvcGVydGllcyA9IHJlcG8uZ2V0UHJvcGVydGllcygpOw0KIAkJYXNz
ZXJ0VHJ1ZSgiMS40IiwgIXByb3BlcnRpZXMuY29udGFpbnNLZXkoVEVTVF9LRVkpKTsNCiAJfQ0K
Kw0KKwlwdWJsaWMgdm9pZCB0ZXN0Q29tcHJlc3NlZFJlcG9zaXRvcnkoKSB0aHJvd3MgTWFsZm9y
bWVkVVJMRXhjZXB0aW9uIHsNCisJCUlNZXRhZGF0YVJlcG9zaXRvcnlNYW5hZ2VyIG1hbmFnZXIg
PSBnZXRNZXRhZGF0YVJlcG9zaXRvcnlNYW5hZ2VyKCk7DQorCQlJTWV0YWRhdGFSZXBvc2l0b3J5
IHJlcG8gPSBtYW5hZ2VyLmNyZWF0ZVJlcG9zaXRvcnkocmVwb0xvY2F0aW9uLnRvVVJMKCksICJU
ZXN0UmVwbyIsIElNZXRhZGF0YVJlcG9zaXRvcnlNYW5hZ2VyLlRZUEVfU0lNUExFX1JFUE9TSVRP
UlkpOw0KKwkJcmVwby5zZXRQcm9wZXJ0eShKQVJfS0VZLCAidHJ1ZSIpOw0KKwkJRWNsaXBzZUlu
c3RhbGxHZW5lcmF0b3JJbmZvUHJvdmlkZXIgcHJvdmlkZXIgPSBuZXcgRWNsaXBzZUluc3RhbGxH
ZW5lcmF0b3JJbmZvUHJvdmlkZXIoKTsNCisJCXByb3ZpZGVyLnNldE1ldGFkYXRhUmVwb3NpdG9y
eShyZXBvKTsNCisJCXByb3ZpZGVyLmluaXRpYWxpemUocmVwb0xvY2F0aW9uKTsNCisJCXByb3Zp
ZGVyLnNldFJvb3RWZXJzaW9uKCIzLjMiKTsNCisJCXByb3ZpZGVyLnNldFJvb3RJZCgic2RrIik7
DQorCQlwcm92aWRlci5zZXRGbGF2b3IoInRvb2xpbmciKTsNCisJCS8vIEdlbmVyYXRlIHRoZSBy
ZXBvc2l0b3J5DQorCQluZXcgR2VuZXJhdG9yKHByb3ZpZGVyKS5nZW5lcmF0ZSgpOw0KKwkJRmls
ZVtdIGZpbGVzID0gcmVwb0xvY2F0aW9uLmxpc3RGaWxlcygpOw0KKwkJYm9vbGVhbiBqYXJGaWxl
UHJlc2VudCA9IGZhbHNlOw0KKwkJYm9vbGVhbiB4bWxGaWxlUHJlc2VudCA9IGZhbHNlOw0KKwkJ
Ly8gb25lIG9mIHRoZSBmaWxlcyBpbiB0aGUgcmVwb3NpdG9yeSBzaG91bGQgYmUgdGhlIGNvbnRl
bnQueG1sLmphcg0KKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkrKykgew0K
KwkJCWlmICgiY29udGVudC54bWwuamFyIi5lcXVhbHNJZ25vcmVDYXNlKGZpbGVzW2ldLmdldE5h
bWUoKSkpIHsNCisJCQkJamFyRmlsZVByZXNlbnQgPSB0cnVlOw0KKwkJCX0NCisJCQlpZiAoImNv
bnRlbnQueG1sIi5lcXVhbHNJZ25vcmVDYXNlKGZpbGVzW2ldLmdldE5hbWUoKSkpIHsNCisJCQkJ
eG1sRmlsZVByZXNlbnQgPSB0cnVlOw0KKwkJCX0NCisJCX0NCisJCWlmICghamFyRmlsZVByZXNl
bnQpIHsNCisJCQlmYWlsKCJSZXBvc2l0b3J5IGRpZCBub3QgY3JlYXRlIEpBUiBmb3IgY29udGVu
dC54bWwiKTsNCisJCX0NCisJCWlmICh4bWxGaWxlUHJlc2VudCkgew0KKwkJCWZhaWwoIlJlcG9z
aXRvcnkgc2hvdWxkIG5vdCBjcmVhdGUgY29udGVudC54bWwiKTsNCisJCX0NCisJfQ0KKw0KKwlw
dWJsaWMgdm9pZCB0ZXN0VW5jb21wcmVzc2VkUmVwb3NpdG9yeSgpIHRocm93cyBNYWxmb3JtZWRV
UkxFeGNlcHRpb24gew0KKwkJSU1ldGFkYXRhUmVwb3NpdG9yeU1hbmFnZXIgbWFuYWdlciA9IGdl
dE1ldGFkYXRhUmVwb3NpdG9yeU1hbmFnZXIoKTsNCisJCUlNZXRhZGF0YVJlcG9zaXRvcnkgcmVw
byA9IG1hbmFnZXIuY3JlYXRlUmVwb3NpdG9yeShyZXBvTG9jYXRpb24udG9VUkwoKSwgIlRlc3RS
ZXBvIiwgSU1ldGFkYXRhUmVwb3NpdG9yeU1hbmFnZXIuVFlQRV9TSU1QTEVfUkVQT1NJVE9SWSk7
DQorCQlyZXBvLnNldFByb3BlcnR5KEpBUl9LRVksICJmYWxzZSIpOw0KKwkJRWNsaXBzZUluc3Rh
bGxHZW5lcmF0b3JJbmZvUHJvdmlkZXIgcHJvdmlkZXIgPSBuZXcgRWNsaXBzZUluc3RhbGxHZW5l
cmF0b3JJbmZvUHJvdmlkZXIoKTsNCisJCXByb3ZpZGVyLnNldE1ldGFkYXRhUmVwb3NpdG9yeShy
ZXBvKTsNCisJCXByb3ZpZGVyLmluaXRpYWxpemUocmVwb0xvY2F0aW9uKTsNCisJCXByb3ZpZGVy
LnNldFJvb3RWZXJzaW9uKCIzLjMiKTsNCisJCXByb3ZpZGVyLnNldFJvb3RJZCgic2RrIik7DQor
CQlwcm92aWRlci5zZXRGbGF2b3IoInRvb2xpbmciKTsNCisJCS8vIEdlbmVyYXRlIHRoZSByZXBv
c2l0b3J5DQorCQluZXcgR2VuZXJhdG9yKHByb3ZpZGVyKS5nZW5lcmF0ZSgpOw0KKwkJRmlsZVtd
IGZpbGVzID0gcmVwb0xvY2F0aW9uLmxpc3RGaWxlcygpOw0KKwkJYm9vbGVhbiBqYXJGaWxlUHJl
c2VudCA9IGZhbHNlOw0KKwkJLy8gbm9uZSBvZiB0aGUgZmlsZXMgaW4gdGhlIHJlcG9zaXRvcnkg
c2hvdWxkIGJlIHRoZSBjb250ZW50LnhtbC5qYXINCisJCWZvciAoaW50IGkgPSAwOyBpIDwgZmls
ZXMubGVuZ3RoOyBpKyspIHsNCisJCQlpZiAoImNvbnRlbnQueG1sLmphciIuZXF1YWxzSWdub3Jl
Q2FzZShmaWxlc1tpXS5nZXROYW1lKCkpKSB7DQorCQkJCWphckZpbGVQcmVzZW50ID0gdHJ1ZTsN
CisJCQl9DQorCQl9DQorCQlpZiAoamFyRmlsZVByZXNlbnQpIHsNCisJCQlmYWlsKCJSZXBvc2l0
b3J5IHNob3VsZCBub3QgY3JlYXRlIEpBUiBmb3IgY29udGVudC54bWwiKTsNCisJCX0NCisNCisJ
fQ0KIH0NCg==
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>86613</attachid>
            <date>2008-01-10 16:21:00 -0500</date>
            <delta_ts>2008-01-10 16:21:13 -0500</delta_ts>
            <desc>Test case</desc>
            <filename>patch.txt</filename>
            <type>text/plain</type>
            <size>4770</size>
            <attacher name="John Arthorne">john_arthorne</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuZXF1aW5veC5w
Mi50ZXN0cw0KSW5kZXg6IHNyYy9vcmcvZWNsaXBzZS9lcXVpbm94L3AyL3Rlc3RzL21ldGFkYXRh
L3JlcG9zaXRvcnkvTWV0YWRhdGFSZXBvc2l0b3J5TWFuYWdlclRlc3QuamF2YQ0KPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQ0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2UvZXF1aW5veC1pbmN1YmF0b3IvcHJvdmlzaW9u
aW5nL29yZy5lY2xpcHNlLmVxdWlub3gucDIudGVzdHMvc3JjL29yZy9lY2xpcHNlL2VxdWlub3gv
cDIvdGVzdHMvbWV0YWRhdGEvcmVwb3NpdG9yeS9NZXRhZGF0YVJlcG9zaXRvcnlNYW5hZ2VyVGVz
dC5qYXZhLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS4yDQpkaWZmIC11IC1yMS4yIE1ldGFkYXRh
UmVwb3NpdG9yeU1hbmFnZXJUZXN0LmphdmENCi0tLSBzcmMvb3JnL2VjbGlwc2UvZXF1aW5veC9w
Mi90ZXN0cy9tZXRhZGF0YS9yZXBvc2l0b3J5L01ldGFkYXRhUmVwb3NpdG9yeU1hbmFnZXJUZXN0
LmphdmEJNyBKYW4gMjAwOCAyMzowNDozMCAtMDAwMAkxLjINCisrKyBzcmMvb3JnL2VjbGlwc2Uv
ZXF1aW5veC9wMi90ZXN0cy9tZXRhZGF0YS9yZXBvc2l0b3J5L01ldGFkYXRhUmVwb3NpdG9yeU1h
bmFnZXJUZXN0LmphdmEJMTAgSmFuIDIwMDggMjE6MjA6NDEgLTAwMDANCkBAIC0xMyw5ICsxMywx
MiBAQA0KIGltcG9ydCBqYXZhLmlvLkZpbGU7DQogaW1wb3J0IGphdmEubmV0Lk1hbGZvcm1lZFVS
TEV4Y2VwdGlvbjsNCiBpbXBvcnQgamF2YS5uZXQuVVJMOw0KK2ltcG9ydCBqYXZhLnV0aWwuKjsN
CiBpbXBvcnQganVuaXQuZnJhbWV3b3JrLlRlc3Q7DQogaW1wb3J0IGp1bml0LmZyYW1ld29yay5U
ZXN0U3VpdGU7DQogaW1wb3J0IG9yZy5lY2xpcHNlLmVxdWlub3guaW50ZXJuYWwucDIuY29yZS5o
ZWxwZXJzLlNlcnZpY2VIZWxwZXI7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmVxdWlub3gucDIuY29y
ZS5yZXBvc2l0b3J5LklSZXBvc2l0b3J5Ow0KK2ltcG9ydCBvcmcuZWNsaXBzZS5lcXVpbm94LnAy
Lm1ldGFkYXRhLnJlcG9zaXRvcnkuSU1ldGFkYXRhUmVwb3NpdG9yeTsNCiBpbXBvcnQgb3JnLmVj
bGlwc2UuZXF1aW5veC5wMi5tZXRhZGF0YS5yZXBvc2l0b3J5LklNZXRhZGF0YVJlcG9zaXRvcnlN
YW5hZ2VyOw0KIGltcG9ydCBvcmcuZWNsaXBzZS5lcXVpbm94LnAyLnRlc3RzLkFic3RyYWN0UHJv
dmlzaW9uaW5nVGVzdDsNCiBpbXBvcnQgb3JnLmVjbGlwc2UuZXF1aW5veC5wMi50ZXN0cy5UZXN0
QWN0aXZhdG9yOw0KQEAgLTI1LDYgKzI4LDEwIEBADQogICovDQogcHVibGljIGNsYXNzIE1ldGFk
YXRhUmVwb3NpdG9yeU1hbmFnZXJUZXN0IGV4dGVuZHMgQWJzdHJhY3RQcm92aXNpb25pbmdUZXN0
IHsNCiAJcHJvdGVjdGVkIElNZXRhZGF0YVJlcG9zaXRvcnlNYW5hZ2VyIG1hbmFnZXI7DQorCS8q
Kg0KKwkgKiBDb250YWlucyB0ZW1wIEZpbGUgaGFuZGxlcyB0aGF0IHNob3VsZCBiZSBkZWxldGVk
IGF0IHRoZSBlbmQgb2YgdGhlIHRlc3QuDQorCSAqLw0KKwlwcml2YXRlIGZpbmFsIExpc3QgdG9E
ZWxldGUgPSBuZXcgQXJyYXlMaXN0KCk7DQogDQogCXB1YmxpYyBzdGF0aWMgVGVzdCBzdWl0ZSgp
IHsNCiAJCXJldHVybiBuZXcgVGVzdFN1aXRlKE1ldGFkYXRhUmVwb3NpdG9yeU1hbmFnZXJUZXN0
LmNsYXNzKTsNCkBAIC0zNSw2ICs0MiwxMyBAQA0KIAkJbWFuYWdlciA9IChJTWV0YWRhdGFSZXBv
c2l0b3J5TWFuYWdlcikgU2VydmljZUhlbHBlci5nZXRTZXJ2aWNlKFRlc3RBY3RpdmF0b3IuY29u
dGV4dCwgSU1ldGFkYXRhUmVwb3NpdG9yeU1hbmFnZXIuY2xhc3MuZ2V0TmFtZSgpKTsNCiAJfQ0K
IA0KKwlwcm90ZWN0ZWQgdm9pZCB0ZWFyRG93bigpIHRocm93cyBFeGNlcHRpb24gew0KKwkJc3Vw
ZXIudGVhckRvd24oKTsNCisJCWZvciAoSXRlcmF0b3IgaXQgPSB0b0RlbGV0ZS5pdGVyYXRvcigp
OyBpdC5oYXNOZXh0KCk7KQ0KKwkJCWRlbGV0ZSgoRmlsZSkgaXQubmV4dCgpKTsNCisJCXRvRGVs
ZXRlLmNsZWFyKCk7DQorCX0NCisNCiAJcHVibGljIHZvaWQgdGVzdEJhc2ljQWRkUmVtb3ZlKCkg
dGhyb3dzIE1hbGZvcm1lZFVSTEV4Y2VwdGlvbiB7DQogCQlGaWxlIHRlbXBGaWxlID0gbmV3IEZp
bGUoU3lzdGVtLmdldFByb3BlcnR5KCJqYXZhLmlvLnRtcGRpciIpKTsNCiAJCVVSTCBsb2NhdGlv
biA9IHRlbXBGaWxlLnRvVVJMKCk7DQpAQCAtNDUsNiArNTksNDkgQEANCiAJCWFzc2VydFRydWUo
IW1hbmFnZXJDb250YWlucyhsb2NhdGlvbikpOw0KIAl9DQogDQorCXB1YmxpYyB2b2lkIHRlc3RH
ZXRLbm93blJlcG9zaXRvcmllcygpIHRocm93cyBNYWxmb3JtZWRVUkxFeGNlcHRpb24gew0KKwkJ
aW50IG5vblN5c3RlbUNvdW50ID0gbWFuYWdlci5nZXRLbm93blJlcG9zaXRvcmllcyhJTWV0YWRh
dGFSZXBvc2l0b3J5TWFuYWdlci5SRVBPU0lUT1JJRVNfTk9OX1NZU1RFTSkubGVuZ3RoOw0KKwkJ
aW50IHN5c3RlbUNvdW50ID0gbWFuYWdlci5nZXRLbm93blJlcG9zaXRvcmllcyhJTWV0YWRhdGFS
ZXBvc2l0b3J5TWFuYWdlci5SRVBPU0lUT1JJRVNfU1lTVEVNKS5sZW5ndGg7DQorCQlpbnQgYWxs
Q291bnQgPSBtYW5hZ2VyLmdldEtub3duUmVwb3NpdG9yaWVzKElNZXRhZGF0YVJlcG9zaXRvcnlN
YW5hZ2VyLlJFUE9TSVRPUklFU19BTEwpLmxlbmd0aDsNCisJCWFzc2VydEVxdWFscygiMS4wIiwg
YWxsQ291bnQsIG5vblN5c3RlbUNvdW50ICsgc3lzdGVtQ291bnQpOw0KKw0KKwkJLy9jcmVhdGUg
YSBuZXcgcmVwb3NpdG9yeQ0KKwkJRmlsZSByZXBvTG9jYXRpb24gPSBnZXRUZW1wTG9jYXRpb24o
KTsNCisJCUlNZXRhZGF0YVJlcG9zaXRvcnkgdGVzdFJlcG8gPSBtYW5hZ2VyLmNyZWF0ZVJlcG9z
aXRvcnkocmVwb0xvY2F0aW9uLnRvVVJMKCksICJNZXRhZGF0YVJlcG9zaXRvcnlNYW5hZ2VyVGVz
dCIsIElNZXRhZGF0YVJlcG9zaXRvcnlNYW5hZ2VyLlRZUEVfU0lNUExFX1JFUE9TSVRPUlkpOw0K
KwkJaW50IG5ld05vblN5c3RlbUNvdW50ID0gbWFuYWdlci5nZXRLbm93blJlcG9zaXRvcmllcyhJ
TWV0YWRhdGFSZXBvc2l0b3J5TWFuYWdlci5SRVBPU0lUT1JJRVNfTk9OX1NZU1RFTSkubGVuZ3Ro
Ow0KKwkJaW50IG5ld1N5c3RlbUNvdW50ID0gbWFuYWdlci5nZXRLbm93blJlcG9zaXRvcmllcyhJ
TWV0YWRhdGFSZXBvc2l0b3J5TWFuYWdlci5SRVBPU0lUT1JJRVNfU1lTVEVNKS5sZW5ndGg7DQor
CQlpbnQgbmV3QWxsQ291bnQgPSBtYW5hZ2VyLmdldEtub3duUmVwb3NpdG9yaWVzKElNZXRhZGF0
YVJlcG9zaXRvcnlNYW5hZ2VyLlJFUE9TSVRPUklFU19BTEwpLmxlbmd0aDsNCisNCisJCS8vdGhl
cmUgc2hvdWxkIGJlIG9uZSBtb3JlIG5vbi1zeXN0ZW0gcmVwb3NpdG9yeQ0KKwkJYXNzZXJ0RXF1
YWxzKCIyLjAiLCBub25TeXN0ZW1Db3VudCArIDEsIG5ld05vblN5c3RlbUNvdW50KTsNCisJCWFz
c2VydEVxdWFscygiMi4xIiwgc3lzdGVtQ291bnQsIG5ld1N5c3RlbUNvdW50KTsNCisJCWFzc2Vy
dEVxdWFscygiMi4yIiwgYWxsQ291bnQgKyAxLCBuZXdBbGxDb3VudCk7DQorDQorCQkvL21ha2Ug
dGhlIHJlcG9zaXRvcnkgYSBzeXN0ZW0gcmVwb3NpdG9yeQ0KKwkJdGVzdFJlcG8uc2V0UHJvcGVy
dHkoSVJlcG9zaXRvcnkuUFJPUF9TWVNURU0sIEJvb2xlYW4uVFJVRS50b1N0cmluZygpKTsNCisN
CisJCS8vdGhlcmUgc2hvdWxkIGJlIG9uZSBtb3JlIHN5c3RlbSByZXBvc2l0b3J5DQorCQluZXdO
b25TeXN0ZW1Db3VudCA9IG1hbmFnZXIuZ2V0S25vd25SZXBvc2l0b3JpZXMoSU1ldGFkYXRhUmVw
b3NpdG9yeU1hbmFnZXIuUkVQT1NJVE9SSUVTX05PTl9TWVNURU0pLmxlbmd0aDsNCisJCW5ld1N5
c3RlbUNvdW50ID0gbWFuYWdlci5nZXRLbm93blJlcG9zaXRvcmllcyhJTWV0YWRhdGFSZXBvc2l0
b3J5TWFuYWdlci5SRVBPU0lUT1JJRVNfU1lTVEVNKS5sZW5ndGg7DQorCQluZXdBbGxDb3VudCA9
IG1hbmFnZXIuZ2V0S25vd25SZXBvc2l0b3JpZXMoSU1ldGFkYXRhUmVwb3NpdG9yeU1hbmFnZXIu
UkVQT1NJVE9SSUVTX0FMTCkubGVuZ3RoOw0KKwkJYXNzZXJ0RXF1YWxzKCIzLjAiLCBub25TeXN0
ZW1Db3VudCwgbmV3Tm9uU3lzdGVtQ291bnQpOw0KKwkJYXNzZXJ0RXF1YWxzKCIzLjEiLCBzeXN0
ZW1Db3VudCArIDEsIG5ld1N5c3RlbUNvdW50KTsNCisJCWFzc2VydEVxdWFscygiMy4yIiwgYWxs
Q291bnQgKyAxLCBuZXdBbGxDb3VudCk7DQorDQorCX0NCisNCisJLyoqDQorCSAqIFJldHVybnMg
YSBub24tZXhpc3RlbnQgZmlsZSB0aGF0IGNhbiBiZSB1c2VkIHRvIHdyaXRlIGEgdGVtcG9yYXJ5
DQorCSAqIGZpbGUgb3IgZGlyZWN0b3J5LiBUaGUgbG9jYXRpb24gd2lsbCBiZSBkZWxldGVkIGlu
IHRoZSB0ZXN0IHRlYXJEb3duIG1ldGhvZC4NCisJICovDQorCXByaXZhdGUgRmlsZSBnZXRUZW1w
TG9jYXRpb24oKSB7DQorCQlGaWxlIHRlbXBEaXIgPSBuZXcgRmlsZShTeXN0ZW0uZ2V0UHJvcGVy
dHkoImphdmEuaW8udG1wZGlyIikpOw0KKwkJRmlsZSB0ZW1wRmlsZSA9IG5ldyBGaWxlKHRlbXBE
aXIsICJNZXRhZGF0YVJlcG9zaXRvcnlNYW5hZ2VyVGVzdCIpOw0KKwkJZGVsZXRlKHRlbXBGaWxl
KTsNCisJCWFzc2VydFRydWUoIXRlbXBGaWxlLmV4aXN0cygpKTsNCisJCXJldHVybiB0ZW1wRmls
ZTsNCisJfQ0KKw0KIAlwdWJsaWMgdm9pZCB0ZXN0RmFpbHVyZUFkZFJlbW92ZSgpIHsNCiAJCXRy
eSB7DQogCQkJbWFuYWdlci5hZGRSZXBvc2l0b3J5KG51bGwpOw0K
</data>

          </attachment>
      

    </bug>

</bugzilla>