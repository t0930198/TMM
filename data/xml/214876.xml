<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.1"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>214876</bug_id>
          
          <creation_ts>2008-01-10 06:34:00 -0500</creation_ts>
          <short_desc>TableViewer doesn&apos;t update its underlaying control</short_desc>
          <delta_ts>2008-01-10 10:21:08 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>UI</component>
          <version>3.3</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows XP</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>INVALID</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Raffaele">r.gambelli</reporter>
          <assigned_to name="JDT-UI-Inbox">jdt-ui-inbox</assigned_to>
          
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1128801</commentid>
    <comment_count>0</comment_count>
      <attachid>86549</attachid>
    <who name="Raffaele">r.gambelli</who>
    <bug_when>2008-01-10 06:34:13 -0500</bug_when>
    <thetext>Created attachment 86549
A simple implementation of a view

Build ID: I20070621-1340

Steps To Reproduce:
1. See the file in attach, it is a simple implementation of an Eclipse View

My scenario:

- I have some data, and I wish to display them in both tree mode and table mode, the user can choose that behaviour simply clicking on a icon in the toolbar of the view (see the tooltip in the two icons...)
Besides, you should invent some data to test both viewers...

HOWEVER THE PROBLEM IS:

TableViewer seems not to update its underlaying control, example:

1. The view starts in table mode
2. User wants to switch in tree mode, he clicks in the icon in the toolbar
3. He resize the view to do a refresh in a way that the content may appear...
4. User wants again come back to table view mode, then he clicks in the other icon in the toolbar.
5. He resize the view again, but this time the content hasn&apos;t appeared....

Debugging the code, I saw that tableviewr, after setInput invocation, doesn&apos;t update its control, and so, items variable of Table object remains empty.

Tree control and the TreeViewer works good.

Am I wrong?

Another question, if I can...
How could I do to make a refresh when I switch from a viewer to the other one, without manually resizing the view?

Best regards
Raffaele</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1128901</commentid>
    <comment_count>1</comment_count>
    <who name="Raffaele">r.gambelli</who>
    <bug_when>2008-01-10 10:21:08 -0500</bug_when>
    <thetext>INVALID BUG...
I&apos;M SORRY!!!</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>86549</attachid>
            <date>2008-01-10 06:34:00 -0500</date>
            <delta_ts>2008-01-10 06:34:13 -0500</delta_ts>
            <desc>A simple implementation of a view</desc>
            <filename>ProblemsView.java</filename>
            <type>text/x-java</type>
            <size>16720</size>
            <attacher name="Raffaele">r.gambelli</attacher>
            
              <data encoding="base64">cGFja2FnZSBzdW5yaXNlLmVjbGlwc2VfcGx1Z2lucy5sb2d2aWV3ZXIudmlld3MucHJvYmxlbXN2
aWV3Ow0KDQppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7DQppbXBvcnQgamF2YS51dGlsLkl0ZXJh
dG9yOw0KaW1wb3J0IGphdmEudXRpbC5MaXN0Ow0KaW1wb3J0IGphdmEudXRpbC5NYXA7DQoNCmlt
cG9ydCBvcmcuZWNsaXBzZS5qZmFjZS5hY3Rpb24uQWN0aW9uOw0KaW1wb3J0IG9yZy5lY2xpcHNl
LmpmYWNlLmFjdGlvbi5JTWVudU1hbmFnZXI7DQppbXBvcnQgb3JnLmVjbGlwc2UuamZhY2UuYWN0
aW9uLklUb29sQmFyTWFuYWdlcjsNCmltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS5yZXNvdXJjZS5J
bWFnZURlc2NyaXB0b3I7DQppbXBvcnQgb3JnLmVjbGlwc2UuamZhY2Uudmlld2Vycy5Db2x1bW5M
YWJlbFByb3ZpZGVyOw0KaW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnZpZXdlcnMuSVN0cnVjdHVy
ZWRDb250ZW50UHJvdmlkZXI7DQppbXBvcnQgb3JnLmVjbGlwc2UuamZhY2Uudmlld2Vycy5JVGFi
bGVMYWJlbFByb3ZpZGVyOw0KaW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnZpZXdlcnMuSVRyZWVD
b250ZW50UHJvdmlkZXI7DQppbXBvcnQgb3JnLmVjbGlwc2UuamZhY2Uudmlld2Vycy5MYWJlbFBy
b3ZpZGVyOw0KaW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnZpZXdlcnMuVGFibGVWaWV3ZXI7DQpp
bXBvcnQgb3JnLmVjbGlwc2UuamZhY2Uudmlld2Vycy5UcmVlVmlld2VyOw0KaW1wb3J0IG9yZy5l
Y2xpcHNlLmpmYWNlLnZpZXdlcnMuVHJlZVZpZXdlckNvbHVtbjsNCmltcG9ydCBvcmcuZWNsaXBz
ZS5qZmFjZS52aWV3ZXJzLlZpZXdlcjsNCmltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS52aWV3ZXJz
LlZpZXdlclNvcnRlcjsNCmltcG9ydCBvcmcuZWNsaXBzZS5zd3QuU1dUOw0KaW1wb3J0IG9yZy5l
Y2xpcHNlLnN3dC5ldmVudHMuU2VsZWN0aW9uQWRhcHRlcjsNCmltcG9ydCBvcmcuZWNsaXBzZS5z
d3QuZXZlbnRzLlNlbGVjdGlvbkV2ZW50Ow0KaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ncmFwaGlj
cy5Db2xvcjsNCmltcG9ydCBvcmcuZWNsaXBzZS5zd3QuZ3JhcGhpY3MuSW1hZ2U7DQppbXBvcnQg
b3JnLmVjbGlwc2Uuc3d0LmxheW91dC5HcmlkRGF0YTsNCmltcG9ydCBvcmcuZWNsaXBzZS5zd3Qu
d2lkZ2V0cy5Db21wb3NpdGU7DQppbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuVGFibGU7
DQppbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuVGFibGVDb2x1bW47DQppbXBvcnQgb3Jn
LmVjbGlwc2Uuc3d0LndpZGdldHMuVHJlZTsNCmltcG9ydCBvcmcuZWNsaXBzZS51aS5JQWN0aW9u
QmFyczsNCmltcG9ydCBvcmcuZWNsaXBzZS51aS5JU2hhcmVkSW1hZ2VzOw0KaW1wb3J0IG9yZy5l
Y2xpcHNlLnVpLlBsYXRmb3JtVUk7DQppbXBvcnQgb3JnLmVjbGlwc2UudWkucGFydC5WaWV3UGFy
dDsNCmltcG9ydCBvcmcuZWNsaXBzZS51aS5wbHVnaW4uQWJzdHJhY3RVSVBsdWdpbjsNCg0KaW1w
b3J0IHN1bnJpc2UuZWNsaXBzZV9wbHVnaW5zLlBzc0VjbGlwc2VQbHVnaW47DQppbXBvcnQgc3Vu
cmlzZS5lY2xpcHNlX3BsdWdpbnMubG9ndmlld2VyLnN0YXRzLkRCSGVscGVyUHJvcGVydGllczsN
CmltcG9ydCBzdW5yaXNlLmVjbGlwc2VfcGx1Z2lucy5sb2d2aWV3ZXIuc3RhdHMuU3RhdHNBY2N1
bXVsYXRvcjsNCmltcG9ydCBzdW5yaXNlLmVjbGlwc2VfcGx1Z2lucy5sb2d2aWV3ZXIuc3RhdHMu
U3RhdHNBY2N1bXVsYXRvci5XYXJuRW50cnk7DQppbXBvcnQgc3VucmlzZS5lY2xpcHNlX3BsdWdp
bnMubG9ndmlld2VyLnZpZXdzLnByb2JsZW1zdmlldy5tb2RlbC5Sb290Ow0KaW1wb3J0IHN1bnJp
c2UuZWNsaXBzZV9wbHVnaW5zLmxvZ3ZpZXdlci52aWV3cy5wcm9ibGVtc3ZpZXcubW9kZWwuU3Vw
ZXJSb290Ow0KaW1wb3J0IHN1bnJpc2UuZWNsaXBzZV9wbHVnaW5zLmxvZ3ZpZXdlci52aWV3cy5w
cm9ibGVtc3ZpZXcubW9kZWwuV2FybmluZzsNCg0KDQpwdWJsaWMgY2xhc3MgUHJvYmxlbXNWaWV3
IGV4dGVuZHMgVmlld1BhcnQgew0KCXByaXZhdGUgc3RhdGljIE9iamVjdFtdIEVNUFRZX0FSUkFZ
ID0gbmV3IE9iamVjdFswXTsNCgkNCgkvL3ByaXZhdGUgVGFibGUgbV90YWJsZTsNCglwcml2YXRl
IFRhYmxlVmlld2VyIG1fdGFibGVWaWV3ZXI7DQoJcHJpdmF0ZSBUcmVlVmlld2VyIG1fdHJlZVZp
ZXdlcjsNCgkNCglwcml2YXRlIFN1cGVyUm9vdCBtX3N1cGVyUm9vdDsNCgkNCglwcml2YXRlIFJv
b3QgbV93YXJuaW5nczsNCgkNCglwcml2YXRlIEFjdGlvbiBtX3RhYmxlVmlld0FjdGlvbjsNCiAg
ICAgICAgcHJpdmF0ZSBBY3Rpb24gbV90cmVlVmlld0FjdGlvbjsNCiAgICAgICAgDQogICAgDQoJ
CQ0KCXByaXZhdGUgQ29tcG9zaXRlIG1fcGFyZW50Ow0KCQ0KCXByaXZhdGUgZmluYWwgU3RyaW5n
IFJPV19JRF9DT0xVTU4gPSAiUm93SWQiOw0KICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIERFU0NS
SVBUSU5fQ09MVU1OID0gIkRlc2NyaXB0aW9uIjsNCgkvLyBTZXQgY29sdW1uIG5hbWVzDQogICAg
cHJpdmF0ZSBTdHJpbmdbXSBtX2NvbHVtbk5hbWVzID0gbmV3IFN0cmluZ1tdIHsgDQogICAgICAg
ICAgICBST1dfSURfQ09MVU1OLA0KICAgICAgICAgICAgREVTQ1JJUFRJTl9DT0xVTU4NCiAgICAg
ICAgICAgIH07DQoNCglwcml2YXRlIGJvb2xlYW4gaXNUcmVlQWN0aXZlID0gZmFsc2U7DQogICAg
DQogICAgDQoJcHVibGljIHZvaWQgY3JlYXRlUGFydENvbnRyb2woQ29tcG9zaXRlIHBhcmVudCkg
ew0KCQltX3BhcmVudCA9IHBhcmVudDsNCgkJDQoJCW1fc3VwZXJSb290ID0gbmV3IFN1cGVyUm9v
dCgpOw0KCQltX3dhcm5pbmdzID0gbmV3IFJvb3QoKTsNCgkJDQogICAgICAgIG1fc3VwZXJSb290
LmFkZFJvb3QobV93YXJuaW5ncyk7DQoJCQ0KICAgICAgICAvLyBDcmVhdGUgYW5kIHNldHVwIHRo
ZSBUYWJsZVZpZXdlcg0KICAgICAgICBjcmVhdGVUYWJsZVZpZXdlcigpOw0KICAgICAgICBtX3Rh
YmxlVmlld2VyLnNldElucHV0KG1fc3VwZXJSb290KTsNCg0KCQkNCgkJbWFrZUFjdGlvbnMoKTsg
ICAgICAgIA0KICAgICAgICBjb250cmlidXRlVG9BY3Rpb25CYXJzKCk7DQoJfQ0KCQ0KCQ0KCS8q
Kg0KICAgICAqIENyZWF0ZSB0aGUgVGFibGVWaWV3ZXIgDQogICAgICovDQogICAgcHJpdmF0ZSB2
b2lkIGNyZWF0ZVRhYmxlVmlld2VyKCkgew0KICAgICAgICBpZiAobV90YWJsZVZpZXdlciA9PSBu
dWxsKSB7DQogICAgICAgICAgICANCiAgICAgICAgICAgIG1fdGFibGVWaWV3ZXIgPSBuZXcgVGFi
bGVWaWV3ZXIoY3JlYXRlVGFibGUoKSk7DQogICAgICAgICAgICBtX3RhYmxlVmlld2VyLnNldFVz
ZUhhc2hsb29rdXAodHJ1ZSk7DQogICAgICAgICAgICBtX3RhYmxlVmlld2VyLnNldENvbHVtblBy
b3BlcnRpZXMobV9jb2x1bW5OYW1lcyk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIG1fdGFi
bGVWaWV3ZXIuc2V0Q29udGVudFByb3ZpZGVyKG5ldyBUYWJsZUNvbnRlbnRQcm92aWRlcigpKTsN
CiAgICAgICAgICAgIG1fdGFibGVWaWV3ZXIuc2V0TGFiZWxQcm92aWRlcihuZXcgVGFibGVMYWJl
bFByb3ZpZGVyKCkpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBHcmlkRGF0YSBsYXlvdXRE
YXRhID0gbmV3IEdyaWREYXRhKCk7DQogICAgICAgICAgICBsYXlvdXREYXRhLmdyYWJFeGNlc3NI
b3Jpem9udGFsU3BhY2UgPSB0cnVlOw0KICAgICAgICAgICAgbGF5b3V0RGF0YS5ncmFiRXhjZXNz
VmVydGljYWxTcGFjZSA9IHRydWU7DQogICAgICAgICAgICBsYXlvdXREYXRhLmhvcml6b250YWxB
bGlnbm1lbnQgPSBHcmlkRGF0YS5GSUxMOw0KICAgICAgICAgICAgbGF5b3V0RGF0YS52ZXJ0aWNh
bEFsaWdubWVudCA9IEdyaWREYXRhLkZJTEw7DQogICAgICAgICAgICBtX3RhYmxlVmlld2VyLmdl
dENvbnRyb2woKS5zZXRMYXlvdXREYXRhKGxheW91dERhdGEpOw0KICAgICAgICB9DQogICAgfQ0K
ICAgIA0KCQ0KCS8qKg0KICAgICAqIENyZWF0ZSB0aGUgVGFibGUNCiAgICAgKi8NCiAgICBwcml2
YXRlIFRhYmxlIGNyZWF0ZVRhYmxlKCkgew0KICAgICAgICBpbnQgc3R5bGUgPSBTV1QuTVVMVEkg
fCBTV1QuRlVMTF9TRUxFQ1RJT04gfCBTV1QuQk9SREVSIHwgU1dULkhfU0NST0xMIHwgU1dULlZf
U0NST0xMOw0KICAgICAgICANCiAgICAgICAgVGFibGUgdGFibGUgPSBuZXcgVGFibGUobV9wYXJl
bnQsIHN0eWxlKTsNCiAgICAgICAgDQogICAgICAgIEdyaWREYXRhIGdyaWREYXRhID0gbmV3IEdy
aWREYXRhKEdyaWREYXRhLkZJTExfQk9USCk7DQogICAgICAgIGdyaWREYXRhLmdyYWJFeGNlc3NW
ZXJ0aWNhbFNwYWNlID0gdHJ1ZTsNCiAgICAgICAgZ3JpZERhdGEuaG9yaXpvbnRhbFNwYW4gPSAx
MTsNCiAgICAgICAgdGFibGUuc2V0TGF5b3V0RGF0YShncmlkRGF0YSk7ICAgICAgDQogICAgICAg
ICAgICAgICAgICAgIA0KICAgICAgICB0YWJsZS5zZXRMaW5lc1Zpc2libGUodHJ1ZSk7DQogICAg
ICAgIHRhYmxlLnNldEhlYWRlclZpc2libGUodHJ1ZSk7DQogICAgICAgIA0KICAgICAgICAvLyAN
CiAgICAgICAgVGFibGVDb2x1bW4gY29sdW1uID0gbmV3IFRhYmxlQ29sdW1uKHRhYmxlLCBTV1Qu
TEVGVCwgMCk7ICAgICANCiAgICAgICAgY29sdW1uLnNldFRleHQoUk9XX0lEX0NPTFVNTik7DQog
ICAgICAgIGNvbHVtbi5zZXRXaWR0aCg2MCk7DQogICAgICAgIGNvbHVtbi5hZGRTZWxlY3Rpb25M
aXN0ZW5lcihuZXcgU2VsZWN0aW9uQWRhcHRlcigpIHsgICAgICAgIA0KICAgICAgICAgICAgcHVi
bGljIHZvaWQgd2lkZ2V0U2VsZWN0ZWQoU2VsZWN0aW9uRXZlbnQgZSkgew0KICAgICAgICAgICAg
ICAgIG1fcm93SWRzb3J0ZXJEaXJlY3Rpb24gPSAxIC0gbV9yb3dJZHNvcnRlckRpcmVjdGlvbjsN
CiAgICAgICAgICAgICAgICBtX3RhYmxlVmlld2VyLnNldFNvcnRlcihuZXcgUm93SWRTb3J0ZXIo
Um93SWRTb3J0ZXIuUk9XX0lELCBtX3Jvd0lkc29ydGVyRGlyZWN0aW9uKSk7DQogICAgICAgICAg
ICB9DQogICAgICAgIH0pOyAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgLy8gDQogICAg
ICAgIGNvbHVtbiA9IG5ldyBUYWJsZUNvbHVtbih0YWJsZSwgU1dULkxFRlQsIDEpOyAgICAgDQog
ICAgICAgIGNvbHVtbi5zZXRUZXh0KERFU0NSSVBUSU5fQ09MVU1OKTsNCiAgICAgICAgY29sdW1u
LnNldFdpZHRoKDMwMCk7DQogICAgICAgIGNvbHVtbi5hZGRTZWxlY3Rpb25MaXN0ZW5lcihuZXcg
U2VsZWN0aW9uQWRhcHRlcigpIHsgICAgICAgIA0KICAgICAgICAgICAgcHVibGljIHZvaWQgd2lk
Z2V0U2VsZWN0ZWQoU2VsZWN0aW9uRXZlbnQgZSkgew0KICAgICAgICAgICAgICAgIA0KICAgICAg
ICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiB0YWJsZTsNCiAg
ICB9DQogICAgDQogICAgDQogICAgcHJpdmF0ZSB2b2lkIGNyZWF0ZVRyZWVWaWV3ZXIoKSB7DQog
ICAgICAgIGlmIChtX3RyZWVWaWV3ZXIgPT0gbnVsbCkgew0KICAgICAgICAgICAgbV90cmVlVmll
d2VyID0gbmV3IFRyZWVWaWV3ZXIobV9wYXJlbnQpOw0KICAgICAgICAgICAgDQogICAgICAgICAg
ICAoKFRyZWVWaWV3ZXIpbV90cmVlVmlld2VyKS5nZXRUcmVlKCkuc2V0SGVhZGVyVmlzaWJsZSh0
cnVlKTsNCiAgICAgICAgICAgICgoVHJlZVZpZXdlciltX3RyZWVWaWV3ZXIpLmdldFRyZWUoKS5z
ZXRMaW5lc1Zpc2libGUodHJ1ZSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIFRyZWVWaWV3
ZXJDb2x1bW4gZGVzY3JpcHRpb24gPSBuZXcgVHJlZVZpZXdlckNvbHVtbihtX3RyZWVWaWV3ZXIs
IFNXVC5OT05FKTsNCiAgICAgICAgICAgIGRlc2NyaXB0aW9uLnNldExhYmVsUHJvdmlkZXIobmV3
IERlc2NyaXB0aW9uUHJvdmlkZXIoKSk7DQogICAgICAgICAgICBkZXNjcmlwdGlvbi5nZXRDb2x1
bW4oKS5zZXRUZXh0KCJEZXNjcmlwdGlvbiIpOw0KICAgICAgICAgICAgZGVzY3JpcHRpb24uZ2V0
Q29sdW1uKCkuc2V0V2lkdGgoMjAwKTsNCiAgICAgICAgDQogICAgICAgICAgICBUcmVlVmlld2Vy
Q29sdW1uIHJvd0lkID0gbmV3IFRyZWVWaWV3ZXJDb2x1bW4obV90cmVlVmlld2VyLCBTV1QuTk9O
RSk7DQogICAgICAgICAgICByb3dJZC5zZXRMYWJlbFByb3ZpZGVyKG5ldyBSb3dJZFByb3ZpZGVy
KCkpOw0KICAgICAgICAgICAgcm93SWQuZ2V0Q29sdW1uKCkuc2V0VGV4dCgiUm93IGlkIik7DQog
ICAgICAgICAgICByb3dJZC5nZXRDb2x1bW4oKS5zZXRXaWR0aCg1MCk7DQogICAgICAgICAgICBy
b3dJZC5nZXRDb2x1bW4oKS5hZGRTZWxlY3Rpb25MaXN0ZW5lcihuZXcgU2VsZWN0aW9uQWRhcHRl
cigpIHsgICAgICAgIA0KICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHdpZGdldFNlbGVjdGVk
KFNlbGVjdGlvbkV2ZW50IGUpIHsNCiAgICAgICAgICAgICAgICAgICAgbV9yb3dJZHNvcnRlckRp
cmVjdGlvbiA9IDEgLSBtX3Jvd0lkc29ydGVyRGlyZWN0aW9uOw0KICAgICAgICAgICAgICAgICAg
ICBtX3RyZWVWaWV3ZXIuc2V0U29ydGVyKG5ldyBSb3dJZFNvcnRlcihSb3dJZFNvcnRlci5ST1df
SUQsIG1fcm93SWRzb3J0ZXJEaXJlY3Rpb24pKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAg
ICAgICB9KTsNCiAgICAgICAgDQogICAgICAgICAgICBtX3RyZWVWaWV3ZXIuc2V0Q29udGVudFBy
b3ZpZGVyKG5ldyBUcmVlQ29udGVudFByb3ZpZGVyKCkpOyAgICAgICAgICAgICAgDQogICAgICAg
ICAgICBtX3RyZWVWaWV3ZXIuZXhwYW5kQWxsKCk7DQogICAgICAgIH0NCiAgICB9DQoNCgkNCglw
dWJsaWMgdm9pZCBzZXRGb2N1cygpIHsNCgkJLy8gVE9ETyBBdXRvLWdlbmVyYXRlZCBtZXRob2Qg
c3R1YgkJDQoJfQ0KCQ0KCQ0KCQ0KCQ0KCQ0KCQ0KCQ0KCQ0KCXB1YmxpYyB2b2lkIHJlc2V0KCkg
ewkgICAgDQoJICAgIA0KCSAgICANCgkgICAgaWYgKGlzVHJlZUFjdGl2ZSkgew0KCSAgICAgICAg
bV90cmVlVmlld2VyLnJlZnJlc2goKTsNCgkgICAgfQ0KCSAgICBlbHNlIHsNCgkgICAgICAgIG1f
dGFibGVWaWV3ZXIucmVmcmVzaCgpOw0KCSAgICB9DQoJfQ0KICAgIA0KICAgIA0KICAgIA0KICAg
IHByaXZhdGUgdm9pZCBtYWtlQWN0aW9ucygpIHsgICANCiAgICAgICAgbV90YWJsZVZpZXdBY3Rp
b24gPSBuZXcgQWN0aW9uKCkgew0KICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgew0KICAg
ICAgICAgICAgICAgbV90YWJsZVZpZXdBY3Rpb24uc2V0RW5hYmxlZChmYWxzZSk7IA0KICAgICAg
ICAgICAgICAgbV90cmVlVmlld0FjdGlvbi5zZXRFbmFibGVkKHRydWUpOw0KICAgICAgICAgICAg
ICAgDQogICAgICAgICAgICAgICBhY3RpdmF0ZVRhYmxlVmlld01vZGUoKTsNCiAgICAgICAgICAg
IH0NCiAgICAgICAgfTsNCiAgICAgICAgbV90YWJsZVZpZXdBY3Rpb24uc2V0VGV4dCgiVGFibGUg
dmlldyIpOw0KICAgICAgICBtX3RhYmxlVmlld0FjdGlvbi5zZXRUb29sVGlwVGV4dCgiVmlldyB3
YXJuaW5ncyBpbiBhIHRhYmxlIG1vZGUiKTsNCiAgICAgICAgbV90YWJsZVZpZXdBY3Rpb24uc2V0
SW1hZ2VEZXNjcmlwdG9yKFBsYXRmb3JtVUkuZ2V0V29ya2JlbmNoKCkuZ2V0U2hhcmVkSW1hZ2Vz
KCkuZ2V0SW1hZ2VEZXNjcmlwdG9yKElTaGFyZWRJbWFnZXMuSU1HX1RPT0xfQ1VUKSk7DQogICAg
ICAgIG1fdGFibGVWaWV3QWN0aW9uLnNldEVuYWJsZWQoZmFsc2UpOw0KICAgICAgICANCiAgICAg
ICAgDQogICAgICAgIG1fdHJlZVZpZXdBY3Rpb24gPSBuZXcgQWN0aW9uKCkgew0KICAgICAgICAg
ICAgcHVibGljIHZvaWQgcnVuKCkgew0KICAgICAgICAgICAgICAgbV90YWJsZVZpZXdBY3Rpb24u
c2V0RW5hYmxlZCh0cnVlKTsNCiAgICAgICAgICAgICAgIG1fdHJlZVZpZXdBY3Rpb24uc2V0RW5h
YmxlZChmYWxzZSk7DQogICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgIGFjdGl2YXRlVHJl
ZVZpZXdNb2RlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH07DQogICAgICAgIA0KICAgICAg
ICBtX3RyZWVWaWV3QWN0aW9uLnNldFRleHQoIlRyZWUgdmlldyIpOw0KICAgICAgICBtX3RyZWVW
aWV3QWN0aW9uLnNldFRvb2xUaXBUZXh0KCJWaWV3IHdhcm5pbmdzIGluIGEgdHJlZSBtb2RlIik7
ICAgICAgICANCiAgICAgICAgbV90cmVlVmlld0FjdGlvbi5zZXRJbWFnZURlc2NyaXB0b3IoUGxh
dGZvcm1VSS5nZXRXb3JrYmVuY2goKS5nZXRTaGFyZWRJbWFnZXMoKS5nZXRJbWFnZURlc2NyaXB0
b3IoSVNoYXJlZEltYWdlcy5JTUdfVE9PTF9DVVQpKTsNCiAgICAgICAgbV90cmVlVmlld0FjdGlv
bi5zZXRFbmFibGVkKHRydWUpOw0KICAgIH0NCiAgICANCiAgICANCiAgICBwcml2YXRlIHZvaWQg
Y29udHJpYnV0ZVRvQWN0aW9uQmFycygpIHsNCiAgICAgICAgSUFjdGlvbkJhcnMgYmFycyA9IGdl
dFZpZXdTaXRlKCkuZ2V0QWN0aW9uQmFycygpOw0KICAgICAgICBmaWxsTG9jYWxQdWxsRG93bihi
YXJzLmdldE1lbnVNYW5hZ2VyKCkpOw0KICAgICAgICBmaWxsTG9jYWxUb29sQmFyKGJhcnMuZ2V0
VG9vbEJhck1hbmFnZXIoKSk7DQogICAgfQ0KDQogICAgcHJpdmF0ZSB2b2lkIGZpbGxMb2NhbFB1
bGxEb3duKElNZW51TWFuYWdlciBtYW5hZ2VyKSB7DQogICAgICAgIG1hbmFnZXIuYWRkKG1fdGFi
bGVWaWV3QWN0aW9uKTsNCiAgICAgICAgbWFuYWdlci5hZGQobV90cmVlVmlld0FjdGlvbik7ICAg
ICAgICAgICAgICAgICANCiAgICB9ICAgDQogICAgDQogICAgcHJpdmF0ZSB2b2lkIGZpbGxMb2Nh
bFRvb2xCYXIoSVRvb2xCYXJNYW5hZ2VyIG1hbmFnZXIpIHsNCiAgICAgICAgbWFuYWdlci5hZGQo
bV90YWJsZVZpZXdBY3Rpb24pOw0KICAgICAgICBtYW5hZ2VyLmFkZChtX3RyZWVWaWV3QWN0aW9u
KTsNCiAgICB9DQoNCiAgICBwcml2YXRlIHZvaWQgYWN0aXZhdGVUYWJsZVZpZXdNb2RlKCkgew0K
ICAgICAgICBpc1RyZWVBY3RpdmUgPSBmYWxzZTsNCiAgICAgICAgDQogICAgICAgIHRyeSB7DQog
ICAgICAgICAgICBtX3N1cGVyUm9vdCA9IChTdXBlclJvb3QpKChTdXBlclJvb3QpbV90cmVlVmll
d2VyLmdldElucHV0KCkpLmNsb25lKCk7DQogICAgICAgIH0gY2F0Y2ggKENsb25lTm90U3VwcG9y
dGVkRXhjZXB0aW9uIGUpIHsgICAgICAgICAgICANCiAgICAgICAgICAgIGUucHJpbnRTdGFja1Ry
YWNlKCk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigi
KioqKioqKioqKiBUQUJMRSAqKioqKioqKioqKioqKioiKTsNCiAgICAgICAgcHJpbnRDb250ZW50
KCk7DQogICAgICAgIG1fdHJlZVZpZXdlci5nZXRUcmVlKCkuZGlzcG9zZSgpOw0KICAgICAgICBt
X3RyZWVWaWV3ZXIgPSBudWxsOyAgDQogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiKioqKioq
KioqKioqKioqKioqKioqKioqKiIpOw0KICAgICAgICBwcmludENvbnRlbnQoKTsNCiAgICAgICAg
U3lzdGVtLm91dC5wcmludGxuKCk7DQogICAgICAgIA0KICAgICAgICBjcmVhdGVUYWJsZVZpZXdl
cigpOw0KICAgICAgICBtX3RhYmxlVmlld2VyLnNldElucHV0KG1fc3VwZXJSb290KTsNCiAgICAg
ICAgbV90YWJsZVZpZXdlci5nZXRUYWJsZSgpLnJlZHJhdygpOw0KICAgICAgICBtX3RhYmxlVmll
d2VyLnJlZnJlc2goKTsNCiAgICAgICAgDQogICAgICAgIGludCBpID0gMDsNCiAgICAgICAgaSsr
Ow0KICAgIH0NCiAgICANCiAgICBwcml2YXRlIHZvaWQgYWN0aXZhdGVUcmVlVmlld01vZGUoKSB7
ICAgIA0KICAgICAgICBpc1RyZWVBY3RpdmUgPSB0cnVlOyAgICAgICAgDQoNCiAgICAgICAgdHJ5
IHsNCiAgICAgICAgICAgIC8qbV90ZW1wU3VwZXJSb290Ki9tX3N1cGVyUm9vdCA9IChTdXBlclJv
b3QpKChTdXBlclJvb3QpbV90YWJsZVZpZXdlci5nZXRJbnB1dCgpKS5jbG9uZSgpOw0KICAgICAg
ICB9IGNhdGNoIChDbG9uZU5vdFN1cHBvcnRlZEV4Y2VwdGlvbiBlKSB7ICAgICAgICAgICAgDQog
ICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOw0KICAgICAgICB9DQogICAgICAgIA0KICAg
ICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIioqKioqKioqKiogVFJFRSAqKioqKioqKioqKioqKioi
KTsNCiAgICAgICAgcHJpbnRDb250ZW50KCk7DQogICAgICAgIG1fdGFibGVWaWV3ZXIuZ2V0VGFi
bGUoKS5kaXNwb3NlKCk7DQogICAgICAgIG1fdGFibGVWaWV3ZXIgPSBudWxsOw0KICAgICAgICBT
eXN0ZW0ub3V0LnByaW50bG4oIioqKioqKioqKioqKioqKioqKioqKioqKioiKTsNCiAgICAgICAg
cHJpbnRDb250ZW50KCk7DQogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigpOw0KICAgICAgICAN
CiAgICAgICAgY3JlYXRlVHJlZVZpZXdlcigpOyAgICANCiAgICAgICAgbV90cmVlVmlld2VyLnNl
dElucHV0KG1fc3VwZXJSb290KTsNCiAgICAgICAgbV90cmVlVmlld2VyLmdldFRyZWUoKS5yZWRy
YXcoKTsNCiAgICAgICAgbV90cmVlVmlld2VyLnJlZnJlc2goKTsNCiAgICB9DQogICAgDQogICAg
cHJpdmF0ZSB2b2lkIHByaW50Q29udGVudCgpIHsNCiAgICAgICAgTGlzdCBsID0gbV9zdXBlclJv
b3QuZ2V0Um9vdHNMaXN0KCk7DQogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlcmF0b3IgPSBsLml0
ZXJhdG9yKCk7IGl0ZXJhdG9yLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgIFJvb3Qgcm9vdCA9
IChSb290KSBpdGVyYXRvci5uZXh0KCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIExpc3Qg
bDEgPSByb290LmdldFByb2JsZW1zVHlwZUxpc3QoKTsNCiAgICAgICAgICAgIGZvciAoSXRlcmF0
b3IgaXRlcmF0b3IyID0gbDEuaXRlcmF0b3IoKTsgaXRlcmF0b3IyLmhhc05leHQoKTspIHsNCiAg
ICAgICAgICAgICAgICBXYXJuaW5nIHdhcm4gPSAoV2FybmluZykgaXRlcmF0b3IyLm5leHQoKTsN
CiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4od2Fy
bik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoJDQovLyAqKioqKioqKioqKioq
KioqKioqKiogSU5ORVIgQ0xBU1NFUyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioJDQogICAgDQogICAgDQogICAgDQogICAgY2xhc3MgVGFibGVDb250ZW50
UHJvdmlkZXIgaW1wbGVtZW50cyBJU3RydWN0dXJlZENvbnRlbnRQcm92aWRlciB7DQogICAgICAg
IA0KICAgICAgICBwdWJsaWMgdm9pZCBpbnB1dENoYW5nZWQoVmlld2VyIHYsIE9iamVjdCBvbGRJ
bnB1dCwgT2JqZWN0IG5ld0lucHV0KSB7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHB1
YmxpYyB2b2lkIGRpc3Bvc2UoKSB7DQogICAgICAgICAgICBtX3dhcm5pbmdzLmdldFByb2JsZW1z
VHlwZUxpc3QoKS5jbGVhcigpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBwdWJsaWMg
T2JqZWN0W10gZ2V0RWxlbWVudHMoT2JqZWN0IHBhcmVudCkgeyAgICAgICAgICAgIA0KICAgICAg
ICAgICAgcmV0dXJuIG1fd2FybmluZ3MuZ2V0UHJvYmxlbXNUeXBlTGlzdCgpLnRvQXJyYXkoKTsN
CiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICANCiAgICBzdGF0aWMgY2xhc3MgVGFibGVMYWJl
bFByb3ZpZGVyIGV4dGVuZHMgTGFiZWxQcm92aWRlciBpbXBsZW1lbnRzIElUYWJsZUxhYmVsUHJv
dmlkZXIgew0KICAgICAgICBJbWFnZURlc2NyaXB0b3IgZGVzY3JpcHRvciA9IG51bGw7DQogICAg
ICAgIHByaXZhdGUgTWFwIG1faW1hZ2VDYWNoZSA9IG5ldyBIYXNoTWFwKDUpOyAgICAgICAgIA0K
ICAgICAgICANCiAgICAgICAgcHVibGljIFN0cmluZyBnZXRDb2x1bW5UZXh0KE9iamVjdCBvYmos
IGludCBpbmRleCkgeyAgICAgICAgICAgIA0KICAgICAgICAgICAgU3RyaW5nIHJlc3VsdCA9ICIi
Ow0KICAgICAgICAgICAgV2FybmluZyB3YXJuID0gKFdhcm5pbmcpb2JqOw0KICAgICAgICAgICAg
c3dpdGNoIChpbmRleCkgew0KICAgICAgICAgICAgICAgIGNhc2UgMDogIA0KICAgICAgICAgICAg
ICAgICAgICByZXN1bHQgPSBTdHJpbmcudmFsdWVPZih3YXJuLmdldFJvd0lkKCkpOw0KICAgICAg
ICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIDE6ICANCiAgICAgICAg
ICAgICAgICAgICAgcmVzdWx0ID0gd2Fybi5nZXRUaXRsZSgpOw0KICAgICAgICAgICAgICAgICAg
ICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAg
IGRlZmF1bHQgOg0KICAgICAgICAgICAgICAgICAgICBicmVhazsgICANCiAgICAgICAgICAgICAg
ICB9DQogICAgICAgICAgICByZXR1cm4gcmVzdWx0Ow0KICAgICAgICB9DQogICAgICAgIA0KICAg
ICAgICBwdWJsaWMgSW1hZ2UgZ2V0Q29sdW1uSW1hZ2UoT2JqZWN0IG9iaiwgaW50IGluZGV4KSB7
DQogICAgICAgICAgICByZXR1cm4gZ2V0SW1hZ2UoaW5kZXgpOw0KICAgICAgICB9DQogICAgICAg
IA0KICAgICAgICBwdWJsaWMgSW1hZ2UgZ2V0SW1hZ2UoaW50IGluZGV4KSB7ICAgICAgICAgICAg
IA0KICAgICAgICAgICAgc3dpdGNoIChpbmRleCkgew0KICAgICAgICAgICAgICAgIGNhc2UgMTog
IA0KICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdG9yID0gUGxhdGZvcm1VSS5nZXRXb3JrYmVu
Y2goKS5nZXRTaGFyZWRJbWFnZXMoKS5nZXRJbWFnZURlc2NyaXB0b3IoSVNoYXJlZEltYWdlcy5J
TUdfT0JKU19XQVJOX1RTSyk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAg
ICAgICAgIGRlZmF1bHQgOg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAg
ICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gT2J0YWluIHRoZSBjYWNoZWQg
aW1hZ2UgY29ycmVzcG9uZGluZyB0byB0aGUgZGVzY3JpcHRvcg0KICAgICAgICAgICAgSW1hZ2Ug
aW1hZ2UgPSAoSW1hZ2UpbV9pbWFnZUNhY2hlLmdldChkZXNjcmlwdG9yKTsNCiAgICAgICAgICAg
IGlmIChpbWFnZSA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgaW1hZ2UgPSBkZXNjcmlwdG9y
LmNyZWF0ZUltYWdlKCk7DQogICAgICAgICAgICAgICAgbV9pbWFnZUNhY2hlLnB1dChkZXNjcmlw
dG9yLCBpbWFnZSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gaW1hZ2U7DQog
ICAgICAgIH0NCiAgICB9DQogICAgDQoJDQoJY2xhc3MgVHJlZUNvbnRlbnRQcm92aWRlciBpbXBs
ZW1lbnRzIElUcmVlQ29udGVudFByb3ZpZGVyIHsNCg0KCQlwdWJsaWMgT2JqZWN0W10gZ2V0Q2hp
bGRyZW4oT2JqZWN0IHBhcmVudEVsZW1lbnQpIHsNCgkJICAgIGlmIChwYXJlbnRFbGVtZW50IGlu
c3RhbmNlb2YgU3VwZXJSb290KSB7DQoJCSAgICAgICAgU3VwZXJSb290IHN1cGVyUm9vdCA9IChT
dXBlclJvb3QpcGFyZW50RWxlbWVudDsNCgkJICAgICAgICByZXR1cm4gc3VwZXJSb290LmdldFJv
b3RzTGlzdCgpLnRvQXJyYXkoKTsNCgkJICAgIH0NCgkJICAgIGVsc2UgaWYgKHBhcmVudEVsZW1l
bnQgaW5zdGFuY2VvZiBSb290KSB7DQoJCSAgICAgICAgUm9vdCByb290ID0gKFJvb3QpcGFyZW50
RWxlbWVudDsNCgkJICAgICAgICANCgkJICAgICAgICByZXR1cm4gcm9vdC5nZXRQcm9ibGVtc1R5
cGVMaXN0KCkudG9BcnJheSgpOw0KCQkgICAgfQ0KCQkgICAgcmV0dXJuIEVNUFRZX0FSUkFZOw0K
CQl9DQoNCgkJcHVibGljIE9iamVjdCBnZXRQYXJlbnQoT2JqZWN0IGVsZW1lbnQpIHsNCgkJICAg
IGlmKGVsZW1lbnQgaW5zdGFuY2VvZiBSb290KSB7DQoJCSAgICAgICAgcmV0dXJuICgoUm9vdCll
bGVtZW50KS5nZXRQYXJlbnQoKTsNCgkJICAgIH0NCgkJICAgIGVsc2UgaWYoZWxlbWVudCBpbnN0
YW5jZW9mIFdhcm5pbmcpIHsNCgkJICAgICAgICByZXR1cm4gKChXYXJuaW5nKWVsZW1lbnQpLmdl
dFBhcmVudCgpOw0KCQkgICAgfQ0KCQkgICAgcmV0dXJuIG51bGw7DQoJCX0NCg0KCQlwdWJsaWMg
Ym9vbGVhbiBoYXNDaGlsZHJlbihPYmplY3QgZWxlbWVudCkgew0KCQkJYm9vbGVhbiBiID0gZ2V0
Q2hpbGRyZW4oZWxlbWVudCkubGVuZ3RoID4gMDsNCiAgICAgICAgICAgIHJldHVybiBiOw0KCQl9
DQoNCgkJLyoqDQoJCSAqIFRoZSBnZXRFbGVtZW50cyBtZXRob2QgaXMgdXNlZCB0byBvYnRhaW4g
dGhlIHJvb3QgZWxlbWVudHMgZm9yIHRoZSB0cmVlIHZpZXdlcg0KCQkgKi8NCgkJcHVibGljIE9i
amVjdFtdIGdldEVsZW1lbnRzKE9iamVjdCBpbnB1dEVsZW1lbnQpIHsNCgkJCWlmIChpbnB1dEVs
ZW1lbnQgaW5zdGFuY2VvZiBTdXBlclJvb3QpIHsNCgkJCQlyZXR1cm4gKChTdXBlclJvb3QpaW5w
dXRFbGVtZW50KS5nZXRSb290c0xpc3QoKS50b0FycmF5KCk7DQoJCQl9DQoJCQllbHNlIHsNCgkJ
CQlyZXR1cm4gRU1QVFlfQVJSQVk7DQoJCQl9DQoJCX0NCg0KCQlwdWJsaWMgdm9pZCBkaXNwb3Nl
KCkgew0KCQkJLy8gVE9ETyBBdXRvLWdlbmVyYXRlZCBtZXRob2Qgc3R1Yg0KCQkJDQoJCX0NCg0K
CQlwdWJsaWMgdm9pZCBpbnB1dENoYW5nZWQoVmlld2VyIGFyZzAsIE9iamVjdCBhcmcxLCBPYmpl
Y3QgYXJnMikgew0KCQkJLy8gVE9ETyBBdXRvLWdlbmVyYXRlZCBtZXRob2Qgc3R1Yg0KCQkJDQoJ
CX0JCQ0KCX0NCgkNCglwdWJsaWMgY2xhc3MgRGVzY3JpcHRpb25Qcm92aWRlciBleHRlbmRzIENv
bHVtbkxhYmVsUHJvdmlkZXIgew0KCSAgICBJbWFnZURlc2NyaXB0b3IgZGVzY3JpcHRvciA9IG51
bGw7DQoJICAgIHByaXZhdGUgTWFwIG1faW1hZ2VDYWNoZSA9IG5ldyBIYXNoTWFwKDUpOw0KCSAg
ICANCgkgICAgDQoJICAgIHB1YmxpYyBTdHJpbmcgZ2V0VGV4dChPYmplY3QgZWxlbWVudCkgew0K
CSAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBXYXJuaW5nKSB7DQogICAgCSAgICAgICAg
aWYoKChXYXJuaW5nKWVsZW1lbnQpLmdldFRpdGxlKCkgPT0gbnVsbCkgew0KICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gIldhcm5pbmciOw0KICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAg
ICAgICAgZWxzZSB7ICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICByZXR1cm4g
KChXYXJuaW5nKWVsZW1lbnQpLmdldFRpdGxlKCk7DQogICAgICAgICAgICAgICAgfQ0KCSAgICAg
ICAgfQ0KCSAgICAgICAgZWxzZSB7DQoJICAgICAgICAgICAgcmV0dXJuICJXYXJuaW5ncyI7DQoJ
ICAgICAgICB9DQoJICAgIH0NCgkgICAgDQoJICAgIA0KCSAgICBwdWJsaWMgSW1hZ2UgZ2V0SW1h
Z2UoT2JqZWN0IGVsZW1lbnQpIHsNCgkgICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgV2Fy
bmluZykgew0KCSAgICAgICAgICAgIGRlc2NyaXB0b3IgPSBQbGF0Zm9ybVVJLmdldFdvcmtiZW5j
aCgpLmdldFNoYXJlZEltYWdlcygpLmdldEltYWdlRGVzY3JpcHRvcihJU2hhcmVkSW1hZ2VzLklN
R19PQkpTX1dBUk5fVFNLKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgaWYgKGVs
ZW1lbnQgaW5zdGFuY2VvZiBSb290KSB7DQogICAgICAgICAgICAgICAgZGVzY3JpcHRvciA9IFBz
c0VjbGlwc2VQbHVnaW4uZ2V0SW1hZ2VEZXNjcmlwdG9yKCJpY29ucy9wc3MuZ2lmIik7DQogICAg
ICAgICAgICB9DQoJICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgIHRocm93IG5ldyBSdW50
aW1lRXhjZXB0aW9uKCJVbmtub3duIHR5cGUgb2YgZWxlbWVudCBpbiB0cmVlIG9mIHR5cGUgIiAr
IGVsZW1lbnQuZ2V0Q2xhc3MoKS5nZXROYW1lKCkpOw0KICAgICAgICAgICAgfQ0KCSAgICAgICAg
DQoJICAgICAgIC8vIE9idGFpbiB0aGUgY2FjaGVkIGltYWdlIGNvcnJlc3BvbmRpbmcgdG8gdGhl
IGRlc2NyaXB0b3INCiAgICAgICAgICAgSW1hZ2UgaW1hZ2UgPSAoSW1hZ2UpbV9pbWFnZUNhY2hl
LmdldChkZXNjcmlwdG9yKTsNCiAgICAgICAgICAgaWYgKGltYWdlID09IG51bGwpIHsNCiAgICAg
ICAgICAgICAgIGltYWdlID0gZGVzY3JpcHRvci5jcmVhdGVJbWFnZSgpOw0KICAgICAgICAgICAg
ICAgbV9pbWFnZUNhY2hlLnB1dChkZXNjcmlwdG9yLCBpbWFnZSk7DQogICAgICAgICAgIH0NCiAg
ICAgICAgICAgcmV0dXJuIGltYWdlOw0KCSAgICB9DQoJICAgIA0KCSAgICANCgkgICAgcHVibGlj
IHZvaWQgZGlzcG9zZSgpIHsNCiAgICAgICAgICAgZm9yIChJdGVyYXRvciBpID0gbV9pbWFnZUNh
Y2hlLnZhbHVlcygpLml0ZXJhdG9yKCk7IGkuaGFzTmV4dCgpOykgew0KICAgICAgICAgICAgICAg
KChJbWFnZSkgaS5uZXh0KCkpLmRpc3Bvc2UoKTsNCiAgICAgICAgICAgfQ0KICAgICAgICAgICBt
X2ltYWdlQ2FjaGUuY2xlYXIoKTsNCiAgICAgIH0NCgl9DQoJDQoNCglwdWJsaWMgY2xhc3MgUm93
SWRQcm92aWRlciBleHRlbmRzIENvbHVtbkxhYmVsUHJvdmlkZXIgew0KCSAgICBwdWJsaWMgU3Ry
aW5nIGdldFRleHQoT2JqZWN0IGVsZW1lbnQpIHsNCgkgICAgICAgIGlmIChlbGVtZW50IGluc3Rh
bmNlb2YgV2FybmluZykgew0KCSAgICAgICAgICAgIHJldHVybiAiIiArICgoV2FybmluZyllbGVt
ZW50KS5nZXRSb3dJZCgpOwkgICAgICAgICAgICANCgkgICAgICAgIH0NCgkgICAgICAgIGVsc2Ug
ew0KCSAgICAgICAgICAgIHJldHVybiAiIjsNCgkgICAgICAgIH0NCgkgICAgfQ0KCSAgICANCgkg
ICAgcHVibGljIENvbG9yIGdldEZvcmVncm91bmQoT2JqZWN0IGVsZW1lbnQpIHsNCgkgICAgICAg
IGlmIChlbGVtZW50IGluc3RhbmNlb2YgV2FybmluZykgew0KICAgIAkgICAgICAgICAgICByZXR1
cm4gbV9wYXJlbnQuZ2V0RGlzcGxheSgpLmdldFN5c3RlbUNvbG9yKFNXVC5DT0xPUl9SRUQpOw0K
CSAgICAgICAgfQ0KCSAgICAgICAgZWxzZSB7DQoJICAgICAgICAgICAgcmV0dXJuIG1fcGFyZW50
LmdldERpc3BsYXkoKS5nZXRTeXN0ZW1Db2xvcihTV1QuQ09MT1JfQkxBQ0spOw0KCSAgICAgICAg
fQ0KCSAgICB9DQoJfQkNCn0NCg==
</data>

          </attachment>
      

    </bug>

</bugzilla>