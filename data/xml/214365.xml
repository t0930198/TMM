<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.1"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>214365</bug_id>
          
          <creation_ts>2008-01-04 11:59:00 -0500</creation_ts>
          <short_desc>Compare With Latest from repository results in: Error while loading resources, input was null.</short_desc>
          <delta_ts>2011-08-18 04:05:54 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>11</classification_id>
          <classification>Modeling</classification>
          <product>EMFCompare</product>
          <component>Core</component>
          <version>unspecified</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows XP</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Hajo Eichler">hajo.eichler</reporter>
          <assigned_to name="EMF Compare">emf.compare-inbox</assigned_to>
          <cc>cedric.brun</cc>
    
    <cc>laurent.goubet</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1125869</commentid>
    <comment_count>0</comment_count>
    <who name="Hajo Eichler">hajo.eichler</who>
    <bug_when>2008-01-04 11:59:07 -0500</bug_when>
    <thetext>Build ID: EMF Compare: I200801030355 

Steps To Reproduce:
1. Use an ecore metamodel file (error occurs independent of model type!)
2. Share it with subversive and commit the model file (failure does not depend on subversive!)
3. Change something in the model
4. Use context menu: Team-&gt;Compare With-&gt;Latest from Repository and the error will occur

(This error occurs also in other compare situations: e.g. if I want to compare two versions of a model from the SVN Source Resource History view.)

More information:
Problem is located in the org.eclipse.emf.compare.ui.viewer.structure ModelStructureContentProvider.doCompare:

Here, a IRunnableWithProgress is initialized, with a run method to calculate the diff model snapshot. Problem is that the diff model snapshot is directly accessed after the initialization of the progress (but the progress may not be triggered - as in the case described above) Thus, the model snapshot is still null!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1125921</commentid>
    <comment_count>1</comment_count>
    <who name="Laurent Goubet">laurent.goubet</who>
    <bug_when>2008-01-04 12:39:19 -0500</bug_when>
    <thetext>hummmm, this particular use case is our standard way of using EMF Compare, and we&apos;ve never met this problem. Are you sure this is not related to #207593 ?

As for the org.eclipse.emf.compare.ui.viewer.structure
ModelStructureContentProvider#doCompare() method, you are telling us the snapshot may not hav been initialized ... but it obviously is : 
snapshot = DiffFactory.eINSTANCE.createModelInputSnapshot();
is called in both pathes of an &quot;if ... else ...&quot; with no condition on the else, meaning this particular line of code is always called and the snapshot always initialized, except if the factory generated by EMF returns null which strike me as greatly doubtful if not impossible.

As for comparing models with the svn revision history ... well this works for us with the EMF Compare build you specified.

We all use Eclipse 3.3 and never tried the latest builds on eclipse &lt; 3.3. The issue might lie there? We cannot reproduce your problem on either Linux or windows XP.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1125936</commentid>
    <comment_count>2</comment_count>
    <who name="Hajo Eichler">hajo.eichler</who>
    <bug_when>2008-01-04 13:06:32 -0500</bug_when>
    <thetext>Well, I checked bug 207593, and it is not related to this one.

We are using eclipse.buildId=I20070625-1500

In the doCompare() method, you are right, it seems that both if/else directions always initialize the snapshot. But not in the same thread. The if/else do only initialize to Progresses, which will later initialize the snapshots. This not happens until the run() method of the processes is called! 

I will try to pack a minimum eclipse/SVN/compare package to reproduce this and send it to you</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1125942</commentid>
    <comment_count>3</comment_count>
    <who name="Hajo Eichler">hajo.eichler</who>
    <bug_when>2008-01-04 13:10:34 -0500</bug_when>
    <thetext>BTW: We changed the doCompare() operation to not use the following surrounding code: 

PlatformUI.getWorkbench().getProgressService().busyCursorWhile(new IRunnableWithProgress() {
 public void run(IProgressMonitor monitor) throws InterruptedException { 

}
});

After this change the error does not occur any longer.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1218872</commentid>
    <comment_count>4</comment_count>
    <who name="Laurent Goubet">laurent.goubet</who>
    <bug_when>2008-04-30 08:51:32 -0400</bug_when>
    <thetext>This issue should be fixed on CVS</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1980490</commentid>
    <comment_count>5</comment_count>
    <who name="Laurent Goubet">laurent.goubet</who>
    <bug_when>2011-08-18 04:05:54 -0400</bug_when>
    <thetext>Closing our &quot;resolved&quot; and &quot;verified&quot; bugs.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>