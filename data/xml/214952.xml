<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.1"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>214952</bug_id>
          
          <creation_ts>2008-01-10 15:43:00 -0500</creation_ts>
          <short_desc>Need ability to select preferred update mirror(s)</short_desc>
          <delta_ts>2009-03-30 11:35:29 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>Platform</product>
          <component>Update  (deprecated - use RT&gt;Equinox&gt;p2)</component>
          <version>3.3.1</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows XP</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Rustam Abdullaev">rustamabd</reporter>
          <assigned_to name="Platform-Update-Inbox">platform-update-inbox</assigned_to>
          <cc>cbos.ec</cc>
    
    <cc>eclipse-bugs</cc>
    
    <cc>remysuen</cc>
          
          <votes>1</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1129240</commentid>
    <comment_count>0</comment_count>
    <who name="Rustam Abdullaev">rustamabd</who>
    <bug_when>2008-01-10 15:43:50 -0500</bug_when>
    <thetext>Build ID: M20071023-1652

In automatic mode Eclipse picks SLOW US mirrors even though I&apos;m in EUROPE.
Would be nice to have a preference page where I can pick one or more mirrors for my updates.

Steps To Reproduce:
1. Help -&gt; Update -&gt; Find and install...
2. Check &quot;Select mirror automatically&quot; (otherwise I&apos;m prompted to select mirror 20 times)
3. Eclipse picks SLOW US mirrors even though I&apos;m in EUROPE</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1129366</commentid>
    <comment_count>1</comment_count>
    <who name="Remy Suen">remysuen</who>
    <bug_when>2008-01-10 18:14:59 -0500</bug_when>
    <thetext>See bug 213956.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1132535</commentid>
    <comment_count>2</comment_count>
      <attachid>87066</attachid>
    <who name="Rustam Abdullaev">rustamabd</who>
    <bug_when>2008-01-16 13:01:47 -0500</bug_when>
    <thetext>Created attachment 87066
Mirror preferences patch

I propose the following patch:

1) The mirror selection window now allows to select one or more mirrors and remember these settings on per-update-site basis.
2) The Install/Update settings page now allows to flush saved mirrors.

Attaching my proposed patch for org.eclipse.update.core and org.eclipse.update.ui.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1132594</commentid>
    <comment_count>3</comment_count>
      <attachid>87077</attachid>
    <who name="Rustam Abdullaev">rustamabd</who>
    <bug_when>2008-01-16 13:47:12 -0500</bug_when>
    <thetext>Created attachment 87077
mirror patch v.2

sorry, here&apos;s the correct patch. please ignore my previous patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1461909</commentid>
    <comment_count>4</comment_count>
    <who name="Eric Rizzo">eclipse-bugs</who>
    <bug_when>2009-03-30 09:50:20 -0400</bug_when>
    <thetext>How relevant is this now that p2 is around? Does it still apply to p2?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1462044</commentid>
    <comment_count>5</comment_count>
    <who name="John Arthorne">john_arthorne</who>
    <bug_when>2009-03-30 11:35:29 -0400</bug_when>
    <thetext>p2 does automatic mirror selection. Mirrors are initially sorted by geographic location, but the algorithm records the transfer rate for each mirror and automatically adapts to select faster mirrors. Since the mirror list (and mirror performance) can change from minute to minute. A static mirror preference doesn&apos;t work well.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>87066</attachid>
            <date>2008-01-16 13:01:00 -0500</date>
            <delta_ts>2008-01-16 13:47:12 -0500</delta_ts>
            <desc>Mirror preferences patch</desc>
            <filename>mirrors.patch</filename>
            <type>text/plain</type>
            <size>16324</size>
            <attacher name="Rustam Abdullaev">rustamabd</attacher>
            
              <data encoding="base64">ZGlmZiAtdXIgb3JnLmVjbGlwc2UudXBkYXRlLmNvcmVfMy4yLjEwMS5SMzN4X3YyMDA3MDkxMS9z
cmMvb3JnL2VjbGlwc2UvdXBkYXRlL2ludGVybmFsL2NvcmUvVXBkYXRlQ29yZS5qYXZhIG9yZy5l
Y2xpcHNlLnVwZGF0ZS5jb3JlL3NyYy9vcmcvZWNsaXBzZS91cGRhdGUvaW50ZXJuYWwvY29yZS9V
cGRhdGVDb3JlLmphdmEKLS0tIG9yZy5lY2xpcHNlLnVwZGF0ZS5jb3JlXzMuMi4xMDEuUjMzeF92
MjAwNzA5MTEvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRlcm5hbC9jb3JlL1VwZGF0ZUNvcmUu
amF2YQkyMDA3LTA2LTA2IDE2OjQyOjMwLjAwMDAwMDAwMCArMDIwMAorKysgb3JnLmVjbGlwc2Uu
dXBkYXRlLmNvcmUvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRlcm5hbC9jb3JlL1VwZGF0ZUNv
cmUuamF2YQkyMDA4LTAxLTE2IDE2OjI4OjU4LjQ1MzEyNTAwMCArMDEwMApAQCAtNTIsNiArNTIs
OCBAQAogCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFBfSElTVE9SWV9TSVpFID0gUFJFRklY
ICsgIi5oaXN0b3J5U2l6ZSI7IC8vJE5PTi1OTFMtMSQKIAlwdWJsaWMgc3RhdGljIGZpbmFsIFN0
cmluZyBQX0NIRUNLX1NJR05BVFVSRSA9IFBSRUZJWCArICIuY2hlY2tTaWduYXR1cmUiOyAvLyRO
T04tTkxTLTEkCiAJcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgUF9BVVRPTUFUSUNBTExZX0NI
T09TRV9NSVJST1IgPSAgUFJFRklYICsgIi5hdXRvbWF0aWNhbGx5Q2hvb3NlTWlycm9yIjsgLy8k
Tk9OLU5MUy0xJAorCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFBfU0FWRURfTUlSUk9SUyA9
ICBQUkVGSVggKyAiLm1pcnJvcnMiOyAvLyROT04tTkxTLTEkCisJcHVibGljIHN0YXRpYyBmaW5h
bCBTdHJpbmcgU0FWRURfTUlSUk9SU19TRVBBUkFUT1IgPSAgIlxuIjsgLy8kTk9OLU5MUy0xJAog
CXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFBfVVBEQVRFX1ZFUlNJT05TID0gUFJFRklYICsg
Ii51cGRhdGVWZXJzaW9ucyI7IC8vJE5PTi1OTFMtMSQKIAlwdWJsaWMgc3RhdGljIGZpbmFsIFN0
cmluZyBFUVVJVkFMRU5UX1ZBTFVFID0gImVxdWl2YWxlbnQiOyAvLyROT04tTkxTLTEkCiAJcHVi
bGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ09NUEFUSUJMRV9WQUxVRSA9ICJjb21wYXRpYmxlIjsg
Ly8kTk9OLU5MUy0xJApPbmx5IGluIG9yZy5lY2xpcHNlLnVwZGF0ZS5jb3JlL3NyYy9vcmcvZWNs
aXBzZS91cGRhdGUvaW50ZXJuYWwvY29yZTogbWVzc2FnZXMucHJvcGVydGllcwpPbmx5IGluIG9y
Zy5lY2xpcHNlLnVwZGF0ZS5jb3JlL3NyYy9vcmcvZWNsaXBzZS91cGRhdGUvaW50ZXJuYWwvamFy
cHJvY2Vzc29yOiBwYWNrLXJlYWRtZS5odG1sCmRpZmYgLXVyIG9yZy5lY2xpcHNlLnVwZGF0ZS51
aV8zLjIuMTAwLnYyMDA3MDYxNS9zcmMvb3JnL2VjbGlwc2UvdXBkYXRlL2ludGVybmFsL3VpL1Vw
ZGF0ZVVJTWVzc2FnZXMuamF2YSBvcmcuZWNsaXBzZS51cGRhdGUudWkvc3JjL29yZy9lY2xpcHNl
L3VwZGF0ZS9pbnRlcm5hbC91aS9VcGRhdGVVSU1lc3NhZ2VzLmphdmEKLS0tIG9yZy5lY2xpcHNl
LnVwZGF0ZS51aV8zLjIuMTAwLnYyMDA3MDYxNS9zcmMvb3JnL2VjbGlwc2UvdXBkYXRlL2ludGVy
bmFsL3VpL1VwZGF0ZVVJTWVzc2FnZXMuamF2YQkyMDA3LTA2LTA2IDE2OjQyOjQwLjAwMDAwMDAw
MCArMDIwMAorKysgb3JnLmVjbGlwc2UudXBkYXRlLnVpL3NyYy9vcmcvZWNsaXBzZS91cGRhdGUv
aW50ZXJuYWwvdWkvVXBkYXRlVUlNZXNzYWdlcy5qYXZhCTIwMDgtMDEtMTYgMTg6Mzg6NDUuMDE1
NjI1MDAwICswMTAwCkBAIC0yMCw2ICsyMCwxMCBAQAogCQkvLyBEbyBub3QgaW5zdGFudGlhdGUK
IAl9CiAKKwlwdWJsaWMgc3RhdGljIFN0cmluZyBNYWluUHJlZmVyZW5jZVBhZ2VfZmx1c2hTYXZl
ZE1pcnJvcnM7CisJcHVibGljIHN0YXRpYyBTdHJpbmcgTWlycm9yc0RpYWxvZ19lcnJvck11c3RD
aG9vc2U7CisJcHVibGljIHN0YXRpYyBTdHJpbmcgTWlycm9yc0RpYWxvZ19lcnJvck11c3RDaG9v
c2VIZWFkZXI7CisJcHVibGljIHN0YXRpYyBTdHJpbmcgTWlycm9yc0RpYWxvZ19yZW1lbWJlcjsK
IAlwdWJsaWMgc3RhdGljIFN0cmluZyBSZXN0YXJ0VGl0bGU7CiAJcHVibGljIHN0YXRpYyBTdHJp
bmcgUmVzdGFydE1lc3NhZ2U7CiAJcHVibGljIHN0YXRpYyBTdHJpbmcgT3B0aW9uYWxSZXN0YXJ0
TWVzc2FnZTsKT25seSBpbiBvcmcuZWNsaXBzZS51cGRhdGUudWkvc3JjL29yZy9lY2xpcHNlL3Vw
ZGF0ZS9pbnRlcm5hbC91aTogVXBkYXRlVUlQbHVnaW5SZXNvdXJjZXMucHJvcGVydGllcwpkaWZm
IC11ciBvcmcuZWNsaXBzZS51cGRhdGUudWlfMy4yLjEwMC52MjAwNzA2MTUvc3JjL29yZy9lY2xp
cHNlL3VwZGF0ZS9pbnRlcm5hbC91aS9wcmVmZXJlbmNlcy9NYWluUHJlZmVyZW5jZVBhZ2UuamF2
YSBvcmcuZWNsaXBzZS51cGRhdGUudWkvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRlcm5hbC91
aS9wcmVmZXJlbmNlcy9NYWluUHJlZmVyZW5jZVBhZ2UuamF2YQotLS0gb3JnLmVjbGlwc2UudXBk
YXRlLnVpXzMuMi4xMDAudjIwMDcwNjE1L3NyYy9vcmcvZWNsaXBzZS91cGRhdGUvaW50ZXJuYWwv
dWkvcHJlZmVyZW5jZXMvTWFpblByZWZlcmVuY2VQYWdlLmphdmEJMjAwNy0wNi0wNiAxNjo0Mjo0
MC4wMDAwMDAwMDAgKzAyMDAKKysrIG9yZy5lY2xpcHNlLnVwZGF0ZS51aS9zcmMvb3JnL2VjbGlw
c2UvdXBkYXRlL2ludGVybmFsL3VpL3ByZWZlcmVuY2VzL01haW5QcmVmZXJlbmNlUGFnZS5qYXZh
CTIwMDgtMDEtMTYgMTg6Mzg6NDQuOTM3NTAwMDAwICswMTAwCkBAIC0xMCwxOCArMTAsMzIgQEAK
ICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqLwogcGFja2FnZSBvcmcuZWNsaXBzZS51cGRhdGUuaW50
ZXJuYWwudWkucHJlZmVyZW5jZXM7CiAKLWltcG9ydCBqYXZhLm5ldC4qOworaW1wb3J0IGphdmEu
bmV0Lk1hbGZvcm1lZFVSTEV4Y2VwdGlvbjsKK2ltcG9ydCBqYXZhLm5ldC5VUkw7CiAKLWltcG9y
dCBvcmcuZWNsaXBzZS5jb3JlLnJ1bnRpbWUuKjsKLWltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS5k
aWFsb2dzLio7CitpbXBvcnQgb3JnLmVjbGlwc2UuY29yZS5ydW50aW1lLkNvcmVFeGNlcHRpb247
CitpbXBvcnQgb3JnLmVjbGlwc2UuY29yZS5ydW50aW1lLlByZWZlcmVuY2VzOwogaW1wb3J0IG9y
Zy5lY2xpcHNlLmpmYWNlLmRpYWxvZ3MuRGlhbG9nOworaW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNl
LmRpYWxvZ3MuTWVzc2FnZURpYWxvZzsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS5wcmVmZXJl
bmNlLlByZWZlcmVuY2VQYWdlOwogaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5TV1Q7CiBpbXBvcnQg
b3JnLmVjbGlwc2Uuc3d0LmN1c3RvbS5CdXN5SW5kaWNhdG9yOwotaW1wb3J0IG9yZy5lY2xpcHNl
LnN3dC5ldmVudHMuKjsKLWltcG9ydCBvcmcuZWNsaXBzZS5zd3QubGF5b3V0Lio7Ci1pbXBvcnQg
b3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuKjsKLWltcG9ydCBvcmcuZWNsaXBzZS51aS4qOworaW1w
b3J0IG9yZy5lY2xpcHNlLnN3dC5ldmVudHMuTW9kaWZ5RXZlbnQ7CitpbXBvcnQgb3JnLmVjbGlw
c2Uuc3d0LmV2ZW50cy5Nb2RpZnlMaXN0ZW5lcjsKK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuZXZl
bnRzLlNlbGVjdGlvbkFkYXB0ZXI7CitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmV2ZW50cy5TZWxl
Y3Rpb25FdmVudDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QubGF5b3V0LkdyaWREYXRhOworaW1w
b3J0IG9yZy5lY2xpcHNlLnN3dC5sYXlvdXQuR3JpZExheW91dDsKK2ltcG9ydCBvcmcuZWNsaXBz
ZS5zd3Qud2lkZ2V0cy5CdXR0b247CitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuQ29t
cG9zaXRlOworaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC53aWRnZXRzLkNvbnRyb2w7CitpbXBvcnQg
b3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuR3JvdXA7CitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0Lndp
ZGdldHMuTGFiZWw7CitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuU2hlbGw7CitpbXBv
cnQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuVGV4dDsKK2ltcG9ydCBvcmcuZWNsaXBzZS51aS5J
V29ya2JlbmNoOworaW1wb3J0IG9yZy5lY2xpcHNlLnVpLklXb3JrYmVuY2hQcmVmZXJlbmNlUGFn
ZTsKK2ltcG9ydCBvcmcuZWNsaXBzZS51aS5QbGF0Zm9ybVVJOwogaW1wb3J0IG9yZy5lY2xpcHNl
LnVwZGF0ZS5jb3JlLlNpdGVNYW5hZ2VyOwogaW1wb3J0IG9yZy5lY2xpcHNlLnVwZGF0ZS5pbnRl
cm5hbC5jb3JlLlVwZGF0ZUNvcmU7CiBpbXBvcnQgb3JnLmVjbGlwc2UudXBkYXRlLmludGVybmFs
Lm9wZXJhdGlvbnMuVXBkYXRlVXRpbHM7CkBAIC00MCw2ICs1NCw3IEBACiAJcHJpdmF0ZSBUZXh0
IGhpc3RvcnlTaXplVGV4dDsKIAlwcml2YXRlIEJ1dHRvbiBjaGVja1NpZ25hdHVyZUNoZWNrYm94
OwogCXByaXZhdGUgQnV0dG9uIGF1dG9tYXRpY2FsbHlDaG9vc2VNaXJyb3JDaGVja2JveDsKKwlw
cml2YXRlIEJ1dHRvbiBmbHVzaENob3Nlbk1pcnJvcnNCdXR0b247CiAJcHJpdmF0ZSBCdXR0b24g
ZXF1aXZhbGVudEJ1dHRvbjsKIAlwcml2YXRlIEJ1dHRvbiBjb21wYXRpYmxlQnV0dG9uOwogCXBy
aXZhdGUgVGV4dCB1cGRhdGVQb2xpY3lUZXh0OwpAQCAtMTA4LDYgKzEyMywxMSBAQAogCiAJCWNy
ZWF0ZVNwYWNlcihtYWluQ29tcG9zaXRlLCAyKTsKIAorCQlmbHVzaENob3Nlbk1pcnJvcnNCdXR0
b24gPSBuZXcgQnV0dG9uKG1haW5Db21wb3NpdGUsIFNXVC5QVVNIKTsKKwkJZmx1c2hDaG9zZW5N
aXJyb3JzQnV0dG9uLnNldFRleHQoVXBkYXRlVUlNZXNzYWdlcy5NYWluUHJlZmVyZW5jZVBhZ2Vf
Zmx1c2hTYXZlZE1pcnJvcnMpOworCisJCWNyZWF0ZVNwYWNlcihtYWluQ29tcG9zaXRlLCAyKTsK
KwogCQlHcm91cCBncm91cCA9IG5ldyBHcm91cChtYWluQ29tcG9zaXRlLCBTV1QuTk9ORSk7CiAJ
CWdyb3VwLnNldFRleHQoVXBkYXRlVUlNZXNzYWdlcy5NYWluUHJlZmVyZW5jZVBhZ2VfdXBkYXRl
VmVyc2lvbnMpOyAKIAkJZ3JvdXAuc2V0TGF5b3V0KG5ldyBHcmlkTGF5b3V0KCkpOwpAQCAtMTQy
LDYgKzE2MiwxMyBAQAogCQkvL2NyZWF0ZVNwYWNlcihtYWluQ29tcG9zaXRlLCAyKTsKIAkJLy9j
cmVhdGVIdHRwUHJveHkobWFpbkNvbXBvc2l0ZSwgMik7CiAJCWluaXRpYWxpemUoKTsKKwkJZmx1
c2hDaG9zZW5NaXJyb3JzQnV0dG9uLmFkZFNlbGVjdGlvbkxpc3RlbmVyKG5ldyBTZWxlY3Rpb25B
ZGFwdGVyKCl7CisJCQlwdWJsaWMgdm9pZCB3aWRnZXRTZWxlY3RlZChTZWxlY3Rpb25FdmVudCBl
KQorCQkJeworCQkJCXBlcmZvcm1GbHVzaENob3Nlbk1pcnJvcnMoKTsKKwkJCQlzdXBlci53aWRn
ZXRTZWxlY3RlZChlKTsKKwkJCX0KKwkJfSk7CiAJCXVwZGF0ZVBvbGljeVRleHQuYWRkTW9kaWZ5
TGlzdGVuZXIobmV3IE1vZGlmeUxpc3RlbmVyKCkgewogCQkJcHVibGljIHZvaWQgbW9kaWZ5VGV4
dChNb2RpZnlFdmVudCBlKSB7CiAJCQkJdGV4dENoYW5nZWQoKTsKQEAgLTIwMSw2ICsyMjgsMTUg
QEAKIAkJc2V0RXJyb3JNZXNzYWdlKG51bGwpOwkKIAl9CiAKKwlwdWJsaWMgdm9pZCBwZXJmb3Jt
Rmx1c2hDaG9zZW5NaXJyb3JzKCkgeworCQlmbHVzaENob3Nlbk1pcnJvcnNCdXR0b24uc2V0RW5h
YmxlZChmYWxzZSk7CisJCVByZWZlcmVuY2VzIHByZWZzID0gVXBkYXRlQ29yZS5nZXRQbHVnaW4o
KS5nZXRQbHVnaW5QcmVmZXJlbmNlcygpOworCQlpbnQgaSwgbiA9IHByZWZzLmdldFN0cmluZyhV
cGRhdGVDb3JlLlBfU0FWRURfTUlSUk9SUykuc3BsaXQoVXBkYXRlQ29yZS5TQVZFRF9NSVJST1JT
X1NFUEFSQVRPUikubGVuZ3RoOworCQlmb3IgKGk9MDtpPG47aSsrKQorCQkJcHJlZnMuc2V0VmFs
dWUoVXBkYXRlQ29yZS5QX1NBVkVEX01JUlJPUlMrIi4iK2ksICIiKTsgLy8kTk9OLU5MUy0xJCAv
LyROT04tTkxTLTIkCisJCXByZWZzLnNldFZhbHVlKFVwZGF0ZUNvcmUuUF9TQVZFRF9NSVJST1JT
LCAiIik7IC8vJE5PTi1OTFMtMSQKKwkJVXBkYXRlQ29yZS5nZXRQbHVnaW4oKS5zYXZlUGx1Z2lu
UHJlZmVyZW5jZXMoKTsKKwl9CiAJcHVibGljIGJvb2xlYW4gcGVyZm9ybU9rKCkgewogCQlCdXN5
SW5kaWNhdG9yLnNob3dXaGlsZShnZXRDb250cm9sKCkuZ2V0RGlzcGxheSgpLCBuZXcgUnVubmFi
bGUoKSB7CiAJCQlwdWJsaWMgdm9pZCBydW4oKSB7CkBAIC0yNDAsNiArMjc2LDggQEAKIAkJCXBy
ZWZzLmdldEJvb2xlYW4oVXBkYXRlQ29yZS5QX0NIRUNLX1NJR05BVFVSRSkpOwogCQlhdXRvbWF0
aWNhbGx5Q2hvb3NlTWlycm9yQ2hlY2tib3guc2V0U2VsZWN0aW9uKAogCQkJCXByZWZzLmdldEJv
b2xlYW4oVXBkYXRlQ29yZS5QX0FVVE9NQVRJQ0FMTFlfQ0hPT1NFX01JUlJPUikpOworCQlib29s
ZWFuIGhhdmVDaG9zZW5NaXJyb3JzID0gcHJlZnMuZ2V0U3RyaW5nKFVwZGF0ZUNvcmUuUF9TQVZF
RF9NSVJST1JTKS5sZW5ndGgoKSE9MDsKKwkJZmx1c2hDaG9zZW5NaXJyb3JzQnV0dG9uLnNldEVu
YWJsZWQoaGF2ZUNob3Nlbk1pcnJvcnMpOwogCiAJCWhpc3RvcnlTaXplVGV4dC5zZXRUZXh0KHBy
ZWZzLmdldFN0cmluZyhVcGRhdGVDb3JlLlBfSElTVE9SWV9TSVpFKSk7CiAKZGlmZiAtdXIgb3Jn
LmVjbGlwc2UudXBkYXRlLnVpXzMuMi4xMDAudjIwMDcwNjE1L3NyYy9vcmcvZWNsaXBzZS91cGRh
dGUvaW50ZXJuYWwvdWkvd2l6YXJkcy9NaXJyb3JzRGlhbG9nLmphdmEgb3JnLmVjbGlwc2UudXBk
YXRlLnVpL3NyYy9vcmcvZWNsaXBzZS91cGRhdGUvaW50ZXJuYWwvdWkvd2l6YXJkcy9NaXJyb3Jz
RGlhbG9nLmphdmEKLS0tIG9yZy5lY2xpcHNlLnVwZGF0ZS51aV8zLjIuMTAwLnYyMDA3MDYxNS9z
cmMvb3JnL2VjbGlwc2UvdXBkYXRlL2ludGVybmFsL3VpL3dpemFyZHMvTWlycm9yc0RpYWxvZy5q
YXZhCTIwMDctMDYtMDYgMTY6NDI6NDAuMDAwMDAwMDAwICswMjAwCisrKyBvcmcuZWNsaXBzZS51
cGRhdGUudWkvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRlcm5hbC91aS93aXphcmRzL01pcnJv
cnNEaWFsb2cuamF2YQkyMDA4LTAxLTE2IDE4OjAzOjM3LjI5Njg3NTAwMCArMDEwMApAQCAtMTQs
MTIgKzE0LDE1IEBACiBpbXBvcnQgb3JnLmVjbGlwc2UuY29yZS5ydW50aW1lLlByZWZlcmVuY2Vz
OwogaW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLmRpYWxvZ3MuRGlhbG9nOwogaW1wb3J0IG9yZy5l
Y2xpcHNlLmpmYWNlLmRpYWxvZ3MuSURpYWxvZ0NvbnN0YW50czsKK2ltcG9ydCBvcmcuZWNsaXBz
ZS5qZmFjZS5kaWFsb2dzLk1lc3NhZ2VEaWFsb2c7CiBpbXBvcnQgb3JnLmVjbGlwc2Uub3NnaS51
dGlsLk5MUzsKIGltcG9ydCBvcmcuZWNsaXBzZS5zd3QuU1dUOwogaW1wb3J0IG9yZy5lY2xpcHNl
LnN3dC5ldmVudHMuRm9jdXNBZGFwdGVyOwogaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ldmVudHMu
Rm9jdXNFdmVudDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuZXZlbnRzLk1vdXNlQWRhcHRlcjsK
IGltcG9ydCBvcmcuZWNsaXBzZS5zd3QuZXZlbnRzLk1vdXNlRXZlbnQ7Ci1pbXBvcnQgb3JnLmVj
bGlwc2Uuc3d0LmV2ZW50cy5Nb3VzZUxpc3RlbmVyOworaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5l
dmVudHMuU2VsZWN0aW9uQWRhcHRlcjsKK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuZXZlbnRzLlNl
bGVjdGlvbkV2ZW50OwogaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5sYXlvdXQuR3JpZERhdGE7CiBp
bXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmxheW91dC5HcmlkTGF5b3V0OwogaW1wb3J0IG9yZy5lY2xp
cHNlLnN3dC53aWRnZXRzLkJ1dHRvbjsKQEAgLTM5LDggKzQyLDkgQEAKIAlwcml2YXRlIFN0cmlu
ZyBzaXRlTmFtZTsKIAlwcml2YXRlIElVUkxFbnRyeVtdIG1pcnJvcnM7CiAJcHJpdmF0ZSBMaXN0
IG1pcnJvcnNMaXN0OwotCXByaXZhdGUgSVVSTEVudHJ5IG1pcnJvclNlbGVjdGVkOworCXByaXZh
dGUgSVVSTEVudHJ5IHNlbGVjdGVkTWlycm9yc1tdOwogCXByaXZhdGUgQnV0dG9uIGF1dG9tYXRp
Y2FsbHlDaG9vc2VNaXJyb3JDaGVja2JveDsKKwlwcml2YXRlIEJ1dHRvbiByZW1lbWJlck1pcnJv
clNlbGVjdGlvbkNoZWNrYm94OwogCS8vcHJpdmF0ZSBCdXR0b24gb2tCdXR0b247CiAJLyoqCiAJ
ICogQHBhcmFtIHBhcmVudFNoZWxsCkBAIC05Nyw3ICsxMDEsNyBAQAogCQkJfQogCQl9KTsKIAkJ
Ci0JCW1pcnJvcnNMaXN0ID0gbmV3IExpc3QoY29tcG9zaXRlLCBTV1QuQk9SREVSIHwgU1dULkhf
U0NST0xMIHwgU1dULlZfU0NST0xMKTsKKwkJbWlycm9yc0xpc3QgPSBuZXcgTGlzdChjb21wb3Np
dGUsIFNXVC5CT1JERVIgfCBTV1QuSF9TQ1JPTEwgfCBTV1QuVl9TQ1JPTEwgfCBTV1QuTVVMVEkp
OwogCQlkYXRhID0gbmV3IEdyaWREYXRhKEdyaWREYXRhLkZJTExfQk9USCk7CiAJCWRhdGEuaG9y
aXpvbnRhbFNwYW4gPSAyOwogCQltaXJyb3JzTGlzdC5zZXRMYXlvdXREYXRhKGRhdGEpOwpAQCAt
MTA2LDcgKzExMCwxNCBAQAogCQkJbWlycm9yc0xpc3QuYWRkKG1pcnJvcnNbaV0uZ2V0QW5ub3Rh
dGlvbigpKTsKIAkJbWlycm9yc0xpc3QuYWRkKHNpdGVOYW1lKTsKIAotCQltaXJyb3JzTGlzdC5z
ZWxlY3QoMCk7CisvLwkJbWlycm9yc0xpc3Quc2VsZWN0KDApOworCQkKKwkJcmVtZW1iZXJNaXJy
b3JTZWxlY3Rpb25DaGVja2JveCA9CisJCQluZXcgQnV0dG9uKGNvbXBvc2l0ZSwgU1dULkNIRUNL
IHwgU1dULkxFRlQpOworCQlyZW1lbWJlck1pcnJvclNlbGVjdGlvbkNoZWNrYm94LnNldFRleHQo
TkxTLmJpbmQoVXBkYXRlVUlNZXNzYWdlcy5NaXJyb3JzRGlhbG9nX3JlbWVtYmVyLHNpdGVOYW1l
KSk7CisJCWRhdGEgPSBuZXcgR3JpZERhdGEoKTsKKwkJZGF0YS5ob3Jpem9udGFsU3BhbiA9IDI7
CisJCXJlbWVtYmVyTWlycm9yU2VsZWN0aW9uQ2hlY2tib3guc2V0TGF5b3V0RGF0YShkYXRhKTsJ
CQogCQkKIAkJYXV0b21hdGljYWxseUNob29zZU1pcnJvckNoZWNrYm94ID0KIAkJCW5ldyBCdXR0
b24oY29tcG9zaXRlLCBTV1QuQ0hFQ0sgfCBTV1QuTEVGVCk7CkBAIC0xMTQsMzkgKzEyNSw4NyBA
QAogCQlkYXRhID0gbmV3IEdyaWREYXRhKCk7CiAJCWRhdGEuaG9yaXpvbnRhbFNwYW4gPSAyOwog
CQlhdXRvbWF0aWNhbGx5Q2hvb3NlTWlycm9yQ2hlY2tib3guc2V0TGF5b3V0RGF0YShkYXRhKTsJ
CQotCQkKKwogCQlEaWFsb2cuYXBwbHlEaWFsb2dGb250KGNvbXBvc2l0ZSk7CiAJCQotCQltaXJy
b3JzTGlzdC5hZGRNb3VzZUxpc3RlbmVyKCBuZXcgTW91c2VMaXN0ZW5lcigpIHsKKwkJYXV0b21h
dGljYWxseUNob29zZU1pcnJvckNoZWNrYm94LmFkZFNlbGVjdGlvbkxpc3RlbmVyKG5ldyBTZWxl
Y3Rpb25BZGFwdGVyKCkgeworCQkJcHJpdmF0ZSBib29sZWFuIHNhdmVkUmVtZW1iZXJNaXJyb3JT
ZWxlY3Rpb247CisJCQlwcml2YXRlIGludFtdIHNhdmVkTWlycm9yc1NlbGVjdGlvbjsKKwkJCXB1
YmxpYyB2b2lkIHdpZGdldFNlbGVjdGVkKFNlbGVjdGlvbkV2ZW50IGUpCisJCQl7CisJCQkJc3Vw
ZXIud2lkZ2V0U2VsZWN0ZWQoZSk7CisJCQkJaWYgKGF1dG9tYXRpY2FsbHlDaG9vc2VNaXJyb3JD
aGVja2JveC5nZXRTZWxlY3Rpb24oKSkgeworCQkJCQltaXJyb3JzTGlzdC5zZXRFbmFibGVkKGZh
bHNlKTsKKwkJCQkJcmVtZW1iZXJNaXJyb3JTZWxlY3Rpb25DaGVja2JveC5zZXRFbmFibGVkKGZh
bHNlKTsKKwkJCQkJc2F2ZWRSZW1lbWJlck1pcnJvclNlbGVjdGlvbiA9IHJlbWVtYmVyTWlycm9y
U2VsZWN0aW9uQ2hlY2tib3guZ2V0U2VsZWN0aW9uKCk7CisJCQkJCXNhdmVkTWlycm9yc1NlbGVj
dGlvbiA9IG1pcnJvcnNMaXN0LmdldFNlbGVjdGlvbkluZGljZXMoKTsKKwkJCQkJbWlycm9yc0xp
c3Quc2V0U2VsZWN0aW9uKDEsIDApOworCQkJCQlyZW1lbWJlck1pcnJvclNlbGVjdGlvbkNoZWNr
Ym94LnNldFNlbGVjdGlvbihmYWxzZSk7CisJCQkJfSBlbHNlIHsKKwkJCQkJbWlycm9yc0xpc3Qu
c2V0U2VsZWN0aW9uKHNhdmVkTWlycm9yc1NlbGVjdGlvbik7CisJCQkJCXJlbWVtYmVyTWlycm9y
U2VsZWN0aW9uQ2hlY2tib3guc2V0U2VsZWN0aW9uKHNhdmVkUmVtZW1iZXJNaXJyb3JTZWxlY3Rp
b24pOworCQkJCQltaXJyb3JzTGlzdC5zZXRFbmFibGVkKHRydWUpOworCQkJCQlyZW1lbWJlck1p
cnJvclNlbGVjdGlvbkNoZWNrYm94LnNldEVuYWJsZWQodHJ1ZSk7CisJCQkJfQorCQkJfQorCQl9
KTsKKwkJbWlycm9yc0xpc3QuYWRkTW91c2VMaXN0ZW5lciggbmV3IE1vdXNlQWRhcHRlcigpIHsK
IAkJCQlwdWJsaWMgdm9pZCBtb3VzZURvdWJsZUNsaWNrKE1vdXNlRXZlbnQgZSkgewogCQkJCQlv
a1ByZXNzZWQoKTsJCQkKIAkJCQl9CQotCQkJCXB1YmxpYyB2b2lkIG1vdXNlRG93bihNb3VzZUV2
ZW50IGUpIHsKLQkJCQkJLy8gZG8gbm90aGluZwkJCQotCQkJCX0KLQkJCQlwdWJsaWMgdm9pZCBt
b3VzZVVwKE1vdXNlRXZlbnQgZSkgewotCQkJCQkvLwlkbyBub3RoaW5nCQkJCQotCQkJCX0JCQkK
IAkJCX0KIAkJKTsKIAkJcmV0dXJuIGNvbXBvc2l0ZTsKIAl9CiAJCQogCXByb3RlY3RlZCB2b2lk
IG9rUHJlc3NlZCgpIHsKLQkJaW50IGkgPSBtaXJyb3JzTGlzdC5nZXRTZWxlY3Rpb25JbmRleCgp
OworCQlpbnQgaSwgbWlycm9ySURzW10gPSBtaXJyb3JzTGlzdC5nZXRTZWxlY3Rpb25JbmRpY2Vz
KCk7CiAJCS8vIGZpcnN0IGVudHJ5IGlzIHRoZSBzaXRlIGl0c2VsZgotCQlpZiAoaSA8bWlycm9y
cy5sZW5ndGgpCi0JCQltaXJyb3JTZWxlY3RlZCA9IG1pcnJvcnNbaV07CisJCXNlbGVjdGVkTWly
cm9ycyA9IG5ldyBJVVJMRW50cnlbbWlycm9ySURzLmxlbmd0aF07CisJCWZvciAoaT0wO2k8bWly
cm9ySURzLmxlbmd0aDtpKyspCisJCQlzZWxlY3RlZE1pcnJvcnNbaV0gPSBtaXJyb3JzW21pcnJv
cklEc1swXV07CiAJCWlmIChhdXRvbWF0aWNhbGx5Q2hvb3NlTWlycm9yQ2hlY2tib3guZ2V0U2Vs
ZWN0aW9uKCkpIHsKIAkJCVByZWZlcmVuY2VzIHByZWZzID0gVXBkYXRlQ29yZS5nZXRQbHVnaW4o
KS5nZXRQbHVnaW5QcmVmZXJlbmNlcygpOwogCQkJcHJlZnMuc2V0VmFsdWUoVXBkYXRlQ29yZS5Q
X0FVVE9NQVRJQ0FMTFlfQ0hPT1NFX01JUlJPUiwgdHJ1ZSk7CiAJCQlVcGRhdGVDb3JlLmdldFBs
dWdpbigpLnNhdmVQbHVnaW5QcmVmZXJlbmNlcygpOwogCQl9CisJCWlmIChzZWxlY3RlZE1pcnJv
cnMubGVuZ3RoPT0wKSB7CisJCQlNZXNzYWdlRGlhbG9nLm9wZW5FcnJvcihnZXRTaGVsbCgpLAor
CQkJCQlVcGRhdGVVSU1lc3NhZ2VzLk1pcnJvcnNEaWFsb2dfZXJyb3JNdXN0Q2hvb3NlSGVhZGVy
LAorCQkJCQlVcGRhdGVVSU1lc3NhZ2VzLk1pcnJvcnNEaWFsb2dfZXJyb3JNdXN0Q2hvb3NlKTsK
KwkJCXJldHVybjsKKwkJfQorCQlpZiAocmVtZW1iZXJNaXJyb3JTZWxlY3Rpb25DaGVja2JveC5n
ZXRTZWxlY3Rpb24oKSkgeworCQkJUHJlZmVyZW5jZXMgcHJlZnMgPSBVcGRhdGVDb3JlLmdldFBs
dWdpbigpLmdldFBsdWdpblByZWZlcmVuY2VzKCk7CisJCQlTdHJpbmcgc2F2ZWRNaXJyb3JTaXRl
c1tdID0gcHJlZnMuZ2V0U3RyaW5nKFVwZGF0ZUNvcmUuUF9TQVZFRF9NSVJST1JTKS5zcGxpdChV
cGRhdGVDb3JlLlNBVkVEX01JUlJPUlNfU0VQQVJBVE9SKTsKKwkJCWludCBzaXRlSWR4ID0gMDsK
KwkJCXdoaWxlIChzaXRlSWR4PHNhdmVkTWlycm9yU2l0ZXMubGVuZ3RoICYmICFzYXZlZE1pcnJv
clNpdGVzW3NpdGVJZHhdLmVxdWFscyhzaXRlTmFtZSkpCisJCQkJc2l0ZUlkeCsrOworCQkJaWYg
KHNpdGVJZHg+PXNhdmVkTWlycm9yU2l0ZXMubGVuZ3RoKSB7CisJCQkJU3RyaW5nIHRtcFtdID0g
bmV3IFN0cmluZ1tzaXRlSWR4KzFdOworCQkJCWZvciAoaT0wO2k8c2F2ZWRNaXJyb3JTaXRlcy5s
ZW5ndGg7aSsrKSB0bXBbaV09c2F2ZWRNaXJyb3JTaXRlc1tpXTsKKwkJCQlzYXZlZE1pcnJvclNp
dGVzID0gdG1wOworCQkJfQorCQkJc2F2ZWRNaXJyb3JTaXRlc1tzaXRlSWR4XSA9IHNpdGVOYW1l
OworCQkJU3RyaW5nQnVmZmVyIG1pcnJvclVSTHMgPSBuZXcgU3RyaW5nQnVmZmVyKDEwMjQpOwor
CQkJZm9yIChpPTA7aTxtaXJyb3JJRHMubGVuZ3RoO2krKykgeworCQkJCWlmIChpIT0wKSBtaXJy
b3JVUkxzLmFwcGVuZChVcGRhdGVDb3JlLlNBVkVEX01JUlJPUlNfU0VQQVJBVE9SKTsKKwkJCQlt
aXJyb3JVUkxzLmFwcGVuZChtaXJyb3JzW21pcnJvcklEc1tpXV0uZ2V0VVJMKCkudG9FeHRlcm5h
bEZvcm0oKSk7CisJCQl9CisJCQlwcmVmcy5zZXRWYWx1ZShVcGRhdGVDb3JlLlBfU0FWRURfTUlS
Uk9SUysiLiIrc2l0ZUlkeCwgbWlycm9yVVJMcy50b1N0cmluZygpKTsgLy8kTk9OLU5MUy0xJAor
CQkJU3RyaW5nQnVmZmVyIHNhdmVkTWlycm9ycyA9IG5ldyBTdHJpbmdCdWZmZXIoMTAyNCk7CisJ
CQlmb3IgKGk9MDtpPHNhdmVkTWlycm9yU2l0ZXMubGVuZ3RoO2krKykgeworCQkJCWlmIChpIT0w
KSBzYXZlZE1pcnJvcnMuYXBwZW5kKFVwZGF0ZUNvcmUuU0FWRURfTUlSUk9SU19TRVBBUkFUT1Ip
OworCQkJCXNhdmVkTWlycm9ycy5hcHBlbmQoc2F2ZWRNaXJyb3JTaXRlc1tpXSk7CisJCQl9CisJ
CQlwcmVmcy5zZXRWYWx1ZShVcGRhdGVDb3JlLlBfU0FWRURfTUlSUk9SUywgc2F2ZWRNaXJyb3Jz
LnRvU3RyaW5nKCkpOworCQkJVXBkYXRlQ29yZS5nZXRQbHVnaW4oKS5zYXZlUGx1Z2luUHJlZmVy
ZW5jZXMoKTsKKwkJfQogCQlzdXBlci5va1ByZXNzZWQoKTsKIAl9CiAJCi0JcHVibGljIElVUkxF
bnRyeSBnZXRNaXJyb3IoKSB7Ci0JCXJldHVybiBtaXJyb3JTZWxlY3RlZDsKKwlwdWJsaWMgSVVS
TEVudHJ5W10gZ2V0TWlycm9ycygpIHsKKwkJcmV0dXJuIHNlbGVjdGVkTWlycm9yczsKIAl9CiAK
ICAgIHByb3RlY3RlZCB2b2lkIGNvbmZpZ3VyZVNoZWxsKFNoZWxsIHNoZWxsKSB7CmRpZmYgLXVy
IG9yZy5lY2xpcHNlLnVwZGF0ZS51aV8zLjIuMTAwLnYyMDA3MDYxNS9zcmMvb3JnL2VjbGlwc2Uv
dXBkYXRlL3VpL1VwZGF0ZUpvYi5qYXZhIG9yZy5lY2xpcHNlLnVwZGF0ZS51aS9zcmMvb3JnL2Vj
bGlwc2UvdXBkYXRlL3VpL1VwZGF0ZUpvYi5qYXZhCi0tLSBvcmcuZWNsaXBzZS51cGRhdGUudWlf
My4yLjEwMC52MjAwNzA2MTUvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS91aS9VcGRhdGVKb2IuamF2
YQkyMDA3LTA2LTA2IDE2OjQyOjQwLjAwMDAwMDAwMCArMDIwMAorKysgb3JnLmVjbGlwc2UudXBk
YXRlLnVpL3NyYy9vcmcvZWNsaXBzZS91cGRhdGUvdWkvVXBkYXRlSm9iLmphdmEJMjAwOC0wMS0x
NiAxODowNToxMy4yMDMxMjUwMDAgKzAxMDAKQEAgLTE4LDYgKzE4LDcgQEAKIGltcG9ydCBvcmcu
ZWNsaXBzZS5jb3JlLnJ1bnRpbWUuSVN0YXR1czsKIGltcG9ydCBvcmcuZWNsaXBzZS5jb3JlLnJ1
bnRpbWUuTXVsdGlTdGF0dXM7CiBpbXBvcnQgb3JnLmVjbGlwc2UuY29yZS5ydW50aW1lLk9wZXJh
dGlvbkNhbmNlbGVkRXhjZXB0aW9uOworaW1wb3J0IG9yZy5lY2xpcHNlLmNvcmUucnVudGltZS5Q
cmVmZXJlbmNlczsKIGltcG9ydCBvcmcuZWNsaXBzZS5jb3JlLnJ1bnRpbWUuU3RhdHVzOwogaW1w
b3J0IG9yZy5lY2xpcHNlLmNvcmUucnVudGltZS5qb2JzLkpvYjsKIGltcG9ydCBvcmcuZWNsaXBz
ZS51cGRhdGUuY29yZS5JRmVhdHVyZTsKQEAgLTMxMCwyNSArMzExLDUwIEBACiAJCQkJCXJldHVy
biBtaXJyb3JVUkxzW21pcnJvckluZGV4XTsKIAkJCQl9IGVsc2UgewogCQkJCQkvLyBoZXJlIHdl
IG5lZWQgdG8gcHJvbXB0IHRoZSB1c2VyCi0JCQkJCWZpbmFsIElVUkxFbnRyeVtdIHJldHVyblZh
bHVlID0gbmV3IElVUkxFbnRyeVsxXTsKLQkJCQkJZmluYWwgYm9vbGVhbiBbXSBjYW5jZWxlZCA9
IG5ldyBib29sZWFuWzFdOwotCQkJCQlVcGRhdGVVSS5nZXRTdGFuZGFyZERpc3BsYXkoKS5zeW5j
RXhlYyhuZXcgUnVubmFibGUoKSB7Ci0JCQkJCQlwdWJsaWMgdm9pZCBydW4oKSB7Ci0JCQkJCQkJ
TWlycm9yc0RpYWxvZyBkaWFsb2cgPSBuZXcgTWlycm9yc0RpYWxvZyhVcGRhdGVVSQotCQkJCQkJ
CQkJLmdldEFjdGl2ZVdvcmtiZW5jaFNoZWxsKCksIHNpdGUsIHNpdGVOYW1lKTsKLQkJCQkJCQlk
aWFsb2cuY3JlYXRlKCk7Ci0JCQkJCQkJaW50IHJlc3VsdCA9IGRpYWxvZy5vcGVuKCk7Ci0JCQkJ
CQkJaWYgKHJlc3VsdD09TWlycm9yc0RpYWxvZy5DQU5DRUwpIHsKLQkJCQkJCQkJY2FuY2VsZWRb
MF0gPSB0cnVlOworCQkJCQkvLyBidXQgZmlyc3QgY2hlY2sgZm9yIHByZWZlcnJlZCBtaXJyb3Jz
CisJCQkJCWludCBpLCBqLCBzaXRlSWR4OworCQkJCQlJVVJMRW50cnkgc2VsZWN0ZWRNaXJyb3Jz
W10gPSBuZXcgSVVSTEVudHJ5WzBdOworCQkJCQlQcmVmZXJlbmNlcyBwcmVmcyA9IFVwZGF0ZUNv
cmUuZ2V0UGx1Z2luKCkuZ2V0UGx1Z2luUHJlZmVyZW5jZXMoKTsKKwkJCQkJU3RyaW5nIHNhdmVk
TWlycm9yU2l0ZXNbXSA9IHByZWZzLmdldFN0cmluZyhVcGRhdGVDb3JlLlBfU0FWRURfTUlSUk9S
Uykuc3BsaXQoVXBkYXRlQ29yZS5TQVZFRF9NSVJST1JTX1NFUEFSQVRPUik7CisJCQkJCWZvciAo
c2l0ZUlkeD0wO3NpdGVJZHg8c2F2ZWRNaXJyb3JTaXRlcy5sZW5ndGg7c2l0ZUlkeCsrKSB7CisJ
CQkJCQlpZiAoc2F2ZWRNaXJyb3JTaXRlc1tzaXRlSWR4XS5lcXVhbHMoc2l0ZU5hbWUpKSB7CisJ
CQkJCQkJU3RyaW5nIHNhdmVkVVJMc1tdID0gcHJlZnMuZ2V0U3RyaW5nKFVwZGF0ZUNvcmUuUF9T
QVZFRF9NSVJST1JTKyIuIitzaXRlSWR4KS5zcGxpdChVcGRhdGVDb3JlLlNBVkVEX01JUlJPUlNf
U0VQQVJBVE9SKTsgIC8vJE5PTi1OTFMtMSQKKwkJCQkJCQlBcnJheUxpc3QgYXIgPSBuZXcgQXJy
YXlMaXN0KHNhdmVkVVJMcy5sZW5ndGgpOworCQkJCQkJCS8vIG1haW50YWluIG9yZGVyaW5nIGFz
IHJlY2VpdmVkIGZyb20gc2VydmVyCisJCQkJCQkJZm9yIChqPTA7ajxtaXJyb3JVUkxzLmxlbmd0
aDtqKyspIHsKKwkJCQkJCQkJU3RyaW5nIHVybCA9IG1pcnJvclVSTHNbal0uZ2V0VVJMKCkudG9F
eHRlcm5hbEZvcm0oKTsKKwkJCQkJCQkJZm9yIChpPTA7aTxzYXZlZFVSTHMubGVuZ3RoO2krKykK
KwkJCQkJCQkJCWlmIChzYXZlZFVSTHNbaV0uZXF1YWxzKHVybCkpIHsKKwkJCQkJCQkJCQlhci5h
ZGQobWlycm9yVVJMc1tqXSk7IGJyZWFrOworCQkJCQkJCQkJfQogCQkJCQkJCX0KLQkJCQkJCQlJ
VVJMRW50cnkgbWlycm9yID0gZGlhbG9nLmdldE1pcnJvcigpOwotCQkJCQkJCW1pcnJvcnMucHV0
KHNpdGUsIG1pcnJvcik7Ci0JCQkJCQkJcmV0dXJuVmFsdWVbMF0gPSBtaXJyb3I7CisJCQkJCQkJ
c2VsZWN0ZWRNaXJyb3JzID0gKElVUkxFbnRyeVtdKSBhci50b0FycmF5KG5ldyBJVVJMRW50cnlb
YXIuc2l6ZSgpXSk7CisJCQkJCQkJYnJlYWs7CiAJCQkJCQl9Ci0JCQkJCX0pOwotCQkJCQlpZiAo
Y2FuY2VsZWRbMF0pCi0JCQkJCQl0aHJvdyBuZXcgT3BlcmF0aW9uQ2FuY2VsZWRFeGNlcHRpb24o
KTsKLQkJCQkJcmV0dXJuIHJldHVyblZhbHVlWzBdOworCQkJCQl9CisJCQkJCWlmIChzZWxlY3Rl
ZE1pcnJvcnMubGVuZ3RoPT0wKSB7CisJCQkJCQlmaW5hbCBJVVJMRW50cnlbXVtdIHJldHVyblZh
bHVlID0gbmV3IElVUkxFbnRyeVsxXVswXTsKKwkJCQkJCWZpbmFsIGJvb2xlYW4gW10gY2FuY2Vs
ZWQgPSBuZXcgYm9vbGVhblsxXTsKKwkJCQkJCVVwZGF0ZVVJLmdldFN0YW5kYXJkRGlzcGxheSgp
LnN5bmNFeGVjKG5ldyBSdW5uYWJsZSgpIHsKKwkJCQkJCQlwdWJsaWMgdm9pZCBydW4oKSB7CisJ
CQkJCQkJCU1pcnJvcnNEaWFsb2cgZGlhbG9nID0gbmV3IE1pcnJvcnNEaWFsb2coVXBkYXRlVUkK
KwkJCQkJCQkJCQkuZ2V0QWN0aXZlV29ya2JlbmNoU2hlbGwoKSwgc2l0ZSwgc2l0ZU5hbWUpOwor
CQkJCQkJCQlkaWFsb2cuY3JlYXRlKCk7CisJCQkJCQkJCWludCByZXN1bHQgPSBkaWFsb2cub3Bl
bigpOworCQkJCQkJCQlpZiAocmVzdWx0PT1NaXJyb3JzRGlhbG9nLkNBTkNFTCkgeworCQkJCQkJ
CQkJY2FuY2VsZWRbMF0gPSB0cnVlOworCQkJCQkJCQl9CisJCQkJCQkJCXJldHVyblZhbHVlWzBd
ID0gZGlhbG9nLmdldE1pcnJvcnMoKTsKKwkJCQkJCQl9CisJCQkJCQl9KTsKKwkJCQkJCWlmIChj
YW5jZWxlZFswXSkKKwkJCQkJCQl0aHJvdyBuZXcgT3BlcmF0aW9uQ2FuY2VsZWRFeGNlcHRpb24o
KTsKKwkJCQkJCXNlbGVjdGVkTWlycm9ycyA9IHJldHVyblZhbHVlWzBdOworCQkJCQl9CisJCQkJ
CS8vIHNob3VsZCB3ZSBwaWNrIHRoZSBmaXJzdCBvbmUgaGVyZSBvciBhdCByYW5kb20/CisJCQkJ
CUlVUkxFbnRyeSBtaXJyb3IgPSBzZWxlY3RlZE1pcnJvcnNbKGludCkoTWF0aC5yYW5kb20oKSpz
ZWxlY3RlZE1pcnJvcnMubGVuZ3RoKV07CisJCQkJCW1pcnJvcnMucHV0KHNpdGUsIG1pcnJvcik7
CisJCQkJCXJldHVybiBtaXJyb3I7CiAJCQkJfQogCQkJfSBjYXRjaCAoQ29yZUV4Y2VwdGlvbiBl
KSB7CiAJCQkJcmV0dXJuIG51bGw7Cg==
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>87077</attachid>
            <date>2008-01-16 13:47:00 -0500</date>
            <delta_ts>2008-01-16 13:47:12 -0500</delta_ts>
            <desc>mirror patch v.2</desc>
            <filename>mirrors.patch</filename>
            <type>text/plain</type>
            <size>18027</size>
            <attacher name="Rustam Abdullaev">rustamabd</attacher>
            
              <data encoding="base64">ZGlmZiAtdXIgb3JnLmVjbGlwc2UudXBkYXRlLmNvcmVfMy4yLjEwMS5SMzN4X3YyMDA3MDkxMS9z
cmMvb3JnL2VjbGlwc2UvdXBkYXRlL2ludGVybmFsL2NvcmUvVXBkYXRlQ29yZS5qYXZhIG9yZy5l
Y2xpcHNlLnVwZGF0ZS5jb3JlL3NyYy9vcmcvZWNsaXBzZS91cGRhdGUvaW50ZXJuYWwvY29yZS9V
cGRhdGVDb3JlLmphdmEKLS0tIG9yZy5lY2xpcHNlLnVwZGF0ZS5jb3JlXzMuMi4xMDEuUjMzeF92
MjAwNzA5MTEvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRlcm5hbC9jb3JlL1VwZGF0ZUNvcmUu
amF2YQkyMDA3LTA2LTA2IDE2OjQyOjMwLjAwMDAwMDAwMCArMDIwMAorKysgb3JnLmVjbGlwc2Uu
dXBkYXRlLmNvcmUvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRlcm5hbC9jb3JlL1VwZGF0ZUNv
cmUuamF2YQkyMDA4LTAxLTE2IDE2OjI4OjU4LjQ1MzEyNTAwMCArMDEwMApAQCAtNTIsNiArNTIs
OCBAQAogCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFBfSElTVE9SWV9TSVpFID0gUFJFRklY
ICsgIi5oaXN0b3J5U2l6ZSI7IC8vJE5PTi1OTFMtMSQKIAlwdWJsaWMgc3RhdGljIGZpbmFsIFN0
cmluZyBQX0NIRUNLX1NJR05BVFVSRSA9IFBSRUZJWCArICIuY2hlY2tTaWduYXR1cmUiOyAvLyRO
T04tTkxTLTEkCiAJcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgUF9BVVRPTUFUSUNBTExZX0NI
T09TRV9NSVJST1IgPSAgUFJFRklYICsgIi5hdXRvbWF0aWNhbGx5Q2hvb3NlTWlycm9yIjsgLy8k
Tk9OLU5MUy0xJAorCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFBfU0FWRURfTUlSUk9SUyA9
ICBQUkVGSVggKyAiLm1pcnJvcnMiOyAvLyROT04tTkxTLTEkCisJcHVibGljIHN0YXRpYyBmaW5h
bCBTdHJpbmcgU0FWRURfTUlSUk9SU19TRVBBUkFUT1IgPSAgIlxuIjsgLy8kTk9OLU5MUy0xJAog
CXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFBfVVBEQVRFX1ZFUlNJT05TID0gUFJFRklYICsg
Ii51cGRhdGVWZXJzaW9ucyI7IC8vJE5PTi1OTFMtMSQKIAlwdWJsaWMgc3RhdGljIGZpbmFsIFN0
cmluZyBFUVVJVkFMRU5UX1ZBTFVFID0gImVxdWl2YWxlbnQiOyAvLyROT04tTkxTLTEkCiAJcHVi
bGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ09NUEFUSUJMRV9WQUxVRSA9ICJjb21wYXRpYmxlIjsg
Ly8kTk9OLU5MUy0xJApkaWZmIC11ciBvcmcuZWNsaXBzZS51cGRhdGUudWlfMy4yLjEwMC52MjAw
NzA2MTUvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRlcm5hbC91aS9VcGRhdGVVSU1lc3NhZ2Vz
LmphdmEgb3JnLmVjbGlwc2UudXBkYXRlLnVpL3NyYy9vcmcvZWNsaXBzZS91cGRhdGUvaW50ZXJu
YWwvdWkvVXBkYXRlVUlNZXNzYWdlcy5qYXZhCi0tLSBvcmcuZWNsaXBzZS51cGRhdGUudWlfMy4y
LjEwMC52MjAwNzA2MTUvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRlcm5hbC91aS9VcGRhdGVV
SU1lc3NhZ2VzLmphdmEJMjAwNy0wNi0wNiAxNjo0Mjo0MC4wMDAwMDAwMDAgKzAyMDAKKysrIG9y
Zy5lY2xpcHNlLnVwZGF0ZS51aS9zcmMvb3JnL2VjbGlwc2UvdXBkYXRlL2ludGVybmFsL3VpL1Vw
ZGF0ZVVJTWVzc2FnZXMuamF2YQkyMDA4LTAxLTE2IDE4OjM4OjQ1LjAxNTYyNTAwMCArMDEwMApA
QCAtMjAsNiArMjAsMTAgQEAKIAkJLy8gRG8gbm90IGluc3RhbnRpYXRlCiAJfQogCisJcHVibGlj
IHN0YXRpYyBTdHJpbmcgTWFpblByZWZlcmVuY2VQYWdlX2ZsdXNoU2F2ZWRNaXJyb3JzOworCXB1
YmxpYyBzdGF0aWMgU3RyaW5nIE1pcnJvcnNEaWFsb2dfZXJyb3JNdXN0Q2hvb3NlOworCXB1Ymxp
YyBzdGF0aWMgU3RyaW5nIE1pcnJvcnNEaWFsb2dfZXJyb3JNdXN0Q2hvb3NlSGVhZGVyOworCXB1
YmxpYyBzdGF0aWMgU3RyaW5nIE1pcnJvcnNEaWFsb2dfcmVtZW1iZXI7CiAJcHVibGljIHN0YXRp
YyBTdHJpbmcgUmVzdGFydFRpdGxlOwogCXB1YmxpYyBzdGF0aWMgU3RyaW5nIFJlc3RhcnRNZXNz
YWdlOwogCXB1YmxpYyBzdGF0aWMgU3RyaW5nIE9wdGlvbmFsUmVzdGFydE1lc3NhZ2U7CmRpZmYg
LXVyIG9yZy5lY2xpcHNlLnVwZGF0ZS51aV8zLjIuMTAwLnYyMDA3MDYxNS9zcmMvb3JnL2VjbGlw
c2UvdXBkYXRlL2ludGVybmFsL3VpL1VwZGF0ZVVJUGx1Z2luUmVzb3VyY2VzLnByb3BlcnRpZXMg
b3JnLmVjbGlwc2UudXBkYXRlLnVpL3NyYy9vcmcvZWNsaXBzZS91cGRhdGUvaW50ZXJuYWwvdWkv
VXBkYXRlVUlQbHVnaW5SZXNvdXJjZXMucHJvcGVydGllcwotLS0gb3JnLmVjbGlwc2UudXBkYXRl
LnVpXzMuMi4xMDAudjIwMDcwNjE1L3NyYy9vcmcvZWNsaXBzZS91cGRhdGUvaW50ZXJuYWwvdWkv
VXBkYXRlVUlQbHVnaW5SZXNvdXJjZXMucHJvcGVydGllcwkyMDA3LTA2LTI1IDE3OjE0OjA4LjAw
MDAwMDAwMCArMDIwMAorKysgb3JnLmVjbGlwc2UudXBkYXRlLnVpL3NyYy9vcmcvZWNsaXBzZS91
cGRhdGUvaW50ZXJuYWwvdWkvVXBkYXRlVUlQbHVnaW5SZXNvdXJjZXMucHJvcGVydGllcwkyMDA4
LTAxLTE2IDE4OjM4OjQ1LjAwMDAwMDAwMCArMDEwMApAQCAtNTMsNiArNTMsNyBAQAogTWFpblBy
ZWZlcmVuY2VQYWdlX2F1dG9tYXRpY2FsbHlDaG9vc2VNaXJyb3IgPSBBdXRvbWF0aWNhbGx5IHNl
bGVjdCAmbWlycm9ycwogTWFpblByZWZlcmVuY2VQYWdlX2hpc3RvcnlTaXplID0gJk1heGltdW0g
bnVtYmVyIG9mICdIaXN0b3J5JyBjb25maWd1cmF0aW9uczoKIE1haW5QcmVmZXJlbmNlUGFnZV9p
bnZhbGlkSGlzdG9yeVNpemUgPSBUaGUgbWF4aW11bSBudW1iZXIgb2YgJ0hpc3RvcnknIGNvbmZp
Z3VyYXRpb25zIG11c3QgYmUgMCBvciBtb3JlLgorTWFpblByZWZlcmVuY2VQYWdlX2ZsdXNoU2F2
ZWRNaXJyb3JzPUZsdXNoIHNhdmVkIG1pcnJvcnMKIE1haW5QcmVmZXJlbmNlUGFnZV91cGRhdGVW
ZXJzaW9ucyA9IFZhbGlkIHVwZGF0ZXMKIE1haW5QcmVmZXJlbmNlUGFnZV91cGRhdGVWZXJzaW9u
c19lcXVpdmFsZW50ID0gZSZxdWl2YWxlbnQgKDEuMC4xIC0+IDEuMC4yIC0gb25seSBzZXJ2aWNl
IGluY3JlbWVudHMpCiBNYWluUHJlZmVyZW5jZVBhZ2VfdXBkYXRlVmVyc2lvbnNfY29tcGF0aWJs
ZSA9ICZjb21wYXRpYmxlICgxLjAuOSAtPiAxLjEuMCAtIHNlcnZpY2UgYW5kIG1pbm9yIGluY3Jl
bWVudHMpCkBAIC00NTcsOCArNDU4LDExIEBACiBTd2FwRmVhdHVyZVdpemFyZFBhZ2VfZGVzYz1E
aXNhYmxlIHRoZSBjdXJyZW50IHZlcnNpb24gb2YgdGhlIGZlYXR1cmUgYW5kIHJlcGxhY2UgaXQg
d2l0aCBvbmUgb2YgdGhlIHZlcnNpb25zIGZyb20gdGhlIGxpc3QKIFN3YXBGZWF0dXJlV2l6YXJk
UGFnZV9sYWJlbD0mQXZhaWxhYmxlIGRpc2FibGVkIHZlcnNpb25zOgogCi1NaXJyb3JzRGlhbG9n
X3RleHQ9VGhlIGNvbnRlbnQgb2YgdGhlIHVwZGF0ZSBzaXRlICJ7MH0iIGlzIGFsc28gYXZhaWxh
YmxlIG9uIHRoZSBtaXJyb3JzIGxpc3RlZCBiZWxvdy4gWW91IG1heSBjaG9vc2UgdG8gc2VsZWN0
IGEgbWlycm9yIGluc3RlYWQgb2YgdGhlIGRlZmF1bHQgdXBkYXRlIHNpdGUuCitNaXJyb3JzRGlh
bG9nX3RleHQ9VGhlIGNvbnRlbnQgb2YgdGhlIHVwZGF0ZSBzaXRlICJ7MH0iIGlzIGFsc28gYXZh
aWxhYmxlIG9uIHRoZSBtaXJyb3JzIGxpc3RlZCBiZWxvdy4gWW91IG1heSBjaG9vc2UgdG8gc2Vs
ZWN0IGEgbWlycm9yIGluc3RlYWQgb2YgdGhlIGRlZmF1bHQgdXBkYXRlIHNpdGUuIFlvdSBjYW4g
YWxzbyBzZWxlY3QgbW9yZSB0aGFuIG9uZSBzaXRlLgogTWlycm9yc0RpYWxvZ190aXRsZT1VcGRh
dGUgU2l0ZSBNaXJyb3JzCitNaXJyb3JzRGlhbG9nX3JlbWVtYmVyPUFsd2F5cyB1c2UgdGhpcyBz
ZWxlY3Rpb24gZm9yIHswfQorTWlycm9yc0RpYWxvZ19lcnJvck11c3RDaG9vc2U9UGxlYXNlIHBp
Y2sgYXQgbGVhc3Qgb25lIG1pcnJvcgorTWlycm9yc0RpYWxvZ19lcnJvck11c3RDaG9vc2VIZWFk
ZXI9RXJyb3IKIAogQXV0b21hdGljVXBkYXRlc0pvYl9VcGRhdGVzPVVwZGF0ZXMKIEF1dG9tYXRp
Y1VwZGF0ZXNKb2JfRWNsaXBzZVVwZGF0ZXMxPUF1dG9tYXRpYyBVcGRhdGVzCmRpZmYgLXVyIG9y
Zy5lY2xpcHNlLnVwZGF0ZS51aV8zLjIuMTAwLnYyMDA3MDYxNS9zcmMvb3JnL2VjbGlwc2UvdXBk
YXRlL2ludGVybmFsL3VpL3ByZWZlcmVuY2VzL01haW5QcmVmZXJlbmNlUGFnZS5qYXZhIG9yZy5l
Y2xpcHNlLnVwZGF0ZS51aS9zcmMvb3JnL2VjbGlwc2UvdXBkYXRlL2ludGVybmFsL3VpL3ByZWZl
cmVuY2VzL01haW5QcmVmZXJlbmNlUGFnZS5qYXZhCi0tLSBvcmcuZWNsaXBzZS51cGRhdGUudWlf
My4yLjEwMC52MjAwNzA2MTUvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRlcm5hbC91aS9wcmVm
ZXJlbmNlcy9NYWluUHJlZmVyZW5jZVBhZ2UuamF2YQkyMDA3LTA2LTA2IDE2OjQyOjQwLjAwMDAw
MDAwMCArMDIwMAorKysgb3JnLmVjbGlwc2UudXBkYXRlLnVpL3NyYy9vcmcvZWNsaXBzZS91cGRh
dGUvaW50ZXJuYWwvdWkvcHJlZmVyZW5jZXMvTWFpblByZWZlcmVuY2VQYWdlLmphdmEJMjAwOC0w
MS0xNiAxODozODo0NC45Mzc1MDAwMDAgKzAxMDAKQEAgLTEwLDE4ICsxMCwzMiBAQAogICoqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKiovCiBwYWNrYWdlIG9yZy5lY2xpcHNlLnVwZGF0ZS5pbnRlcm5hbC51
aS5wcmVmZXJlbmNlczsKIAotaW1wb3J0IGphdmEubmV0Lio7CitpbXBvcnQgamF2YS5uZXQuTWFs
Zm9ybWVkVVJMRXhjZXB0aW9uOworaW1wb3J0IGphdmEubmV0LlVSTDsKIAotaW1wb3J0IG9yZy5l
Y2xpcHNlLmNvcmUucnVudGltZS4qOwotaW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLmRpYWxvZ3Mu
KjsKK2ltcG9ydCBvcmcuZWNsaXBzZS5jb3JlLnJ1bnRpbWUuQ29yZUV4Y2VwdGlvbjsKK2ltcG9y
dCBvcmcuZWNsaXBzZS5jb3JlLnJ1bnRpbWUuUHJlZmVyZW5jZXM7CiBpbXBvcnQgb3JnLmVjbGlw
c2UuamZhY2UuZGlhbG9ncy5EaWFsb2c7CitpbXBvcnQgb3JnLmVjbGlwc2UuamZhY2UuZGlhbG9n
cy5NZXNzYWdlRGlhbG9nOwogaW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnByZWZlcmVuY2UuUHJl
ZmVyZW5jZVBhZ2U7CiBpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LlNXVDsKIGltcG9ydCBvcmcuZWNs
aXBzZS5zd3QuY3VzdG9tLkJ1c3lJbmRpY2F0b3I7Ci1pbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmV2
ZW50cy4qOwotaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5sYXlvdXQuKjsKLWltcG9ydCBvcmcuZWNs
aXBzZS5zd3Qud2lkZ2V0cy4qOwotaW1wb3J0IG9yZy5lY2xpcHNlLnVpLio7CitpbXBvcnQgb3Jn
LmVjbGlwc2Uuc3d0LmV2ZW50cy5Nb2RpZnlFdmVudDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3Qu
ZXZlbnRzLk1vZGlmeUxpc3RlbmVyOworaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ldmVudHMuU2Vs
ZWN0aW9uQWRhcHRlcjsKK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuZXZlbnRzLlNlbGVjdGlvbkV2
ZW50OworaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5sYXlvdXQuR3JpZERhdGE7CitpbXBvcnQgb3Jn
LmVjbGlwc2Uuc3d0LmxheW91dC5HcmlkTGF5b3V0OworaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC53
aWRnZXRzLkJ1dHRvbjsKK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3Qud2lkZ2V0cy5Db21wb3NpdGU7
CitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuQ29udHJvbDsKK2ltcG9ydCBvcmcuZWNs
aXBzZS5zd3Qud2lkZ2V0cy5Hcm91cDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3Qud2lkZ2V0cy5M
YWJlbDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3Qud2lkZ2V0cy5TaGVsbDsKK2ltcG9ydCBvcmcu
ZWNsaXBzZS5zd3Qud2lkZ2V0cy5UZXh0OworaW1wb3J0IG9yZy5lY2xpcHNlLnVpLklXb3JrYmVu
Y2g7CitpbXBvcnQgb3JnLmVjbGlwc2UudWkuSVdvcmtiZW5jaFByZWZlcmVuY2VQYWdlOworaW1w
b3J0IG9yZy5lY2xpcHNlLnVpLlBsYXRmb3JtVUk7CiBpbXBvcnQgb3JnLmVjbGlwc2UudXBkYXRl
LmNvcmUuU2l0ZU1hbmFnZXI7CiBpbXBvcnQgb3JnLmVjbGlwc2UudXBkYXRlLmludGVybmFsLmNv
cmUuVXBkYXRlQ29yZTsKIGltcG9ydCBvcmcuZWNsaXBzZS51cGRhdGUuaW50ZXJuYWwub3BlcmF0
aW9ucy5VcGRhdGVVdGlsczsKQEAgLTQwLDYgKzU0LDcgQEAKIAlwcml2YXRlIFRleHQgaGlzdG9y
eVNpemVUZXh0OwogCXByaXZhdGUgQnV0dG9uIGNoZWNrU2lnbmF0dXJlQ2hlY2tib3g7CiAJcHJp
dmF0ZSBCdXR0b24gYXV0b21hdGljYWxseUNob29zZU1pcnJvckNoZWNrYm94OworCXByaXZhdGUg
QnV0dG9uIGZsdXNoQ2hvc2VuTWlycm9yc0J1dHRvbjsKIAlwcml2YXRlIEJ1dHRvbiBlcXVpdmFs
ZW50QnV0dG9uOwogCXByaXZhdGUgQnV0dG9uIGNvbXBhdGlibGVCdXR0b247CiAJcHJpdmF0ZSBU
ZXh0IHVwZGF0ZVBvbGljeVRleHQ7CkBAIC0xMDgsNiArMTIzLDExIEBACiAKIAkJY3JlYXRlU3Bh
Y2VyKG1haW5Db21wb3NpdGUsIDIpOwogCisJCWZsdXNoQ2hvc2VuTWlycm9yc0J1dHRvbiA9IG5l
dyBCdXR0b24obWFpbkNvbXBvc2l0ZSwgU1dULlBVU0gpOworCQlmbHVzaENob3Nlbk1pcnJvcnNC
dXR0b24uc2V0VGV4dChVcGRhdGVVSU1lc3NhZ2VzLk1haW5QcmVmZXJlbmNlUGFnZV9mbHVzaFNh
dmVkTWlycm9ycyk7CisKKwkJY3JlYXRlU3BhY2VyKG1haW5Db21wb3NpdGUsIDIpOworCiAJCUdy
b3VwIGdyb3VwID0gbmV3IEdyb3VwKG1haW5Db21wb3NpdGUsIFNXVC5OT05FKTsKIAkJZ3JvdXAu
c2V0VGV4dChVcGRhdGVVSU1lc3NhZ2VzLk1haW5QcmVmZXJlbmNlUGFnZV91cGRhdGVWZXJzaW9u
cyk7IAogCQlncm91cC5zZXRMYXlvdXQobmV3IEdyaWRMYXlvdXQoKSk7CkBAIC0xNDIsNiArMTYy
LDEzIEBACiAJCS8vY3JlYXRlU3BhY2VyKG1haW5Db21wb3NpdGUsIDIpOwogCQkvL2NyZWF0ZUh0
dHBQcm94eShtYWluQ29tcG9zaXRlLCAyKTsKIAkJaW5pdGlhbGl6ZSgpOworCQlmbHVzaENob3Nl
bk1pcnJvcnNCdXR0b24uYWRkU2VsZWN0aW9uTGlzdGVuZXIobmV3IFNlbGVjdGlvbkFkYXB0ZXIo
KXsKKwkJCXB1YmxpYyB2b2lkIHdpZGdldFNlbGVjdGVkKFNlbGVjdGlvbkV2ZW50IGUpCisJCQl7
CisJCQkJcGVyZm9ybUZsdXNoQ2hvc2VuTWlycm9ycygpOworCQkJCXN1cGVyLndpZGdldFNlbGVj
dGVkKGUpOworCQkJfQorCQl9KTsKIAkJdXBkYXRlUG9saWN5VGV4dC5hZGRNb2RpZnlMaXN0ZW5l
cihuZXcgTW9kaWZ5TGlzdGVuZXIoKSB7CiAJCQlwdWJsaWMgdm9pZCBtb2RpZnlUZXh0KE1vZGlm
eUV2ZW50IGUpIHsKIAkJCQl0ZXh0Q2hhbmdlZCgpOwpAQCAtMjAxLDYgKzIyOCwxNSBAQAogCQlz
ZXRFcnJvck1lc3NhZ2UobnVsbCk7CQogCX0KIAorCXB1YmxpYyB2b2lkIHBlcmZvcm1GbHVzaENo
b3Nlbk1pcnJvcnMoKSB7CisJCWZsdXNoQ2hvc2VuTWlycm9yc0J1dHRvbi5zZXRFbmFibGVkKGZh
bHNlKTsKKwkJUHJlZmVyZW5jZXMgcHJlZnMgPSBVcGRhdGVDb3JlLmdldFBsdWdpbigpLmdldFBs
dWdpblByZWZlcmVuY2VzKCk7CisJCWludCBpLCBuID0gcHJlZnMuZ2V0U3RyaW5nKFVwZGF0ZUNv
cmUuUF9TQVZFRF9NSVJST1JTKS5zcGxpdChVcGRhdGVDb3JlLlNBVkVEX01JUlJPUlNfU0VQQVJB
VE9SKS5sZW5ndGg7CisJCWZvciAoaT0wO2k8bjtpKyspCisJCQlwcmVmcy5zZXRWYWx1ZShVcGRh
dGVDb3JlLlBfU0FWRURfTUlSUk9SUysiLiIraSwgIiIpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1O
TFMtMiQKKwkJcHJlZnMuc2V0VmFsdWUoVXBkYXRlQ29yZS5QX1NBVkVEX01JUlJPUlMsICIiKTsg
Ly8kTk9OLU5MUy0xJAorCQlVcGRhdGVDb3JlLmdldFBsdWdpbigpLnNhdmVQbHVnaW5QcmVmZXJl
bmNlcygpOworCX0KIAlwdWJsaWMgYm9vbGVhbiBwZXJmb3JtT2soKSB7CiAJCUJ1c3lJbmRpY2F0
b3Iuc2hvd1doaWxlKGdldENvbnRyb2woKS5nZXREaXNwbGF5KCksIG5ldyBSdW5uYWJsZSgpIHsK
IAkJCXB1YmxpYyB2b2lkIHJ1bigpIHsKQEAgLTI0MCw2ICsyNzYsOCBAQAogCQkJcHJlZnMuZ2V0
Qm9vbGVhbihVcGRhdGVDb3JlLlBfQ0hFQ0tfU0lHTkFUVVJFKSk7CiAJCWF1dG9tYXRpY2FsbHlD
aG9vc2VNaXJyb3JDaGVja2JveC5zZXRTZWxlY3Rpb24oCiAJCQkJcHJlZnMuZ2V0Qm9vbGVhbihV
cGRhdGVDb3JlLlBfQVVUT01BVElDQUxMWV9DSE9PU0VfTUlSUk9SKSk7CisJCWJvb2xlYW4gaGF2
ZUNob3Nlbk1pcnJvcnMgPSBwcmVmcy5nZXRTdHJpbmcoVXBkYXRlQ29yZS5QX1NBVkVEX01JUlJP
UlMpLmxlbmd0aCgpIT0wOworCQlmbHVzaENob3Nlbk1pcnJvcnNCdXR0b24uc2V0RW5hYmxlZCho
YXZlQ2hvc2VuTWlycm9ycyk7CiAKIAkJaGlzdG9yeVNpemVUZXh0LnNldFRleHQocHJlZnMuZ2V0
U3RyaW5nKFVwZGF0ZUNvcmUuUF9ISVNUT1JZX1NJWkUpKTsKIApkaWZmIC11ciBvcmcuZWNsaXBz
ZS51cGRhdGUudWlfMy4yLjEwMC52MjAwNzA2MTUvc3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRl
cm5hbC91aS93aXphcmRzL01pcnJvcnNEaWFsb2cuamF2YSBvcmcuZWNsaXBzZS51cGRhdGUudWkv
c3JjL29yZy9lY2xpcHNlL3VwZGF0ZS9pbnRlcm5hbC91aS93aXphcmRzL01pcnJvcnNEaWFsb2cu
amF2YQotLS0gb3JnLmVjbGlwc2UudXBkYXRlLnVpXzMuMi4xMDAudjIwMDcwNjE1L3NyYy9vcmcv
ZWNsaXBzZS91cGRhdGUvaW50ZXJuYWwvdWkvd2l6YXJkcy9NaXJyb3JzRGlhbG9nLmphdmEJMjAw
Ny0wNi0wNiAxNjo0Mjo0MC4wMDAwMDAwMDAgKzAyMDAKKysrIG9yZy5lY2xpcHNlLnVwZGF0ZS51
aS9zcmMvb3JnL2VjbGlwc2UvdXBkYXRlL2ludGVybmFsL3VpL3dpemFyZHMvTWlycm9yc0RpYWxv
Zy5qYXZhCTIwMDgtMDEtMTYgMTg6MDM6MzcuMjk2ODc1MDAwICswMTAwCkBAIC0xNCwxMiArMTQs
MTUgQEAKIGltcG9ydCBvcmcuZWNsaXBzZS5jb3JlLnJ1bnRpbWUuUHJlZmVyZW5jZXM7CiBpbXBv
cnQgb3JnLmVjbGlwc2UuamZhY2UuZGlhbG9ncy5EaWFsb2c7CiBpbXBvcnQgb3JnLmVjbGlwc2Uu
amZhY2UuZGlhbG9ncy5JRGlhbG9nQ29uc3RhbnRzOworaW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNl
LmRpYWxvZ3MuTWVzc2FnZURpYWxvZzsKIGltcG9ydCBvcmcuZWNsaXBzZS5vc2dpLnV0aWwuTkxT
OwogaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5TV1Q7CiBpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmV2
ZW50cy5Gb2N1c0FkYXB0ZXI7CiBpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmV2ZW50cy5Gb2N1c0V2
ZW50OworaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ldmVudHMuTW91c2VBZGFwdGVyOwogaW1wb3J0
IG9yZy5lY2xpcHNlLnN3dC5ldmVudHMuTW91c2VFdmVudDsKLWltcG9ydCBvcmcuZWNsaXBzZS5z
d3QuZXZlbnRzLk1vdXNlTGlzdGVuZXI7CitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmV2ZW50cy5T
ZWxlY3Rpb25BZGFwdGVyOworaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ldmVudHMuU2VsZWN0aW9u
RXZlbnQ7CiBpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmxheW91dC5HcmlkRGF0YTsKIGltcG9ydCBv
cmcuZWNsaXBzZS5zd3QubGF5b3V0LkdyaWRMYXlvdXQ7CiBpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0
LndpZGdldHMuQnV0dG9uOwpAQCAtMzksOCArNDIsOSBAQAogCXByaXZhdGUgU3RyaW5nIHNpdGVO
YW1lOwogCXByaXZhdGUgSVVSTEVudHJ5W10gbWlycm9yczsKIAlwcml2YXRlIExpc3QgbWlycm9y
c0xpc3Q7Ci0JcHJpdmF0ZSBJVVJMRW50cnkgbWlycm9yU2VsZWN0ZWQ7CisJcHJpdmF0ZSBJVVJM
RW50cnkgc2VsZWN0ZWRNaXJyb3JzW107CiAJcHJpdmF0ZSBCdXR0b24gYXV0b21hdGljYWxseUNo
b29zZU1pcnJvckNoZWNrYm94OworCXByaXZhdGUgQnV0dG9uIHJlbWVtYmVyTWlycm9yU2VsZWN0
aW9uQ2hlY2tib3g7CiAJLy9wcml2YXRlIEJ1dHRvbiBva0J1dHRvbjsKIAkvKioKIAkgKiBAcGFy
YW0gcGFyZW50U2hlbGwKQEAgLTk3LDcgKzEwMSw3IEBACiAJCQl9CiAJCX0pOwogCQkKLQkJbWly
cm9yc0xpc3QgPSBuZXcgTGlzdChjb21wb3NpdGUsIFNXVC5CT1JERVIgfCBTV1QuSF9TQ1JPTEwg
fCBTV1QuVl9TQ1JPTEwpOworCQltaXJyb3JzTGlzdCA9IG5ldyBMaXN0KGNvbXBvc2l0ZSwgU1dU
LkJPUkRFUiB8IFNXVC5IX1NDUk9MTCB8IFNXVC5WX1NDUk9MTCB8IFNXVC5NVUxUSSk7CiAJCWRh
dGEgPSBuZXcgR3JpZERhdGEoR3JpZERhdGEuRklMTF9CT1RIKTsKIAkJZGF0YS5ob3Jpem9udGFs
U3BhbiA9IDI7CiAJCW1pcnJvcnNMaXN0LnNldExheW91dERhdGEoZGF0YSk7CkBAIC0xMDYsNyAr
MTEwLDE0IEBACiAJCQltaXJyb3JzTGlzdC5hZGQobWlycm9yc1tpXS5nZXRBbm5vdGF0aW9uKCkp
OwogCQltaXJyb3JzTGlzdC5hZGQoc2l0ZU5hbWUpOwogCi0JCW1pcnJvcnNMaXN0LnNlbGVjdCgw
KTsKKy8vCQltaXJyb3JzTGlzdC5zZWxlY3QoMCk7CisJCQorCQlyZW1lbWJlck1pcnJvclNlbGVj
dGlvbkNoZWNrYm94ID0KKwkJCW5ldyBCdXR0b24oY29tcG9zaXRlLCBTV1QuQ0hFQ0sgfCBTV1Qu
TEVGVCk7CisJCXJlbWVtYmVyTWlycm9yU2VsZWN0aW9uQ2hlY2tib3guc2V0VGV4dChOTFMuYmlu
ZChVcGRhdGVVSU1lc3NhZ2VzLk1pcnJvcnNEaWFsb2dfcmVtZW1iZXIsc2l0ZU5hbWUpKTsKKwkJ
ZGF0YSA9IG5ldyBHcmlkRGF0YSgpOworCQlkYXRhLmhvcml6b250YWxTcGFuID0gMjsKKwkJcmVt
ZW1iZXJNaXJyb3JTZWxlY3Rpb25DaGVja2JveC5zZXRMYXlvdXREYXRhKGRhdGEpOwkJCiAJCQog
CQlhdXRvbWF0aWNhbGx5Q2hvb3NlTWlycm9yQ2hlY2tib3ggPQogCQkJbmV3IEJ1dHRvbihjb21w
b3NpdGUsIFNXVC5DSEVDSyB8IFNXVC5MRUZUKTsKQEAgLTExNCwzOSArMTI1LDg3IEBACiAJCWRh
dGEgPSBuZXcgR3JpZERhdGEoKTsKIAkJZGF0YS5ob3Jpem9udGFsU3BhbiA9IDI7CiAJCWF1dG9t
YXRpY2FsbHlDaG9vc2VNaXJyb3JDaGVja2JveC5zZXRMYXlvdXREYXRhKGRhdGEpOwkJCi0JCQor
CiAJCURpYWxvZy5hcHBseURpYWxvZ0ZvbnQoY29tcG9zaXRlKTsKIAkJCi0JCW1pcnJvcnNMaXN0
LmFkZE1vdXNlTGlzdGVuZXIoIG5ldyBNb3VzZUxpc3RlbmVyKCkgeworCQlhdXRvbWF0aWNhbGx5
Q2hvb3NlTWlycm9yQ2hlY2tib3guYWRkU2VsZWN0aW9uTGlzdGVuZXIobmV3IFNlbGVjdGlvbkFk
YXB0ZXIoKSB7CisJCQlwcml2YXRlIGJvb2xlYW4gc2F2ZWRSZW1lbWJlck1pcnJvclNlbGVjdGlv
bjsKKwkJCXByaXZhdGUgaW50W10gc2F2ZWRNaXJyb3JzU2VsZWN0aW9uOworCQkJcHVibGljIHZv
aWQgd2lkZ2V0U2VsZWN0ZWQoU2VsZWN0aW9uRXZlbnQgZSkKKwkJCXsKKwkJCQlzdXBlci53aWRn
ZXRTZWxlY3RlZChlKTsKKwkJCQlpZiAoYXV0b21hdGljYWxseUNob29zZU1pcnJvckNoZWNrYm94
LmdldFNlbGVjdGlvbigpKSB7CisJCQkJCW1pcnJvcnNMaXN0LnNldEVuYWJsZWQoZmFsc2UpOwor
CQkJCQlyZW1lbWJlck1pcnJvclNlbGVjdGlvbkNoZWNrYm94LnNldEVuYWJsZWQoZmFsc2UpOwor
CQkJCQlzYXZlZFJlbWVtYmVyTWlycm9yU2VsZWN0aW9uID0gcmVtZW1iZXJNaXJyb3JTZWxlY3Rp
b25DaGVja2JveC5nZXRTZWxlY3Rpb24oKTsKKwkJCQkJc2F2ZWRNaXJyb3JzU2VsZWN0aW9uID0g
bWlycm9yc0xpc3QuZ2V0U2VsZWN0aW9uSW5kaWNlcygpOworCQkJCQltaXJyb3JzTGlzdC5zZXRT
ZWxlY3Rpb24oMSwgMCk7CisJCQkJCXJlbWVtYmVyTWlycm9yU2VsZWN0aW9uQ2hlY2tib3guc2V0
U2VsZWN0aW9uKGZhbHNlKTsKKwkJCQl9IGVsc2UgeworCQkJCQltaXJyb3JzTGlzdC5zZXRTZWxl
Y3Rpb24oc2F2ZWRNaXJyb3JzU2VsZWN0aW9uKTsKKwkJCQkJcmVtZW1iZXJNaXJyb3JTZWxlY3Rp
b25DaGVja2JveC5zZXRTZWxlY3Rpb24oc2F2ZWRSZW1lbWJlck1pcnJvclNlbGVjdGlvbik7CisJ
CQkJCW1pcnJvcnNMaXN0LnNldEVuYWJsZWQodHJ1ZSk7CisJCQkJCXJlbWVtYmVyTWlycm9yU2Vs
ZWN0aW9uQ2hlY2tib3guc2V0RW5hYmxlZCh0cnVlKTsKKwkJCQl9CisJCQl9CisJCX0pOworCQlt
aXJyb3JzTGlzdC5hZGRNb3VzZUxpc3RlbmVyKCBuZXcgTW91c2VBZGFwdGVyKCkgewogCQkJCXB1
YmxpYyB2b2lkIG1vdXNlRG91YmxlQ2xpY2soTW91c2VFdmVudCBlKSB7CiAJCQkJCW9rUHJlc3Nl
ZCgpOwkJCQogCQkJCX0JCi0JCQkJcHVibGljIHZvaWQgbW91c2VEb3duKE1vdXNlRXZlbnQgZSkg
ewotCQkJCQkvLyBkbyBub3RoaW5nCQkJCi0JCQkJfQotCQkJCXB1YmxpYyB2b2lkIG1vdXNlVXAo
TW91c2VFdmVudCBlKSB7Ci0JCQkJCS8vCWRvIG5vdGhpbmcJCQkJCi0JCQkJfQkJCQogCQkJfQog
CQkpOwogCQlyZXR1cm4gY29tcG9zaXRlOwogCX0KIAkJCiAJcHJvdGVjdGVkIHZvaWQgb2tQcmVz
c2VkKCkgewotCQlpbnQgaSA9IG1pcnJvcnNMaXN0LmdldFNlbGVjdGlvbkluZGV4KCk7CisJCWlu
dCBpLCBtaXJyb3JJRHNbXSA9IG1pcnJvcnNMaXN0LmdldFNlbGVjdGlvbkluZGljZXMoKTsKIAkJ
Ly8gZmlyc3QgZW50cnkgaXMgdGhlIHNpdGUgaXRzZWxmCi0JCWlmIChpIDxtaXJyb3JzLmxlbmd0
aCkKLQkJCW1pcnJvclNlbGVjdGVkID0gbWlycm9yc1tpXTsKKwkJc2VsZWN0ZWRNaXJyb3JzID0g
bmV3IElVUkxFbnRyeVttaXJyb3JJRHMubGVuZ3RoXTsKKwkJZm9yIChpPTA7aTxtaXJyb3JJRHMu
bGVuZ3RoO2krKykKKwkJCXNlbGVjdGVkTWlycm9yc1tpXSA9IG1pcnJvcnNbbWlycm9ySURzWzBd
XTsKIAkJaWYgKGF1dG9tYXRpY2FsbHlDaG9vc2VNaXJyb3JDaGVja2JveC5nZXRTZWxlY3Rpb24o
KSkgewogCQkJUHJlZmVyZW5jZXMgcHJlZnMgPSBVcGRhdGVDb3JlLmdldFBsdWdpbigpLmdldFBs
dWdpblByZWZlcmVuY2VzKCk7CiAJCQlwcmVmcy5zZXRWYWx1ZShVcGRhdGVDb3JlLlBfQVVUT01B
VElDQUxMWV9DSE9PU0VfTUlSUk9SLCB0cnVlKTsKIAkJCVVwZGF0ZUNvcmUuZ2V0UGx1Z2luKCku
c2F2ZVBsdWdpblByZWZlcmVuY2VzKCk7CiAJCX0KKwkJaWYgKHNlbGVjdGVkTWlycm9ycy5sZW5n
dGg9PTApIHsKKwkJCU1lc3NhZ2VEaWFsb2cub3BlbkVycm9yKGdldFNoZWxsKCksCisJCQkJCVVw
ZGF0ZVVJTWVzc2FnZXMuTWlycm9yc0RpYWxvZ19lcnJvck11c3RDaG9vc2VIZWFkZXIsCisJCQkJ
CVVwZGF0ZVVJTWVzc2FnZXMuTWlycm9yc0RpYWxvZ19lcnJvck11c3RDaG9vc2UpOworCQkJcmV0
dXJuOworCQl9CisJCWlmIChyZW1lbWJlck1pcnJvclNlbGVjdGlvbkNoZWNrYm94LmdldFNlbGVj
dGlvbigpKSB7CisJCQlQcmVmZXJlbmNlcyBwcmVmcyA9IFVwZGF0ZUNvcmUuZ2V0UGx1Z2luKCku
Z2V0UGx1Z2luUHJlZmVyZW5jZXMoKTsKKwkJCVN0cmluZyBzYXZlZE1pcnJvclNpdGVzW10gPSBw
cmVmcy5nZXRTdHJpbmcoVXBkYXRlQ29yZS5QX1NBVkVEX01JUlJPUlMpLnNwbGl0KFVwZGF0ZUNv
cmUuU0FWRURfTUlSUk9SU19TRVBBUkFUT1IpOworCQkJaW50IHNpdGVJZHggPSAwOworCQkJd2hp
bGUgKHNpdGVJZHg8c2F2ZWRNaXJyb3JTaXRlcy5sZW5ndGggJiYgIXNhdmVkTWlycm9yU2l0ZXNb
c2l0ZUlkeF0uZXF1YWxzKHNpdGVOYW1lKSkKKwkJCQlzaXRlSWR4Kys7CisJCQlpZiAoc2l0ZUlk
eD49c2F2ZWRNaXJyb3JTaXRlcy5sZW5ndGgpIHsKKwkJCQlTdHJpbmcgdG1wW10gPSBuZXcgU3Ry
aW5nW3NpdGVJZHgrMV07CisJCQkJZm9yIChpPTA7aTxzYXZlZE1pcnJvclNpdGVzLmxlbmd0aDtp
KyspIHRtcFtpXT1zYXZlZE1pcnJvclNpdGVzW2ldOworCQkJCXNhdmVkTWlycm9yU2l0ZXMgPSB0
bXA7CisJCQl9CisJCQlzYXZlZE1pcnJvclNpdGVzW3NpdGVJZHhdID0gc2l0ZU5hbWU7CisJCQlT
dHJpbmdCdWZmZXIgbWlycm9yVVJMcyA9IG5ldyBTdHJpbmdCdWZmZXIoMTAyNCk7CisJCQlmb3Ig
KGk9MDtpPG1pcnJvcklEcy5sZW5ndGg7aSsrKSB7CisJCQkJaWYgKGkhPTApIG1pcnJvclVSTHMu
YXBwZW5kKFVwZGF0ZUNvcmUuU0FWRURfTUlSUk9SU19TRVBBUkFUT1IpOworCQkJCW1pcnJvclVS
THMuYXBwZW5kKG1pcnJvcnNbbWlycm9ySURzW2ldXS5nZXRVUkwoKS50b0V4dGVybmFsRm9ybSgp
KTsKKwkJCX0KKwkJCXByZWZzLnNldFZhbHVlKFVwZGF0ZUNvcmUuUF9TQVZFRF9NSVJST1JTKyIu
IitzaXRlSWR4LCBtaXJyb3JVUkxzLnRvU3RyaW5nKCkpOyAvLyROT04tTkxTLTEkCisJCQlTdHJp
bmdCdWZmZXIgc2F2ZWRNaXJyb3JzID0gbmV3IFN0cmluZ0J1ZmZlcigxMDI0KTsKKwkJCWZvciAo
aT0wO2k8c2F2ZWRNaXJyb3JTaXRlcy5sZW5ndGg7aSsrKSB7CisJCQkJaWYgKGkhPTApIHNhdmVk
TWlycm9ycy5hcHBlbmQoVXBkYXRlQ29yZS5TQVZFRF9NSVJST1JTX1NFUEFSQVRPUik7CisJCQkJ
c2F2ZWRNaXJyb3JzLmFwcGVuZChzYXZlZE1pcnJvclNpdGVzW2ldKTsKKwkJCX0KKwkJCXByZWZz
LnNldFZhbHVlKFVwZGF0ZUNvcmUuUF9TQVZFRF9NSVJST1JTLCBzYXZlZE1pcnJvcnMudG9TdHJp
bmcoKSk7CisJCQlVcGRhdGVDb3JlLmdldFBsdWdpbigpLnNhdmVQbHVnaW5QcmVmZXJlbmNlcygp
OworCQl9CiAJCXN1cGVyLm9rUHJlc3NlZCgpOwogCX0KIAkKLQlwdWJsaWMgSVVSTEVudHJ5IGdl
dE1pcnJvcigpIHsKLQkJcmV0dXJuIG1pcnJvclNlbGVjdGVkOworCXB1YmxpYyBJVVJMRW50cnlb
XSBnZXRNaXJyb3JzKCkgeworCQlyZXR1cm4gc2VsZWN0ZWRNaXJyb3JzOwogCX0KIAogICAgcHJv
dGVjdGVkIHZvaWQgY29uZmlndXJlU2hlbGwoU2hlbGwgc2hlbGwpIHsKZGlmZiAtdXIgb3JnLmVj
bGlwc2UudXBkYXRlLnVpXzMuMi4xMDAudjIwMDcwNjE1L3NyYy9vcmcvZWNsaXBzZS91cGRhdGUv
dWkvVXBkYXRlSm9iLmphdmEgb3JnLmVjbGlwc2UudXBkYXRlLnVpL3NyYy9vcmcvZWNsaXBzZS91
cGRhdGUvdWkvVXBkYXRlSm9iLmphdmEKLS0tIG9yZy5lY2xpcHNlLnVwZGF0ZS51aV8zLjIuMTAw
LnYyMDA3MDYxNS9zcmMvb3JnL2VjbGlwc2UvdXBkYXRlL3VpL1VwZGF0ZUpvYi5qYXZhCTIwMDct
MDYtMDYgMTY6NDI6NDAuMDAwMDAwMDAwICswMjAwCisrKyBvcmcuZWNsaXBzZS51cGRhdGUudWkv
c3JjL29yZy9lY2xpcHNlL3VwZGF0ZS91aS9VcGRhdGVKb2IuamF2YQkyMDA4LTAxLTE2IDE4OjA1
OjEzLjIwMzEyNTAwMCArMDEwMApAQCAtMTgsNiArMTgsNyBAQAogaW1wb3J0IG9yZy5lY2xpcHNl
LmNvcmUucnVudGltZS5JU3RhdHVzOwogaW1wb3J0IG9yZy5lY2xpcHNlLmNvcmUucnVudGltZS5N
dWx0aVN0YXR1czsKIGltcG9ydCBvcmcuZWNsaXBzZS5jb3JlLnJ1bnRpbWUuT3BlcmF0aW9uQ2Fu
Y2VsZWRFeGNlcHRpb247CitpbXBvcnQgb3JnLmVjbGlwc2UuY29yZS5ydW50aW1lLlByZWZlcmVu
Y2VzOwogaW1wb3J0IG9yZy5lY2xpcHNlLmNvcmUucnVudGltZS5TdGF0dXM7CiBpbXBvcnQgb3Jn
LmVjbGlwc2UuY29yZS5ydW50aW1lLmpvYnMuSm9iOwogaW1wb3J0IG9yZy5lY2xpcHNlLnVwZGF0
ZS5jb3JlLklGZWF0dXJlOwpAQCAtMzEwLDI1ICszMTEsNTAgQEAKIAkJCQkJcmV0dXJuIG1pcnJv
clVSTHNbbWlycm9ySW5kZXhdOwogCQkJCX0gZWxzZSB7CiAJCQkJCS8vIGhlcmUgd2UgbmVlZCB0
byBwcm9tcHQgdGhlIHVzZXIKLQkJCQkJZmluYWwgSVVSTEVudHJ5W10gcmV0dXJuVmFsdWUgPSBu
ZXcgSVVSTEVudHJ5WzFdOwotCQkJCQlmaW5hbCBib29sZWFuIFtdIGNhbmNlbGVkID0gbmV3IGJv
b2xlYW5bMV07Ci0JCQkJCVVwZGF0ZVVJLmdldFN0YW5kYXJkRGlzcGxheSgpLnN5bmNFeGVjKG5l
dyBSdW5uYWJsZSgpIHsKLQkJCQkJCXB1YmxpYyB2b2lkIHJ1bigpIHsKLQkJCQkJCQlNaXJyb3Jz
RGlhbG9nIGRpYWxvZyA9IG5ldyBNaXJyb3JzRGlhbG9nKFVwZGF0ZVVJCi0JCQkJCQkJCQkuZ2V0
QWN0aXZlV29ya2JlbmNoU2hlbGwoKSwgc2l0ZSwgc2l0ZU5hbWUpOwotCQkJCQkJCWRpYWxvZy5j
cmVhdGUoKTsKLQkJCQkJCQlpbnQgcmVzdWx0ID0gZGlhbG9nLm9wZW4oKTsKLQkJCQkJCQlpZiAo
cmVzdWx0PT1NaXJyb3JzRGlhbG9nLkNBTkNFTCkgewotCQkJCQkJCQljYW5jZWxlZFswXSA9IHRy
dWU7CisJCQkJCS8vIGJ1dCBmaXJzdCBjaGVjayBmb3IgcHJlZmVycmVkIG1pcnJvcnMKKwkJCQkJ
aW50IGksIGosIHNpdGVJZHg7CisJCQkJCUlVUkxFbnRyeSBzZWxlY3RlZE1pcnJvcnNbXSA9IG5l
dyBJVVJMRW50cnlbMF07CisJCQkJCVByZWZlcmVuY2VzIHByZWZzID0gVXBkYXRlQ29yZS5nZXRQ
bHVnaW4oKS5nZXRQbHVnaW5QcmVmZXJlbmNlcygpOworCQkJCQlTdHJpbmcgc2F2ZWRNaXJyb3JT
aXRlc1tdID0gcHJlZnMuZ2V0U3RyaW5nKFVwZGF0ZUNvcmUuUF9TQVZFRF9NSVJST1JTKS5zcGxp
dChVcGRhdGVDb3JlLlNBVkVEX01JUlJPUlNfU0VQQVJBVE9SKTsKKwkJCQkJZm9yIChzaXRlSWR4
PTA7c2l0ZUlkeDxzYXZlZE1pcnJvclNpdGVzLmxlbmd0aDtzaXRlSWR4KyspIHsKKwkJCQkJCWlm
IChzYXZlZE1pcnJvclNpdGVzW3NpdGVJZHhdLmVxdWFscyhzaXRlTmFtZSkpIHsKKwkJCQkJCQlT
dHJpbmcgc2F2ZWRVUkxzW10gPSBwcmVmcy5nZXRTdHJpbmcoVXBkYXRlQ29yZS5QX1NBVkVEX01J
UlJPUlMrIi4iK3NpdGVJZHgpLnNwbGl0KFVwZGF0ZUNvcmUuU0FWRURfTUlSUk9SU19TRVBBUkFU
T1IpOyAgLy8kTk9OLU5MUy0xJAorCQkJCQkJCUFycmF5TGlzdCBhciA9IG5ldyBBcnJheUxpc3Qo
c2F2ZWRVUkxzLmxlbmd0aCk7CisJCQkJCQkJLy8gbWFpbnRhaW4gb3JkZXJpbmcgYXMgcmVjZWl2
ZWQgZnJvbSBzZXJ2ZXIKKwkJCQkJCQlmb3IgKGo9MDtqPG1pcnJvclVSTHMubGVuZ3RoO2orKykg
eworCQkJCQkJCQlTdHJpbmcgdXJsID0gbWlycm9yVVJMc1tqXS5nZXRVUkwoKS50b0V4dGVybmFs
Rm9ybSgpOworCQkJCQkJCQlmb3IgKGk9MDtpPHNhdmVkVVJMcy5sZW5ndGg7aSsrKQorCQkJCQkJ
CQkJaWYgKHNhdmVkVVJMc1tpXS5lcXVhbHModXJsKSkgeworCQkJCQkJCQkJCWFyLmFkZChtaXJy
b3JVUkxzW2pdKTsgYnJlYWs7CisJCQkJCQkJCQl9CiAJCQkJCQkJfQotCQkJCQkJCUlVUkxFbnRy
eSBtaXJyb3IgPSBkaWFsb2cuZ2V0TWlycm9yKCk7Ci0JCQkJCQkJbWlycm9ycy5wdXQoc2l0ZSwg
bWlycm9yKTsKLQkJCQkJCQlyZXR1cm5WYWx1ZVswXSA9IG1pcnJvcjsKKwkJCQkJCQlzZWxlY3Rl
ZE1pcnJvcnMgPSAoSVVSTEVudHJ5W10pIGFyLnRvQXJyYXkobmV3IElVUkxFbnRyeVthci5zaXpl
KCldKTsKKwkJCQkJCQlicmVhazsKIAkJCQkJCX0KLQkJCQkJfSk7Ci0JCQkJCWlmIChjYW5jZWxl
ZFswXSkKLQkJCQkJCXRocm93IG5ldyBPcGVyYXRpb25DYW5jZWxlZEV4Y2VwdGlvbigpOwotCQkJ
CQlyZXR1cm4gcmV0dXJuVmFsdWVbMF07CisJCQkJCX0KKwkJCQkJaWYgKHNlbGVjdGVkTWlycm9y
cy5sZW5ndGg9PTApIHsKKwkJCQkJCWZpbmFsIElVUkxFbnRyeVtdW10gcmV0dXJuVmFsdWUgPSBu
ZXcgSVVSTEVudHJ5WzFdWzBdOworCQkJCQkJZmluYWwgYm9vbGVhbiBbXSBjYW5jZWxlZCA9IG5l
dyBib29sZWFuWzFdOworCQkJCQkJVXBkYXRlVUkuZ2V0U3RhbmRhcmREaXNwbGF5KCkuc3luY0V4
ZWMobmV3IFJ1bm5hYmxlKCkgeworCQkJCQkJCXB1YmxpYyB2b2lkIHJ1bigpIHsKKwkJCQkJCQkJ
TWlycm9yc0RpYWxvZyBkaWFsb2cgPSBuZXcgTWlycm9yc0RpYWxvZyhVcGRhdGVVSQorCQkJCQkJ
CQkJCS5nZXRBY3RpdmVXb3JrYmVuY2hTaGVsbCgpLCBzaXRlLCBzaXRlTmFtZSk7CisJCQkJCQkJ
CWRpYWxvZy5jcmVhdGUoKTsKKwkJCQkJCQkJaW50IHJlc3VsdCA9IGRpYWxvZy5vcGVuKCk7CisJ
CQkJCQkJCWlmIChyZXN1bHQ9PU1pcnJvcnNEaWFsb2cuQ0FOQ0VMKSB7CisJCQkJCQkJCQljYW5j
ZWxlZFswXSA9IHRydWU7CisJCQkJCQkJCX0KKwkJCQkJCQkJcmV0dXJuVmFsdWVbMF0gPSBkaWFs
b2cuZ2V0TWlycm9ycygpOworCQkJCQkJCX0KKwkJCQkJCX0pOworCQkJCQkJaWYgKGNhbmNlbGVk
WzBdKQorCQkJCQkJCXRocm93IG5ldyBPcGVyYXRpb25DYW5jZWxlZEV4Y2VwdGlvbigpOworCQkJ
CQkJc2VsZWN0ZWRNaXJyb3JzID0gcmV0dXJuVmFsdWVbMF07CisJCQkJCX0KKwkJCQkJLy8gc2hv
dWxkIHdlIHBpY2sgdGhlIGZpcnN0IG9uZSBoZXJlIG9yIGF0IHJhbmRvbT8KKwkJCQkJSVVSTEVu
dHJ5IG1pcnJvciA9IHNlbGVjdGVkTWlycm9yc1soaW50KShNYXRoLnJhbmRvbSgpKnNlbGVjdGVk
TWlycm9ycy5sZW5ndGgpXTsKKwkJCQkJbWlycm9ycy5wdXQoc2l0ZSwgbWlycm9yKTsKKwkJCQkJ
cmV0dXJuIG1pcnJvcjsKIAkJCQl9CiAJCQl9IGNhdGNoIChDb3JlRXhjZXB0aW9uIGUpIHsKIAkJ
CQlyZXR1cm4gbnVsbDsK
</data>

          </attachment>
      

    </bug>

</bugzilla>