<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.1"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>214741</bug_id>
          
          <creation_ts>2008-01-09 08:50:00 -0500</creation_ts>
          <short_desc>background for syntax coloring overrules that of &apos;current line&apos; setting</short_desc>
          <delta_ts>2010-01-22 02:54:20 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>4</classification_id>
          <classification>Tools</classification>
          <product>PDT</product>
          <component>Editor</component>
          <version>unspecified</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>NEW</bug_status>
          <resolution></resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>2.2.0RC1</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Erik">info</reporter>
          <assigned_to name="PHP UI">php.ui-inbox</assigned_to>
          <cc>vadim.p</cc>
          
          <votes>1</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1128056</commentid>
    <comment_count>0</comment_count>
    <who name="Erik">info</who>
    <bug_when>2008-01-09 08:50:50 -0500</bug_when>
    <thetext>Build ID: M20071023-1652

Steps To Reproduce:
1.set all colors to use a black background, instread of a white one.
2.set the current line background to light grey.
3.


More information:
If I use a black background in PHP Eclipse editor settings, and set syntax coloring accordingly, and set  the current line color to something light grey, the syntax on the current line is colored like the text that is NOT on the current line. That gives a &apos;ragged&apos; view of the current line: some background is black (where the text is) and some background is light grey (spaces and tabs and empty space).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1128211</commentid>
    <comment_count>1</comment_count>
    <who name="Brian Bauman">baumanbr</who>
    <bug_when>2008-01-09 11:23:21 -0500</bug_when>
    <thetext>This sounds like a problem with the PHP Editor.  If it is not and instead is a PDE editor, please reassign back to us.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1650111</commentid>
    <comment_count>2</comment_count>
    <who name="Vadim Punski">vadim.p</who>
    <bug_when>2010-01-04 03:55:35 -0500</bug_when>
    <thetext>moving to 2.2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1660375</commentid>
    <comment_count>3</comment_count>
      <attachid>156768</attachid>
    <who name="Zhongwei Zhao">zhaozhongwei</who>
    <bug_when>2010-01-21 06:01:21 -0500</bug_when>
    <thetext>Created attachment 156768
patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1661279</commentid>
    <comment_count>4</comment_count>
      <attachid>156895</attachid>
    <who name="Zhongwei Zhao">zhaozhongwei</who>
    <bug_when>2010-01-22 01:19:01 -0500</bug_when>
    <thetext>Created attachment 156895
patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1661296</commentid>
    <comment_count>5</comment_count>
      <attachid>156896</attachid>
    <who name="Zhongwei Zhao">zhaozhongwei</who>
    <bug_when>2010-01-22 02:24:59 -0500</bug_when>
    <thetext>Created attachment 156896
patch

use WeekReference,or the PHPRangeStyle maybe get too much,but it sees still not a good method......
but i have no other method to fix this bug:)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1661298</commentid>
    <comment_count>6</comment_count>
      <attachid>156897</attachid>
    <who name="Zhongwei Zhao">zhaozhongwei</who>
    <bug_when>2010-01-22 02:33:41 -0500</bug_when>
    <thetext>Created attachment 156897
patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1661307</commentid>
    <comment_count>7</comment_count>
    <who name="Zhongwei Zhao">zhaozhongwei</who>
    <bug_when>2010-01-22 02:54:20 -0500</bug_when>
    <thetext>Actually i failed to fix this bug,it stills exists in some conditions!So i give up...</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>156768</attachid>
            <date>2010-01-21 06:01:00 -0500</date>
            <delta_ts>2010-01-22 01:18:34 -0500</delta_ts>
            <desc>patch</desc>
            <filename>linebackground.txt</filename>
            <type>text/plain</type>
            <size>23446</size>
            <attacher name="Zhongwei Zhao">zhaozhongwei</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UucGhwLnVpDQpJ
bmRleDogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJl
ZEVkaXRvci5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvdG9vbHMvb3JnLmVj
bGlwc2UucGR0L3BsdWdpbnMvb3JnLmVjbGlwc2UucGhwLnVpL3NyYy9vcmcvZWNsaXBzZS9waHAv
aW50ZXJuYWwvdWkvZWRpdG9yL1BIUFN0cnVjdHVyZWRFZGl0b3IuamF2YSx2DQpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuMTMyDQpkaWZmIC11IC1yMS4xMzIgUEhQU3RydWN0dXJlZEVkaXRvci5qYXZh
DQotLS0gc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJl
ZEVkaXRvci5qYXZhCTIwIEphbiAyMDEwIDA3OjM1OjU4IC0wMDAwCTEuMTMyDQorKysgc3JjL29y
Zy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJlZEVkaXRvci5qYXZh
CTIxIEphbiAyMDEwIDEwOjU5OjU2IC0wMDAwDQpAQCAtMzMzMiw0ICszMzMyLDE0IEBADQogCQkJ
KChDb25maWd1cmFibGVDb250ZW50T3V0bGluZVBhZ2UpIGZQSFBPdXRsaW5lUGFnZSkuc2V0SW5w
dXQoZ2V0TW9kZWxFbGVtZW50KCkpOw0KIAkJfQ0KIAl9DQorCQ0KKwlAT3ZlcnJpZGUNCisJcHJv
dGVjdGVkIFNvdXJjZVZpZXdlckRlY29yYXRpb25TdXBwb3J0IGdldFNvdXJjZVZpZXdlckRlY29y
YXRpb25TdXBwb3J0KA0KKwkJCUlTb3VyY2VWaWV3ZXIgdmlld2VyKSB7DQorCQlpZiAoZlNvdXJj
ZVZpZXdlckRlY29yYXRpb25TdXBwb3J0ID09IG51bGwpIHsNCisJCQlmU291cmNlVmlld2VyRGVj
b3JhdGlvblN1cHBvcnQ9IG5ldyBQSFBTb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9ydCh2aWV3
ZXIsIGdldE92ZXJ2aWV3UnVsZXIoKSwgZ2V0QW5ub3RhdGlvbkFjY2VzcygpLCBnZXRTaGFyZWRD
b2xvcnMoKSk7DQorCQkJY29uZmlndXJlU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQoZlNv
dXJjZVZpZXdlckRlY29yYXRpb25TdXBwb3J0KTsNCisJCX0NCisJCXJldHVybiBmU291cmNlVmll
d2VyRGVjb3JhdGlvblN1cHBvcnQ7DQorCX0NCiB9DQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZp
bGUNCkluZGV4OiBzcmMvb3JnL2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGln
aHRlci9MaW5lU3R5bGVQcm92aWRlckZvclBocC5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTog
L2N2c3Jvb3QvdG9vbHMvb3JnLmVjbGlwc2UucGR0L3BsdWdpbnMvb3JnLmVjbGlwc2UucGhwLnVp
L3NyYy9vcmcvZWNsaXBzZS9waHAvaW50ZXJuYWwvdWkvZWRpdG9yL2hpZ2hsaWdodGVyL0xpbmVT
dHlsZVByb3ZpZGVyRm9yUGhwLmphdmEsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjI5DQpkaWZm
IC11IC1yMS4yOSBMaW5lU3R5bGVQcm92aWRlckZvclBocC5qYXZhDQotLS0gc3JjL29yZy9lY2xp
cHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvTGluZVN0eWxlUHJvdmlkZXJG
b3JQaHAuamF2YQkxOCBKYW4gMjAxMCAwODoyODowMCAtMDAwMAkxLjI5DQorKysgc3JjL29yZy9l
Y2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvTGluZVN0eWxlUHJvdmlk
ZXJGb3JQaHAuamF2YQkyMSBKYW4gMjAxMCAxMDo1OTo1NyAtMDAwMA0KQEAgLTM3NSw3ICszNzUs
NyBAQA0KIAkJCX0NCiAJCX0NCiAJfQ0KLQkNCisNCiAJcHJvdGVjdGVkIHZvaWQgYWRkRGVmYXVs
dFRleHRBdHRyaWJ1dGUoU3RyaW5nIGNvbG9yS2V5KSB7DQogCQlpZiAoZ2V0Q29sb3JQcmVmZXJl
bmNlcygpICE9IG51bGwpIHsNCiAJCQlTdHJpbmcgcHJlZlN0cmluZyA9IFByZWZlcmVuY2VDb25z
dGFudHMuRURJVE9SX05PUk1BTF9ERUZBVUxUX0NPTE9SOw0KQEAgLTM4Nyw3ICszODcsNyBAQA0K
IAkJCX0NCiAJCX0NCiAJfQ0KLQkNCisNCiAJLyoNCiAJICogQ3JlYXRlcyBUZXh0QXR0cmlidXRl
IGZyb20gdGhlIGdpdmVuIHN0eWxlIGRlc2NyaXB0aW9uIGFycmF5IHN0cmluZw0KIAkgKi8NCkBA
IC00MjcsNyArNDI3LDcgQEANCiAJCS8vIGluc3RlYWQgb2YgZW5kLXN0YXJ0Pw0KIAkJaWYgKGVu
ZCA+IG1heE9mZnNldCkNCiAJCQllbmQgPSBtYXhPZmZzZXQ7DQotCQlTdHlsZVJhbmdlIHJlc3Vs
dCA9IG5ldyBTdHlsZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCwgYXR0cg0KKwkJU3R5bGVSYW5n
ZSByZXN1bHQgPSBuZXcgUEhQU3R5bGVSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQsIGF0dHINCiAJ
CQkJLmdldEZvcmVncm91bmQoKSwgYXR0ci5nZXRCYWNrZ3JvdW5kKCksIGF0dHIuZ2V0U3R5bGUo
KSk7DQogCQlpZiAoKGF0dHIuZ2V0U3R5bGUoKSAmIFRleHRBdHRyaWJ1dGUuVU5ERVJMSU5FKSAh
PSAwKSB7DQogCQkJcmVzdWx0LnVuZGVybGluZSA9IHRydWU7DQpAQCAtNzE1LDcgKzcxNSw3IEBA
DQogCQkJCQkJLy8gdGhlDQogCQkJCQkJLy8gd2hpdGVzcGFjZXMNCiAJCQkJCQkvLyBhcHBseWlu
ZyBzdHlsZSB0byB0aGUgcmVnaW9uIHcvbyB0aGUgd2hpdGVzcGFjZQ0KLQkJCQkJCXN0eWxlUmFu
Z2UgPSBuZXcgU3R5bGVSYW5nZShzdHlsZVN0YXJ0LCBzdHlsZUxlbmd0aA0KKwkJCQkJCXN0eWxl
UmFuZ2UgPSBuZXcgUEhQU3R5bGVSYW5nZShzdHlsZVN0YXJ0LCBzdHlsZUxlbmd0aA0KIAkJCQkJ
CQkJLSAoZWxlbWVudC5nZXRFbmQoKSAtIGVsZW1lbnQuZ2V0VGV4dEVuZCgpKSwNCiAJCQkJCQkJ
CWF0dHIuZ2V0Rm9yZWdyb3VuZCgpLCBhdHRyLmdldEJhY2tncm91bmQoKSwNCiAJCQkJCQkJCWF0
dHIuZ2V0U3R5bGUoKSk7DQpAQCAtNzMwLDE0ICs3MzAsMTQgQEANCiAJCQkJCQlob2xkUmVzdWx0
cy5hZGQoc3R5bGVSYW5nZSk7DQogCQkJCQkJLy8gYXBwbHlpbmcgc3R5bGUgdG8gdGhlIHdoaXRl
c3BhY2UgKGltcG9ydGFudCBmb3IgdGhlDQogCQkJCQkJLy8gcmVmcmVzaCBvZiB0aGUgc3BlY2lm
aWMgcmFuZ2UNCi0JCQkJCQlzdHlsZVJhbmdlID0gbmV3IFN0eWxlUmFuZ2UocmVnaW9uU3RhcnQN
CisJCQkJCQlzdHlsZVJhbmdlID0gbmV3IFBIUFN0eWxlUmFuZ2UocmVnaW9uU3RhcnQNCiAJCQkJ
CQkJCSsgZWxlbWVudC5nZXRUZXh0RW5kKCksIGVsZW1lbnQuZ2V0RW5kKCkNCiAJCQkJCQkJCS0g
ZWxlbWVudC5nZXRUZXh0RW5kKCksIGF0dHIuZ2V0Rm9yZWdyb3VuZCgpLA0KLQkJCQkJCQkJbnVs
bCwgYXR0ci5nZXRTdHlsZSgpKTsNCisJCQkJCQkJCWF0dHIuZ2V0QmFja2dyb3VuZCgpLCBhdHRy
LmdldFN0eWxlKCkpOw0KIAkJCQkJCWhvbGRSZXN1bHRzLmFkZChzdHlsZVJhbmdlKTsNCiAJCQkJ
CQlwcmV2aW91c0F0dHIgPSBudWxsOw0KIAkJCQkJfSBlbHNlIHsNCi0JCQkJCQlzdHlsZVJhbmdl
ID0gbmV3IFN0eWxlUmFuZ2Uoc3R5bGVTdGFydCwgc3R5bGVMZW5ndGgsDQorCQkJCQkJc3R5bGVS
YW5nZSA9IG5ldyBQSFBTdHlsZVJhbmdlKHN0eWxlU3RhcnQsIHN0eWxlTGVuZ3RoLA0KIAkJCQkJ
CQkJYXR0ci5nZXRGb3JlZ3JvdW5kKCksIGF0dHIuZ2V0QmFja2dyb3VuZCgpLA0KIAkJCQkJCQkJ
YXR0ci5nZXRTdHlsZSgpKTsNCiAJCQkJCQlpZiAoKGF0dHIuZ2V0U3R5bGUoKSAmIFRleHRBdHRy
aWJ1dGUuVU5ERVJMSU5FKSAhPSAwKSB7DQpAQCAtODM5LDI5ICs4MzksNDggQEANCiAJCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0hFUkVET0NfQ09MT1IuZXF1YWxzKHByZWZLZXkp
DQogCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9UQVNLX0NPTE9SLmVxdWFscyhw
cmVmS2V5KSkgew0KIAkJCQlhZGRUZXh0QXR0cmlidXRlKHByZWZLZXkpOw0KLQkJCX0gZWxzZSBp
ZiAoUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNl
Q29uc3RhbnRzLkVESVRPUl9OT1JNQUxfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJfHwg
UHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNlQ29u
c3RhbnRzLkVESVRPUl9CT1VOREFSWU1BUktFUl9DT0xPUikNCi0JCQkJCQkJLmVxdWFscyhwcmVm
S2V5KQ0KLQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtl
eShQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9LRVlXT1JEX0NPTE9SKS5lcXVhbHMocHJlZktl
eSkNCi0JCQkJCXx8IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXko
UHJlZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfVkFSSUFCTEVfQ09MT1IpDQorCQkJfSBlbHNlIGlm
IChQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJUHJl
ZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfTk9STUFMX0NPTE9SKS5lcXVhbHMocHJlZktleSkNCisJ
CQkJCXx8IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoDQorCQkJ
CQkJCVByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0JPVU5EQVJZTUFSS0VSX0NPTE9SKQ0KIAkJ
CQkJCQkuZXF1YWxzKHByZWZLZXkpDQotCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVu
YWJsZWRQcmVmZXJlbmNlS2V5KFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX1NUUklOR19DT0xP
UikuZXF1YWxzKHByZWZLZXkpDQotCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJs
ZWRQcmVmZXJlbmNlS2V5KFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0NPTU1FTlRfQ09MT1Ip
LmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVk
UHJlZmVyZW5jZUtleShQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9MSU5FX0NPTU1FTlRfQ09M
T1IpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5
KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9LRVlXT1JEX0NPTE9SKS5lcXVh
bHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVu
YWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9W
QVJJQUJMRV9DT0xPUikuZXF1YWxzKA0KKwkJCQkJCQlwcmVmS2V5KQ0KKwkJCQkJfHwgUHJlZmVy
ZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleSgNCisJCQkJCQkJUHJlZmVyZW5j
ZUNvbnN0YW50cy5FRElUT1JfU1RSSU5HX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkp
DQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0K
KwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9DT01NRU5UX0NPTE9SKS5lcXVhbHMo
DQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJs
ZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9MSU5F
X0NPTU1FTlRfQ09MT1IpDQogCQkJCQkJCS5lcXVhbHMocHJlZktleSkNCi0JCQkJCXx8IFByZWZl
cmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoUHJlZmVyZW5jZUNvbnN0YW50
cy5FRElUT1JfUEhQRE9DX0NPTU1FTlRfQ09MT1IpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3Rh
bnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRz
LkVESVRPUl9QSFBET0NfQ09NTUVOVF9DT0xPUikNCiAJCQkJCQkJLmVxdWFscyhwcmVmS2V5KQ0K
LQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVm
ZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9QSFBET0NfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJ
CQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJl
bmNlQ29uc3RhbnRzLkVESVRPUl9OVU1CRVJfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJ
fHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNl
Q29uc3RhbnRzLkVESVRPUl9IRVJFRE9DX0NPTE9SKS5lcXVhbHMocHJlZktleSkNCi0JCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoUHJlZmVyZW5jZUNv
bnN0YW50cy5FRElUT1JfVEFTS19DT0xPUikuZXF1YWxzKHByZWZLZXkpKSB7DQotCQkJCQlib29s
ZWFuIGVuYWJsZWQgPSBnZXRDb2xvclByZWZlcmVuY2VzKCkuZ2V0Qm9vbGVhbihwcmVmS2V5KTsN
Ci0JCQkJCXByZWZLZXkgPSBwcmVmS2V5LnNwbGl0KCJcXC4iKVsxXTsNCi0JCQkJCWlmKGVuYWJs
ZWQpew0KLQkJCQkJCWFkZFRleHRBdHRyaWJ1dGUocHJlZktleSk7DQotCQkJCQl9ZWxzZXsNCi0J
CQkJCQlhZGREZWZhdWx0VGV4dEF0dHJpYnV0ZShwcmVmS2V5KTsNCi0JCQkJCX0NCisJCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoDQorCQkJCQkJCVBy
ZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX1BIUERPQ19DT0xPUikuZXF1YWxzKA0KKwkJCQkJCQlw
cmVmS2V5KQ0KKwkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5j
ZUtleSgNCisJCQkJCQkJUHJlZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfTlVNQkVSX0NPTE9SKS5l
cXVhbHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdl
dEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRP
Ul9IRVJFRE9DX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVm
ZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJl
bmNlQ29uc3RhbnRzLkVESVRPUl9UQVNLX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkp
KSB7DQorCQkJCWJvb2xlYW4gZW5hYmxlZCA9IGdldENvbG9yUHJlZmVyZW5jZXMoKS5nZXRCb29s
ZWFuKHByZWZLZXkpOw0KKwkJCQlwcmVmS2V5ID0gcHJlZktleS5zcGxpdCgiXFwuIilbMV07DQor
CQkJCWlmIChlbmFibGVkKSB7DQorCQkJCQlhZGRUZXh0QXR0cmlidXRlKHByZWZLZXkpOw0KKwkJ
CQl9IGVsc2Ugew0KKwkJCQkJYWRkRGVmYXVsdFRleHRBdHRyaWJ1dGUocHJlZktleSk7DQorCQkJ
CX0NCiAJCQl9DQogCQl9IGVsc2Ugew0KIAkJCWxvYWRDb2xvcnMoKTsNCkluZGV4OiBzcmMvb3Jn
L2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJhbmdl
LmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiBzcmMvb3JnL2VjbGlwc2UvcGhwL2ludGVybmFs
L3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJhbmdlLmphdmENCmRpZmYgLU4gc3JjL29y
Zy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvUEhQU3R5bGVSYW5n
ZS5qYXZhDQotLS0gL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCisrKyBzcmMv
b3JnL2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJh
bmdlLmphdmEJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KQEAgLTAsMCArMSw1MyBAQA0KK3Bh
Y2thZ2Ugb3JnLmVjbGlwc2UucGhwLmludGVybmFsLnVpLmVkaXRvci5oaWdobGlnaHRlcjsNCisN
CitpbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsNCitpbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9y
Ow0KK2ltcG9ydCBqYXZhLnV0aWwuTGlzdDsNCisNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmN1
c3RvbS5TdHlsZVJhbmdlOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuZ3JhcGhpY3MuQ29sb3I7
DQorDQorcHVibGljIGNsYXNzIFBIUFN0eWxlUmFuZ2UgZXh0ZW5kcyBTdHlsZVJhbmdlIHsNCisJ
cHJpdmF0ZSBmaW5hbCBDb2xvciByZWFsYmFja2dyb3VuZDsNCisJcHJpdmF0ZSBMaXN0PFBIUFN0
eWxlUmFuZ2U+IGFsbENsb25lcyA9IG5ldyBBcnJheUxpc3Q8UEhQU3R5bGVSYW5nZT4oKTsNCisN
CisJcHVibGljIFBIUFN0eWxlUmFuZ2UoaW50IHN0YXJ0LCBpbnQgbGVuZ3RoLCBDb2xvciBmb3Jl
Z3JvdW5kLA0KKwkJCUNvbG9yIGJhY2tncm91bmQsIGludCBmb250U3R5bGUpIHsNCisJCXN1cGVy
KHN0YXJ0LCBsZW5ndGgsIGZvcmVncm91bmQsIGJhY2tncm91bmQsIGZvbnRTdHlsZSk7DQorCQl0
aGlzLnJlYWxiYWNrZ3JvdW5kID0gYmFja2dyb3VuZDsNCisJCWFsbENsb25lcy5hZGQodGhpcyk7
DQorCX0NCisNCisJLyoqDQorCSAqIHdoZW4gdGhpcyBQSFBTdHlsZVJhbmdlIGlzIGluIG9uZSB0
aGUgY3VycmVjdCBsaW5lLGNhbGwgdGhpcyBtZXRob2QNCisJICovDQorCXB1YmxpYyB2b2lkIGNs
ZWFyQmFja2dyb3VuZCgpIHsNCisJCWZvciAoSXRlcmF0b3I8UEhQU3R5bGVSYW5nZT4gaXRlcmF0
b3IgPSBhbGxDbG9uZXMuaXRlcmF0b3IoKTsgaXRlcmF0b3INCisJCQkJLmhhc05leHQoKTspIHsN
CisJCQlQSFBTdHlsZVJhbmdlIHN0eWxlUmFuZ2UgPSAoUEhQU3R5bGVSYW5nZSkgaXRlcmF0b3Iu
bmV4dCgpOw0KKwkJCXN0eWxlUmFuZ2UuYmFja2dyb3VuZCA9IG51bGw7DQorCQl9DQorCX0NCisN
CisJLyoqDQorCSAqIHdoZW4gdGhpcyBQSFBTdHlsZVJhbmdlIGlzIE5PVCBpbiBvbmUgdGhlIGN1
cnJlY3QgbGluZSxjYWxsIHRoaXMgbWV0aG9kDQorCSAqLw0KKwlwdWJsaWMgdm9pZCByZXNldEJh
Y2tncm91bmQoKSB7DQorCQlmb3IgKEl0ZXJhdG9yPFBIUFN0eWxlUmFuZ2U+IGl0ZXJhdG9yID0g
YWxsQ2xvbmVzLml0ZXJhdG9yKCk7IGl0ZXJhdG9yDQorCQkJCS5oYXNOZXh0KCk7KSB7DQorCQkJ
UEhQU3R5bGVSYW5nZSBzdHlsZVJhbmdlID0gKFBIUFN0eWxlUmFuZ2UpIGl0ZXJhdG9yLm5leHQo
KTsNCisJCQlzdHlsZVJhbmdlLmJhY2tncm91bmQgPSByZWFsYmFja2dyb3VuZDsNCisJCX0NCisJ
fQ0KKw0KKwkvLyBAT3ZlcnJpZGUNCisJcHVibGljIE9iamVjdCBjbG9uZSgpIHsNCisJCVBIUFN0
eWxlUmFuZ2UgY2xvbmUgPSAoUEhQU3R5bGVSYW5nZSkgc3VwZXIuY2xvbmUoKTsNCisJCS8vIHRo
aXMgaXMgaW1wb3J0YW50IGZvciBTdHlsZWRUZXh0IGFsd2F5cyByZXR1cm4gdGhlIGNsb25lcyBv
ZiBpdHMNCisJCS8vIFN0eWxlUmFuZ2Usc28gaWYgd2Ugbm90IGNvbGxlY3QgYWxsIHRoZSBjbG9u
ZXMoaW5jbHVkaW5nIGl0c2VsZiksd2hlbg0KKwkJLy8gd2Ugc2V0IGl0cyBiYWNrZ3JvdW5kIHdp
bGwgbWFrZSBubyBlZmZlY3QsZm9yIHlvdSBhbHdheXMgY2hhbmdlIGl0cw0KKwkJLy8gY2xvbmUg
b2JqZWN0J3MgYmFja2dyb3VuZCBwcm9wZXJ0eQ0KKwkJYWxsQ2xvbmVzLmFkZChjbG9uZSk7DQor
CQlyZXR1cm4gY2xvbmU7DQorCX0NCit9DQpJbmRleDogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRl
cm5hbC91aS9lZGl0b3IvUEhQQ3Vyc29yTGluZVBhaW50ZXIuamF2YQ0KPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNT
IGZpbGU6IHNyYy9vcmcvZWNsaXBzZS9waHAvaW50ZXJuYWwvdWkvZWRpdG9yL1BIUEN1cnNvckxp
bmVQYWludGVyLmphdmENCmRpZmYgLU4gc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9l
ZGl0b3IvUEhQQ3Vyc29yTGluZVBhaW50ZXIuamF2YQ0KLS0tIC9kZXYvbnVsbAkxIEphbiAxOTcw
IDAwOjAwOjAwIC0wMDAwDQorKysgc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0
b3IvUEhQQ3Vyc29yTGluZVBhaW50ZXIuamF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQpA
QCAtMCwwICsxLDI2MiBAQA0KK3BhY2thZ2Ugb3JnLmVjbGlwc2UucGhwLmludGVybmFsLnVpLmVk
aXRvcjsNCisNCitpbXBvcnQgb3JnLmVjbGlwc2UuamZhY2UudGV4dC4qOw0KK2ltcG9ydCBvcmcu
ZWNsaXBzZS5waHAuaW50ZXJuYWwudWkuZWRpdG9yLmhpZ2hsaWdodGVyLlBIUFN0eWxlUmFuZ2U7
DQoraW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5jdXN0b20uTGluZUJhY2tncm91bmRFdmVudDsNCitp
bXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmN1c3RvbS5MaW5lQmFja2dyb3VuZExpc3RlbmVyOw0KK2lt
cG9ydCBvcmcuZWNsaXBzZS5zd3QuY3VzdG9tLlN0eWxlUmFuZ2U7DQoraW1wb3J0IG9yZy5lY2xp
cHNlLnN3dC5jdXN0b20uU3R5bGVkVGV4dDsNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmdyYXBo
aWNzLlBvaW50Ow0KKw0KK3B1YmxpYyBjbGFzcyBQSFBDdXJzb3JMaW5lUGFpbnRlciBpbXBsZW1l
bnRzIElQYWludGVyLCBMaW5lQmFja2dyb3VuZExpc3RlbmVyIHsNCisNCisJLyoqIFRoZSB2aWV3
ZXIgdGhlIHBhaW50ZXIgd29ya3Mgb24gKi8NCisJcHJpdmF0ZSBmaW5hbCBJVGV4dFZpZXdlciBm
Vmlld2VyOw0KKwkvKiogVGhlIHBhaW50IHBvc2l0aW9uIG1hbmFnZXIgZm9yIG1hbmFnaW5nIHRo
ZSBsaW5lIGNvb3JkaW5hdGVzICovDQorCXByaXZhdGUgSVBhaW50UG9zaXRpb25NYW5hZ2VyIGZQ
b3NpdGlvbk1hbmFnZXI7DQorCS8qKiBLZWVwcyB0cmFjayBvZiB0aGUgbGluZSB0byBiZSBwYWlu
dGVkICovDQorCXByaXZhdGUgUG9zaXRpb24gZkN1cnJlbnRMaW5lID0gbmV3IFBvc2l0aW9uKDAs
IDApOw0KKwkvKiogS2VlcHMgdHJhY2sgb2YgdGhlIGxpbmUgdG8gYmUgY2xlYXJlZCAqLw0KKwlw
cml2YXRlIFBvc2l0aW9uIGZMYXN0TGluZSA9IG5ldyBQb3NpdGlvbigwLCAwKTsNCisJLyoqIEtl
ZXBzIHRyYWNrIG9mIHRoZSBsaW5lIG51bWJlciBvZiB0aGUgbGFzdCBwYWludGVkIGxpbmUgKi8N
CisJcHJpdmF0ZSBpbnQgZkxhc3RMaW5lTnVtYmVyID0gLTE7DQorCS8qKiBJbmRpY2F0ZXMgd2hl
dGhlciB0aGlzIHBhaW50ZXIgaXMgYWN0aXZlICovDQorCXByaXZhdGUgYm9vbGVhbiBmSXNBY3Rp
dmU7DQorDQorCS8qKg0KKwkgKiBDcmVhdGVzIGEgbmV3IHBhaW50ZXIgZm9yIHRoZSBnaXZlbiBz
b3VyY2Ugdmlld2VyLg0KKwkgKiANCisJICogQHBhcmFtIHRleHRWaWV3ZXINCisJICogICAgICAg
ICAgICB0aGUgc291cmNlIHZpZXdlciBmb3Igd2hpY2ggdG8gY3JlYXRlIGEgcGFpbnRlcg0KKwkg
Ki8NCisJcHVibGljIFBIUEN1cnNvckxpbmVQYWludGVyKElUZXh0Vmlld2VyIHRleHRWaWV3ZXIp
IHsNCisJCWZWaWV3ZXIgPSB0ZXh0Vmlld2VyOw0KKwl9DQorDQorCS8qKg0KKwkgKiBTZXRzIHRo
ZSBjb2xvciBpbiB3aGljaCB0byBkcmF3IHRoZSBiYWNrZ3JvdW5kIG9mIHRoZSBjdXJzb3IgbGlu
ZS4NCisJICogDQorCSAqIEBwYXJhbSBoaWdobGlnaHRDb2xvcg0KKwkgKiAgICAgICAgICAgIHRo
ZSBjb2xvciBpbiB3aGljaCB0byBkcmF3IHRoZSBiYWNrZ3JvdW5kIG9mIHRoZSBjdXJzb3IgbGlu
ZQ0KKwkgKi8NCisNCisJLyoNCisJICogQHNlZSBMaW5lQmFja2dyb3VuZExpc3RlbmVyI2xpbmVH
ZXRCYWNrZ3JvdW5kKExpbmVCYWNrZ3JvdW5kRXZlbnQpDQorCSAqLw0KKwlwdWJsaWMgdm9pZCBs
aW5lR2V0QmFja2dyb3VuZChMaW5lQmFja2dyb3VuZEV2ZW50IGV2ZW50KSB7DQorCX0NCisNCisJ
LyoqDQorCSAqIFVwZGF0ZXMgYWxsIHRoZSBjYWNoZWQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGxp
bmVzIHRvIGJlIHBhaW50ZWQgYW5kIHRvDQorCSAqIGJlIGNsZWFyZWQuIFJldHVybnMgPGNvZGU+
dHJ1ZTwvY29kZT4gaWYgdGhlIGxpbmUgbnVtYmVyIG9mIHRoZSBjdXJzb3INCisJICogbGluZSBo
YXMgY2hhbmdlZC4NCisJICogDQorCSAqIEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgY3Vy
c29yIGxpbmUgY2hhbmdlZA0KKwkgKi8NCisJcHJpdmF0ZSBib29sZWFuIHVwZGF0ZUhpZ2hsaWdo
dExpbmUoKSB7DQorCQl0cnkgew0KKw0KKwkJCUlEb2N1bWVudCBkb2N1bWVudCA9IGZWaWV3ZXIu
Z2V0RG9jdW1lbnQoKTsNCisJCQlpbnQgbW9kZWxDYXJldCA9IGdldE1vZGVsQ2FyZXQoKTsNCisJ
CQlpbnQgbGluZU51bWJlciA9IGRvY3VtZW50LmdldExpbmVPZk9mZnNldChtb2RlbENhcmV0KTsN
CisNCisJCQkvLyByZWRyYXcgaWYgdGhlIGN1cnJlbnQgbGluZSBudW1iZXIgaXMgZGlmZmVyZW50
IGZyb20gdGhlIGxhc3QgbGluZQ0KKwkJCS8vIG51bWJlciB3ZSBwYWludGVkDQorCQkJLy8gaW5p
dGlhbGx5IGZMYXN0TGluZU51bWJlciBpcyAtMQ0KKwkJCWlmIChsaW5lTnVtYmVyICE9IGZMYXN0
TGluZU51bWJlcg0KKwkJCQkJfHwgIWZDdXJyZW50TGluZS5vdmVybGFwc1dpdGgobW9kZWxDYXJl
dCwgMCkpIHsNCisNCisJCQkJZkxhc3RMaW5lLm9mZnNldCA9IGZDdXJyZW50TGluZS5vZmZzZXQ7
DQorCQkJCWZMYXN0TGluZS5sZW5ndGggPSBmQ3VycmVudExpbmUubGVuZ3RoOw0KKwkJCQlmTGFz
dExpbmUuaXNEZWxldGVkID0gZkN1cnJlbnRMaW5lLmlzRGVsZXRlZDsNCisNCisJCQkJaWYgKGZD
dXJyZW50TGluZS5pc0RlbGV0ZWQpIHsNCisJCQkJCWZDdXJyZW50TGluZS5pc0RlbGV0ZWQgPSBm
YWxzZTsNCisJCQkJCWZQb3NpdGlvbk1hbmFnZXIubWFuYWdlUG9zaXRpb24oZkN1cnJlbnRMaW5l
KTsNCisJCQkJfQ0KKw0KKwkJCQlmQ3VycmVudExpbmUub2Zmc2V0ID0gZG9jdW1lbnQuZ2V0TGlu
ZU9mZnNldChsaW5lTnVtYmVyKTsNCisJCQkJaWYgKGxpbmVOdW1iZXIgPT0gZG9jdW1lbnQuZ2V0
TnVtYmVyT2ZMaW5lcygpIC0gMSkNCisJCQkJCWZDdXJyZW50TGluZS5sZW5ndGggPSBkb2N1bWVu
dC5nZXRMZW5ndGgoKQ0KKwkJCQkJCQktIGZDdXJyZW50TGluZS5vZmZzZXQ7DQorCQkJCWVsc2UN
CisJCQkJCWZDdXJyZW50TGluZS5sZW5ndGggPSBkb2N1bWVudA0KKwkJCQkJCQkuZ2V0TGluZU9m
ZnNldChsaW5lTnVtYmVyICsgMSkNCisJCQkJCQkJLSBmQ3VycmVudExpbmUub2Zmc2V0Ow0KKw0K
KwkJCQlmTGFzdExpbmVOdW1iZXIgPSBsaW5lTnVtYmVyOw0KKwkJCQlyZXR1cm4gdHJ1ZTsNCisN
CisJCQl9DQorDQorCQl9IGNhdGNoIChCYWRMb2NhdGlvbkV4Y2VwdGlvbiBlKSB7DQorCQl9DQor
DQorCQlyZXR1cm4gZmFsc2U7DQorCX0NCisNCisJLyoqDQorCSAqIFJldHVybnMgdGhlIGxvY2F0
aW9uIG9mIHRoZSBjYXJldCBhcyBvZmZzZXQgaW4gdGhlIHNvdXJjZSB2aWV3ZXIncyBpbnB1dA0K
KwkgKiBkb2N1bWVudC4NCisJICogDQorCSAqIEByZXR1cm4gdGhlIGNhcmV0IGxvY2F0aW9uDQor
CSAqLw0KKwlwcml2YXRlIGludCBnZXRNb2RlbENhcmV0KCkgew0KKwkJaW50IHdpZGdldENhcmV0
ID0gZlZpZXdlci5nZXRUZXh0V2lkZ2V0KCkuZ2V0Q2FyZXRPZmZzZXQoKTsNCisJCWlmIChmVmll
d2VyIGluc3RhbmNlb2YgSVRleHRWaWV3ZXJFeHRlbnNpb241KSB7DQorCQkJSVRleHRWaWV3ZXJF
eHRlbnNpb241IGV4dGVuc2lvbiA9IChJVGV4dFZpZXdlckV4dGVuc2lvbjUpIGZWaWV3ZXI7DQor
CQkJcmV0dXJuIGV4dGVuc2lvbi53aWRnZXRPZmZzZXQyTW9kZWxPZmZzZXQod2lkZ2V0Q2FyZXQp
Ow0KKwkJfQ0KKwkJSVJlZ2lvbiB2aXNpYmxlID0gZlZpZXdlci5nZXRWaXNpYmxlUmVnaW9uKCk7
DQorCQlyZXR1cm4gd2lkZ2V0Q2FyZXQgKyB2aXNpYmxlLmdldE9mZnNldCgpOw0KKwl9DQorDQor
CS8qDQorCSAqIEBzZWUgSVBhaW50ZXIjZGVhY3RpdmF0ZShib29sZWFuKQ0KKwkgKi8NCisJcHVi
bGljIHZvaWQgZGVhY3RpdmF0ZShib29sZWFuIHJlZHJhdykgew0KKwkJaWYgKGZJc0FjdGl2ZSkg
ew0KKwkJCWZJc0FjdGl2ZSA9IGZhbHNlOw0KKwkJCWZWaWV3ZXIuZ2V0VGV4dFdpZGdldCgpLnJl
bW92ZUxpbmVCYWNrZ3JvdW5kTGlzdGVuZXIodGhpcyk7DQorCQkJLy8NCisJCQlpZiAoZlBvc2l0
aW9uTWFuYWdlciAhPSBudWxsKQ0KKwkJCQlmUG9zaXRpb25NYW5hZ2VyLnVubWFuYWdlUG9zaXRp
b24oZkN1cnJlbnRMaW5lKTsNCisNCisJCQlmTGFzdExpbmVOdW1iZXIgPSAtMTsNCisJCQlmQ3Vy
cmVudExpbmUub2Zmc2V0ID0gMDsNCisJCQlmQ3VycmVudExpbmUubGVuZ3RoID0gMDsNCisJCX0N
CisJfQ0KKw0KKwkvKg0KKwkgKiBAc2VlIElQYWludGVyI2Rpc3Bvc2UoKQ0KKwkgKi8NCisJcHVi
bGljIHZvaWQgZGlzcG9zZSgpIHsNCisJfQ0KKw0KKwkvKg0KKwkgKiBAc2VlIElQYWludGVyI3Bh
aW50KGludCkNCisJICovDQorCXB1YmxpYyB2b2lkIHBhaW50KGludCByZWFzb24pIHsNCisJCWlm
IChmVmlld2VyLmdldERvY3VtZW50KCkgPT0gbnVsbCkgew0KKwkJCWRlYWN0aXZhdGUoZmFsc2Up
Ow0KKwkJCXJldHVybjsNCisJCX0NCisNCisJCVN0eWxlZFRleHQgdGV4dFdpZGdldCA9IGZWaWV3
ZXIuZ2V0VGV4dFdpZGdldCgpOw0KKw0KKwkJLy8gY2hlY2sgc2VsZWN0aW9uDQorCQlpZiAoaGFz
TXVsdGlMaW5lU2VsZWN0aW9uKHRleHRXaWRnZXQpKSB7DQorCQkJZGVhY3RpdmF0ZSh0cnVlKTsN
CisJCQlyZXR1cm47DQorCQl9DQorDQorCQkvLyBpbml0aWFsaXphdGlvbg0KKwkJaWYgKCFmSXNB
Y3RpdmUpIHsNCisJCQl0ZXh0V2lkZ2V0LmFkZExpbmVCYWNrZ3JvdW5kTGlzdGVuZXIodGhpcyk7
DQorCQkJZklzQWN0aXZlID0gdHJ1ZTsNCisJCX0NCisNCisJCWludCBvbGRMYXN0TGluZU51bWJl
ciA9IGZMYXN0TGluZU51bWJlcjsNCisNCisJCXVwZGF0ZUhpZ2hsaWdodExpbmUoKTsNCisJCWlm
IChvbGRMYXN0TGluZU51bWJlciAhPSAtMSAmJiBvbGRMYXN0TGluZU51bWJlciAhPSBmTGFzdExp
bmVOdW1iZXIpIHsNCisJCQkvLyByZWNvdmVyIHRoZSBvbGQgc3R5bGVkIHJhbmdlIGJhY2tncm91
bmQgY29sb3INCisJCQlpbnQgbGluZU9mZnNldCA9IHRleHRXaWRnZXQuZ2V0T2Zmc2V0QXRMaW5l
KG9sZExhc3RMaW5lTnVtYmVyKTsNCisJCQlTdHJpbmcgbGluZSA9IHRleHRXaWRnZXQuZ2V0TGlu
ZShvbGRMYXN0TGluZU51bWJlcik7DQorCQkJaW50IGxpbmVMZW5ndGggPSBsaW5lLmxlbmd0aCgp
Ow0KKwkJCVN0eWxlUmFuZ2VbXSByYW5nZXMgPSB0ZXh0V2lkZ2V0LmdldFN0eWxlUmFuZ2VzKGxp
bmVPZmZzZXQsDQorCQkJCQlsaW5lTGVuZ3RoKTsNCisJCQlmb3IgKGludCBpID0gMDsgaSA8IHJh
bmdlcy5sZW5ndGg7IGkrKykgew0KKwkJCQlTdHlsZVJhbmdlIHN0eWxlUmFuZ2UgPSByYW5nZXNb
aV07DQorCQkJCWlmIChzdHlsZVJhbmdlIGluc3RhbmNlb2YgUEhQU3R5bGVSYW5nZSkgew0KKwkJ
CQkJUEhQU3R5bGVSYW5nZSBwaHBTdHlsZVJhbmdlID0gKFBIUFN0eWxlUmFuZ2UpIHN0eWxlUmFu
Z2U7DQorCQkJCQlwaHBTdHlsZVJhbmdlLnJlc2V0QmFja2dyb3VuZCgpOw0KKw0KKwkJCQl9DQor
CQkJfQ0KKwkJfQ0KKw0KKwkJLy8gc2V0IHRoaXMgbGluZSdzIHN0eWxlZCByYW5nZSBiYWNrZ3Jv
dW5kIGNvbG9yIHRvIG51bGwNCisJCWludCBzdGFydCA9IHRleHRXaWRnZXQuZ2V0T2Zmc2V0QXRM
aW5lKGZMYXN0TGluZU51bWJlcik7DQorCQlTdHlsZVJhbmdlW10gcmFuZ2VzID0gdGV4dFdpZGdl
dC5nZXRTdHlsZVJhbmdlcyhzdGFydCwgdGV4dFdpZGdldA0KKwkJCQkuZ2V0TGluZShmTGFzdExp
bmVOdW1iZXIpLmxlbmd0aCgpKTsNCisJCWZvciAoaW50IGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0
aDsgaSsrKSB7DQorCQkJU3R5bGVSYW5nZSBzdHlsZVJhbmdlID0gcmFuZ2VzW2ldOw0KKwkJCWlm
IChzdHlsZVJhbmdlIGluc3RhbmNlb2YgUEhQU3R5bGVSYW5nZSkgew0KKwkJCQlQSFBTdHlsZVJh
bmdlIHBocFN0eWxlUmFuZ2UgPSAoUEhQU3R5bGVSYW5nZSkgc3R5bGVSYW5nZTsNCisJCQkJcGhw
U3R5bGVSYW5nZS5jbGVhckJhY2tncm91bmQoKTsNCisJCQl9DQorCQl9DQorCQkvLyBkcmF3IG5l
dyBsaW5lLHdlIG11c3QgY2FsbCB0aGlzIG1ldGhvZCB0byByZWRyYXcgdGhlIGN1cnJlbnQgbGlu
ZQ0KKwkJLy8gYmVjYXVzZSB3aGVuIHdlIG1vZGlmeSB0ZXh0IEN1cnNvckxpbmVQYWludGVyIHdp
bGwgbm90IHJlZHJhdyB0aGUNCisJCS8vIGN1cnJlbnQgbGluZSx0aGVuIHBocFN0eWxlUmFuZ2Uu
Y2xlYXJCYWNrZ3JvdW5kKCkgbWFrZXMgbm8gZWZmZWN0DQorCQlkcmF3SGlnaGxpZ2h0TGluZShm
Q3VycmVudExpbmUpOw0KKwl9DQorDQorCXByaXZhdGUgdm9pZCBkcmF3SGlnaGxpZ2h0TGluZShQ
b3NpdGlvbiBwb3NpdGlvbikgew0KKw0KKwkJLy8gaWYgdGhlIHBvc2l0aW9uIHRoYXQgaXMgYWJv
dXQgdG8gYmUgZHJhd24gd2FzIGRlbGV0ZWQgdGhlbiB3ZSBjYW4ndA0KKwkJaWYgKHBvc2l0aW9u
LmlzRGVsZXRlZCgpKQ0KKwkJCXJldHVybjsNCisNCisJCWludCB3aWRnZXRPZmZzZXQgPSAwOw0K
KwkJaWYgKGZWaWV3ZXIgaW5zdGFuY2VvZiBJVGV4dFZpZXdlckV4dGVuc2lvbjUpIHsNCisNCisJ
CQlJVGV4dFZpZXdlckV4dGVuc2lvbjUgZXh0ZW5zaW9uID0gKElUZXh0Vmlld2VyRXh0ZW5zaW9u
NSkgZlZpZXdlcjsNCisJCQl3aWRnZXRPZmZzZXQgPSBleHRlbnNpb24ubW9kZWxPZmZzZXQyV2lk
Z2V0T2Zmc2V0KHBvc2l0aW9uDQorCQkJCQkuZ2V0T2Zmc2V0KCkpOw0KKwkJCWlmICh3aWRnZXRP
ZmZzZXQgPT0gLTEpDQorCQkJCXJldHVybjsNCisNCisJCX0gZWxzZSB7DQorDQorCQkJSVJlZ2lv
biB2aXNpYmxlID0gZlZpZXdlci5nZXRWaXNpYmxlUmVnaW9uKCk7DQorCQkJd2lkZ2V0T2Zmc2V0
ID0gcG9zaXRpb24uZ2V0T2Zmc2V0KCkgLSB2aXNpYmxlLmdldE9mZnNldCgpOw0KKwkJCWlmICh3
aWRnZXRPZmZzZXQgPCAwIHx8IHZpc2libGUuZ2V0TGVuZ3RoKCkgPCB3aWRnZXRPZmZzZXQpDQor
CQkJCXJldHVybjsNCisJCX0NCisNCisJCVN0eWxlZFRleHQgdGV4dFdpZGdldCA9IGZWaWV3ZXIu
Z2V0VGV4dFdpZGdldCgpOw0KKwkJLy8gY2hlY2sgZm9yIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9y
Zy9idWdzL3Nob3dfYnVnLmNnaT9pZD02NDg5OA0KKwkJLy8gdGhpcyBpcyBhIGd1YXJkIGFnYWlu
c3QgdGhlIHN5bXB0b21zIGJ1dCBub3QgdGhlIGFjdHVhbCBzb2x1dGlvbg0KKwkJaWYgKDAgPD0g
d2lkZ2V0T2Zmc2V0ICYmIHdpZGdldE9mZnNldCA8PSB0ZXh0V2lkZ2V0LmdldENoYXJDb3VudCgp
KSB7DQorCQkJUG9pbnQgdXBwZXJMZWZ0ID0gdGV4dFdpZGdldC5nZXRMb2NhdGlvbkF0T2Zmc2V0
KHdpZGdldE9mZnNldCk7DQorCQkJaW50IHdpZHRoID0gdGV4dFdpZGdldC5nZXRDbGllbnRBcmVh
KCkud2lkdGgNCisJCQkJCSsgdGV4dFdpZGdldC5nZXRIb3Jpem9udGFsUGl4ZWwoKTsNCisJCQlp
bnQgaGVpZ2h0ID0gdGV4dFdpZGdldC5nZXRMaW5lSGVpZ2h0KHdpZGdldE9mZnNldCk7DQorCQkJ
dGV4dFdpZGdldC5yZWRyYXcoMCwgdXBwZXJMZWZ0LnksIHdpZHRoLCBoZWlnaHQsIGZhbHNlKTsN
CisJCX0NCisJfQ0KKw0KKwkvKioNCisJICogUmV0dXJucyA8Y29kZT50cnVlPC9jb2RlPiBpZiB0
aGUgd2lkZ2V0IGhhcyBhIHNlbGVjdGlvbiBzcGFubmluZyBtdWx0aXBsZQ0KKwkgKiBsaW5lcywg
PGNvZGU+ZmFsc2U8L2NvZGU+IG90aGVyd2lzZS4NCisJICogDQorCSAqIEBwYXJhbSB0ZXh0V2lk
Z2V0DQorCSAqICAgICAgICAgICAgdGhlIHRleHQgd2lkZ2V0IHRvIGNoZWNrDQorCSAqIEByZXR1
cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgPGNvZGU+dGV4dFdpZGdldDwvY29kZT4gaGFzIGEgbXVs
dGlsaW5lDQorCSAqICAgICAgICAgc2VsZWN0aW9uLCA8Y29kZT5mYWxzZTwvY29kZT4gb3RoZXJ3
aXNlDQorCSAqIEBzaW5jZSAzLjUNCisJICovDQorCXByaXZhdGUgYm9vbGVhbiBoYXNNdWx0aUxp
bmVTZWxlY3Rpb24oU3R5bGVkVGV4dCB0ZXh0V2lkZ2V0KSB7DQorCQlQb2ludCBzZWxlY3Rpb24g
PSB0ZXh0V2lkZ2V0LmdldFNlbGVjdGlvbigpOw0KKwkJdHJ5IHsNCisJCQlpbnQgc3RhcnRMaW5l
ID0gdGV4dFdpZGdldC5nZXRMaW5lQXRPZmZzZXQoc2VsZWN0aW9uLngpOw0KKwkJCWludCBlbmRM
aW5lID0gdGV4dFdpZGdldC5nZXRMaW5lQXRPZmZzZXQoc2VsZWN0aW9uLnkpOw0KKwkJCXJldHVy
biBzdGFydExpbmUgIT0gZW5kTGluZTsNCisJCX0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2Vw
dGlvbiBlKSB7DQorCQkJLy8gaWdub3JlIC0gYXBwYXJlbnRseSwgdGhlIHdpZGdldCBoYXMgYSBz
dGFsZSBzZWxlY3Rpb24NCisJCQkvLyBzZWUgaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mv
c2hvd19idWcuY2dpP2lkPTI3MzcyMQ0KKwkJCXJldHVybiBmYWxzZTsNCisJCX0NCisJfQ0KKw0K
KwkvLw0KKwkvLyAvKg0KKwkvLyAqIEBzZWUgSVBhaW50ZXIjc2V0UG9zaXRpb25NYW5hZ2VyKElQ
YWludFBvc2l0aW9uTWFuYWdlcikNCisJLy8gKi8NCisJcHVibGljIHZvaWQgc2V0UG9zaXRpb25N
YW5hZ2VyKElQYWludFBvc2l0aW9uTWFuYWdlciBtYW5hZ2VyKSB7DQorCQlmUG9zaXRpb25NYW5h
Z2VyID0gbWFuYWdlcjsNCisJfQ0KK30NCkluZGV4OiBzcmMvb3JnL2VjbGlwc2UvcGhwL2ludGVy
bmFsL3VpL2VkaXRvci9QSFBTb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9ydC5qYXZhDQo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09DQpSQ1MgZmlsZTogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3Iv
UEhQU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQuamF2YQ0KZGlmZiAtTiBzcmMvb3JnL2Vj
bGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9QSFBTb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3Vw
cG9ydC5qYXZhDQotLS0gL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCisrKyBz
cmMvb3JnL2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9QSFBTb3VyY2VWaWV3ZXJEZWNv
cmF0aW9uU3VwcG9ydC5qYXZhCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCkBAIC0wLDAgKzEs
MTQzIEBADQorcGFja2FnZSBvcmcuZWNsaXBzZS5waHAuaW50ZXJuYWwudWkuZWRpdG9yOw0KKw0K
K2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS5wcmVmZXJlbmNlLklQcmVmZXJlbmNlU3RvcmU7DQor
aW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnByZWZlcmVuY2UuUHJlZmVyZW5jZUNvbnZlcnRlcjsN
CitpbXBvcnQgb3JnLmVjbGlwc2UuamZhY2UudGV4dC5JVGV4dFZpZXdlckV4dGVuc2lvbjI7DQor
aW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnRleHQuc291cmNlLklBbm5vdGF0aW9uQWNjZXNzOw0K
K2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS50ZXh0LnNvdXJjZS5JT3ZlcnZpZXdSdWxlcjsNCitp
bXBvcnQgb3JnLmVjbGlwc2UuamZhY2UudGV4dC5zb3VyY2UuSVNoYXJlZFRleHRDb2xvcnM7DQor
aW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnRleHQuc291cmNlLklTb3VyY2VWaWV3ZXI7DQoraW1w
b3J0IG9yZy5lY2xpcHNlLmpmYWNlLnV0aWwuUHJvcGVydHlDaGFuZ2VFdmVudDsNCitpbXBvcnQg
b3JnLmVjbGlwc2Uuc3d0LmdyYXBoaWNzLkNvbG9yOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3Qu
Z3JhcGhpY3MuUkdCOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS51aS50ZXh0ZWRpdG9yLlNvdXJjZVZp
ZXdlckRlY29yYXRpb25TdXBwb3J0Ow0KKw0KK3B1YmxpYyBjbGFzcyBQSFBTb3VyY2VWaWV3ZXJE
ZWNvcmF0aW9uU3VwcG9ydCBleHRlbmRzDQorCQlTb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9y
dCB7DQorCS8qKiBQcmVmZXJlbmNlIGtleSBmb3IgdGhlIGN1cnNvciBsaW5lIGhpZ2hsaWdodGlu
ZyAqLw0KKwlwcml2YXRlIFN0cmluZyBmQ3Vyc29yTGluZVBhaW50ZXJFbmFibGVLZXk7DQorCS8q
KiBQcmVmZXJlbmNlIGtleSBmb3IgdGhlIGN1cnNvciBsaW5lIGJhY2tncm91bmQgY29sb3IgKi8N
CisJcHJpdmF0ZSBTdHJpbmcgZkN1cnNvckxpbmVQYWludGVyQ29sb3JLZXk7DQorCS8qKiBUaGUg
cHJlZmVyZW5jZSBzdG9yZSAqLw0KKwlwcml2YXRlIElQcmVmZXJlbmNlU3RvcmUgZlByZWZlcmVu
Y2VTdG9yZTsNCisJLyoqIFRoZSBzaGFyZWQgY29sb3IgbWFuYWdlciAqLw0KKwlwcml2YXRlIElT
aGFyZWRUZXh0Q29sb3JzIGZTaGFyZWRUZXh0Q29sb3JzOw0KKwkvKiogVGhlIHZpZXdlciAqLw0K
Kwlwcml2YXRlIElTb3VyY2VWaWV3ZXIgZlNvdXJjZVZpZXdlcjsNCisJcHVibGljIFBIUFNvdXJj
ZVZpZXdlckRlY29yYXRpb25TdXBwb3J0KElTb3VyY2VWaWV3ZXIgc291cmNlVmlld2VyLA0KKwkJ
CUlPdmVydmlld1J1bGVyIG92ZXJ2aWV3UnVsZXIsIElBbm5vdGF0aW9uQWNjZXNzIGFubm90YXRp
b25BY2Nlc3MsDQorCQkJSVNoYXJlZFRleHRDb2xvcnMgc2hhcmVkVGV4dENvbG9ycykgew0KKwkJ
c3VwZXIoc291cmNlVmlld2VyLCBvdmVydmlld1J1bGVyLCBhbm5vdGF0aW9uQWNjZXNzLCBzaGFy
ZWRUZXh0Q29sb3JzKTsNCisJCWZTb3VyY2VWaWV3ZXI9IHNvdXJjZVZpZXdlcjsNCisJCWZTaGFy
ZWRUZXh0Q29sb3JzPSBzaGFyZWRUZXh0Q29sb3JzOw0KKwl9DQorCUBPdmVycmlkZQ0KKwlwdWJs
aWMgdm9pZCBpbnN0YWxsKElQcmVmZXJlbmNlU3RvcmUgc3RvcmUpIHsNCisvLwkJc3VwZXIuaW5z
dGFsbChzdG9yZSk7DQorCQkNCisJCWZQcmVmZXJlbmNlU3RvcmUgPSBzdG9yZTsNCisJCWlmIChp
c0N1cnNvckxpbmVTaG93bigpKQ0KKwkJCXNob3dDdXJzb3JMaW5lKCk7DQorCQllbHNlDQorCQkJ
aGlkZUN1cnNvckxpbmUoKTsNCisNCisJCXN1cGVyLmluc3RhbGwoc3RvcmUpOw0KKwl9DQorDQor
CS8qKg0KKwkgKiBUZWxscyB3aGV0aGVyIHRoZSBjdXJzb3IgbGluZSBpcyBzaG93bi4NCisJICoN
CisJICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgY3Vyc29yIGxpbmUgaXMgc2hv
d24NCisJICovDQorCXByaXZhdGUgYm9vbGVhbiBpc0N1cnNvckxpbmVTaG93bigpIHsNCisJCWlm
IChmUHJlZmVyZW5jZVN0b3JlICE9IG51bGwgJiYgZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5
ICE9IG51bGwpDQorCQkJcmV0dXJuIGZQcmVmZXJlbmNlU3RvcmUuZ2V0Qm9vbGVhbihmQ3Vyc29y
TGluZVBhaW50ZXJFbmFibGVLZXkpOw0KKwkJcmV0dXJuIGZhbHNlOw0KKwl9DQorDQorCS8qKg0K
KwkgKiBTZXRzIHRoZSBwcmVmZXJlbmNlIGtleXMgZm9yIHRoZSBjdXJzb3IgbGluZSBwYWludGVy
Lg0KKwkgKiBAcGFyYW0gZW5hYmxlS2V5IHRoZSBwcmVmZXJlbmNlIGtleSBmb3IgdGhlIGN1cnNv
ciBsaW5lIHBhaW50ZXINCisJICogQHBhcmFtIGNvbG9yS2V5IHRoZSBwcmVmZXJlbmNlIGtleSBm
b3IgdGhlIGNvbG9yIHVzZWQgYnkgdGhlIGN1cnNvciBsaW5lDQorCSAqICAgICAgICBwYWludGVy
DQorCSAqLw0KKwlwdWJsaWMgdm9pZCBzZXRDdXJzb3JMaW5lUGFpbnRlclByZWZlcmVuY2VLZXlz
KFN0cmluZyBlbmFibGVLZXksIFN0cmluZyBjb2xvcktleSkgew0KKwkJc3VwZXIuc2V0Q3Vyc29y
TGluZVBhaW50ZXJQcmVmZXJlbmNlS2V5cyhlbmFibGVLZXksIGNvbG9yS2V5KTsNCisJCWZDdXJz
b3JMaW5lUGFpbnRlckVuYWJsZUtleT0gZW5hYmxlS2V5Ow0KKwkJZkN1cnNvckxpbmVQYWludGVy
Q29sb3JLZXk9IGNvbG9yS2V5Ow0KKwl9DQorCQ0KKwlAT3ZlcnJpZGUNCisJcHJvdGVjdGVkIHZv
aWQgaGFuZGxlUHJlZmVyZW5jZVN0b3JlQ2hhbmdlZChQcm9wZXJ0eUNoYW5nZUV2ZW50IGV2ZW50
KSB7DQorDQorCQlTdHJpbmcgcD0gZXZlbnQuZ2V0UHJvcGVydHkoKTsNCisJCWlmIChmQ3Vyc29y
TGluZVBhaW50ZXJFbmFibGVLZXkgIT0gbnVsbCAmJiBmQ3Vyc29yTGluZVBhaW50ZXJFbmFibGVL
ZXkuZXF1YWxzKHApKSB7DQorCQkJaWYgKGlzQ3Vyc29yTGluZVNob3duKCkpDQorCQkJCXNob3dD
dXJzb3JMaW5lKCk7DQorCQkJZWxzZQ0KKwkJCQloaWRlQ3Vyc29yTGluZSgpOw0KKwkJCXJldHVy
bjsNCisJCX0NCisNCisJCQ0KKwkJc3VwZXIuaGFuZGxlUHJlZmVyZW5jZVN0b3JlQ2hhbmdlZChl
dmVudCk7DQorDQorCX0NCisJDQorDQorCS8qKiBUaGUgZWRpdG9yJ3MgbGluZSBwYWludGVyICov
DQorCXByaXZhdGUgUEhQQ3Vyc29yTGluZVBhaW50ZXIgZkN1cnNvckxpbmVQYWludGVyOw0KKwkv
KioNCisJICogU2hvd3MgdGhlIGN1cnNvciBsaW5lLg0KKwkgKi8NCisJcHJpdmF0ZSB2b2lkIHNo
b3dDdXJzb3JMaW5lKCkgew0KKwkJaWYgKGZDdXJzb3JMaW5lUGFpbnRlciA9PSBudWxsKSB7DQor
CQkJaWYgKGZTb3VyY2VWaWV3ZXIgaW5zdGFuY2VvZiBJVGV4dFZpZXdlckV4dGVuc2lvbjIpIHsN
CisJCQkJZkN1cnNvckxpbmVQYWludGVyPSBuZXcgUEhQQ3Vyc29yTGluZVBhaW50ZXIoZlNvdXJj
ZVZpZXdlcik7DQorLy8JCQkJZkN1cnNvckxpbmVQYWludGVyLnNldEhpZ2hsaWdodENvbG9yKGdl
dENvbG9yKGZDdXJzb3JMaW5lUGFpbnRlckNvbG9yS2V5KSk7DQorCQkJCUlUZXh0Vmlld2VyRXh0
ZW5zaW9uMiBleHRlbnNpb249IChJVGV4dFZpZXdlckV4dGVuc2lvbjIpIGZTb3VyY2VWaWV3ZXI7
DQorCQkJCWV4dGVuc2lvbi5hZGRQYWludGVyKGZDdXJzb3JMaW5lUGFpbnRlcik7DQorCQkJfQ0K
KwkJfQ0KKwl9DQorDQorCS8qKg0KKwkgKiBSZXR1cm5zIHRoZSBzaGFyZWQgY29sb3IgZm9yIHRo
ZSBnaXZlbiBrZXkuDQorCSAqDQorCSAqIEBwYXJhbSBrZXkgdGhlIGNvbG9yIGtleSBzdHJpbmcN
CisJICogQHJldHVybiB0aGUgc2hhcmVkIGNvbG9yIGZvciB0aGUgZ2l2ZW4ga2V5DQorCSAqLw0K
Kwlwcml2YXRlIENvbG9yIGdldENvbG9yKFN0cmluZyBrZXkpIHsNCisJCWlmIChmUHJlZmVyZW5j
ZVN0b3JlICE9IG51bGwpIHsNCisJCQlSR0IgcmdiPSBQcmVmZXJlbmNlQ29udmVydGVyLmdldENv
bG9yKGZQcmVmZXJlbmNlU3RvcmUsIGtleSk7DQorCQkJcmV0dXJuIGdldENvbG9yKHJnYik7DQor
CQl9DQorCQlyZXR1cm4gbnVsbDsNCisJfQ0KKw0KKwkvKioNCisJICogUmV0dXJucyB0aGUgc2hh
cmVkIGNvbG9yIGZvciB0aGUgZ2l2ZW4gUkdCLg0KKwkgKg0KKwkgKiBAcGFyYW0gcmdiIHRoZSBS
R0INCisJICogQHJldHVybiB0aGUgc2hhcmVkIGNvbG9yIGZvciB0aGUgZ2l2ZW4gUkdCDQorCSAq
Lw0KKwlwcml2YXRlIENvbG9yIGdldENvbG9yKFJHQiByZ2IpIHsNCisJCXJldHVybiBmU2hhcmVk
VGV4dENvbG9ycy5nZXRDb2xvcihyZ2IpOw0KKwl9DQorDQorCS8qKg0KKwkgKiBIaWRlcyB0aGUg
Y3Vyc29yIGxpbmUuDQorCSAqLw0KKwlwcml2YXRlIHZvaWQgaGlkZUN1cnNvckxpbmUoKSB7DQor
CQlpZiAoZkN1cnNvckxpbmVQYWludGVyICE9IG51bGwpIHsNCisJCQlpZiAoZlNvdXJjZVZpZXdl
ciBpbnN0YW5jZW9mIElUZXh0Vmlld2VyRXh0ZW5zaW9uMikgew0KKwkJCQlJVGV4dFZpZXdlckV4
dGVuc2lvbjIgZXh0ZW5zaW9uPSAoSVRleHRWaWV3ZXJFeHRlbnNpb24yKSBmU291cmNlVmlld2Vy
Ow0KKwkJCQlleHRlbnNpb24ucmVtb3ZlUGFpbnRlcihmQ3Vyc29yTGluZVBhaW50ZXIpOw0KKwkJ
CQlmQ3Vyc29yTGluZVBhaW50ZXIuZGVhY3RpdmF0ZSh0cnVlKTsNCisJCQkJZkN1cnNvckxpbmVQ
YWludGVyLmRpc3Bvc2UoKTsNCisJCQkJZkN1cnNvckxpbmVQYWludGVyPSBudWxsOw0KKwkJCX0N
CisJCX0NCisJfQ0KKw0KK30NCg==
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>156895</attachid>
            <date>2010-01-22 01:19:00 -0500</date>
            <delta_ts>2010-01-22 02:25:25 -0500</delta_ts>
            <desc>patch</desc>
            <filename>linebackground.txt</filename>
            <type>text/plain</type>
            <size>23651</size>
            <attacher name="Zhongwei Zhao">zhaozhongwei</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UucGhwLnVpDQpJ
bmRleDogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJl
ZEVkaXRvci5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvdG9vbHMvb3JnLmVj
bGlwc2UucGR0L3BsdWdpbnMvb3JnLmVjbGlwc2UucGhwLnVpL3NyYy9vcmcvZWNsaXBzZS9waHAv
aW50ZXJuYWwvdWkvZWRpdG9yL1BIUFN0cnVjdHVyZWRFZGl0b3IuamF2YSx2DQpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuMTMyDQpkaWZmIC11IC1yMS4xMzIgUEhQU3RydWN0dXJlZEVkaXRvci5qYXZh
DQotLS0gc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJl
ZEVkaXRvci5qYXZhCTIwIEphbiAyMDEwIDA3OjM1OjU4IC0wMDAwCTEuMTMyDQorKysgc3JjL29y
Zy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJlZEVkaXRvci5qYXZh
CTIyIEphbiAyMDEwIDA2OjE4OjE1IC0wMDAwDQpAQCAtMzMzMiw0ICszMzMyLDE0IEBADQogCQkJ
KChDb25maWd1cmFibGVDb250ZW50T3V0bGluZVBhZ2UpIGZQSFBPdXRsaW5lUGFnZSkuc2V0SW5w
dXQoZ2V0TW9kZWxFbGVtZW50KCkpOw0KIAkJfQ0KIAl9DQorCQ0KKwlAT3ZlcnJpZGUNCisJcHJv
dGVjdGVkIFNvdXJjZVZpZXdlckRlY29yYXRpb25TdXBwb3J0IGdldFNvdXJjZVZpZXdlckRlY29y
YXRpb25TdXBwb3J0KA0KKwkJCUlTb3VyY2VWaWV3ZXIgdmlld2VyKSB7DQorCQlpZiAoZlNvdXJj
ZVZpZXdlckRlY29yYXRpb25TdXBwb3J0ID09IG51bGwpIHsNCisJCQlmU291cmNlVmlld2VyRGVj
b3JhdGlvblN1cHBvcnQ9IG5ldyBQSFBTb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9ydCh2aWV3
ZXIsIGdldE92ZXJ2aWV3UnVsZXIoKSwgZ2V0QW5ub3RhdGlvbkFjY2VzcygpLCBnZXRTaGFyZWRD
b2xvcnMoKSk7DQorCQkJY29uZmlndXJlU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQoZlNv
dXJjZVZpZXdlckRlY29yYXRpb25TdXBwb3J0KTsNCisJCX0NCisJCXJldHVybiBmU291cmNlVmll
d2VyRGVjb3JhdGlvblN1cHBvcnQ7DQorCX0NCiB9DQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZp
bGUNCkluZGV4OiBzcmMvb3JnL2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGln
aHRlci9MaW5lU3R5bGVQcm92aWRlckZvclBocC5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTog
L2N2c3Jvb3QvdG9vbHMvb3JnLmVjbGlwc2UucGR0L3BsdWdpbnMvb3JnLmVjbGlwc2UucGhwLnVp
L3NyYy9vcmcvZWNsaXBzZS9waHAvaW50ZXJuYWwvdWkvZWRpdG9yL2hpZ2hsaWdodGVyL0xpbmVT
dHlsZVByb3ZpZGVyRm9yUGhwLmphdmEsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjI5DQpkaWZm
IC11IC1yMS4yOSBMaW5lU3R5bGVQcm92aWRlckZvclBocC5qYXZhDQotLS0gc3JjL29yZy9lY2xp
cHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvTGluZVN0eWxlUHJvdmlkZXJG
b3JQaHAuamF2YQkxOCBKYW4gMjAxMCAwODoyODowMCAtMDAwMAkxLjI5DQorKysgc3JjL29yZy9l
Y2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvTGluZVN0eWxlUHJvdmlk
ZXJGb3JQaHAuamF2YQkyMiBKYW4gMjAxMCAwNjoxODoxNiAtMDAwMA0KQEAgLTM3NSw3ICszNzUs
NyBAQA0KIAkJCX0NCiAJCX0NCiAJfQ0KLQkNCisNCiAJcHJvdGVjdGVkIHZvaWQgYWRkRGVmYXVs
dFRleHRBdHRyaWJ1dGUoU3RyaW5nIGNvbG9yS2V5KSB7DQogCQlpZiAoZ2V0Q29sb3JQcmVmZXJl
bmNlcygpICE9IG51bGwpIHsNCiAJCQlTdHJpbmcgcHJlZlN0cmluZyA9IFByZWZlcmVuY2VDb25z
dGFudHMuRURJVE9SX05PUk1BTF9ERUZBVUxUX0NPTE9SOw0KQEAgLTM4Nyw3ICszODcsNyBAQA0K
IAkJCX0NCiAJCX0NCiAJfQ0KLQkNCisNCiAJLyoNCiAJICogQ3JlYXRlcyBUZXh0QXR0cmlidXRl
IGZyb20gdGhlIGdpdmVuIHN0eWxlIGRlc2NyaXB0aW9uIGFycmF5IHN0cmluZw0KIAkgKi8NCkBA
IC00MjcsNyArNDI3LDcgQEANCiAJCS8vIGluc3RlYWQgb2YgZW5kLXN0YXJ0Pw0KIAkJaWYgKGVu
ZCA+IG1heE9mZnNldCkNCiAJCQllbmQgPSBtYXhPZmZzZXQ7DQotCQlTdHlsZVJhbmdlIHJlc3Vs
dCA9IG5ldyBTdHlsZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCwgYXR0cg0KKwkJU3R5bGVSYW5n
ZSByZXN1bHQgPSBuZXcgUEhQU3R5bGVSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQsIGF0dHINCiAJ
CQkJLmdldEZvcmVncm91bmQoKSwgYXR0ci5nZXRCYWNrZ3JvdW5kKCksIGF0dHIuZ2V0U3R5bGUo
KSk7DQogCQlpZiAoKGF0dHIuZ2V0U3R5bGUoKSAmIFRleHRBdHRyaWJ1dGUuVU5ERVJMSU5FKSAh
PSAwKSB7DQogCQkJcmVzdWx0LnVuZGVybGluZSA9IHRydWU7DQpAQCAtNzE1LDcgKzcxNSw3IEBA
DQogCQkJCQkJLy8gdGhlDQogCQkJCQkJLy8gd2hpdGVzcGFjZXMNCiAJCQkJCQkvLyBhcHBseWlu
ZyBzdHlsZSB0byB0aGUgcmVnaW9uIHcvbyB0aGUgd2hpdGVzcGFjZQ0KLQkJCQkJCXN0eWxlUmFu
Z2UgPSBuZXcgU3R5bGVSYW5nZShzdHlsZVN0YXJ0LCBzdHlsZUxlbmd0aA0KKwkJCQkJCXN0eWxl
UmFuZ2UgPSBuZXcgUEhQU3R5bGVSYW5nZShzdHlsZVN0YXJ0LCBzdHlsZUxlbmd0aA0KIAkJCQkJ
CQkJLSAoZWxlbWVudC5nZXRFbmQoKSAtIGVsZW1lbnQuZ2V0VGV4dEVuZCgpKSwNCiAJCQkJCQkJ
CWF0dHIuZ2V0Rm9yZWdyb3VuZCgpLCBhdHRyLmdldEJhY2tncm91bmQoKSwNCiAJCQkJCQkJCWF0
dHIuZ2V0U3R5bGUoKSk7DQpAQCAtNzMwLDE0ICs3MzAsMTQgQEANCiAJCQkJCQlob2xkUmVzdWx0
cy5hZGQoc3R5bGVSYW5nZSk7DQogCQkJCQkJLy8gYXBwbHlpbmcgc3R5bGUgdG8gdGhlIHdoaXRl
c3BhY2UgKGltcG9ydGFudCBmb3IgdGhlDQogCQkJCQkJLy8gcmVmcmVzaCBvZiB0aGUgc3BlY2lm
aWMgcmFuZ2UNCi0JCQkJCQlzdHlsZVJhbmdlID0gbmV3IFN0eWxlUmFuZ2UocmVnaW9uU3RhcnQN
CisJCQkJCQlzdHlsZVJhbmdlID0gbmV3IFBIUFN0eWxlUmFuZ2UocmVnaW9uU3RhcnQNCiAJCQkJ
CQkJCSsgZWxlbWVudC5nZXRUZXh0RW5kKCksIGVsZW1lbnQuZ2V0RW5kKCkNCiAJCQkJCQkJCS0g
ZWxlbWVudC5nZXRUZXh0RW5kKCksIGF0dHIuZ2V0Rm9yZWdyb3VuZCgpLA0KLQkJCQkJCQkJbnVs
bCwgYXR0ci5nZXRTdHlsZSgpKTsNCisJCQkJCQkJCWF0dHIuZ2V0QmFja2dyb3VuZCgpLCBhdHRy
LmdldFN0eWxlKCkpOw0KIAkJCQkJCWhvbGRSZXN1bHRzLmFkZChzdHlsZVJhbmdlKTsNCiAJCQkJ
CQlwcmV2aW91c0F0dHIgPSBudWxsOw0KIAkJCQkJfSBlbHNlIHsNCi0JCQkJCQlzdHlsZVJhbmdl
ID0gbmV3IFN0eWxlUmFuZ2Uoc3R5bGVTdGFydCwgc3R5bGVMZW5ndGgsDQorCQkJCQkJc3R5bGVS
YW5nZSA9IG5ldyBQSFBTdHlsZVJhbmdlKHN0eWxlU3RhcnQsIHN0eWxlTGVuZ3RoLA0KIAkJCQkJ
CQkJYXR0ci5nZXRGb3JlZ3JvdW5kKCksIGF0dHIuZ2V0QmFja2dyb3VuZCgpLA0KIAkJCQkJCQkJ
YXR0ci5nZXRTdHlsZSgpKTsNCiAJCQkJCQlpZiAoKGF0dHIuZ2V0U3R5bGUoKSAmIFRleHRBdHRy
aWJ1dGUuVU5ERVJMSU5FKSAhPSAwKSB7DQpAQCAtODM5LDI5ICs4MzksNDggQEANCiAJCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0hFUkVET0NfQ09MT1IuZXF1YWxzKHByZWZLZXkp
DQogCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9UQVNLX0NPTE9SLmVxdWFscyhw
cmVmS2V5KSkgew0KIAkJCQlhZGRUZXh0QXR0cmlidXRlKHByZWZLZXkpOw0KLQkJCX0gZWxzZSBp
ZiAoUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNl
Q29uc3RhbnRzLkVESVRPUl9OT1JNQUxfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJfHwg
UHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNlQ29u
c3RhbnRzLkVESVRPUl9CT1VOREFSWU1BUktFUl9DT0xPUikNCi0JCQkJCQkJLmVxdWFscyhwcmVm
S2V5KQ0KLQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtl
eShQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9LRVlXT1JEX0NPTE9SKS5lcXVhbHMocHJlZktl
eSkNCi0JCQkJCXx8IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXko
UHJlZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfVkFSSUFCTEVfQ09MT1IpDQorCQkJfSBlbHNlIGlm
IChQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJUHJl
ZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfTk9STUFMX0NPTE9SKS5lcXVhbHMocHJlZktleSkNCisJ
CQkJCXx8IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoDQorCQkJ
CQkJCVByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0JPVU5EQVJZTUFSS0VSX0NPTE9SKQ0KIAkJ
CQkJCQkuZXF1YWxzKHByZWZLZXkpDQotCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVu
YWJsZWRQcmVmZXJlbmNlS2V5KFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX1NUUklOR19DT0xP
UikuZXF1YWxzKHByZWZLZXkpDQotCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJs
ZWRQcmVmZXJlbmNlS2V5KFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0NPTU1FTlRfQ09MT1Ip
LmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVk
UHJlZmVyZW5jZUtleShQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9MSU5FX0NPTU1FTlRfQ09M
T1IpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5
KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9LRVlXT1JEX0NPTE9SKS5lcXVh
bHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVu
YWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9W
QVJJQUJMRV9DT0xPUikuZXF1YWxzKA0KKwkJCQkJCQlwcmVmS2V5KQ0KKwkJCQkJfHwgUHJlZmVy
ZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleSgNCisJCQkJCQkJUHJlZmVyZW5j
ZUNvbnN0YW50cy5FRElUT1JfU1RSSU5HX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkp
DQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0K
KwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9DT01NRU5UX0NPTE9SKS5lcXVhbHMo
DQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJs
ZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9MSU5F
X0NPTU1FTlRfQ09MT1IpDQogCQkJCQkJCS5lcXVhbHMocHJlZktleSkNCi0JCQkJCXx8IFByZWZl
cmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoUHJlZmVyZW5jZUNvbnN0YW50
cy5FRElUT1JfUEhQRE9DX0NPTU1FTlRfQ09MT1IpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3Rh
bnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRz
LkVESVRPUl9QSFBET0NfQ09NTUVOVF9DT0xPUikNCiAJCQkJCQkJLmVxdWFscyhwcmVmS2V5KQ0K
LQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVm
ZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9QSFBET0NfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJ
CQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJl
bmNlQ29uc3RhbnRzLkVESVRPUl9OVU1CRVJfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJ
fHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNl
Q29uc3RhbnRzLkVESVRPUl9IRVJFRE9DX0NPTE9SKS5lcXVhbHMocHJlZktleSkNCi0JCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoUHJlZmVyZW5jZUNv
bnN0YW50cy5FRElUT1JfVEFTS19DT0xPUikuZXF1YWxzKHByZWZLZXkpKSB7DQotCQkJCQlib29s
ZWFuIGVuYWJsZWQgPSBnZXRDb2xvclByZWZlcmVuY2VzKCkuZ2V0Qm9vbGVhbihwcmVmS2V5KTsN
Ci0JCQkJCXByZWZLZXkgPSBwcmVmS2V5LnNwbGl0KCJcXC4iKVsxXTsNCi0JCQkJCWlmKGVuYWJs
ZWQpew0KLQkJCQkJCWFkZFRleHRBdHRyaWJ1dGUocHJlZktleSk7DQotCQkJCQl9ZWxzZXsNCi0J
CQkJCQlhZGREZWZhdWx0VGV4dEF0dHJpYnV0ZShwcmVmS2V5KTsNCi0JCQkJCX0NCisJCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoDQorCQkJCQkJCVBy
ZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX1BIUERPQ19DT0xPUikuZXF1YWxzKA0KKwkJCQkJCQlw
cmVmS2V5KQ0KKwkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5j
ZUtleSgNCisJCQkJCQkJUHJlZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfTlVNQkVSX0NPTE9SKS5l
cXVhbHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdl
dEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRP
Ul9IRVJFRE9DX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVm
ZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJl
bmNlQ29uc3RhbnRzLkVESVRPUl9UQVNLX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkp
KSB7DQorCQkJCWJvb2xlYW4gZW5hYmxlZCA9IGdldENvbG9yUHJlZmVyZW5jZXMoKS5nZXRCb29s
ZWFuKHByZWZLZXkpOw0KKwkJCQlwcmVmS2V5ID0gcHJlZktleS5zcGxpdCgiXFwuIilbMV07DQor
CQkJCWlmIChlbmFibGVkKSB7DQorCQkJCQlhZGRUZXh0QXR0cmlidXRlKHByZWZLZXkpOw0KKwkJ
CQl9IGVsc2Ugew0KKwkJCQkJYWRkRGVmYXVsdFRleHRBdHRyaWJ1dGUocHJlZktleSk7DQorCQkJ
CX0NCiAJCQl9DQogCQl9IGVsc2Ugew0KIAkJCWxvYWRDb2xvcnMoKTsNCkluZGV4OiBzcmMvb3Jn
L2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJhbmdl
LmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiBzcmMvb3JnL2VjbGlwc2UvcGhwL2ludGVybmFs
L3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJhbmdlLmphdmENCmRpZmYgLU4gc3JjL29y
Zy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvUEhQU3R5bGVSYW5n
ZS5qYXZhDQotLS0gL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCisrKyBzcmMv
b3JnL2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJh
bmdlLmphdmEJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KQEAgLTAsMCArMSw1OCBAQA0KK3Bh
Y2thZ2Ugb3JnLmVjbGlwc2UucGhwLmludGVybmFsLnVpLmVkaXRvci5oaWdobGlnaHRlcjsNCisN
CitpbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsNCitpbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9y
Ow0KK2ltcG9ydCBqYXZhLnV0aWwuTGlzdDsNCisNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmN1
c3RvbS5TdHlsZVJhbmdlOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuZ3JhcGhpY3MuQ29sb3I7
DQorDQorcHVibGljIGNsYXNzIFBIUFN0eWxlUmFuZ2UgZXh0ZW5kcyBTdHlsZVJhbmdlIHsNCisJ
cHJpdmF0ZSBmaW5hbCBDb2xvciByZWFsYmFja2dyb3VuZDsNCisJcHJpdmF0ZSBMaXN0PFBIUFN0
eWxlUmFuZ2U+IGFsbENsb25lcyA9IG5ldyBBcnJheUxpc3Q8UEhQU3R5bGVSYW5nZT4oKTsNCisN
CisJcHVibGljIFBIUFN0eWxlUmFuZ2UoaW50IHN0YXJ0LCBpbnQgbGVuZ3RoLCBDb2xvciBmb3Jl
Z3JvdW5kLA0KKwkJCUNvbG9yIGJhY2tncm91bmQsIGludCBmb250U3R5bGUpIHsNCisJCXN1cGVy
KHN0YXJ0LCBsZW5ndGgsIGZvcmVncm91bmQsIGJhY2tncm91bmQsIGZvbnRTdHlsZSk7DQorCQl0
aGlzLnJlYWxiYWNrZ3JvdW5kID0gYmFja2dyb3VuZDsNCisJCWFsbENsb25lcy5hZGQodGhpcyk7
DQorCX0NCisNCisJLyoqDQorCSAqIHdoZW4gdGhpcyBQSFBTdHlsZVJhbmdlIGlzIGluIG9uZSB0
aGUgY3VycmVjdCBsaW5lLGNhbGwgdGhpcyBtZXRob2QNCisJICovDQorCXB1YmxpYyB2b2lkIGNs
ZWFyQmFja2dyb3VuZCgpIHsNCisJCWZvciAoSXRlcmF0b3I8UEhQU3R5bGVSYW5nZT4gaXRlcmF0
b3IgPSBhbGxDbG9uZXMuaXRlcmF0b3IoKTsgaXRlcmF0b3INCisJCQkJLmhhc05leHQoKTspIHsN
CisJCQlQSFBTdHlsZVJhbmdlIHN0eWxlUmFuZ2UgPSAoUEhQU3R5bGVSYW5nZSkgaXRlcmF0b3Iu
bmV4dCgpOw0KKwkJCXN0eWxlUmFuZ2UuYmFja2dyb3VuZCA9IG51bGw7DQorCQl9DQorCX0NCisN
CisJLyoqDQorCSAqIHdoZW4gdGhpcyBQSFBTdHlsZVJhbmdlIGlzIE5PVCBpbiBvbmUgdGhlIGN1
cnJlY3QgbGluZSxjYWxsIHRoaXMgbWV0aG9kDQorCSAqLw0KKwlwdWJsaWMgdm9pZCByZXNldEJh
Y2tncm91bmQoKSB7DQorCQlmb3IgKEl0ZXJhdG9yPFBIUFN0eWxlUmFuZ2U+IGl0ZXJhdG9yID0g
YWxsQ2xvbmVzLml0ZXJhdG9yKCk7IGl0ZXJhdG9yDQorCQkJCS5oYXNOZXh0KCk7KSB7DQorCQkJ
UEhQU3R5bGVSYW5nZSBzdHlsZVJhbmdlID0gKFBIUFN0eWxlUmFuZ2UpIGl0ZXJhdG9yLm5leHQo
KTsNCisJCQlzdHlsZVJhbmdlLmJhY2tncm91bmQgPSByZWFsYmFja2dyb3VuZDsNCisJCX0NCisJ
fQ0KKw0KKwkvLyBAT3ZlcnJpZGUNCisJcHVibGljIE9iamVjdCBjbG9uZSgpIHsNCisJCVBIUFN0
eWxlUmFuZ2UgY2xvbmUgPSAoUEhQU3R5bGVSYW5nZSkgc3VwZXIuY2xvbmUoKTsNCisJCS8vIHRo
aXMgaXMgaW1wb3J0YW50IGZvciBTdHlsZWRUZXh0IGFsd2F5cyByZXR1cm4gdGhlIGNsb25lcyBv
ZiBpdHMNCisJCS8vIFN0eWxlUmFuZ2Usc28gaWYgd2Ugbm90IGNvbGxlY3QgYWxsIHRoZSBjbG9u
ZXMoaW5jbHVkaW5nIGl0c2VsZiksd2hlbg0KKwkJLy8gd2Ugc2V0IGl0cyBiYWNrZ3JvdW5kIHdp
bGwgbWFrZSBubyBlZmZlY3QsZm9yIHlvdSBhbHdheXMgY2hhbmdlIGl0cw0KKwkJLy8gY2xvbmUg
b2JqZWN0J3MgYmFja2dyb3VuZCBwcm9wZXJ0eQ0KKwkJYWxsQ2xvbmVzLmFkZChjbG9uZSk7DQor
CQlyZXR1cm4gY2xvbmU7DQorCX0NCisNCisJcHVibGljIHZvaWQgcmVtb3ZlU2VsZigpIHsNCisJ
CS8vIFRPRE8gQXV0by1nZW5lcmF0ZWQgbWV0aG9kIHN0dWINCisJCWFsbENsb25lcy5yZW1vdmUo
dGhpcyk7DQorCX0NCit9DQpJbmRleDogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9l
ZGl0b3IvUEhQQ3Vyc29yTGluZVBhaW50ZXIuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IHNy
Yy9vcmcvZWNsaXBzZS9waHAvaW50ZXJuYWwvdWkvZWRpdG9yL1BIUEN1cnNvckxpbmVQYWludGVy
LmphdmENCmRpZmYgLU4gc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQ
Q3Vyc29yTGluZVBhaW50ZXIuamF2YQ0KLS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAw
IC0wMDAwDQorKysgc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQQ3Vy
c29yTGluZVBhaW50ZXIuamF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsx
LDI2NCBAQA0KK3BhY2thZ2Ugb3JnLmVjbGlwc2UucGhwLmludGVybmFsLnVpLmVkaXRvcjsNCisN
CitpbXBvcnQgb3JnLmVjbGlwc2UuamZhY2UudGV4dC4qOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5w
aHAuaW50ZXJuYWwudWkuZWRpdG9yLmhpZ2hsaWdodGVyLlBIUFN0eWxlUmFuZ2U7DQoraW1wb3J0
IG9yZy5lY2xpcHNlLnN3dC5jdXN0b20uTGluZUJhY2tncm91bmRFdmVudDsNCitpbXBvcnQgb3Jn
LmVjbGlwc2Uuc3d0LmN1c3RvbS5MaW5lQmFja2dyb3VuZExpc3RlbmVyOw0KK2ltcG9ydCBvcmcu
ZWNsaXBzZS5zd3QuY3VzdG9tLlN0eWxlUmFuZ2U7DQoraW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5j
dXN0b20uU3R5bGVkVGV4dDsNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmdyYXBoaWNzLlBvaW50
Ow0KKw0KK3B1YmxpYyBjbGFzcyBQSFBDdXJzb3JMaW5lUGFpbnRlciBpbXBsZW1lbnRzIElQYWlu
dGVyLCBMaW5lQmFja2dyb3VuZExpc3RlbmVyIHsNCisNCisJLyoqIFRoZSB2aWV3ZXIgdGhlIHBh
aW50ZXIgd29ya3Mgb24gKi8NCisJcHJpdmF0ZSBmaW5hbCBJVGV4dFZpZXdlciBmVmlld2VyOw0K
KwkvKiogVGhlIHBhaW50IHBvc2l0aW9uIG1hbmFnZXIgZm9yIG1hbmFnaW5nIHRoZSBsaW5lIGNv
b3JkaW5hdGVzICovDQorCXByaXZhdGUgSVBhaW50UG9zaXRpb25NYW5hZ2VyIGZQb3NpdGlvbk1h
bmFnZXI7DQorCS8qKiBLZWVwcyB0cmFjayBvZiB0aGUgbGluZSB0byBiZSBwYWludGVkICovDQor
CXByaXZhdGUgUG9zaXRpb24gZkN1cnJlbnRMaW5lID0gbmV3IFBvc2l0aW9uKDAsIDApOw0KKwkv
KiogS2VlcHMgdHJhY2sgb2YgdGhlIGxpbmUgdG8gYmUgY2xlYXJlZCAqLw0KKwlwcml2YXRlIFBv
c2l0aW9uIGZMYXN0TGluZSA9IG5ldyBQb3NpdGlvbigwLCAwKTsNCisJLyoqIEtlZXBzIHRyYWNr
IG9mIHRoZSBsaW5lIG51bWJlciBvZiB0aGUgbGFzdCBwYWludGVkIGxpbmUgKi8NCisJcHJpdmF0
ZSBpbnQgZkxhc3RMaW5lTnVtYmVyID0gLTE7DQorCS8qKiBJbmRpY2F0ZXMgd2hldGhlciB0aGlz
IHBhaW50ZXIgaXMgYWN0aXZlICovDQorCXByaXZhdGUgYm9vbGVhbiBmSXNBY3RpdmU7DQorDQor
CS8qKg0KKwkgKiBDcmVhdGVzIGEgbmV3IHBhaW50ZXIgZm9yIHRoZSBnaXZlbiBzb3VyY2Ugdmll
d2VyLg0KKwkgKiANCisJICogQHBhcmFtIHRleHRWaWV3ZXINCisJICogICAgICAgICAgICB0aGUg
c291cmNlIHZpZXdlciBmb3Igd2hpY2ggdG8gY3JlYXRlIGEgcGFpbnRlcg0KKwkgKi8NCisJcHVi
bGljIFBIUEN1cnNvckxpbmVQYWludGVyKElUZXh0Vmlld2VyIHRleHRWaWV3ZXIpIHsNCisJCWZW
aWV3ZXIgPSB0ZXh0Vmlld2VyOw0KKwl9DQorDQorCS8qKg0KKwkgKiBTZXRzIHRoZSBjb2xvciBp
biB3aGljaCB0byBkcmF3IHRoZSBiYWNrZ3JvdW5kIG9mIHRoZSBjdXJzb3IgbGluZS4NCisJICog
DQorCSAqIEBwYXJhbSBoaWdobGlnaHRDb2xvcg0KKwkgKiAgICAgICAgICAgIHRoZSBjb2xvciBp
biB3aGljaCB0byBkcmF3IHRoZSBiYWNrZ3JvdW5kIG9mIHRoZSBjdXJzb3IgbGluZQ0KKwkgKi8N
CisNCisJLyoNCisJICogQHNlZSBMaW5lQmFja2dyb3VuZExpc3RlbmVyI2xpbmVHZXRCYWNrZ3Jv
dW5kKExpbmVCYWNrZ3JvdW5kRXZlbnQpDQorCSAqLw0KKwlwdWJsaWMgdm9pZCBsaW5lR2V0QmFj
a2dyb3VuZChMaW5lQmFja2dyb3VuZEV2ZW50IGV2ZW50KSB7DQorCX0NCisNCisJLyoqDQorCSAq
IFVwZGF0ZXMgYWxsIHRoZSBjYWNoZWQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGxpbmVzIHRvIGJl
IHBhaW50ZWQgYW5kIHRvDQorCSAqIGJlIGNsZWFyZWQuIFJldHVybnMgPGNvZGU+dHJ1ZTwvY29k
ZT4gaWYgdGhlIGxpbmUgbnVtYmVyIG9mIHRoZSBjdXJzb3INCisJICogbGluZSBoYXMgY2hhbmdl
ZC4NCisJICogDQorCSAqIEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgY3Vyc29yIGxpbmUg
Y2hhbmdlZA0KKwkgKi8NCisJcHJpdmF0ZSBib29sZWFuIHVwZGF0ZUhpZ2hsaWdodExpbmUoKSB7
DQorCQl0cnkgew0KKw0KKwkJCUlEb2N1bWVudCBkb2N1bWVudCA9IGZWaWV3ZXIuZ2V0RG9jdW1l
bnQoKTsNCisJCQlpbnQgbW9kZWxDYXJldCA9IGdldE1vZGVsQ2FyZXQoKTsNCisJCQlpbnQgbGlu
ZU51bWJlciA9IGRvY3VtZW50LmdldExpbmVPZk9mZnNldChtb2RlbENhcmV0KTsNCisNCisJCQkv
LyByZWRyYXcgaWYgdGhlIGN1cnJlbnQgbGluZSBudW1iZXIgaXMgZGlmZmVyZW50IGZyb20gdGhl
IGxhc3QgbGluZQ0KKwkJCS8vIG51bWJlciB3ZSBwYWludGVkDQorCQkJLy8gaW5pdGlhbGx5IGZM
YXN0TGluZU51bWJlciBpcyAtMQ0KKwkJCWlmIChsaW5lTnVtYmVyICE9IGZMYXN0TGluZU51bWJl
cg0KKwkJCQkJfHwgIWZDdXJyZW50TGluZS5vdmVybGFwc1dpdGgobW9kZWxDYXJldCwgMCkpIHsN
CisNCisJCQkJZkxhc3RMaW5lLm9mZnNldCA9IGZDdXJyZW50TGluZS5vZmZzZXQ7DQorCQkJCWZM
YXN0TGluZS5sZW5ndGggPSBmQ3VycmVudExpbmUubGVuZ3RoOw0KKwkJCQlmTGFzdExpbmUuaXNE
ZWxldGVkID0gZkN1cnJlbnRMaW5lLmlzRGVsZXRlZDsNCisNCisJCQkJaWYgKGZDdXJyZW50TGlu
ZS5pc0RlbGV0ZWQpIHsNCisJCQkJCWZDdXJyZW50TGluZS5pc0RlbGV0ZWQgPSBmYWxzZTsNCisJ
CQkJCWZQb3NpdGlvbk1hbmFnZXIubWFuYWdlUG9zaXRpb24oZkN1cnJlbnRMaW5lKTsNCisJCQkJ
fQ0KKw0KKwkJCQlmQ3VycmVudExpbmUub2Zmc2V0ID0gZG9jdW1lbnQuZ2V0TGluZU9mZnNldChs
aW5lTnVtYmVyKTsNCisJCQkJaWYgKGxpbmVOdW1iZXIgPT0gZG9jdW1lbnQuZ2V0TnVtYmVyT2ZM
aW5lcygpIC0gMSkNCisJCQkJCWZDdXJyZW50TGluZS5sZW5ndGggPSBkb2N1bWVudC5nZXRMZW5n
dGgoKQ0KKwkJCQkJCQktIGZDdXJyZW50TGluZS5vZmZzZXQ7DQorCQkJCWVsc2UNCisJCQkJCWZD
dXJyZW50TGluZS5sZW5ndGggPSBkb2N1bWVudA0KKwkJCQkJCQkuZ2V0TGluZU9mZnNldChsaW5l
TnVtYmVyICsgMSkNCisJCQkJCQkJLSBmQ3VycmVudExpbmUub2Zmc2V0Ow0KKw0KKwkJCQlmTGFz
dExpbmVOdW1iZXIgPSBsaW5lTnVtYmVyOw0KKwkJCQlyZXR1cm4gdHJ1ZTsNCisNCisJCQl9DQor
DQorCQl9IGNhdGNoIChCYWRMb2NhdGlvbkV4Y2VwdGlvbiBlKSB7DQorCQl9DQorDQorCQlyZXR1
cm4gZmFsc2U7DQorCX0NCisNCisJLyoqDQorCSAqIFJldHVybnMgdGhlIGxvY2F0aW9uIG9mIHRo
ZSBjYXJldCBhcyBvZmZzZXQgaW4gdGhlIHNvdXJjZSB2aWV3ZXIncyBpbnB1dA0KKwkgKiBkb2N1
bWVudC4NCisJICogDQorCSAqIEByZXR1cm4gdGhlIGNhcmV0IGxvY2F0aW9uDQorCSAqLw0KKwlw
cml2YXRlIGludCBnZXRNb2RlbENhcmV0KCkgew0KKwkJaW50IHdpZGdldENhcmV0ID0gZlZpZXdl
ci5nZXRUZXh0V2lkZ2V0KCkuZ2V0Q2FyZXRPZmZzZXQoKTsNCisJCWlmIChmVmlld2VyIGluc3Rh
bmNlb2YgSVRleHRWaWV3ZXJFeHRlbnNpb241KSB7DQorCQkJSVRleHRWaWV3ZXJFeHRlbnNpb241
IGV4dGVuc2lvbiA9IChJVGV4dFZpZXdlckV4dGVuc2lvbjUpIGZWaWV3ZXI7DQorCQkJcmV0dXJu
IGV4dGVuc2lvbi53aWRnZXRPZmZzZXQyTW9kZWxPZmZzZXQod2lkZ2V0Q2FyZXQpOw0KKwkJfQ0K
KwkJSVJlZ2lvbiB2aXNpYmxlID0gZlZpZXdlci5nZXRWaXNpYmxlUmVnaW9uKCk7DQorCQlyZXR1
cm4gd2lkZ2V0Q2FyZXQgKyB2aXNpYmxlLmdldE9mZnNldCgpOw0KKwl9DQorDQorCS8qDQorCSAq
IEBzZWUgSVBhaW50ZXIjZGVhY3RpdmF0ZShib29sZWFuKQ0KKwkgKi8NCisJcHVibGljIHZvaWQg
ZGVhY3RpdmF0ZShib29sZWFuIHJlZHJhdykgew0KKwkJaWYgKGZJc0FjdGl2ZSkgew0KKwkJCWZJ
c0FjdGl2ZSA9IGZhbHNlOw0KKwkJCWZWaWV3ZXIuZ2V0VGV4dFdpZGdldCgpLnJlbW92ZUxpbmVC
YWNrZ3JvdW5kTGlzdGVuZXIodGhpcyk7DQorCQkJLy8NCisJCQlpZiAoZlBvc2l0aW9uTWFuYWdl
ciAhPSBudWxsKQ0KKwkJCQlmUG9zaXRpb25NYW5hZ2VyLnVubWFuYWdlUG9zaXRpb24oZkN1cnJl
bnRMaW5lKTsNCisNCisJCQlmTGFzdExpbmVOdW1iZXIgPSAtMTsNCisJCQlmQ3VycmVudExpbmUu
b2Zmc2V0ID0gMDsNCisJCQlmQ3VycmVudExpbmUubGVuZ3RoID0gMDsNCisJCX0NCisJfQ0KKw0K
KwkvKg0KKwkgKiBAc2VlIElQYWludGVyI2Rpc3Bvc2UoKQ0KKwkgKi8NCisJcHVibGljIHZvaWQg
ZGlzcG9zZSgpIHsNCisJfQ0KKw0KKwkvKg0KKwkgKiBAc2VlIElQYWludGVyI3BhaW50KGludCkN
CisJICovDQorCXB1YmxpYyB2b2lkIHBhaW50KGludCByZWFzb24pIHsNCisJCWlmIChmVmlld2Vy
LmdldERvY3VtZW50KCkgPT0gbnVsbCkgew0KKwkJCWRlYWN0aXZhdGUoZmFsc2UpOw0KKwkJCXJl
dHVybjsNCisJCX0NCisNCisJCVN0eWxlZFRleHQgdGV4dFdpZGdldCA9IGZWaWV3ZXIuZ2V0VGV4
dFdpZGdldCgpOw0KKw0KKwkJLy8gY2hlY2sgc2VsZWN0aW9uDQorCQlpZiAoaGFzTXVsdGlMaW5l
U2VsZWN0aW9uKHRleHRXaWRnZXQpKSB7DQorCQkJZGVhY3RpdmF0ZSh0cnVlKTsNCisJCQlyZXR1
cm47DQorCQl9DQorDQorCQkvLyBpbml0aWFsaXphdGlvbg0KKwkJaWYgKCFmSXNBY3RpdmUpIHsN
CisJCQl0ZXh0V2lkZ2V0LmFkZExpbmVCYWNrZ3JvdW5kTGlzdGVuZXIodGhpcyk7DQorCQkJZklz
QWN0aXZlID0gdHJ1ZTsNCisJCX0NCisNCisJCWludCBvbGRMYXN0TGluZU51bWJlciA9IGZMYXN0
TGluZU51bWJlcjsNCisNCisJCXVwZGF0ZUhpZ2hsaWdodExpbmUoKTsNCisJCWlmIChvbGRMYXN0
TGluZU51bWJlciAhPSAtMSAmJiBvbGRMYXN0TGluZU51bWJlciAhPSBmTGFzdExpbmVOdW1iZXIp
IHsNCisJCQkvLyByZWNvdmVyIHRoZSBvbGQgc3R5bGVkIHJhbmdlIGJhY2tncm91bmQgY29sb3IN
CisJCQlpbnQgbGluZU9mZnNldCA9IHRleHRXaWRnZXQuZ2V0T2Zmc2V0QXRMaW5lKG9sZExhc3RM
aW5lTnVtYmVyKTsNCisJCQlTdHJpbmcgbGluZSA9IHRleHRXaWRnZXQuZ2V0TGluZShvbGRMYXN0
TGluZU51bWJlcik7DQorCQkJaW50IGxpbmVMZW5ndGggPSBsaW5lLmxlbmd0aCgpOw0KKwkJCVN0
eWxlUmFuZ2VbXSByYW5nZXMgPSB0ZXh0V2lkZ2V0LmdldFN0eWxlUmFuZ2VzKGxpbmVPZmZzZXQs
DQorCQkJCQlsaW5lTGVuZ3RoKTsNCisJCQlmb3IgKGludCBpID0gMDsgaSA8IHJhbmdlcy5sZW5n
dGg7IGkrKykgew0KKwkJCQlTdHlsZVJhbmdlIHN0eWxlUmFuZ2UgPSByYW5nZXNbaV07DQorCQkJ
CWlmIChzdHlsZVJhbmdlIGluc3RhbmNlb2YgUEhQU3R5bGVSYW5nZSkgew0KKwkJCQkJUEhQU3R5
bGVSYW5nZSBwaHBTdHlsZVJhbmdlID0gKFBIUFN0eWxlUmFuZ2UpIHN0eWxlUmFuZ2U7DQorCQkJ
CQlwaHBTdHlsZVJhbmdlLnJlc2V0QmFja2dyb3VuZCgpOw0KKwkJCQkJcGhwU3R5bGVSYW5nZS5y
ZW1vdmVTZWxmKCk7DQorCQkJCX0NCisJCQl9DQorCQl9DQorDQorCQkvLyBzZXQgdGhpcyBsaW5l
J3Mgc3R5bGVkIHJhbmdlIGJhY2tncm91bmQgY29sb3IgdG8gbnVsbA0KKwkJaW50IHN0YXJ0ID0g
dGV4dFdpZGdldC5nZXRPZmZzZXRBdExpbmUoZkxhc3RMaW5lTnVtYmVyKTsNCisJCVN0eWxlUmFu
Z2VbXSByYW5nZXMgPSB0ZXh0V2lkZ2V0LmdldFN0eWxlUmFuZ2VzKHN0YXJ0LCB0ZXh0V2lkZ2V0
DQorCQkJCS5nZXRMaW5lKGZMYXN0TGluZU51bWJlcikubGVuZ3RoKCkpOw0KKwkJZm9yIChpbnQg
aSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspIHsNCisJCQlTdHlsZVJhbmdlIHN0eWxlUmFu
Z2UgPSByYW5nZXNbaV07DQorCQkJaWYgKHN0eWxlUmFuZ2UgaW5zdGFuY2VvZiBQSFBTdHlsZVJh
bmdlKSB7DQorCQkJCVBIUFN0eWxlUmFuZ2UgcGhwU3R5bGVSYW5nZSA9IChQSFBTdHlsZVJhbmdl
KSBzdHlsZVJhbmdlOw0KKwkJCQlwaHBTdHlsZVJhbmdlLmNsZWFyQmFja2dyb3VuZCgpOw0KKwkJ
CQlwaHBTdHlsZVJhbmdlLnJlbW92ZVNlbGYoKTsNCisJCQl9DQorCQl9DQorCQkvLyBkcmF3IG5l
dyBsaW5lLHdlIG11c3QgY2FsbCB0aGlzIG1ldGhvZCB0byByZWRyYXcgdGhlIGN1cnJlbnQgbGlu
ZQ0KKwkJLy8gYmVjYXVzZSB3aGVuIHdlIG1vZGlmeSB0ZXh0IEN1cnNvckxpbmVQYWludGVyIHdp
bGwgbm90IHJlZHJhdyB0aGUNCisJCS8vIGN1cnJlbnQgbGluZSx0aGVuIHBocFN0eWxlUmFuZ2Uu
Y2xlYXJCYWNrZ3JvdW5kKCkgbWFrZXMgbm8gZWZmZWN0DQorCQlkcmF3SGlnaGxpZ2h0TGluZShm
TGFzdExpbmUpOw0KKwkJZHJhd0hpZ2hsaWdodExpbmUoZkN1cnJlbnRMaW5lKTsNCisJfQ0KKw0K
Kwlwcml2YXRlIHZvaWQgZHJhd0hpZ2hsaWdodExpbmUoUG9zaXRpb24gcG9zaXRpb24pIHsNCisN
CisJCS8vIGlmIHRoZSBwb3NpdGlvbiB0aGF0IGlzIGFib3V0IHRvIGJlIGRyYXduIHdhcyBkZWxl
dGVkIHRoZW4gd2UgY2FuJ3QNCisJCWlmIChwb3NpdGlvbi5pc0RlbGV0ZWQoKSkNCisJCQlyZXR1
cm47DQorDQorCQlpbnQgd2lkZ2V0T2Zmc2V0ID0gMDsNCisJCWlmIChmVmlld2VyIGluc3RhbmNl
b2YgSVRleHRWaWV3ZXJFeHRlbnNpb241KSB7DQorDQorCQkJSVRleHRWaWV3ZXJFeHRlbnNpb241
IGV4dGVuc2lvbiA9IChJVGV4dFZpZXdlckV4dGVuc2lvbjUpIGZWaWV3ZXI7DQorCQkJd2lkZ2V0
T2Zmc2V0ID0gZXh0ZW5zaW9uLm1vZGVsT2Zmc2V0MldpZGdldE9mZnNldChwb3NpdGlvbg0KKwkJ
CQkJLmdldE9mZnNldCgpKTsNCisJCQlpZiAod2lkZ2V0T2Zmc2V0ID09IC0xKQ0KKwkJCQlyZXR1
cm47DQorDQorCQl9IGVsc2Ugew0KKw0KKwkJCUlSZWdpb24gdmlzaWJsZSA9IGZWaWV3ZXIuZ2V0
VmlzaWJsZVJlZ2lvbigpOw0KKwkJCXdpZGdldE9mZnNldCA9IHBvc2l0aW9uLmdldE9mZnNldCgp
IC0gdmlzaWJsZS5nZXRPZmZzZXQoKTsNCisJCQlpZiAod2lkZ2V0T2Zmc2V0IDwgMCB8fCB2aXNp
YmxlLmdldExlbmd0aCgpIDwgd2lkZ2V0T2Zmc2V0KQ0KKwkJCQlyZXR1cm47DQorCQl9DQorDQor
CQlTdHlsZWRUZXh0IHRleHRXaWRnZXQgPSBmVmlld2VyLmdldFRleHRXaWRnZXQoKTsNCisJCS8v
IGNoZWNrIGZvciBodHRwczovL2J1Z3MuZWNsaXBzZS5vcmcvYnVncy9zaG93X2J1Zy5jZ2k/aWQ9
NjQ4OTgNCisJCS8vIHRoaXMgaXMgYSBndWFyZCBhZ2FpbnN0IHRoZSBzeW1wdG9tcyBidXQgbm90
IHRoZSBhY3R1YWwgc29sdXRpb24NCisJCWlmICgwIDw9IHdpZGdldE9mZnNldCAmJiB3aWRnZXRP
ZmZzZXQgPD0gdGV4dFdpZGdldC5nZXRDaGFyQ291bnQoKSkgew0KKwkJCVBvaW50IHVwcGVyTGVm
dCA9IHRleHRXaWRnZXQuZ2V0TG9jYXRpb25BdE9mZnNldCh3aWRnZXRPZmZzZXQpOw0KKwkJCWlu
dCB3aWR0aCA9IHRleHRXaWRnZXQuZ2V0Q2xpZW50QXJlYSgpLndpZHRoDQorCQkJCQkrIHRleHRX
aWRnZXQuZ2V0SG9yaXpvbnRhbFBpeGVsKCk7DQorCQkJaW50IGhlaWdodCA9IHRleHRXaWRnZXQu
Z2V0TGluZUhlaWdodCh3aWRnZXRPZmZzZXQpOw0KKwkJCXRleHRXaWRnZXQucmVkcmF3KDAsIHVw
cGVyTGVmdC55LCB3aWR0aCwgaGVpZ2h0LCBmYWxzZSk7DQorCQl9DQorCX0NCisNCisJLyoqDQor
CSAqIFJldHVybnMgPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIHdpZGdldCBoYXMgYSBzZWxlY3Rp
b24gc3Bhbm5pbmcgbXVsdGlwbGUNCisJICogbGluZXMsIDxjb2RlPmZhbHNlPC9jb2RlPiBvdGhl
cndpc2UuDQorCSAqIA0KKwkgKiBAcGFyYW0gdGV4dFdpZGdldA0KKwkgKiAgICAgICAgICAgIHRo
ZSB0ZXh0IHdpZGdldCB0byBjaGVjaw0KKwkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlm
IDxjb2RlPnRleHRXaWRnZXQ8L2NvZGU+IGhhcyBhIG11bHRpbGluZQ0KKwkgKiAgICAgICAgIHNl
bGVjdGlvbiwgPGNvZGU+ZmFsc2U8L2NvZGU+IG90aGVyd2lzZQ0KKwkgKiBAc2luY2UgMy41DQor
CSAqLw0KKwlwcml2YXRlIGJvb2xlYW4gaGFzTXVsdGlMaW5lU2VsZWN0aW9uKFN0eWxlZFRleHQg
dGV4dFdpZGdldCkgew0KKwkJUG9pbnQgc2VsZWN0aW9uID0gdGV4dFdpZGdldC5nZXRTZWxlY3Rp
b24oKTsNCisJCXRyeSB7DQorCQkJaW50IHN0YXJ0TGluZSA9IHRleHRXaWRnZXQuZ2V0TGluZUF0
T2Zmc2V0KHNlbGVjdGlvbi54KTsNCisJCQlpbnQgZW5kTGluZSA9IHRleHRXaWRnZXQuZ2V0TGlu
ZUF0T2Zmc2V0KHNlbGVjdGlvbi55KTsNCisJCQlyZXR1cm4gc3RhcnRMaW5lICE9IGVuZExpbmU7
DQorCQl9IGNhdGNoIChJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gZSkgew0KKwkJCS8vIGlnbm9y
ZSAtIGFwcGFyZW50bHksIHRoZSB3aWRnZXQgaGFzIGEgc3RhbGUgc2VsZWN0aW9uDQorCQkJLy8g
c2VlIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD0yNzM3MjEN
CisJCQlyZXR1cm4gZmFsc2U7DQorCQl9DQorCX0NCisNCisJLy8NCisJLy8gLyoNCisJLy8gKiBA
c2VlIElQYWludGVyI3NldFBvc2l0aW9uTWFuYWdlcihJUGFpbnRQb3NpdGlvbk1hbmFnZXIpDQor
CS8vICovDQorCXB1YmxpYyB2b2lkIHNldFBvc2l0aW9uTWFuYWdlcihJUGFpbnRQb3NpdGlvbk1h
bmFnZXIgbWFuYWdlcikgew0KKwkJZlBvc2l0aW9uTWFuYWdlciA9IG1hbmFnZXI7DQorCX0NCit9
DQpJbmRleDogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU291cmNl
Vmlld2VyRGVjb3JhdGlvblN1cHBvcnQuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IHNyYy9v
cmcvZWNsaXBzZS9waHAvaW50ZXJuYWwvdWkvZWRpdG9yL1BIUFNvdXJjZVZpZXdlckRlY29yYXRp
b25TdXBwb3J0LmphdmENCmRpZmYgLU4gc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9l
ZGl0b3IvUEhQU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQuamF2YQ0KLS0tIC9kZXYvbnVs
bAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQorKysgc3JjL29yZy9lY2xpcHNlL3BocC9pbnRl
cm5hbC91aS9lZGl0b3IvUEhQU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQuamF2YQkxIEph
biAxOTcwIDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDE0MyBAQA0KK3BhY2thZ2Ugb3JnLmVj
bGlwc2UucGhwLmludGVybmFsLnVpLmVkaXRvcjsNCisNCitpbXBvcnQgb3JnLmVjbGlwc2UuamZh
Y2UucHJlZmVyZW5jZS5JUHJlZmVyZW5jZVN0b3JlOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFj
ZS5wcmVmZXJlbmNlLlByZWZlcmVuY2VDb252ZXJ0ZXI7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmpm
YWNlLnRleHQuSVRleHRWaWV3ZXJFeHRlbnNpb24yOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFj
ZS50ZXh0LnNvdXJjZS5JQW5ub3RhdGlvbkFjY2VzczsNCitpbXBvcnQgb3JnLmVjbGlwc2UuamZh
Y2UudGV4dC5zb3VyY2UuSU92ZXJ2aWV3UnVsZXI7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNl
LnRleHQuc291cmNlLklTaGFyZWRUZXh0Q29sb3JzOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFj
ZS50ZXh0LnNvdXJjZS5JU291cmNlVmlld2VyOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS51
dGlsLlByb3BlcnR5Q2hhbmdlRXZlbnQ7DQoraW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ncmFwaGlj
cy5Db2xvcjsNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmdyYXBoaWNzLlJHQjsNCitpbXBvcnQg
b3JnLmVjbGlwc2UudWkudGV4dGVkaXRvci5Tb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9ydDsN
CisNCitwdWJsaWMgY2xhc3MgUEhQU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQgZXh0ZW5k
cw0KKwkJU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQgew0KKwkvKiogUHJlZmVyZW5jZSBr
ZXkgZm9yIHRoZSBjdXJzb3IgbGluZSBoaWdobGlnaHRpbmcgKi8NCisJcHJpdmF0ZSBTdHJpbmcg
ZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5Ow0KKwkvKiogUHJlZmVyZW5jZSBrZXkgZm9yIHRo
ZSBjdXJzb3IgbGluZSBiYWNrZ3JvdW5kIGNvbG9yICovDQorCXByaXZhdGUgU3RyaW5nIGZDdXJz
b3JMaW5lUGFpbnRlckNvbG9yS2V5Ow0KKwkvKiogVGhlIHByZWZlcmVuY2Ugc3RvcmUgKi8NCisJ
cHJpdmF0ZSBJUHJlZmVyZW5jZVN0b3JlIGZQcmVmZXJlbmNlU3RvcmU7DQorCS8qKiBUaGUgc2hh
cmVkIGNvbG9yIG1hbmFnZXIgKi8NCisJcHJpdmF0ZSBJU2hhcmVkVGV4dENvbG9ycyBmU2hhcmVk
VGV4dENvbG9yczsNCisJLyoqIFRoZSB2aWV3ZXIgKi8NCisJcHJpdmF0ZSBJU291cmNlVmlld2Vy
IGZTb3VyY2VWaWV3ZXI7DQorCXB1YmxpYyBQSFBTb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9y
dChJU291cmNlVmlld2VyIHNvdXJjZVZpZXdlciwNCisJCQlJT3ZlcnZpZXdSdWxlciBvdmVydmll
d1J1bGVyLCBJQW5ub3RhdGlvbkFjY2VzcyBhbm5vdGF0aW9uQWNjZXNzLA0KKwkJCUlTaGFyZWRU
ZXh0Q29sb3JzIHNoYXJlZFRleHRDb2xvcnMpIHsNCisJCXN1cGVyKHNvdXJjZVZpZXdlciwgb3Zl
cnZpZXdSdWxlciwgYW5ub3RhdGlvbkFjY2Vzcywgc2hhcmVkVGV4dENvbG9ycyk7DQorCQlmU291
cmNlVmlld2VyPSBzb3VyY2VWaWV3ZXI7DQorCQlmU2hhcmVkVGV4dENvbG9ycz0gc2hhcmVkVGV4
dENvbG9yczsNCisJfQ0KKwlAT3ZlcnJpZGUNCisJcHVibGljIHZvaWQgaW5zdGFsbChJUHJlZmVy
ZW5jZVN0b3JlIHN0b3JlKSB7DQorLy8JCXN1cGVyLmluc3RhbGwoc3RvcmUpOw0KKwkJDQorCQlm
UHJlZmVyZW5jZVN0b3JlID0gc3RvcmU7DQorCQlpZiAoaXNDdXJzb3JMaW5lU2hvd24oKSkNCisJ
CQlzaG93Q3Vyc29yTGluZSgpOw0KKwkJZWxzZQ0KKwkJCWhpZGVDdXJzb3JMaW5lKCk7DQorDQor
CQlzdXBlci5pbnN0YWxsKHN0b3JlKTsNCisJfQ0KKw0KKwkvKioNCisJICogVGVsbHMgd2hldGhl
ciB0aGUgY3Vyc29yIGxpbmUgaXMgc2hvd24uDQorCSAqDQorCSAqIEByZXR1cm4gPGNvZGU+dHJ1
ZTwvY29kZT4gaWYgdGhlIGN1cnNvciBsaW5lIGlzIHNob3duDQorCSAqLw0KKwlwcml2YXRlIGJv
b2xlYW4gaXNDdXJzb3JMaW5lU2hvd24oKSB7DQorCQlpZiAoZlByZWZlcmVuY2VTdG9yZSAhPSBu
dWxsICYmIGZDdXJzb3JMaW5lUGFpbnRlckVuYWJsZUtleSAhPSBudWxsKQ0KKwkJCXJldHVybiBm
UHJlZmVyZW5jZVN0b3JlLmdldEJvb2xlYW4oZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5KTsN
CisJCXJldHVybiBmYWxzZTsNCisJfQ0KKw0KKwkvKioNCisJICogU2V0cyB0aGUgcHJlZmVyZW5j
ZSBrZXlzIGZvciB0aGUgY3Vyc29yIGxpbmUgcGFpbnRlci4NCisJICogQHBhcmFtIGVuYWJsZUtl
eSB0aGUgcHJlZmVyZW5jZSBrZXkgZm9yIHRoZSBjdXJzb3IgbGluZSBwYWludGVyDQorCSAqIEBw
YXJhbSBjb2xvcktleSB0aGUgcHJlZmVyZW5jZSBrZXkgZm9yIHRoZSBjb2xvciB1c2VkIGJ5IHRo
ZSBjdXJzb3IgbGluZQ0KKwkgKiAgICAgICAgcGFpbnRlcg0KKwkgKi8NCisJcHVibGljIHZvaWQg
c2V0Q3Vyc29yTGluZVBhaW50ZXJQcmVmZXJlbmNlS2V5cyhTdHJpbmcgZW5hYmxlS2V5LCBTdHJp
bmcgY29sb3JLZXkpIHsNCisJCXN1cGVyLnNldEN1cnNvckxpbmVQYWludGVyUHJlZmVyZW5jZUtl
eXMoZW5hYmxlS2V5LCBjb2xvcktleSk7DQorCQlmQ3Vyc29yTGluZVBhaW50ZXJFbmFibGVLZXk9
IGVuYWJsZUtleTsNCisJCWZDdXJzb3JMaW5lUGFpbnRlckNvbG9yS2V5PSBjb2xvcktleTsNCisJ
fQ0KKwkNCisJQE92ZXJyaWRlDQorCXByb3RlY3RlZCB2b2lkIGhhbmRsZVByZWZlcmVuY2VTdG9y
ZUNoYW5nZWQoUHJvcGVydHlDaGFuZ2VFdmVudCBldmVudCkgew0KKw0KKwkJU3RyaW5nIHA9IGV2
ZW50LmdldFByb3BlcnR5KCk7DQorCQlpZiAoZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5ICE9
IG51bGwgJiYgZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5LmVxdWFscyhwKSkgew0KKwkJCWlm
IChpc0N1cnNvckxpbmVTaG93bigpKQ0KKwkJCQlzaG93Q3Vyc29yTGluZSgpOw0KKwkJCWVsc2UN
CisJCQkJaGlkZUN1cnNvckxpbmUoKTsNCisJCQlyZXR1cm47DQorCQl9DQorDQorCQkNCisJCXN1
cGVyLmhhbmRsZVByZWZlcmVuY2VTdG9yZUNoYW5nZWQoZXZlbnQpOw0KKw0KKwl9DQorCQ0KKw0K
KwkvKiogVGhlIGVkaXRvcidzIGxpbmUgcGFpbnRlciAqLw0KKwlwcml2YXRlIFBIUEN1cnNvckxp
bmVQYWludGVyIGZDdXJzb3JMaW5lUGFpbnRlcjsNCisJLyoqDQorCSAqIFNob3dzIHRoZSBjdXJz
b3IgbGluZS4NCisJICovDQorCXByaXZhdGUgdm9pZCBzaG93Q3Vyc29yTGluZSgpIHsNCisJCWlm
IChmQ3Vyc29yTGluZVBhaW50ZXIgPT0gbnVsbCkgew0KKwkJCWlmIChmU291cmNlVmlld2VyIGlu
c3RhbmNlb2YgSVRleHRWaWV3ZXJFeHRlbnNpb24yKSB7DQorCQkJCWZDdXJzb3JMaW5lUGFpbnRl
cj0gbmV3IFBIUEN1cnNvckxpbmVQYWludGVyKGZTb3VyY2VWaWV3ZXIpOw0KKy8vCQkJCWZDdXJz
b3JMaW5lUGFpbnRlci5zZXRIaWdobGlnaHRDb2xvcihnZXRDb2xvcihmQ3Vyc29yTGluZVBhaW50
ZXJDb2xvcktleSkpOw0KKwkJCQlJVGV4dFZpZXdlckV4dGVuc2lvbjIgZXh0ZW5zaW9uPSAoSVRl
eHRWaWV3ZXJFeHRlbnNpb24yKSBmU291cmNlVmlld2VyOw0KKwkJCQlleHRlbnNpb24uYWRkUGFp
bnRlcihmQ3Vyc29yTGluZVBhaW50ZXIpOw0KKwkJCX0NCisJCX0NCisJfQ0KKw0KKwkvKioNCisJ
ICogUmV0dXJucyB0aGUgc2hhcmVkIGNvbG9yIGZvciB0aGUgZ2l2ZW4ga2V5Lg0KKwkgKg0KKwkg
KiBAcGFyYW0ga2V5IHRoZSBjb2xvciBrZXkgc3RyaW5nDQorCSAqIEByZXR1cm4gdGhlIHNoYXJl
ZCBjb2xvciBmb3IgdGhlIGdpdmVuIGtleQ0KKwkgKi8NCisJcHJpdmF0ZSBDb2xvciBnZXRDb2xv
cihTdHJpbmcga2V5KSB7DQorCQlpZiAoZlByZWZlcmVuY2VTdG9yZSAhPSBudWxsKSB7DQorCQkJ
UkdCIHJnYj0gUHJlZmVyZW5jZUNvbnZlcnRlci5nZXRDb2xvcihmUHJlZmVyZW5jZVN0b3JlLCBr
ZXkpOw0KKwkJCXJldHVybiBnZXRDb2xvcihyZ2IpOw0KKwkJfQ0KKwkJcmV0dXJuIG51bGw7DQor
CX0NCisNCisJLyoqDQorCSAqIFJldHVybnMgdGhlIHNoYXJlZCBjb2xvciBmb3IgdGhlIGdpdmVu
IFJHQi4NCisJICoNCisJICogQHBhcmFtIHJnYiB0aGUgUkdCDQorCSAqIEByZXR1cm4gdGhlIHNo
YXJlZCBjb2xvciBmb3IgdGhlIGdpdmVuIFJHQg0KKwkgKi8NCisJcHJpdmF0ZSBDb2xvciBnZXRD
b2xvcihSR0IgcmdiKSB7DQorCQlyZXR1cm4gZlNoYXJlZFRleHRDb2xvcnMuZ2V0Q29sb3Iocmdi
KTsNCisJfQ0KKw0KKwkvKioNCisJICogSGlkZXMgdGhlIGN1cnNvciBsaW5lLg0KKwkgKi8NCisJ
cHJpdmF0ZSB2b2lkIGhpZGVDdXJzb3JMaW5lKCkgew0KKwkJaWYgKGZDdXJzb3JMaW5lUGFpbnRl
ciAhPSBudWxsKSB7DQorCQkJaWYgKGZTb3VyY2VWaWV3ZXIgaW5zdGFuY2VvZiBJVGV4dFZpZXdl
ckV4dGVuc2lvbjIpIHsNCisJCQkJSVRleHRWaWV3ZXJFeHRlbnNpb24yIGV4dGVuc2lvbj0gKElU
ZXh0Vmlld2VyRXh0ZW5zaW9uMikgZlNvdXJjZVZpZXdlcjsNCisJCQkJZXh0ZW5zaW9uLnJlbW92
ZVBhaW50ZXIoZkN1cnNvckxpbmVQYWludGVyKTsNCisJCQkJZkN1cnNvckxpbmVQYWludGVyLmRl
YWN0aXZhdGUodHJ1ZSk7DQorCQkJCWZDdXJzb3JMaW5lUGFpbnRlci5kaXNwb3NlKCk7DQorCQkJ
CWZDdXJzb3JMaW5lUGFpbnRlcj0gbnVsbDsNCisJCQl9DQorCQl9DQorCX0NCisNCit9DQo=
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>156896</attachid>
            <date>2010-01-22 02:24:00 -0500</date>
            <delta_ts>2010-01-22 02:24:59 -0500</delta_ts>
            <desc>patch</desc>
            <filename>linebackground.txt</filename>
            <type>text/plain</type>
            <size>23909</size>
            <attacher name="Zhongwei Zhao">zhaozhongwei</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UucGhwLnVpDQpJ
bmRleDogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJl
ZEVkaXRvci5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvdG9vbHMvb3JnLmVj
bGlwc2UucGR0L3BsdWdpbnMvb3JnLmVjbGlwc2UucGhwLnVpL3NyYy9vcmcvZWNsaXBzZS9waHAv
aW50ZXJuYWwvdWkvZWRpdG9yL1BIUFN0cnVjdHVyZWRFZGl0b3IuamF2YSx2DQpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuMTMyDQpkaWZmIC11IC1yMS4xMzIgUEhQU3RydWN0dXJlZEVkaXRvci5qYXZh
DQotLS0gc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJl
ZEVkaXRvci5qYXZhCTIwIEphbiAyMDEwIDA3OjM1OjU4IC0wMDAwCTEuMTMyDQorKysgc3JjL29y
Zy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJlZEVkaXRvci5qYXZh
CTIyIEphbiAyMDEwIDA3OjIzOjIwIC0wMDAwDQpAQCAtMzMzMiw0ICszMzMyLDE0IEBADQogCQkJ
KChDb25maWd1cmFibGVDb250ZW50T3V0bGluZVBhZ2UpIGZQSFBPdXRsaW5lUGFnZSkuc2V0SW5w
dXQoZ2V0TW9kZWxFbGVtZW50KCkpOw0KIAkJfQ0KIAl9DQorCQ0KKwlAT3ZlcnJpZGUNCisJcHJv
dGVjdGVkIFNvdXJjZVZpZXdlckRlY29yYXRpb25TdXBwb3J0IGdldFNvdXJjZVZpZXdlckRlY29y
YXRpb25TdXBwb3J0KA0KKwkJCUlTb3VyY2VWaWV3ZXIgdmlld2VyKSB7DQorCQlpZiAoZlNvdXJj
ZVZpZXdlckRlY29yYXRpb25TdXBwb3J0ID09IG51bGwpIHsNCisJCQlmU291cmNlVmlld2VyRGVj
b3JhdGlvblN1cHBvcnQ9IG5ldyBQSFBTb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9ydCh2aWV3
ZXIsIGdldE92ZXJ2aWV3UnVsZXIoKSwgZ2V0QW5ub3RhdGlvbkFjY2VzcygpLCBnZXRTaGFyZWRD
b2xvcnMoKSk7DQorCQkJY29uZmlndXJlU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQoZlNv
dXJjZVZpZXdlckRlY29yYXRpb25TdXBwb3J0KTsNCisJCX0NCisJCXJldHVybiBmU291cmNlVmll
d2VyRGVjb3JhdGlvblN1cHBvcnQ7DQorCX0NCiB9DQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZp
bGUNCkluZGV4OiBzcmMvb3JnL2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGln
aHRlci9MaW5lU3R5bGVQcm92aWRlckZvclBocC5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTog
L2N2c3Jvb3QvdG9vbHMvb3JnLmVjbGlwc2UucGR0L3BsdWdpbnMvb3JnLmVjbGlwc2UucGhwLnVp
L3NyYy9vcmcvZWNsaXBzZS9waHAvaW50ZXJuYWwvdWkvZWRpdG9yL2hpZ2hsaWdodGVyL0xpbmVT
dHlsZVByb3ZpZGVyRm9yUGhwLmphdmEsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjI5DQpkaWZm
IC11IC1yMS4yOSBMaW5lU3R5bGVQcm92aWRlckZvclBocC5qYXZhDQotLS0gc3JjL29yZy9lY2xp
cHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvTGluZVN0eWxlUHJvdmlkZXJG
b3JQaHAuamF2YQkxOCBKYW4gMjAxMCAwODoyODowMCAtMDAwMAkxLjI5DQorKysgc3JjL29yZy9l
Y2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvTGluZVN0eWxlUHJvdmlk
ZXJGb3JQaHAuamF2YQkyMiBKYW4gMjAxMCAwNzoyMzoyMSAtMDAwMA0KQEAgLTM3NSw3ICszNzUs
NyBAQA0KIAkJCX0NCiAJCX0NCiAJfQ0KLQkNCisNCiAJcHJvdGVjdGVkIHZvaWQgYWRkRGVmYXVs
dFRleHRBdHRyaWJ1dGUoU3RyaW5nIGNvbG9yS2V5KSB7DQogCQlpZiAoZ2V0Q29sb3JQcmVmZXJl
bmNlcygpICE9IG51bGwpIHsNCiAJCQlTdHJpbmcgcHJlZlN0cmluZyA9IFByZWZlcmVuY2VDb25z
dGFudHMuRURJVE9SX05PUk1BTF9ERUZBVUxUX0NPTE9SOw0KQEAgLTM4Nyw3ICszODcsNyBAQA0K
IAkJCX0NCiAJCX0NCiAJfQ0KLQkNCisNCiAJLyoNCiAJICogQ3JlYXRlcyBUZXh0QXR0cmlidXRl
IGZyb20gdGhlIGdpdmVuIHN0eWxlIGRlc2NyaXB0aW9uIGFycmF5IHN0cmluZw0KIAkgKi8NCkBA
IC00MjcsNyArNDI3LDcgQEANCiAJCS8vIGluc3RlYWQgb2YgZW5kLXN0YXJ0Pw0KIAkJaWYgKGVu
ZCA+IG1heE9mZnNldCkNCiAJCQllbmQgPSBtYXhPZmZzZXQ7DQotCQlTdHlsZVJhbmdlIHJlc3Vs
dCA9IG5ldyBTdHlsZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCwgYXR0cg0KKwkJU3R5bGVSYW5n
ZSByZXN1bHQgPSBuZXcgUEhQU3R5bGVSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQsIGF0dHINCiAJ
CQkJLmdldEZvcmVncm91bmQoKSwgYXR0ci5nZXRCYWNrZ3JvdW5kKCksIGF0dHIuZ2V0U3R5bGUo
KSk7DQogCQlpZiAoKGF0dHIuZ2V0U3R5bGUoKSAmIFRleHRBdHRyaWJ1dGUuVU5ERVJMSU5FKSAh
PSAwKSB7DQogCQkJcmVzdWx0LnVuZGVybGluZSA9IHRydWU7DQpAQCAtNzE1LDcgKzcxNSw3IEBA
DQogCQkJCQkJLy8gdGhlDQogCQkJCQkJLy8gd2hpdGVzcGFjZXMNCiAJCQkJCQkvLyBhcHBseWlu
ZyBzdHlsZSB0byB0aGUgcmVnaW9uIHcvbyB0aGUgd2hpdGVzcGFjZQ0KLQkJCQkJCXN0eWxlUmFu
Z2UgPSBuZXcgU3R5bGVSYW5nZShzdHlsZVN0YXJ0LCBzdHlsZUxlbmd0aA0KKwkJCQkJCXN0eWxl
UmFuZ2UgPSBuZXcgUEhQU3R5bGVSYW5nZShzdHlsZVN0YXJ0LCBzdHlsZUxlbmd0aA0KIAkJCQkJ
CQkJLSAoZWxlbWVudC5nZXRFbmQoKSAtIGVsZW1lbnQuZ2V0VGV4dEVuZCgpKSwNCiAJCQkJCQkJ
CWF0dHIuZ2V0Rm9yZWdyb3VuZCgpLCBhdHRyLmdldEJhY2tncm91bmQoKSwNCiAJCQkJCQkJCWF0
dHIuZ2V0U3R5bGUoKSk7DQpAQCAtNzMwLDE0ICs3MzAsMTQgQEANCiAJCQkJCQlob2xkUmVzdWx0
cy5hZGQoc3R5bGVSYW5nZSk7DQogCQkJCQkJLy8gYXBwbHlpbmcgc3R5bGUgdG8gdGhlIHdoaXRl
c3BhY2UgKGltcG9ydGFudCBmb3IgdGhlDQogCQkJCQkJLy8gcmVmcmVzaCBvZiB0aGUgc3BlY2lm
aWMgcmFuZ2UNCi0JCQkJCQlzdHlsZVJhbmdlID0gbmV3IFN0eWxlUmFuZ2UocmVnaW9uU3RhcnQN
CisJCQkJCQlzdHlsZVJhbmdlID0gbmV3IFBIUFN0eWxlUmFuZ2UocmVnaW9uU3RhcnQNCiAJCQkJ
CQkJCSsgZWxlbWVudC5nZXRUZXh0RW5kKCksIGVsZW1lbnQuZ2V0RW5kKCkNCiAJCQkJCQkJCS0g
ZWxlbWVudC5nZXRUZXh0RW5kKCksIGF0dHIuZ2V0Rm9yZWdyb3VuZCgpLA0KLQkJCQkJCQkJbnVs
bCwgYXR0ci5nZXRTdHlsZSgpKTsNCisJCQkJCQkJCWF0dHIuZ2V0QmFja2dyb3VuZCgpLCBhdHRy
LmdldFN0eWxlKCkpOw0KIAkJCQkJCWhvbGRSZXN1bHRzLmFkZChzdHlsZVJhbmdlKTsNCiAJCQkJ
CQlwcmV2aW91c0F0dHIgPSBudWxsOw0KIAkJCQkJfSBlbHNlIHsNCi0JCQkJCQlzdHlsZVJhbmdl
ID0gbmV3IFN0eWxlUmFuZ2Uoc3R5bGVTdGFydCwgc3R5bGVMZW5ndGgsDQorCQkJCQkJc3R5bGVS
YW5nZSA9IG5ldyBQSFBTdHlsZVJhbmdlKHN0eWxlU3RhcnQsIHN0eWxlTGVuZ3RoLA0KIAkJCQkJ
CQkJYXR0ci5nZXRGb3JlZ3JvdW5kKCksIGF0dHIuZ2V0QmFja2dyb3VuZCgpLA0KIAkJCQkJCQkJ
YXR0ci5nZXRTdHlsZSgpKTsNCiAJCQkJCQlpZiAoKGF0dHIuZ2V0U3R5bGUoKSAmIFRleHRBdHRy
aWJ1dGUuVU5ERVJMSU5FKSAhPSAwKSB7DQpAQCAtODM5LDI5ICs4MzksNDggQEANCiAJCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0hFUkVET0NfQ09MT1IuZXF1YWxzKHByZWZLZXkp
DQogCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9UQVNLX0NPTE9SLmVxdWFscyhw
cmVmS2V5KSkgew0KIAkJCQlhZGRUZXh0QXR0cmlidXRlKHByZWZLZXkpOw0KLQkJCX0gZWxzZSBp
ZiAoUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNl
Q29uc3RhbnRzLkVESVRPUl9OT1JNQUxfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJfHwg
UHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNlQ29u
c3RhbnRzLkVESVRPUl9CT1VOREFSWU1BUktFUl9DT0xPUikNCi0JCQkJCQkJLmVxdWFscyhwcmVm
S2V5KQ0KLQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtl
eShQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9LRVlXT1JEX0NPTE9SKS5lcXVhbHMocHJlZktl
eSkNCi0JCQkJCXx8IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXko
UHJlZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfVkFSSUFCTEVfQ09MT1IpDQorCQkJfSBlbHNlIGlm
IChQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJUHJl
ZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfTk9STUFMX0NPTE9SKS5lcXVhbHMocHJlZktleSkNCisJ
CQkJCXx8IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoDQorCQkJ
CQkJCVByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0JPVU5EQVJZTUFSS0VSX0NPTE9SKQ0KIAkJ
CQkJCQkuZXF1YWxzKHByZWZLZXkpDQotCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVu
YWJsZWRQcmVmZXJlbmNlS2V5KFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX1NUUklOR19DT0xP
UikuZXF1YWxzKHByZWZLZXkpDQotCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJs
ZWRQcmVmZXJlbmNlS2V5KFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0NPTU1FTlRfQ09MT1Ip
LmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVk
UHJlZmVyZW5jZUtleShQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9MSU5FX0NPTU1FTlRfQ09M
T1IpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5
KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9LRVlXT1JEX0NPTE9SKS5lcXVh
bHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVu
YWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9W
QVJJQUJMRV9DT0xPUikuZXF1YWxzKA0KKwkJCQkJCQlwcmVmS2V5KQ0KKwkJCQkJfHwgUHJlZmVy
ZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleSgNCisJCQkJCQkJUHJlZmVyZW5j
ZUNvbnN0YW50cy5FRElUT1JfU1RSSU5HX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkp
DQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0K
KwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9DT01NRU5UX0NPTE9SKS5lcXVhbHMo
DQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJs
ZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9MSU5F
X0NPTU1FTlRfQ09MT1IpDQogCQkJCQkJCS5lcXVhbHMocHJlZktleSkNCi0JCQkJCXx8IFByZWZl
cmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoUHJlZmVyZW5jZUNvbnN0YW50
cy5FRElUT1JfUEhQRE9DX0NPTU1FTlRfQ09MT1IpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3Rh
bnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRz
LkVESVRPUl9QSFBET0NfQ09NTUVOVF9DT0xPUikNCiAJCQkJCQkJLmVxdWFscyhwcmVmS2V5KQ0K
LQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVm
ZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9QSFBET0NfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJ
CQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJl
bmNlQ29uc3RhbnRzLkVESVRPUl9OVU1CRVJfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJ
fHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNl
Q29uc3RhbnRzLkVESVRPUl9IRVJFRE9DX0NPTE9SKS5lcXVhbHMocHJlZktleSkNCi0JCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoUHJlZmVyZW5jZUNv
bnN0YW50cy5FRElUT1JfVEFTS19DT0xPUikuZXF1YWxzKHByZWZLZXkpKSB7DQotCQkJCQlib29s
ZWFuIGVuYWJsZWQgPSBnZXRDb2xvclByZWZlcmVuY2VzKCkuZ2V0Qm9vbGVhbihwcmVmS2V5KTsN
Ci0JCQkJCXByZWZLZXkgPSBwcmVmS2V5LnNwbGl0KCJcXC4iKVsxXTsNCi0JCQkJCWlmKGVuYWJs
ZWQpew0KLQkJCQkJCWFkZFRleHRBdHRyaWJ1dGUocHJlZktleSk7DQotCQkJCQl9ZWxzZXsNCi0J
CQkJCQlhZGREZWZhdWx0VGV4dEF0dHJpYnV0ZShwcmVmS2V5KTsNCi0JCQkJCX0NCisJCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoDQorCQkJCQkJCVBy
ZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX1BIUERPQ19DT0xPUikuZXF1YWxzKA0KKwkJCQkJCQlw
cmVmS2V5KQ0KKwkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5j
ZUtleSgNCisJCQkJCQkJUHJlZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfTlVNQkVSX0NPTE9SKS5l
cXVhbHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdl
dEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRP
Ul9IRVJFRE9DX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVm
ZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJl
bmNlQ29uc3RhbnRzLkVESVRPUl9UQVNLX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkp
KSB7DQorCQkJCWJvb2xlYW4gZW5hYmxlZCA9IGdldENvbG9yUHJlZmVyZW5jZXMoKS5nZXRCb29s
ZWFuKHByZWZLZXkpOw0KKwkJCQlwcmVmS2V5ID0gcHJlZktleS5zcGxpdCgiXFwuIilbMV07DQor
CQkJCWlmIChlbmFibGVkKSB7DQorCQkJCQlhZGRUZXh0QXR0cmlidXRlKHByZWZLZXkpOw0KKwkJ
CQl9IGVsc2Ugew0KKwkJCQkJYWRkRGVmYXVsdFRleHRBdHRyaWJ1dGUocHJlZktleSk7DQorCQkJ
CX0NCiAJCQl9DQogCQl9IGVsc2Ugew0KIAkJCWxvYWRDb2xvcnMoKTsNCkluZGV4OiBzcmMvb3Jn
L2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJhbmdl
LmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiBzcmMvb3JnL2VjbGlwc2UvcGhwL2ludGVybmFs
L3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJhbmdlLmphdmENCmRpZmYgLU4gc3JjL29y
Zy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvUEhQU3R5bGVSYW5n
ZS5qYXZhDQotLS0gL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCisrKyBzcmMv
b3JnL2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJh
bmdlLmphdmEJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KQEAgLTAsMCArMSw2MiBAQA0KK3Bh
Y2thZ2Ugb3JnLmVjbGlwc2UucGhwLmludGVybmFsLnVpLmVkaXRvci5oaWdobGlnaHRlcjsNCisN
CitpbXBvcnQgamF2YS5sYW5nLnJlZi5XZWFrUmVmZXJlbmNlOw0KK2ltcG9ydCBqYXZhLnV0aWwu
QXJyYXlMaXN0Ow0KK2ltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7DQoraW1wb3J0IGphdmEudXRp
bC5MaXN0Ow0KKw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuY3VzdG9tLlN0eWxlUmFuZ2U7DQor
aW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ncmFwaGljcy5Db2xvcjsNCisNCitwdWJsaWMgY2xhc3Mg
UEhQU3R5bGVSYW5nZSBleHRlbmRzIFN0eWxlUmFuZ2Ugew0KKwlwcml2YXRlIGZpbmFsIENvbG9y
IHJlYWxiYWNrZ3JvdW5kOw0KKwlwcml2YXRlIExpc3Q8V2Vha1JlZmVyZW5jZTxQSFBTdHlsZVJh
bmdlPj4gYWxsQ2xvbmVzID0gbmV3IEFycmF5TGlzdDxXZWFrUmVmZXJlbmNlPFBIUFN0eWxlUmFu
Z2U+PigpOw0KKw0KKwlwdWJsaWMgUEhQU3R5bGVSYW5nZShpbnQgc3RhcnQsIGludCBsZW5ndGgs
IENvbG9yIGZvcmVncm91bmQsDQorCQkJQ29sb3IgYmFja2dyb3VuZCwgaW50IGZvbnRTdHlsZSkg
ew0KKwkJc3VwZXIoc3RhcnQsIGxlbmd0aCwgZm9yZWdyb3VuZCwgYmFja2dyb3VuZCwgZm9udFN0
eWxlKTsNCisJCXRoaXMucmVhbGJhY2tncm91bmQgPSBiYWNrZ3JvdW5kOw0KKwkJYWxsQ2xvbmVz
LmFkZChuZXcgV2Vha1JlZmVyZW5jZTxQSFBTdHlsZVJhbmdlPih0aGlzKSk7DQorCX0NCisNCisJ
LyoqDQorCSAqIHdoZW4gdGhpcyBQSFBTdHlsZVJhbmdlIGlzIGluIG9uZSB0aGUgY3VycmVjdCBs
aW5lLGNhbGwgdGhpcyBtZXRob2QNCisJICovDQorCXB1YmxpYyB2b2lkIGNsZWFyQmFja2dyb3Vu
ZCgpIHsNCisJCWZvciAoSXRlcmF0b3I8V2Vha1JlZmVyZW5jZTxQSFBTdHlsZVJhbmdlPj4gaXRl
cmF0b3IgPSBhbGxDbG9uZXMNCisJCQkJLml0ZXJhdG9yKCk7IGl0ZXJhdG9yLmhhc05leHQoKTsp
IHsNCisJCQlXZWFrUmVmZXJlbmNlPFBIUFN0eWxlUmFuZ2U+IHdlYWtSZWZlcmVuY2UgPSAoV2Vh
a1JlZmVyZW5jZTxQSFBTdHlsZVJhbmdlPikgaXRlcmF0b3INCisJCQkJCS5uZXh0KCk7DQorCQkJ
UEhQU3R5bGVSYW5nZSBzdHlsZVJhbmdlID0gd2Vha1JlZmVyZW5jZS5nZXQoKTsNCisJCQlpZiAo
c3R5bGVSYW5nZSAhPSBudWxsKSB7DQorCQkJCXN0eWxlUmFuZ2UuYmFja2dyb3VuZCA9IG51bGw7
DQorCQkJfQ0KKwkJfQ0KKwl9DQorDQorCS8qKg0KKwkgKiB3aGVuIHRoaXMgUEhQU3R5bGVSYW5n
ZSBpcyBOT1QgaW4gb25lIHRoZSBjdXJyZWN0IGxpbmUsY2FsbCB0aGlzIG1ldGhvZA0KKwkgKi8N
CisJcHVibGljIHZvaWQgcmVzZXRCYWNrZ3JvdW5kKCkgew0KKwkJZm9yIChJdGVyYXRvcjxXZWFr
UmVmZXJlbmNlPFBIUFN0eWxlUmFuZ2U+PiBpdGVyYXRvciA9IGFsbENsb25lcw0KKwkJCQkuaXRl
cmF0b3IoKTsgaXRlcmF0b3IuaGFzTmV4dCgpOykgew0KKwkJCVdlYWtSZWZlcmVuY2U8UEhQU3R5
bGVSYW5nZT4gd2Vha1JlZmVyZW5jZSA9IChXZWFrUmVmZXJlbmNlPFBIUFN0eWxlUmFuZ2U+KSBp
dGVyYXRvcg0KKwkJCQkJLm5leHQoKTsNCisJCQlQSFBTdHlsZVJhbmdlIHN0eWxlUmFuZ2UgPSB3
ZWFrUmVmZXJlbmNlLmdldCgpOw0KKwkJCWlmIChzdHlsZVJhbmdlICE9IG51bGwpIHsNCisJCQkJ
c3R5bGVSYW5nZS5iYWNrZ3JvdW5kID0gcmVhbGJhY2tncm91bmQ7DQorCQkJfQ0KKwkJfQ0KKwl9
DQorDQorCS8vIEBPdmVycmlkZQ0KKwlwdWJsaWMgT2JqZWN0IGNsb25lKCkgew0KKwkJUEhQU3R5
bGVSYW5nZSBjbG9uZSA9IChQSFBTdHlsZVJhbmdlKSBzdXBlci5jbG9uZSgpOw0KKwkJLy8gdGhp
cyBpcyBpbXBvcnRhbnQgZm9yIFN0eWxlZFRleHQgYWx3YXlzIHJldHVybiB0aGUgY2xvbmVzIG9m
IGl0cw0KKwkJLy8gU3R5bGVSYW5nZSxzbyBpZiB3ZSBub3QgY29sbGVjdCBhbGwgdGhlIGNsb25l
cyhpbmNsdWRpbmcgaXRzZWxmKSx3aGVuDQorCQkvLyB3ZSBzZXQgaXRzIGJhY2tncm91bmQgd2ls
bCBtYWtlIG5vIGVmZmVjdCxmb3IgeW91IGFsd2F5cyBjaGFuZ2UgaXRzDQorCQkvLyBjbG9uZSBv
YmplY3QncyBiYWNrZ3JvdW5kIHByb3BlcnR5DQorCQlhbGxDbG9uZXMuYWRkKG5ldyBXZWFrUmVm
ZXJlbmNlPFBIUFN0eWxlUmFuZ2U+KGNsb25lKSk7DQorCQlyZXR1cm4gY2xvbmU7DQorCX0NCit9
DQpJbmRleDogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQQ3Vyc29y
TGluZVBhaW50ZXIuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IHNyYy9vcmcvZWNsaXBzZS9w
aHAvaW50ZXJuYWwvdWkvZWRpdG9yL1BIUEN1cnNvckxpbmVQYWludGVyLmphdmENCmRpZmYgLU4g
c3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQQ3Vyc29yTGluZVBhaW50
ZXIuamF2YQ0KLS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQorKysgc3Jj
L29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQQ3Vyc29yTGluZVBhaW50ZXIu
amF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDI2MiBAQA0KK3BhY2th
Z2Ugb3JnLmVjbGlwc2UucGhwLmludGVybmFsLnVpLmVkaXRvcjsNCisNCitpbXBvcnQgb3JnLmVj
bGlwc2UuamZhY2UudGV4dC4qOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5waHAuaW50ZXJuYWwudWku
ZWRpdG9yLmhpZ2hsaWdodGVyLlBIUFN0eWxlUmFuZ2U7DQoraW1wb3J0IG9yZy5lY2xpcHNlLnN3
dC5jdXN0b20uTGluZUJhY2tncm91bmRFdmVudDsNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmN1
c3RvbS5MaW5lQmFja2dyb3VuZExpc3RlbmVyOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuY3Vz
dG9tLlN0eWxlUmFuZ2U7DQoraW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5jdXN0b20uU3R5bGVkVGV4
dDsNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmdyYXBoaWNzLlBvaW50Ow0KKw0KK3B1YmxpYyBj
bGFzcyBQSFBDdXJzb3JMaW5lUGFpbnRlciBpbXBsZW1lbnRzIElQYWludGVyLCBMaW5lQmFja2dy
b3VuZExpc3RlbmVyIHsNCisNCisJLyoqIFRoZSB2aWV3ZXIgdGhlIHBhaW50ZXIgd29ya3Mgb24g
Ki8NCisJcHJpdmF0ZSBmaW5hbCBJVGV4dFZpZXdlciBmVmlld2VyOw0KKwkvKiogVGhlIHBhaW50
IHBvc2l0aW9uIG1hbmFnZXIgZm9yIG1hbmFnaW5nIHRoZSBsaW5lIGNvb3JkaW5hdGVzICovDQor
CXByaXZhdGUgSVBhaW50UG9zaXRpb25NYW5hZ2VyIGZQb3NpdGlvbk1hbmFnZXI7DQorCS8qKiBL
ZWVwcyB0cmFjayBvZiB0aGUgbGluZSB0byBiZSBwYWludGVkICovDQorCXByaXZhdGUgUG9zaXRp
b24gZkN1cnJlbnRMaW5lID0gbmV3IFBvc2l0aW9uKDAsIDApOw0KKwkvKiogS2VlcHMgdHJhY2sg
b2YgdGhlIGxpbmUgdG8gYmUgY2xlYXJlZCAqLw0KKwlwcml2YXRlIFBvc2l0aW9uIGZMYXN0TGlu
ZSA9IG5ldyBQb3NpdGlvbigwLCAwKTsNCisJLyoqIEtlZXBzIHRyYWNrIG9mIHRoZSBsaW5lIG51
bWJlciBvZiB0aGUgbGFzdCBwYWludGVkIGxpbmUgKi8NCisJcHJpdmF0ZSBpbnQgZkxhc3RMaW5l
TnVtYmVyID0gLTE7DQorCS8qKiBJbmRpY2F0ZXMgd2hldGhlciB0aGlzIHBhaW50ZXIgaXMgYWN0
aXZlICovDQorCXByaXZhdGUgYm9vbGVhbiBmSXNBY3RpdmU7DQorDQorCS8qKg0KKwkgKiBDcmVh
dGVzIGEgbmV3IHBhaW50ZXIgZm9yIHRoZSBnaXZlbiBzb3VyY2Ugdmlld2VyLg0KKwkgKiANCisJ
ICogQHBhcmFtIHRleHRWaWV3ZXINCisJICogICAgICAgICAgICB0aGUgc291cmNlIHZpZXdlciBm
b3Igd2hpY2ggdG8gY3JlYXRlIGEgcGFpbnRlcg0KKwkgKi8NCisJcHVibGljIFBIUEN1cnNvckxp
bmVQYWludGVyKElUZXh0Vmlld2VyIHRleHRWaWV3ZXIpIHsNCisJCWZWaWV3ZXIgPSB0ZXh0Vmll
d2VyOw0KKwl9DQorDQorCS8qKg0KKwkgKiBTZXRzIHRoZSBjb2xvciBpbiB3aGljaCB0byBkcmF3
IHRoZSBiYWNrZ3JvdW5kIG9mIHRoZSBjdXJzb3IgbGluZS4NCisJICogDQorCSAqIEBwYXJhbSBo
aWdobGlnaHRDb2xvcg0KKwkgKiAgICAgICAgICAgIHRoZSBjb2xvciBpbiB3aGljaCB0byBkcmF3
IHRoZSBiYWNrZ3JvdW5kIG9mIHRoZSBjdXJzb3IgbGluZQ0KKwkgKi8NCisNCisJLyoNCisJICog
QHNlZSBMaW5lQmFja2dyb3VuZExpc3RlbmVyI2xpbmVHZXRCYWNrZ3JvdW5kKExpbmVCYWNrZ3Jv
dW5kRXZlbnQpDQorCSAqLw0KKwlwdWJsaWMgdm9pZCBsaW5lR2V0QmFja2dyb3VuZChMaW5lQmFj
a2dyb3VuZEV2ZW50IGV2ZW50KSB7DQorCX0NCisNCisJLyoqDQorCSAqIFVwZGF0ZXMgYWxsIHRo
ZSBjYWNoZWQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGxpbmVzIHRvIGJlIHBhaW50ZWQgYW5kIHRv
DQorCSAqIGJlIGNsZWFyZWQuIFJldHVybnMgPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIGxpbmUg
bnVtYmVyIG9mIHRoZSBjdXJzb3INCisJICogbGluZSBoYXMgY2hhbmdlZC4NCisJICogDQorCSAq
IEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgY3Vyc29yIGxpbmUgY2hhbmdlZA0KKwkgKi8N
CisJcHJpdmF0ZSBib29sZWFuIHVwZGF0ZUhpZ2hsaWdodExpbmUoKSB7DQorCQl0cnkgew0KKw0K
KwkJCUlEb2N1bWVudCBkb2N1bWVudCA9IGZWaWV3ZXIuZ2V0RG9jdW1lbnQoKTsNCisJCQlpbnQg
bW9kZWxDYXJldCA9IGdldE1vZGVsQ2FyZXQoKTsNCisJCQlpbnQgbGluZU51bWJlciA9IGRvY3Vt
ZW50LmdldExpbmVPZk9mZnNldChtb2RlbENhcmV0KTsNCisNCisJCQkvLyByZWRyYXcgaWYgdGhl
IGN1cnJlbnQgbGluZSBudW1iZXIgaXMgZGlmZmVyZW50IGZyb20gdGhlIGxhc3QgbGluZQ0KKwkJ
CS8vIG51bWJlciB3ZSBwYWludGVkDQorCQkJLy8gaW5pdGlhbGx5IGZMYXN0TGluZU51bWJlciBp
cyAtMQ0KKwkJCWlmIChsaW5lTnVtYmVyICE9IGZMYXN0TGluZU51bWJlcg0KKwkJCQkJfHwgIWZD
dXJyZW50TGluZS5vdmVybGFwc1dpdGgobW9kZWxDYXJldCwgMCkpIHsNCisNCisJCQkJZkxhc3RM
aW5lLm9mZnNldCA9IGZDdXJyZW50TGluZS5vZmZzZXQ7DQorCQkJCWZMYXN0TGluZS5sZW5ndGgg
PSBmQ3VycmVudExpbmUubGVuZ3RoOw0KKwkJCQlmTGFzdExpbmUuaXNEZWxldGVkID0gZkN1cnJl
bnRMaW5lLmlzRGVsZXRlZDsNCisNCisJCQkJaWYgKGZDdXJyZW50TGluZS5pc0RlbGV0ZWQpIHsN
CisJCQkJCWZDdXJyZW50TGluZS5pc0RlbGV0ZWQgPSBmYWxzZTsNCisJCQkJCWZQb3NpdGlvbk1h
bmFnZXIubWFuYWdlUG9zaXRpb24oZkN1cnJlbnRMaW5lKTsNCisJCQkJfQ0KKw0KKwkJCQlmQ3Vy
cmVudExpbmUub2Zmc2V0ID0gZG9jdW1lbnQuZ2V0TGluZU9mZnNldChsaW5lTnVtYmVyKTsNCisJ
CQkJaWYgKGxpbmVOdW1iZXIgPT0gZG9jdW1lbnQuZ2V0TnVtYmVyT2ZMaW5lcygpIC0gMSkNCisJ
CQkJCWZDdXJyZW50TGluZS5sZW5ndGggPSBkb2N1bWVudC5nZXRMZW5ndGgoKQ0KKwkJCQkJCQkt
IGZDdXJyZW50TGluZS5vZmZzZXQ7DQorCQkJCWVsc2UNCisJCQkJCWZDdXJyZW50TGluZS5sZW5n
dGggPSBkb2N1bWVudA0KKwkJCQkJCQkuZ2V0TGluZU9mZnNldChsaW5lTnVtYmVyICsgMSkNCisJ
CQkJCQkJLSBmQ3VycmVudExpbmUub2Zmc2V0Ow0KKw0KKwkJCQlmTGFzdExpbmVOdW1iZXIgPSBs
aW5lTnVtYmVyOw0KKwkJCQlyZXR1cm4gdHJ1ZTsNCisNCisJCQl9DQorDQorCQl9IGNhdGNoIChC
YWRMb2NhdGlvbkV4Y2VwdGlvbiBlKSB7DQorCQl9DQorDQorCQlyZXR1cm4gZmFsc2U7DQorCX0N
CisNCisJLyoqDQorCSAqIFJldHVybnMgdGhlIGxvY2F0aW9uIG9mIHRoZSBjYXJldCBhcyBvZmZz
ZXQgaW4gdGhlIHNvdXJjZSB2aWV3ZXIncyBpbnB1dA0KKwkgKiBkb2N1bWVudC4NCisJICogDQor
CSAqIEByZXR1cm4gdGhlIGNhcmV0IGxvY2F0aW9uDQorCSAqLw0KKwlwcml2YXRlIGludCBnZXRN
b2RlbENhcmV0KCkgew0KKwkJaW50IHdpZGdldENhcmV0ID0gZlZpZXdlci5nZXRUZXh0V2lkZ2V0
KCkuZ2V0Q2FyZXRPZmZzZXQoKTsNCisJCWlmIChmVmlld2VyIGluc3RhbmNlb2YgSVRleHRWaWV3
ZXJFeHRlbnNpb241KSB7DQorCQkJSVRleHRWaWV3ZXJFeHRlbnNpb241IGV4dGVuc2lvbiA9IChJ
VGV4dFZpZXdlckV4dGVuc2lvbjUpIGZWaWV3ZXI7DQorCQkJcmV0dXJuIGV4dGVuc2lvbi53aWRn
ZXRPZmZzZXQyTW9kZWxPZmZzZXQod2lkZ2V0Q2FyZXQpOw0KKwkJfQ0KKwkJSVJlZ2lvbiB2aXNp
YmxlID0gZlZpZXdlci5nZXRWaXNpYmxlUmVnaW9uKCk7DQorCQlyZXR1cm4gd2lkZ2V0Q2FyZXQg
KyB2aXNpYmxlLmdldE9mZnNldCgpOw0KKwl9DQorDQorCS8qDQorCSAqIEBzZWUgSVBhaW50ZXIj
ZGVhY3RpdmF0ZShib29sZWFuKQ0KKwkgKi8NCisJcHVibGljIHZvaWQgZGVhY3RpdmF0ZShib29s
ZWFuIHJlZHJhdykgew0KKwkJaWYgKGZJc0FjdGl2ZSkgew0KKwkJCWZJc0FjdGl2ZSA9IGZhbHNl
Ow0KKwkJCWZWaWV3ZXIuZ2V0VGV4dFdpZGdldCgpLnJlbW92ZUxpbmVCYWNrZ3JvdW5kTGlzdGVu
ZXIodGhpcyk7DQorCQkJLy8NCisJCQlpZiAoZlBvc2l0aW9uTWFuYWdlciAhPSBudWxsKQ0KKwkJ
CQlmUG9zaXRpb25NYW5hZ2VyLnVubWFuYWdlUG9zaXRpb24oZkN1cnJlbnRMaW5lKTsNCisNCisJ
CQlmTGFzdExpbmVOdW1iZXIgPSAtMTsNCisJCQlmQ3VycmVudExpbmUub2Zmc2V0ID0gMDsNCisJ
CQlmQ3VycmVudExpbmUubGVuZ3RoID0gMDsNCisJCX0NCisJfQ0KKw0KKwkvKg0KKwkgKiBAc2Vl
IElQYWludGVyI2Rpc3Bvc2UoKQ0KKwkgKi8NCisJcHVibGljIHZvaWQgZGlzcG9zZSgpIHsNCisJ
fQ0KKw0KKwkvKg0KKwkgKiBAc2VlIElQYWludGVyI3BhaW50KGludCkNCisJICovDQorCXB1Ymxp
YyB2b2lkIHBhaW50KGludCByZWFzb24pIHsNCisJCWlmIChmVmlld2VyLmdldERvY3VtZW50KCkg
PT0gbnVsbCkgew0KKwkJCWRlYWN0aXZhdGUoZmFsc2UpOw0KKwkJCXJldHVybjsNCisJCX0NCisN
CisJCVN0eWxlZFRleHQgdGV4dFdpZGdldCA9IGZWaWV3ZXIuZ2V0VGV4dFdpZGdldCgpOw0KKw0K
KwkJLy8gY2hlY2sgc2VsZWN0aW9uDQorCQlpZiAoaGFzTXVsdGlMaW5lU2VsZWN0aW9uKHRleHRX
aWRnZXQpKSB7DQorCQkJZGVhY3RpdmF0ZSh0cnVlKTsNCisJCQlyZXR1cm47DQorCQl9DQorDQor
CQkvLyBpbml0aWFsaXphdGlvbg0KKwkJaWYgKCFmSXNBY3RpdmUpIHsNCisJCQl0ZXh0V2lkZ2V0
LmFkZExpbmVCYWNrZ3JvdW5kTGlzdGVuZXIodGhpcyk7DQorCQkJZklzQWN0aXZlID0gdHJ1ZTsN
CisJCX0NCisNCisJCWludCBvbGRMYXN0TGluZU51bWJlciA9IGZMYXN0TGluZU51bWJlcjsNCisN
CisJCXVwZGF0ZUhpZ2hsaWdodExpbmUoKTsNCisJCWlmIChvbGRMYXN0TGluZU51bWJlciAhPSAt
MSAmJiBvbGRMYXN0TGluZU51bWJlciAhPSBmTGFzdExpbmVOdW1iZXIpIHsNCisJCQkvLyByZWNv
dmVyIHRoZSBvbGQgc3R5bGVkIHJhbmdlIGJhY2tncm91bmQgY29sb3INCisJCQlpbnQgbGluZU9m
ZnNldCA9IHRleHRXaWRnZXQuZ2V0T2Zmc2V0QXRMaW5lKG9sZExhc3RMaW5lTnVtYmVyKTsNCisJ
CQlTdHJpbmcgbGluZSA9IHRleHRXaWRnZXQuZ2V0TGluZShvbGRMYXN0TGluZU51bWJlcik7DQor
CQkJaW50IGxpbmVMZW5ndGggPSBsaW5lLmxlbmd0aCgpOw0KKwkJCVN0eWxlUmFuZ2VbXSByYW5n
ZXMgPSB0ZXh0V2lkZ2V0LmdldFN0eWxlUmFuZ2VzKGxpbmVPZmZzZXQsDQorCQkJCQlsaW5lTGVu
Z3RoKTsNCisJCQlmb3IgKGludCBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykgew0KKwkJ
CQlTdHlsZVJhbmdlIHN0eWxlUmFuZ2UgPSByYW5nZXNbaV07DQorCQkJCWlmIChzdHlsZVJhbmdl
IGluc3RhbmNlb2YgUEhQU3R5bGVSYW5nZSkgew0KKwkJCQkJUEhQU3R5bGVSYW5nZSBwaHBTdHls
ZVJhbmdlID0gKFBIUFN0eWxlUmFuZ2UpIHN0eWxlUmFuZ2U7DQorCQkJCQlwaHBTdHlsZVJhbmdl
LnJlc2V0QmFja2dyb3VuZCgpOw0KKwkJCQl9DQorCQkJfQ0KKwkJfQ0KKw0KKwkJLy8gc2V0IHRo
aXMgbGluZSdzIHN0eWxlZCByYW5nZSBiYWNrZ3JvdW5kIGNvbG9yIHRvIG51bGwNCisJCWludCBz
dGFydCA9IHRleHRXaWRnZXQuZ2V0T2Zmc2V0QXRMaW5lKGZMYXN0TGluZU51bWJlcik7DQorCQlT
dHlsZVJhbmdlW10gcmFuZ2VzID0gdGV4dFdpZGdldC5nZXRTdHlsZVJhbmdlcyhzdGFydCwgdGV4
dFdpZGdldA0KKwkJCQkuZ2V0TGluZShmTGFzdExpbmVOdW1iZXIpLmxlbmd0aCgpKTsNCisJCWZv
ciAoaW50IGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSsrKSB7DQorCQkJU3R5bGVSYW5nZSBz
dHlsZVJhbmdlID0gcmFuZ2VzW2ldOw0KKwkJCWlmIChzdHlsZVJhbmdlIGluc3RhbmNlb2YgUEhQ
U3R5bGVSYW5nZSkgew0KKwkJCQlQSFBTdHlsZVJhbmdlIHBocFN0eWxlUmFuZ2UgPSAoUEhQU3R5
bGVSYW5nZSkgc3R5bGVSYW5nZTsNCisJCQkJcGhwU3R5bGVSYW5nZS5jbGVhckJhY2tncm91bmQo
KTsNCisJCQl9DQorCQl9DQorCQkvLyBkcmF3IG5ldyBsaW5lLHdlIG11c3QgY2FsbCB0aGlzIG1l
dGhvZCB0byByZWRyYXcgdGhlIGN1cnJlbnQgbGluZQ0KKwkJLy8gYmVjYXVzZSB3aGVuIHdlIG1v
ZGlmeSB0ZXh0IEN1cnNvckxpbmVQYWludGVyIHdpbGwgbm90IHJlZHJhdyB0aGUNCisJCS8vIGN1
cnJlbnQgbGluZSx0aGVuIHBocFN0eWxlUmFuZ2UuY2xlYXJCYWNrZ3JvdW5kKCkgbWFrZXMgbm8g
ZWZmZWN0DQorCQlkcmF3SGlnaGxpZ2h0TGluZShmTGFzdExpbmUpOw0KKwkJZHJhd0hpZ2hsaWdo
dExpbmUoZkN1cnJlbnRMaW5lKTsNCisJfQ0KKw0KKwlwcml2YXRlIHZvaWQgZHJhd0hpZ2hsaWdo
dExpbmUoUG9zaXRpb24gcG9zaXRpb24pIHsNCisNCisJCS8vIGlmIHRoZSBwb3NpdGlvbiB0aGF0
IGlzIGFib3V0IHRvIGJlIGRyYXduIHdhcyBkZWxldGVkIHRoZW4gd2UgY2FuJ3QNCisJCWlmIChw
b3NpdGlvbi5pc0RlbGV0ZWQoKSkNCisJCQlyZXR1cm47DQorDQorCQlpbnQgd2lkZ2V0T2Zmc2V0
ID0gMDsNCisJCWlmIChmVmlld2VyIGluc3RhbmNlb2YgSVRleHRWaWV3ZXJFeHRlbnNpb241KSB7
DQorDQorCQkJSVRleHRWaWV3ZXJFeHRlbnNpb241IGV4dGVuc2lvbiA9IChJVGV4dFZpZXdlckV4
dGVuc2lvbjUpIGZWaWV3ZXI7DQorCQkJd2lkZ2V0T2Zmc2V0ID0gZXh0ZW5zaW9uLm1vZGVsT2Zm
c2V0MldpZGdldE9mZnNldChwb3NpdGlvbg0KKwkJCQkJLmdldE9mZnNldCgpKTsNCisJCQlpZiAo
d2lkZ2V0T2Zmc2V0ID09IC0xKQ0KKwkJCQlyZXR1cm47DQorDQorCQl9IGVsc2Ugew0KKw0KKwkJ
CUlSZWdpb24gdmlzaWJsZSA9IGZWaWV3ZXIuZ2V0VmlzaWJsZVJlZ2lvbigpOw0KKwkJCXdpZGdl
dE9mZnNldCA9IHBvc2l0aW9uLmdldE9mZnNldCgpIC0gdmlzaWJsZS5nZXRPZmZzZXQoKTsNCisJ
CQlpZiAod2lkZ2V0T2Zmc2V0IDwgMCB8fCB2aXNpYmxlLmdldExlbmd0aCgpIDwgd2lkZ2V0T2Zm
c2V0KQ0KKwkJCQlyZXR1cm47DQorCQl9DQorDQorCQlTdHlsZWRUZXh0IHRleHRXaWRnZXQgPSBm
Vmlld2VyLmdldFRleHRXaWRnZXQoKTsNCisJCS8vIGNoZWNrIGZvciBodHRwczovL2J1Z3MuZWNs
aXBzZS5vcmcvYnVncy9zaG93X2J1Zy5jZ2k/aWQ9NjQ4OTgNCisJCS8vIHRoaXMgaXMgYSBndWFy
ZCBhZ2FpbnN0IHRoZSBzeW1wdG9tcyBidXQgbm90IHRoZSBhY3R1YWwgc29sdXRpb24NCisJCWlm
ICgwIDw9IHdpZGdldE9mZnNldCAmJiB3aWRnZXRPZmZzZXQgPD0gdGV4dFdpZGdldC5nZXRDaGFy
Q291bnQoKSkgew0KKwkJCVBvaW50IHVwcGVyTGVmdCA9IHRleHRXaWRnZXQuZ2V0TG9jYXRpb25B
dE9mZnNldCh3aWRnZXRPZmZzZXQpOw0KKwkJCWludCB3aWR0aCA9IHRleHRXaWRnZXQuZ2V0Q2xp
ZW50QXJlYSgpLndpZHRoDQorCQkJCQkrIHRleHRXaWRnZXQuZ2V0SG9yaXpvbnRhbFBpeGVsKCk7
DQorCQkJaW50IGhlaWdodCA9IHRleHRXaWRnZXQuZ2V0TGluZUhlaWdodCh3aWRnZXRPZmZzZXQp
Ow0KKwkJCXRleHRXaWRnZXQucmVkcmF3KDAsIHVwcGVyTGVmdC55LCB3aWR0aCwgaGVpZ2h0LCBm
YWxzZSk7DQorCQl9DQorCX0NCisNCisJLyoqDQorCSAqIFJldHVybnMgPGNvZGU+dHJ1ZTwvY29k
ZT4gaWYgdGhlIHdpZGdldCBoYXMgYSBzZWxlY3Rpb24gc3Bhbm5pbmcgbXVsdGlwbGUNCisJICog
bGluZXMsIDxjb2RlPmZhbHNlPC9jb2RlPiBvdGhlcndpc2UuDQorCSAqIA0KKwkgKiBAcGFyYW0g
dGV4dFdpZGdldA0KKwkgKiAgICAgICAgICAgIHRoZSB0ZXh0IHdpZGdldCB0byBjaGVjaw0KKwkg
KiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlmIDxjb2RlPnRleHRXaWRnZXQ8L2NvZGU+IGhh
cyBhIG11bHRpbGluZQ0KKwkgKiAgICAgICAgIHNlbGVjdGlvbiwgPGNvZGU+ZmFsc2U8L2NvZGU+
IG90aGVyd2lzZQ0KKwkgKiBAc2luY2UgMy41DQorCSAqLw0KKwlwcml2YXRlIGJvb2xlYW4gaGFz
TXVsdGlMaW5lU2VsZWN0aW9uKFN0eWxlZFRleHQgdGV4dFdpZGdldCkgew0KKwkJUG9pbnQgc2Vs
ZWN0aW9uID0gdGV4dFdpZGdldC5nZXRTZWxlY3Rpb24oKTsNCisJCXRyeSB7DQorCQkJaW50IHN0
YXJ0TGluZSA9IHRleHRXaWRnZXQuZ2V0TGluZUF0T2Zmc2V0KHNlbGVjdGlvbi54KTsNCisJCQlp
bnQgZW5kTGluZSA9IHRleHRXaWRnZXQuZ2V0TGluZUF0T2Zmc2V0KHNlbGVjdGlvbi55KTsNCisJ
CQlyZXR1cm4gc3RhcnRMaW5lICE9IGVuZExpbmU7DQorCQl9IGNhdGNoIChJbGxlZ2FsQXJndW1l
bnRFeGNlcHRpb24gZSkgew0KKwkJCS8vIGlnbm9yZSAtIGFwcGFyZW50bHksIHRoZSB3aWRnZXQg
aGFzIGEgc3RhbGUgc2VsZWN0aW9uDQorCQkJLy8gc2VlIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9y
Zy9idWdzL3Nob3dfYnVnLmNnaT9pZD0yNzM3MjENCisJCQlyZXR1cm4gZmFsc2U7DQorCQl9DQor
CX0NCisNCisJLy8NCisJLy8gLyoNCisJLy8gKiBAc2VlIElQYWludGVyI3NldFBvc2l0aW9uTWFu
YWdlcihJUGFpbnRQb3NpdGlvbk1hbmFnZXIpDQorCS8vICovDQorCXB1YmxpYyB2b2lkIHNldFBv
c2l0aW9uTWFuYWdlcihJUGFpbnRQb3NpdGlvbk1hbmFnZXIgbWFuYWdlcikgew0KKwkJZlBvc2l0
aW9uTWFuYWdlciA9IG1hbmFnZXI7DQorCX0NCit9DQpJbmRleDogc3JjL29yZy9lY2xpcHNlL3Bo
cC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQuamF2
YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IHNyYy9vcmcvZWNsaXBzZS9waHAvaW50ZXJuYWwvdWkv
ZWRpdG9yL1BIUFNvdXJjZVZpZXdlckRlY29yYXRpb25TdXBwb3J0LmphdmENCmRpZmYgLU4gc3Jj
L29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU291cmNlVmlld2VyRGVjb3Jh
dGlvblN1cHBvcnQuamF2YQ0KLS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAw
DQorKysgc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU291cmNlVmll
d2VyRGVjb3JhdGlvblN1cHBvcnQuamF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQpAQCAt
MCwwICsxLDE0MyBAQA0KK3BhY2thZ2Ugb3JnLmVjbGlwc2UucGhwLmludGVybmFsLnVpLmVkaXRv
cjsNCisNCitpbXBvcnQgb3JnLmVjbGlwc2UuamZhY2UucHJlZmVyZW5jZS5JUHJlZmVyZW5jZVN0
b3JlOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS5wcmVmZXJlbmNlLlByZWZlcmVuY2VDb252
ZXJ0ZXI7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnRleHQuSVRleHRWaWV3ZXJFeHRlbnNp
b24yOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS50ZXh0LnNvdXJjZS5JQW5ub3RhdGlvbkFj
Y2VzczsNCitpbXBvcnQgb3JnLmVjbGlwc2UuamZhY2UudGV4dC5zb3VyY2UuSU92ZXJ2aWV3UnVs
ZXI7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnRleHQuc291cmNlLklTaGFyZWRUZXh0Q29s
b3JzOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS50ZXh0LnNvdXJjZS5JU291cmNlVmlld2Vy
Ow0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS51dGlsLlByb3BlcnR5Q2hhbmdlRXZlbnQ7DQor
aW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ncmFwaGljcy5Db2xvcjsNCitpbXBvcnQgb3JnLmVjbGlw
c2Uuc3d0LmdyYXBoaWNzLlJHQjsNCitpbXBvcnQgb3JnLmVjbGlwc2UudWkudGV4dGVkaXRvci5T
b3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9ydDsNCisNCitwdWJsaWMgY2xhc3MgUEhQU291cmNl
Vmlld2VyRGVjb3JhdGlvblN1cHBvcnQgZXh0ZW5kcw0KKwkJU291cmNlVmlld2VyRGVjb3JhdGlv
blN1cHBvcnQgew0KKwkvKiogUHJlZmVyZW5jZSBrZXkgZm9yIHRoZSBjdXJzb3IgbGluZSBoaWdo
bGlnaHRpbmcgKi8NCisJcHJpdmF0ZSBTdHJpbmcgZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5
Ow0KKwkvKiogUHJlZmVyZW5jZSBrZXkgZm9yIHRoZSBjdXJzb3IgbGluZSBiYWNrZ3JvdW5kIGNv
bG9yICovDQorCXByaXZhdGUgU3RyaW5nIGZDdXJzb3JMaW5lUGFpbnRlckNvbG9yS2V5Ow0KKwkv
KiogVGhlIHByZWZlcmVuY2Ugc3RvcmUgKi8NCisJcHJpdmF0ZSBJUHJlZmVyZW5jZVN0b3JlIGZQ
cmVmZXJlbmNlU3RvcmU7DQorCS8qKiBUaGUgc2hhcmVkIGNvbG9yIG1hbmFnZXIgKi8NCisJcHJp
dmF0ZSBJU2hhcmVkVGV4dENvbG9ycyBmU2hhcmVkVGV4dENvbG9yczsNCisJLyoqIFRoZSB2aWV3
ZXIgKi8NCisJcHJpdmF0ZSBJU291cmNlVmlld2VyIGZTb3VyY2VWaWV3ZXI7DQorCXB1YmxpYyBQ
SFBTb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9ydChJU291cmNlVmlld2VyIHNvdXJjZVZpZXdl
ciwNCisJCQlJT3ZlcnZpZXdSdWxlciBvdmVydmlld1J1bGVyLCBJQW5ub3RhdGlvbkFjY2VzcyBh
bm5vdGF0aW9uQWNjZXNzLA0KKwkJCUlTaGFyZWRUZXh0Q29sb3JzIHNoYXJlZFRleHRDb2xvcnMp
IHsNCisJCXN1cGVyKHNvdXJjZVZpZXdlciwgb3ZlcnZpZXdSdWxlciwgYW5ub3RhdGlvbkFjY2Vz
cywgc2hhcmVkVGV4dENvbG9ycyk7DQorCQlmU291cmNlVmlld2VyPSBzb3VyY2VWaWV3ZXI7DQor
CQlmU2hhcmVkVGV4dENvbG9ycz0gc2hhcmVkVGV4dENvbG9yczsNCisJfQ0KKwlAT3ZlcnJpZGUN
CisJcHVibGljIHZvaWQgaW5zdGFsbChJUHJlZmVyZW5jZVN0b3JlIHN0b3JlKSB7DQorLy8JCXN1
cGVyLmluc3RhbGwoc3RvcmUpOw0KKwkJDQorCQlmUHJlZmVyZW5jZVN0b3JlID0gc3RvcmU7DQor
CQlpZiAoaXNDdXJzb3JMaW5lU2hvd24oKSkNCisJCQlzaG93Q3Vyc29yTGluZSgpOw0KKwkJZWxz
ZQ0KKwkJCWhpZGVDdXJzb3JMaW5lKCk7DQorDQorCQlzdXBlci5pbnN0YWxsKHN0b3JlKTsNCisJ
fQ0KKw0KKwkvKioNCisJICogVGVsbHMgd2hldGhlciB0aGUgY3Vyc29yIGxpbmUgaXMgc2hvd24u
DQorCSAqDQorCSAqIEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIGN1cnNvciBsaW5l
IGlzIHNob3duDQorCSAqLw0KKwlwcml2YXRlIGJvb2xlYW4gaXNDdXJzb3JMaW5lU2hvd24oKSB7
DQorCQlpZiAoZlByZWZlcmVuY2VTdG9yZSAhPSBudWxsICYmIGZDdXJzb3JMaW5lUGFpbnRlckVu
YWJsZUtleSAhPSBudWxsKQ0KKwkJCXJldHVybiBmUHJlZmVyZW5jZVN0b3JlLmdldEJvb2xlYW4o
ZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5KTsNCisJCXJldHVybiBmYWxzZTsNCisJfQ0KKw0K
KwkvKioNCisJICogU2V0cyB0aGUgcHJlZmVyZW5jZSBrZXlzIGZvciB0aGUgY3Vyc29yIGxpbmUg
cGFpbnRlci4NCisJICogQHBhcmFtIGVuYWJsZUtleSB0aGUgcHJlZmVyZW5jZSBrZXkgZm9yIHRo
ZSBjdXJzb3IgbGluZSBwYWludGVyDQorCSAqIEBwYXJhbSBjb2xvcktleSB0aGUgcHJlZmVyZW5j
ZSBrZXkgZm9yIHRoZSBjb2xvciB1c2VkIGJ5IHRoZSBjdXJzb3IgbGluZQ0KKwkgKiAgICAgICAg
cGFpbnRlcg0KKwkgKi8NCisJcHVibGljIHZvaWQgc2V0Q3Vyc29yTGluZVBhaW50ZXJQcmVmZXJl
bmNlS2V5cyhTdHJpbmcgZW5hYmxlS2V5LCBTdHJpbmcgY29sb3JLZXkpIHsNCisJCXN1cGVyLnNl
dEN1cnNvckxpbmVQYWludGVyUHJlZmVyZW5jZUtleXMoZW5hYmxlS2V5LCBjb2xvcktleSk7DQor
CQlmQ3Vyc29yTGluZVBhaW50ZXJFbmFibGVLZXk9IGVuYWJsZUtleTsNCisJCWZDdXJzb3JMaW5l
UGFpbnRlckNvbG9yS2V5PSBjb2xvcktleTsNCisJfQ0KKwkNCisJQE92ZXJyaWRlDQorCXByb3Rl
Y3RlZCB2b2lkIGhhbmRsZVByZWZlcmVuY2VTdG9yZUNoYW5nZWQoUHJvcGVydHlDaGFuZ2VFdmVu
dCBldmVudCkgew0KKw0KKwkJU3RyaW5nIHA9IGV2ZW50LmdldFByb3BlcnR5KCk7DQorCQlpZiAo
ZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5ICE9IG51bGwgJiYgZkN1cnNvckxpbmVQYWludGVy
RW5hYmxlS2V5LmVxdWFscyhwKSkgew0KKwkJCWlmIChpc0N1cnNvckxpbmVTaG93bigpKQ0KKwkJ
CQlzaG93Q3Vyc29yTGluZSgpOw0KKwkJCWVsc2UNCisJCQkJaGlkZUN1cnNvckxpbmUoKTsNCisJ
CQlyZXR1cm47DQorCQl9DQorDQorCQkNCisJCXN1cGVyLmhhbmRsZVByZWZlcmVuY2VTdG9yZUNo
YW5nZWQoZXZlbnQpOw0KKw0KKwl9DQorCQ0KKw0KKwkvKiogVGhlIGVkaXRvcidzIGxpbmUgcGFp
bnRlciAqLw0KKwlwcml2YXRlIFBIUEN1cnNvckxpbmVQYWludGVyIGZDdXJzb3JMaW5lUGFpbnRl
cjsNCisJLyoqDQorCSAqIFNob3dzIHRoZSBjdXJzb3IgbGluZS4NCisJICovDQorCXByaXZhdGUg
dm9pZCBzaG93Q3Vyc29yTGluZSgpIHsNCisJCWlmIChmQ3Vyc29yTGluZVBhaW50ZXIgPT0gbnVs
bCkgew0KKwkJCWlmIChmU291cmNlVmlld2VyIGluc3RhbmNlb2YgSVRleHRWaWV3ZXJFeHRlbnNp
b24yKSB7DQorCQkJCWZDdXJzb3JMaW5lUGFpbnRlcj0gbmV3IFBIUEN1cnNvckxpbmVQYWludGVy
KGZTb3VyY2VWaWV3ZXIpOw0KKy8vCQkJCWZDdXJzb3JMaW5lUGFpbnRlci5zZXRIaWdobGlnaHRD
b2xvcihnZXRDb2xvcihmQ3Vyc29yTGluZVBhaW50ZXJDb2xvcktleSkpOw0KKwkJCQlJVGV4dFZp
ZXdlckV4dGVuc2lvbjIgZXh0ZW5zaW9uPSAoSVRleHRWaWV3ZXJFeHRlbnNpb24yKSBmU291cmNl
Vmlld2VyOw0KKwkJCQlleHRlbnNpb24uYWRkUGFpbnRlcihmQ3Vyc29yTGluZVBhaW50ZXIpOw0K
KwkJCX0NCisJCX0NCisJfQ0KKw0KKwkvKioNCisJICogUmV0dXJucyB0aGUgc2hhcmVkIGNvbG9y
IGZvciB0aGUgZ2l2ZW4ga2V5Lg0KKwkgKg0KKwkgKiBAcGFyYW0ga2V5IHRoZSBjb2xvciBrZXkg
c3RyaW5nDQorCSAqIEByZXR1cm4gdGhlIHNoYXJlZCBjb2xvciBmb3IgdGhlIGdpdmVuIGtleQ0K
KwkgKi8NCisJcHJpdmF0ZSBDb2xvciBnZXRDb2xvcihTdHJpbmcga2V5KSB7DQorCQlpZiAoZlBy
ZWZlcmVuY2VTdG9yZSAhPSBudWxsKSB7DQorCQkJUkdCIHJnYj0gUHJlZmVyZW5jZUNvbnZlcnRl
ci5nZXRDb2xvcihmUHJlZmVyZW5jZVN0b3JlLCBrZXkpOw0KKwkJCXJldHVybiBnZXRDb2xvcihy
Z2IpOw0KKwkJfQ0KKwkJcmV0dXJuIG51bGw7DQorCX0NCisNCisJLyoqDQorCSAqIFJldHVybnMg
dGhlIHNoYXJlZCBjb2xvciBmb3IgdGhlIGdpdmVuIFJHQi4NCisJICoNCisJICogQHBhcmFtIHJn
YiB0aGUgUkdCDQorCSAqIEByZXR1cm4gdGhlIHNoYXJlZCBjb2xvciBmb3IgdGhlIGdpdmVuIFJH
Qg0KKwkgKi8NCisJcHJpdmF0ZSBDb2xvciBnZXRDb2xvcihSR0IgcmdiKSB7DQorCQlyZXR1cm4g
ZlNoYXJlZFRleHRDb2xvcnMuZ2V0Q29sb3IocmdiKTsNCisJfQ0KKw0KKwkvKioNCisJICogSGlk
ZXMgdGhlIGN1cnNvciBsaW5lLg0KKwkgKi8NCisJcHJpdmF0ZSB2b2lkIGhpZGVDdXJzb3JMaW5l
KCkgew0KKwkJaWYgKGZDdXJzb3JMaW5lUGFpbnRlciAhPSBudWxsKSB7DQorCQkJaWYgKGZTb3Vy
Y2VWaWV3ZXIgaW5zdGFuY2VvZiBJVGV4dFZpZXdlckV4dGVuc2lvbjIpIHsNCisJCQkJSVRleHRW
aWV3ZXJFeHRlbnNpb24yIGV4dGVuc2lvbj0gKElUZXh0Vmlld2VyRXh0ZW5zaW9uMikgZlNvdXJj
ZVZpZXdlcjsNCisJCQkJZXh0ZW5zaW9uLnJlbW92ZVBhaW50ZXIoZkN1cnNvckxpbmVQYWludGVy
KTsNCisJCQkJZkN1cnNvckxpbmVQYWludGVyLmRlYWN0aXZhdGUodHJ1ZSk7DQorCQkJCWZDdXJz
b3JMaW5lUGFpbnRlci5kaXNwb3NlKCk7DQorCQkJCWZDdXJzb3JMaW5lUGFpbnRlcj0gbnVsbDsN
CisJCQl9DQorCQl9DQorCX0NCisNCit9DQo=
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>156897</attachid>
            <date>2010-01-22 02:33:00 -0500</date>
            <delta_ts>2010-01-22 02:38:59 -0500</delta_ts>
            <desc>patch</desc>
            <filename>linebackground.txt</filename>
            <type>text/plain</type>
            <size>24044</size>
            <attacher name="Zhongwei Zhao">zhaozhongwei</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UucGhwLnVpDQpJ
bmRleDogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJl
ZEVkaXRvci5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvdG9vbHMvb3JnLmVj
bGlwc2UucGR0L3BsdWdpbnMvb3JnLmVjbGlwc2UucGhwLnVpL3NyYy9vcmcvZWNsaXBzZS9waHAv
aW50ZXJuYWwvdWkvZWRpdG9yL1BIUFN0cnVjdHVyZWRFZGl0b3IuamF2YSx2DQpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuMTMyDQpkaWZmIC11IC1yMS4xMzIgUEhQU3RydWN0dXJlZEVkaXRvci5qYXZh
DQotLS0gc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJl
ZEVkaXRvci5qYXZhCTIwIEphbiAyMDEwIDA3OjM1OjU4IC0wMDAwCTEuMTMyDQorKysgc3JjL29y
Zy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU3RydWN0dXJlZEVkaXRvci5qYXZh
CTIyIEphbiAyMDEwIDA3OjMzOjI3IC0wMDAwDQpAQCAtMzMzMiw0ICszMzMyLDE0IEBADQogCQkJ
KChDb25maWd1cmFibGVDb250ZW50T3V0bGluZVBhZ2UpIGZQSFBPdXRsaW5lUGFnZSkuc2V0SW5w
dXQoZ2V0TW9kZWxFbGVtZW50KCkpOw0KIAkJfQ0KIAl9DQorCQ0KKwlAT3ZlcnJpZGUNCisJcHJv
dGVjdGVkIFNvdXJjZVZpZXdlckRlY29yYXRpb25TdXBwb3J0IGdldFNvdXJjZVZpZXdlckRlY29y
YXRpb25TdXBwb3J0KA0KKwkJCUlTb3VyY2VWaWV3ZXIgdmlld2VyKSB7DQorCQlpZiAoZlNvdXJj
ZVZpZXdlckRlY29yYXRpb25TdXBwb3J0ID09IG51bGwpIHsNCisJCQlmU291cmNlVmlld2VyRGVj
b3JhdGlvblN1cHBvcnQ9IG5ldyBQSFBTb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9ydCh2aWV3
ZXIsIGdldE92ZXJ2aWV3UnVsZXIoKSwgZ2V0QW5ub3RhdGlvbkFjY2VzcygpLCBnZXRTaGFyZWRD
b2xvcnMoKSk7DQorCQkJY29uZmlndXJlU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQoZlNv
dXJjZVZpZXdlckRlY29yYXRpb25TdXBwb3J0KTsNCisJCX0NCisJCXJldHVybiBmU291cmNlVmll
d2VyRGVjb3JhdGlvblN1cHBvcnQ7DQorCX0NCiB9DQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZp
bGUNCkluZGV4OiBzcmMvb3JnL2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGln
aHRlci9MaW5lU3R5bGVQcm92aWRlckZvclBocC5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTog
L2N2c3Jvb3QvdG9vbHMvb3JnLmVjbGlwc2UucGR0L3BsdWdpbnMvb3JnLmVjbGlwc2UucGhwLnVp
L3NyYy9vcmcvZWNsaXBzZS9waHAvaW50ZXJuYWwvdWkvZWRpdG9yL2hpZ2hsaWdodGVyL0xpbmVT
dHlsZVByb3ZpZGVyRm9yUGhwLmphdmEsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjI5DQpkaWZm
IC11IC1yMS4yOSBMaW5lU3R5bGVQcm92aWRlckZvclBocC5qYXZhDQotLS0gc3JjL29yZy9lY2xp
cHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvTGluZVN0eWxlUHJvdmlkZXJG
b3JQaHAuamF2YQkxOCBKYW4gMjAxMCAwODoyODowMCAtMDAwMAkxLjI5DQorKysgc3JjL29yZy9l
Y2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvTGluZVN0eWxlUHJvdmlk
ZXJGb3JQaHAuamF2YQkyMiBKYW4gMjAxMCAwNzozMzoyOCAtMDAwMA0KQEAgLTM3NSw3ICszNzUs
NyBAQA0KIAkJCX0NCiAJCX0NCiAJfQ0KLQkNCisNCiAJcHJvdGVjdGVkIHZvaWQgYWRkRGVmYXVs
dFRleHRBdHRyaWJ1dGUoU3RyaW5nIGNvbG9yS2V5KSB7DQogCQlpZiAoZ2V0Q29sb3JQcmVmZXJl
bmNlcygpICE9IG51bGwpIHsNCiAJCQlTdHJpbmcgcHJlZlN0cmluZyA9IFByZWZlcmVuY2VDb25z
dGFudHMuRURJVE9SX05PUk1BTF9ERUZBVUxUX0NPTE9SOw0KQEAgLTM4Nyw3ICszODcsNyBAQA0K
IAkJCX0NCiAJCX0NCiAJfQ0KLQkNCisNCiAJLyoNCiAJICogQ3JlYXRlcyBUZXh0QXR0cmlidXRl
IGZyb20gdGhlIGdpdmVuIHN0eWxlIGRlc2NyaXB0aW9uIGFycmF5IHN0cmluZw0KIAkgKi8NCkBA
IC00MjcsNyArNDI3LDcgQEANCiAJCS8vIGluc3RlYWQgb2YgZW5kLXN0YXJ0Pw0KIAkJaWYgKGVu
ZCA+IG1heE9mZnNldCkNCiAJCQllbmQgPSBtYXhPZmZzZXQ7DQotCQlTdHlsZVJhbmdlIHJlc3Vs
dCA9IG5ldyBTdHlsZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCwgYXR0cg0KKwkJU3R5bGVSYW5n
ZSByZXN1bHQgPSBuZXcgUEhQU3R5bGVSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQsIGF0dHINCiAJ
CQkJLmdldEZvcmVncm91bmQoKSwgYXR0ci5nZXRCYWNrZ3JvdW5kKCksIGF0dHIuZ2V0U3R5bGUo
KSk7DQogCQlpZiAoKGF0dHIuZ2V0U3R5bGUoKSAmIFRleHRBdHRyaWJ1dGUuVU5ERVJMSU5FKSAh
PSAwKSB7DQogCQkJcmVzdWx0LnVuZGVybGluZSA9IHRydWU7DQpAQCAtNzE1LDcgKzcxNSw3IEBA
DQogCQkJCQkJLy8gdGhlDQogCQkJCQkJLy8gd2hpdGVzcGFjZXMNCiAJCQkJCQkvLyBhcHBseWlu
ZyBzdHlsZSB0byB0aGUgcmVnaW9uIHcvbyB0aGUgd2hpdGVzcGFjZQ0KLQkJCQkJCXN0eWxlUmFu
Z2UgPSBuZXcgU3R5bGVSYW5nZShzdHlsZVN0YXJ0LCBzdHlsZUxlbmd0aA0KKwkJCQkJCXN0eWxl
UmFuZ2UgPSBuZXcgUEhQU3R5bGVSYW5nZShzdHlsZVN0YXJ0LCBzdHlsZUxlbmd0aA0KIAkJCQkJ
CQkJLSAoZWxlbWVudC5nZXRFbmQoKSAtIGVsZW1lbnQuZ2V0VGV4dEVuZCgpKSwNCiAJCQkJCQkJ
CWF0dHIuZ2V0Rm9yZWdyb3VuZCgpLCBhdHRyLmdldEJhY2tncm91bmQoKSwNCiAJCQkJCQkJCWF0
dHIuZ2V0U3R5bGUoKSk7DQpAQCAtNzMwLDE0ICs3MzAsMTQgQEANCiAJCQkJCQlob2xkUmVzdWx0
cy5hZGQoc3R5bGVSYW5nZSk7DQogCQkJCQkJLy8gYXBwbHlpbmcgc3R5bGUgdG8gdGhlIHdoaXRl
c3BhY2UgKGltcG9ydGFudCBmb3IgdGhlDQogCQkJCQkJLy8gcmVmcmVzaCBvZiB0aGUgc3BlY2lm
aWMgcmFuZ2UNCi0JCQkJCQlzdHlsZVJhbmdlID0gbmV3IFN0eWxlUmFuZ2UocmVnaW9uU3RhcnQN
CisJCQkJCQlzdHlsZVJhbmdlID0gbmV3IFBIUFN0eWxlUmFuZ2UocmVnaW9uU3RhcnQNCiAJCQkJ
CQkJCSsgZWxlbWVudC5nZXRUZXh0RW5kKCksIGVsZW1lbnQuZ2V0RW5kKCkNCiAJCQkJCQkJCS0g
ZWxlbWVudC5nZXRUZXh0RW5kKCksIGF0dHIuZ2V0Rm9yZWdyb3VuZCgpLA0KLQkJCQkJCQkJbnVs
bCwgYXR0ci5nZXRTdHlsZSgpKTsNCisJCQkJCQkJCWF0dHIuZ2V0QmFja2dyb3VuZCgpLCBhdHRy
LmdldFN0eWxlKCkpOw0KIAkJCQkJCWhvbGRSZXN1bHRzLmFkZChzdHlsZVJhbmdlKTsNCiAJCQkJ
CQlwcmV2aW91c0F0dHIgPSBudWxsOw0KIAkJCQkJfSBlbHNlIHsNCi0JCQkJCQlzdHlsZVJhbmdl
ID0gbmV3IFN0eWxlUmFuZ2Uoc3R5bGVTdGFydCwgc3R5bGVMZW5ndGgsDQorCQkJCQkJc3R5bGVS
YW5nZSA9IG5ldyBQSFBTdHlsZVJhbmdlKHN0eWxlU3RhcnQsIHN0eWxlTGVuZ3RoLA0KIAkJCQkJ
CQkJYXR0ci5nZXRGb3JlZ3JvdW5kKCksIGF0dHIuZ2V0QmFja2dyb3VuZCgpLA0KIAkJCQkJCQkJ
YXR0ci5nZXRTdHlsZSgpKTsNCiAJCQkJCQlpZiAoKGF0dHIuZ2V0U3R5bGUoKSAmIFRleHRBdHRy
aWJ1dGUuVU5ERVJMSU5FKSAhPSAwKSB7DQpAQCAtODM5LDI5ICs4MzksNDggQEANCiAJCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0hFUkVET0NfQ09MT1IuZXF1YWxzKHByZWZLZXkp
DQogCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9UQVNLX0NPTE9SLmVxdWFscyhw
cmVmS2V5KSkgew0KIAkJCQlhZGRUZXh0QXR0cmlidXRlKHByZWZLZXkpOw0KLQkJCX0gZWxzZSBp
ZiAoUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNl
Q29uc3RhbnRzLkVESVRPUl9OT1JNQUxfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJfHwg
UHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNlQ29u
c3RhbnRzLkVESVRPUl9CT1VOREFSWU1BUktFUl9DT0xPUikNCi0JCQkJCQkJLmVxdWFscyhwcmVm
S2V5KQ0KLQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtl
eShQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9LRVlXT1JEX0NPTE9SKS5lcXVhbHMocHJlZktl
eSkNCi0JCQkJCXx8IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXko
UHJlZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfVkFSSUFCTEVfQ09MT1IpDQorCQkJfSBlbHNlIGlm
IChQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJUHJl
ZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfTk9STUFMX0NPTE9SKS5lcXVhbHMocHJlZktleSkNCisJ
CQkJCXx8IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoDQorCQkJ
CQkJCVByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0JPVU5EQVJZTUFSS0VSX0NPTE9SKQ0KIAkJ
CQkJCQkuZXF1YWxzKHByZWZLZXkpDQotCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVu
YWJsZWRQcmVmZXJlbmNlS2V5KFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX1NUUklOR19DT0xP
UikuZXF1YWxzKHByZWZLZXkpDQotCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJs
ZWRQcmVmZXJlbmNlS2V5KFByZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX0NPTU1FTlRfQ09MT1Ip
LmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVk
UHJlZmVyZW5jZUtleShQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9MSU5FX0NPTU1FTlRfQ09M
T1IpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5
KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9LRVlXT1JEX0NPTE9SKS5lcXVh
bHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVu
YWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9W
QVJJQUJMRV9DT0xPUikuZXF1YWxzKA0KKwkJCQkJCQlwcmVmS2V5KQ0KKwkJCQkJfHwgUHJlZmVy
ZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleSgNCisJCQkJCQkJUHJlZmVyZW5j
ZUNvbnN0YW50cy5FRElUT1JfU1RSSU5HX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkp
DQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0K
KwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9DT01NRU5UX0NPTE9SKS5lcXVhbHMo
DQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJs
ZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9MSU5F
X0NPTU1FTlRfQ09MT1IpDQogCQkJCQkJCS5lcXVhbHMocHJlZktleSkNCi0JCQkJCXx8IFByZWZl
cmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoUHJlZmVyZW5jZUNvbnN0YW50
cy5FRElUT1JfUEhQRE9DX0NPTU1FTlRfQ09MT1IpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3Rh
bnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRz
LkVESVRPUl9QSFBET0NfQ09NTUVOVF9DT0xPUikNCiAJCQkJCQkJLmVxdWFscyhwcmVmS2V5KQ0K
LQkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVm
ZXJlbmNlQ29uc3RhbnRzLkVESVRPUl9QSFBET0NfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJ
CQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJl
bmNlQ29uc3RhbnRzLkVESVRPUl9OVU1CRVJfQ09MT1IpLmVxdWFscyhwcmVmS2V5KQ0KLQkJCQkJ
fHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5jZUtleShQcmVmZXJlbmNl
Q29uc3RhbnRzLkVESVRPUl9IRVJFRE9DX0NPTE9SKS5lcXVhbHMocHJlZktleSkNCi0JCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoUHJlZmVyZW5jZUNv
bnN0YW50cy5FRElUT1JfVEFTS19DT0xPUikuZXF1YWxzKHByZWZLZXkpKSB7DQotCQkJCQlib29s
ZWFuIGVuYWJsZWQgPSBnZXRDb2xvclByZWZlcmVuY2VzKCkuZ2V0Qm9vbGVhbihwcmVmS2V5KTsN
Ci0JCQkJCXByZWZLZXkgPSBwcmVmS2V5LnNwbGl0KCJcXC4iKVsxXTsNCi0JCQkJCWlmKGVuYWJs
ZWQpew0KLQkJCQkJCWFkZFRleHRBdHRyaWJ1dGUocHJlZktleSk7DQotCQkJCQl9ZWxzZXsNCi0J
CQkJCQlhZGREZWZhdWx0VGV4dEF0dHJpYnV0ZShwcmVmS2V5KTsNCi0JCQkJCX0NCisJCQkJCXx8
IFByZWZlcmVuY2VDb25zdGFudHMuZ2V0RW5hYmxlZFByZWZlcmVuY2VLZXkoDQorCQkJCQkJCVBy
ZWZlcmVuY2VDb25zdGFudHMuRURJVE9SX1BIUERPQ19DT0xPUikuZXF1YWxzKA0KKwkJCQkJCQlw
cmVmS2V5KQ0KKwkJCQkJfHwgUHJlZmVyZW5jZUNvbnN0YW50cy5nZXRFbmFibGVkUHJlZmVyZW5j
ZUtleSgNCisJCQkJCQkJUHJlZmVyZW5jZUNvbnN0YW50cy5FRElUT1JfTlVNQkVSX0NPTE9SKS5l
cXVhbHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVmZXJlbmNlQ29uc3RhbnRzLmdl
dEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJlbmNlQ29uc3RhbnRzLkVESVRP
Ul9IRVJFRE9DX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkpDQorCQkJCQl8fCBQcmVm
ZXJlbmNlQ29uc3RhbnRzLmdldEVuYWJsZWRQcmVmZXJlbmNlS2V5KA0KKwkJCQkJCQlQcmVmZXJl
bmNlQ29uc3RhbnRzLkVESVRPUl9UQVNLX0NPTE9SKS5lcXVhbHMoDQorCQkJCQkJCXByZWZLZXkp
KSB7DQorCQkJCWJvb2xlYW4gZW5hYmxlZCA9IGdldENvbG9yUHJlZmVyZW5jZXMoKS5nZXRCb29s
ZWFuKHByZWZLZXkpOw0KKwkJCQlwcmVmS2V5ID0gcHJlZktleS5zcGxpdCgiXFwuIilbMV07DQor
CQkJCWlmIChlbmFibGVkKSB7DQorCQkJCQlhZGRUZXh0QXR0cmlidXRlKHByZWZLZXkpOw0KKwkJ
CQl9IGVsc2Ugew0KKwkJCQkJYWRkRGVmYXVsdFRleHRBdHRyaWJ1dGUocHJlZktleSk7DQorCQkJ
CX0NCiAJCQl9DQogCQl9IGVsc2Ugew0KIAkJCWxvYWRDb2xvcnMoKTsNCkluZGV4OiBzcmMvb3Jn
L2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJhbmdl
LmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiBzcmMvb3JnL2VjbGlwc2UvcGhwL2ludGVybmFs
L3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJhbmdlLmphdmENCmRpZmYgLU4gc3JjL29y
Zy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvaGlnaGxpZ2h0ZXIvUEhQU3R5bGVSYW5n
ZS5qYXZhDQotLS0gL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCisrKyBzcmMv
b3JnL2VjbGlwc2UvcGhwL2ludGVybmFsL3VpL2VkaXRvci9oaWdobGlnaHRlci9QSFBTdHlsZVJh
bmdlLmphdmEJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KQEAgLTAsMCArMSw2NiBAQA0KK3Bh
Y2thZ2Ugb3JnLmVjbGlwc2UucGhwLmludGVybmFsLnVpLmVkaXRvci5oaWdobGlnaHRlcjsNCisN
CitpbXBvcnQgamF2YS5sYW5nLnJlZi5XZWFrUmVmZXJlbmNlOw0KK2ltcG9ydCBqYXZhLnV0aWwu
QXJyYXlMaXN0Ow0KK2ltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7DQoraW1wb3J0IGphdmEudXRp
bC5MaXN0Ow0KKw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuY3VzdG9tLlN0eWxlUmFuZ2U7DQor
aW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ncmFwaGljcy5Db2xvcjsNCisNCitwdWJsaWMgY2xhc3Mg
UEhQU3R5bGVSYW5nZSBleHRlbmRzIFN0eWxlUmFuZ2Ugew0KKwlwcml2YXRlIGZpbmFsIENvbG9y
IHJlYWxiYWNrZ3JvdW5kOw0KKwlwcml2YXRlIExpc3Q8V2Vha1JlZmVyZW5jZTxQSFBTdHlsZVJh
bmdlPj4gYWxsQ2xvbmVzID0gbmV3IEFycmF5TGlzdDxXZWFrUmVmZXJlbmNlPFBIUFN0eWxlUmFu
Z2U+PigpOw0KKw0KKwlwdWJsaWMgUEhQU3R5bGVSYW5nZShpbnQgc3RhcnQsIGludCBsZW5ndGgs
IENvbG9yIGZvcmVncm91bmQsDQorCQkJQ29sb3IgYmFja2dyb3VuZCwgaW50IGZvbnRTdHlsZSkg
ew0KKwkJc3VwZXIoc3RhcnQsIGxlbmd0aCwgZm9yZWdyb3VuZCwgYmFja2dyb3VuZCwgZm9udFN0
eWxlKTsNCisJCXRoaXMucmVhbGJhY2tncm91bmQgPSBiYWNrZ3JvdW5kOw0KKwkJYWxsQ2xvbmVz
LmFkZChuZXcgV2Vha1JlZmVyZW5jZTxQSFBTdHlsZVJhbmdlPih0aGlzKSk7DQorCX0NCisNCisJ
LyoqDQorCSAqIHdoZW4gdGhpcyBQSFBTdHlsZVJhbmdlIGlzIGluIG9uZSB0aGUgY3VycmVjdCBs
aW5lLGNhbGwgdGhpcyBtZXRob2QNCisJICovDQorCXB1YmxpYyB2b2lkIGNsZWFyQmFja2dyb3Vu
ZCgpIHsNCisJCWZvciAoSXRlcmF0b3I8V2Vha1JlZmVyZW5jZTxQSFBTdHlsZVJhbmdlPj4gaXRl
cmF0b3IgPSBhbGxDbG9uZXMNCisJCQkJLml0ZXJhdG9yKCk7IGl0ZXJhdG9yLmhhc05leHQoKTsp
IHsNCisJCQlXZWFrUmVmZXJlbmNlPFBIUFN0eWxlUmFuZ2U+IHdlYWtSZWZlcmVuY2UgPSAoV2Vh
a1JlZmVyZW5jZTxQSFBTdHlsZVJhbmdlPikgaXRlcmF0b3INCisJCQkJCS5uZXh0KCk7DQorCQkJ
UEhQU3R5bGVSYW5nZSBzdHlsZVJhbmdlID0gd2Vha1JlZmVyZW5jZS5nZXQoKTsNCisJCQlpZiAo
c3R5bGVSYW5nZSAhPSBudWxsKSB7DQorCQkJCXN0eWxlUmFuZ2UuYmFja2dyb3VuZCA9IG51bGw7
DQorCQkJfQ0KKwkJfQ0KKwl9DQorDQorCS8qKg0KKwkgKiB3aGVuIHRoaXMgUEhQU3R5bGVSYW5n
ZSBpcyBOT1QgaW4gb25lIHRoZSBjdXJyZWN0IGxpbmUsY2FsbCB0aGlzIG1ldGhvZA0KKwkgKi8N
CisJcHVibGljIHZvaWQgcmVzZXRCYWNrZ3JvdW5kKCkgew0KKwkJZm9yIChJdGVyYXRvcjxXZWFr
UmVmZXJlbmNlPFBIUFN0eWxlUmFuZ2U+PiBpdGVyYXRvciA9IGFsbENsb25lcw0KKwkJCQkuaXRl
cmF0b3IoKTsgaXRlcmF0b3IuaGFzTmV4dCgpOykgew0KKwkJCVdlYWtSZWZlcmVuY2U8UEhQU3R5
bGVSYW5nZT4gd2Vha1JlZmVyZW5jZSA9IChXZWFrUmVmZXJlbmNlPFBIUFN0eWxlUmFuZ2U+KSBp
dGVyYXRvcg0KKwkJCQkJLm5leHQoKTsNCisJCQlQSFBTdHlsZVJhbmdlIHN0eWxlUmFuZ2UgPSB3
ZWFrUmVmZXJlbmNlLmdldCgpOw0KKwkJCWlmIChzdHlsZVJhbmdlICE9IG51bGwpIHsNCisJCQkJ
c3R5bGVSYW5nZS5iYWNrZ3JvdW5kID0gcmVhbGJhY2tncm91bmQ7DQorCQkJfQ0KKwkJfQ0KKwl9
DQorDQorCS8vIEBPdmVycmlkZQ0KKwlwdWJsaWMgT2JqZWN0IGNsb25lKCkgew0KKwkJUEhQU3R5
bGVSYW5nZSBjbG9uZSA9IChQSFBTdHlsZVJhbmdlKSBzdXBlci5jbG9uZSgpOw0KKwkJLy8gdGhp
cyBpcyBpbXBvcnRhbnQgZm9yIFN0eWxlZFRleHQgYWx3YXlzIHJldHVybiB0aGUgY2xvbmVzIG9m
IGl0cw0KKwkJLy8gU3R5bGVSYW5nZSxzbyBpZiB3ZSBub3QgY29sbGVjdCBhbGwgdGhlIGNsb25l
cyhpbmNsdWRpbmcgaXRzZWxmKSx3aGVuDQorCQkvLyB3ZSBzZXQgaXRzIGJhY2tncm91bmQgd2ls
bCBtYWtlIG5vIGVmZmVjdCxmb3IgeW91IGFsd2F5cyBjaGFuZ2UgaXRzDQorCQkvLyBjbG9uZSBv
YmplY3QncyBiYWNrZ3JvdW5kIHByb3BlcnR5DQorCQlhbGxDbG9uZXMuYWRkKG5ldyBXZWFrUmVm
ZXJlbmNlPFBIUFN0eWxlUmFuZ2U+KGNsb25lKSk7DQorCQlyZXR1cm4gY2xvbmU7DQorCX0NCisN
CisJcHVibGljIHZvaWQgcmVtb3ZlU2VsZigpIHsNCisJCWFsbENsb25lcy5yZW1vdmUodGhpcyk7
DQorCX0NCit9DQpJbmRleDogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3Iv
UEhQQ3Vyc29yTGluZVBhaW50ZXIuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IHNyYy9vcmcv
ZWNsaXBzZS9waHAvaW50ZXJuYWwvdWkvZWRpdG9yL1BIUEN1cnNvckxpbmVQYWludGVyLmphdmEN
CmRpZmYgLU4gc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQQ3Vyc29y
TGluZVBhaW50ZXIuamF2YQ0KLS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAw
DQorKysgc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQQ3Vyc29yTGlu
ZVBhaW50ZXIuamF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDI2NCBA
QA0KK3BhY2thZ2Ugb3JnLmVjbGlwc2UucGhwLmludGVybmFsLnVpLmVkaXRvcjsNCisNCitpbXBv
cnQgb3JnLmVjbGlwc2UuamZhY2UudGV4dC4qOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5waHAuaW50
ZXJuYWwudWkuZWRpdG9yLmhpZ2hsaWdodGVyLlBIUFN0eWxlUmFuZ2U7DQoraW1wb3J0IG9yZy5l
Y2xpcHNlLnN3dC5jdXN0b20uTGluZUJhY2tncm91bmRFdmVudDsNCitpbXBvcnQgb3JnLmVjbGlw
c2Uuc3d0LmN1c3RvbS5MaW5lQmFja2dyb3VuZExpc3RlbmVyOw0KK2ltcG9ydCBvcmcuZWNsaXBz
ZS5zd3QuY3VzdG9tLlN0eWxlUmFuZ2U7DQoraW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5jdXN0b20u
U3R5bGVkVGV4dDsNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmdyYXBoaWNzLlBvaW50Ow0KKw0K
K3B1YmxpYyBjbGFzcyBQSFBDdXJzb3JMaW5lUGFpbnRlciBpbXBsZW1lbnRzIElQYWludGVyLCBM
aW5lQmFja2dyb3VuZExpc3RlbmVyIHsNCisNCisJLyoqIFRoZSB2aWV3ZXIgdGhlIHBhaW50ZXIg
d29ya3Mgb24gKi8NCisJcHJpdmF0ZSBmaW5hbCBJVGV4dFZpZXdlciBmVmlld2VyOw0KKwkvKiog
VGhlIHBhaW50IHBvc2l0aW9uIG1hbmFnZXIgZm9yIG1hbmFnaW5nIHRoZSBsaW5lIGNvb3JkaW5h
dGVzICovDQorCXByaXZhdGUgSVBhaW50UG9zaXRpb25NYW5hZ2VyIGZQb3NpdGlvbk1hbmFnZXI7
DQorCS8qKiBLZWVwcyB0cmFjayBvZiB0aGUgbGluZSB0byBiZSBwYWludGVkICovDQorCXByaXZh
dGUgUG9zaXRpb24gZkN1cnJlbnRMaW5lID0gbmV3IFBvc2l0aW9uKDAsIDApOw0KKwkvKiogS2Vl
cHMgdHJhY2sgb2YgdGhlIGxpbmUgdG8gYmUgY2xlYXJlZCAqLw0KKwlwcml2YXRlIFBvc2l0aW9u
IGZMYXN0TGluZSA9IG5ldyBQb3NpdGlvbigwLCAwKTsNCisJLyoqIEtlZXBzIHRyYWNrIG9mIHRo
ZSBsaW5lIG51bWJlciBvZiB0aGUgbGFzdCBwYWludGVkIGxpbmUgKi8NCisJcHJpdmF0ZSBpbnQg
Zkxhc3RMaW5lTnVtYmVyID0gLTE7DQorCS8qKiBJbmRpY2F0ZXMgd2hldGhlciB0aGlzIHBhaW50
ZXIgaXMgYWN0aXZlICovDQorCXByaXZhdGUgYm9vbGVhbiBmSXNBY3RpdmU7DQorDQorCS8qKg0K
KwkgKiBDcmVhdGVzIGEgbmV3IHBhaW50ZXIgZm9yIHRoZSBnaXZlbiBzb3VyY2Ugdmlld2VyLg0K
KwkgKiANCisJICogQHBhcmFtIHRleHRWaWV3ZXINCisJICogICAgICAgICAgICB0aGUgc291cmNl
IHZpZXdlciBmb3Igd2hpY2ggdG8gY3JlYXRlIGEgcGFpbnRlcg0KKwkgKi8NCisJcHVibGljIFBI
UEN1cnNvckxpbmVQYWludGVyKElUZXh0Vmlld2VyIHRleHRWaWV3ZXIpIHsNCisJCWZWaWV3ZXIg
PSB0ZXh0Vmlld2VyOw0KKwl9DQorDQorCS8qKg0KKwkgKiBTZXRzIHRoZSBjb2xvciBpbiB3aGlj
aCB0byBkcmF3IHRoZSBiYWNrZ3JvdW5kIG9mIHRoZSBjdXJzb3IgbGluZS4NCisJICogDQorCSAq
IEBwYXJhbSBoaWdobGlnaHRDb2xvcg0KKwkgKiAgICAgICAgICAgIHRoZSBjb2xvciBpbiB3aGlj
aCB0byBkcmF3IHRoZSBiYWNrZ3JvdW5kIG9mIHRoZSBjdXJzb3IgbGluZQ0KKwkgKi8NCisNCisJ
LyoNCisJICogQHNlZSBMaW5lQmFja2dyb3VuZExpc3RlbmVyI2xpbmVHZXRCYWNrZ3JvdW5kKExp
bmVCYWNrZ3JvdW5kRXZlbnQpDQorCSAqLw0KKwlwdWJsaWMgdm9pZCBsaW5lR2V0QmFja2dyb3Vu
ZChMaW5lQmFja2dyb3VuZEV2ZW50IGV2ZW50KSB7DQorCX0NCisNCisJLyoqDQorCSAqIFVwZGF0
ZXMgYWxsIHRoZSBjYWNoZWQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGxpbmVzIHRvIGJlIHBhaW50
ZWQgYW5kIHRvDQorCSAqIGJlIGNsZWFyZWQuIFJldHVybnMgPGNvZGU+dHJ1ZTwvY29kZT4gaWYg
dGhlIGxpbmUgbnVtYmVyIG9mIHRoZSBjdXJzb3INCisJICogbGluZSBoYXMgY2hhbmdlZC4NCisJ
ICogDQorCSAqIEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgY3Vyc29yIGxpbmUgY2hhbmdl
ZA0KKwkgKi8NCisJcHJpdmF0ZSBib29sZWFuIHVwZGF0ZUhpZ2hsaWdodExpbmUoKSB7DQorCQl0
cnkgew0KKw0KKwkJCUlEb2N1bWVudCBkb2N1bWVudCA9IGZWaWV3ZXIuZ2V0RG9jdW1lbnQoKTsN
CisJCQlpbnQgbW9kZWxDYXJldCA9IGdldE1vZGVsQ2FyZXQoKTsNCisJCQlpbnQgbGluZU51bWJl
ciA9IGRvY3VtZW50LmdldExpbmVPZk9mZnNldChtb2RlbENhcmV0KTsNCisNCisJCQkvLyByZWRy
YXcgaWYgdGhlIGN1cnJlbnQgbGluZSBudW1iZXIgaXMgZGlmZmVyZW50IGZyb20gdGhlIGxhc3Qg
bGluZQ0KKwkJCS8vIG51bWJlciB3ZSBwYWludGVkDQorCQkJLy8gaW5pdGlhbGx5IGZMYXN0TGlu
ZU51bWJlciBpcyAtMQ0KKwkJCWlmIChsaW5lTnVtYmVyICE9IGZMYXN0TGluZU51bWJlcg0KKwkJ
CQkJfHwgIWZDdXJyZW50TGluZS5vdmVybGFwc1dpdGgobW9kZWxDYXJldCwgMCkpIHsNCisNCisJ
CQkJZkxhc3RMaW5lLm9mZnNldCA9IGZDdXJyZW50TGluZS5vZmZzZXQ7DQorCQkJCWZMYXN0TGlu
ZS5sZW5ndGggPSBmQ3VycmVudExpbmUubGVuZ3RoOw0KKwkJCQlmTGFzdExpbmUuaXNEZWxldGVk
ID0gZkN1cnJlbnRMaW5lLmlzRGVsZXRlZDsNCisNCisJCQkJaWYgKGZDdXJyZW50TGluZS5pc0Rl
bGV0ZWQpIHsNCisJCQkJCWZDdXJyZW50TGluZS5pc0RlbGV0ZWQgPSBmYWxzZTsNCisJCQkJCWZQ
b3NpdGlvbk1hbmFnZXIubWFuYWdlUG9zaXRpb24oZkN1cnJlbnRMaW5lKTsNCisJCQkJfQ0KKw0K
KwkJCQlmQ3VycmVudExpbmUub2Zmc2V0ID0gZG9jdW1lbnQuZ2V0TGluZU9mZnNldChsaW5lTnVt
YmVyKTsNCisJCQkJaWYgKGxpbmVOdW1iZXIgPT0gZG9jdW1lbnQuZ2V0TnVtYmVyT2ZMaW5lcygp
IC0gMSkNCisJCQkJCWZDdXJyZW50TGluZS5sZW5ndGggPSBkb2N1bWVudC5nZXRMZW5ndGgoKQ0K
KwkJCQkJCQktIGZDdXJyZW50TGluZS5vZmZzZXQ7DQorCQkJCWVsc2UNCisJCQkJCWZDdXJyZW50
TGluZS5sZW5ndGggPSBkb2N1bWVudA0KKwkJCQkJCQkuZ2V0TGluZU9mZnNldChsaW5lTnVtYmVy
ICsgMSkNCisJCQkJCQkJLSBmQ3VycmVudExpbmUub2Zmc2V0Ow0KKw0KKwkJCQlmTGFzdExpbmVO
dW1iZXIgPSBsaW5lTnVtYmVyOw0KKwkJCQlyZXR1cm4gdHJ1ZTsNCisNCisJCQl9DQorDQorCQl9
IGNhdGNoIChCYWRMb2NhdGlvbkV4Y2VwdGlvbiBlKSB7DQorCQl9DQorDQorCQlyZXR1cm4gZmFs
c2U7DQorCX0NCisNCisJLyoqDQorCSAqIFJldHVybnMgdGhlIGxvY2F0aW9uIG9mIHRoZSBjYXJl
dCBhcyBvZmZzZXQgaW4gdGhlIHNvdXJjZSB2aWV3ZXIncyBpbnB1dA0KKwkgKiBkb2N1bWVudC4N
CisJICogDQorCSAqIEByZXR1cm4gdGhlIGNhcmV0IGxvY2F0aW9uDQorCSAqLw0KKwlwcml2YXRl
IGludCBnZXRNb2RlbENhcmV0KCkgew0KKwkJaW50IHdpZGdldENhcmV0ID0gZlZpZXdlci5nZXRU
ZXh0V2lkZ2V0KCkuZ2V0Q2FyZXRPZmZzZXQoKTsNCisJCWlmIChmVmlld2VyIGluc3RhbmNlb2Yg
SVRleHRWaWV3ZXJFeHRlbnNpb241KSB7DQorCQkJSVRleHRWaWV3ZXJFeHRlbnNpb241IGV4dGVu
c2lvbiA9IChJVGV4dFZpZXdlckV4dGVuc2lvbjUpIGZWaWV3ZXI7DQorCQkJcmV0dXJuIGV4dGVu
c2lvbi53aWRnZXRPZmZzZXQyTW9kZWxPZmZzZXQod2lkZ2V0Q2FyZXQpOw0KKwkJfQ0KKwkJSVJl
Z2lvbiB2aXNpYmxlID0gZlZpZXdlci5nZXRWaXNpYmxlUmVnaW9uKCk7DQorCQlyZXR1cm4gd2lk
Z2V0Q2FyZXQgKyB2aXNpYmxlLmdldE9mZnNldCgpOw0KKwl9DQorDQorCS8qDQorCSAqIEBzZWUg
SVBhaW50ZXIjZGVhY3RpdmF0ZShib29sZWFuKQ0KKwkgKi8NCisJcHVibGljIHZvaWQgZGVhY3Rp
dmF0ZShib29sZWFuIHJlZHJhdykgew0KKwkJaWYgKGZJc0FjdGl2ZSkgew0KKwkJCWZJc0FjdGl2
ZSA9IGZhbHNlOw0KKwkJCWZWaWV3ZXIuZ2V0VGV4dFdpZGdldCgpLnJlbW92ZUxpbmVCYWNrZ3Jv
dW5kTGlzdGVuZXIodGhpcyk7DQorCQkJLy8NCisJCQlpZiAoZlBvc2l0aW9uTWFuYWdlciAhPSBu
dWxsKQ0KKwkJCQlmUG9zaXRpb25NYW5hZ2VyLnVubWFuYWdlUG9zaXRpb24oZkN1cnJlbnRMaW5l
KTsNCisNCisJCQlmTGFzdExpbmVOdW1iZXIgPSAtMTsNCisJCQlmQ3VycmVudExpbmUub2Zmc2V0
ID0gMDsNCisJCQlmQ3VycmVudExpbmUubGVuZ3RoID0gMDsNCisJCX0NCisJfQ0KKw0KKwkvKg0K
KwkgKiBAc2VlIElQYWludGVyI2Rpc3Bvc2UoKQ0KKwkgKi8NCisJcHVibGljIHZvaWQgZGlzcG9z
ZSgpIHsNCisJfQ0KKw0KKwkvKg0KKwkgKiBAc2VlIElQYWludGVyI3BhaW50KGludCkNCisJICov
DQorCXB1YmxpYyB2b2lkIHBhaW50KGludCByZWFzb24pIHsNCisJCWlmIChmVmlld2VyLmdldERv
Y3VtZW50KCkgPT0gbnVsbCkgew0KKwkJCWRlYWN0aXZhdGUoZmFsc2UpOw0KKwkJCXJldHVybjsN
CisJCX0NCisNCisJCVN0eWxlZFRleHQgdGV4dFdpZGdldCA9IGZWaWV3ZXIuZ2V0VGV4dFdpZGdl
dCgpOw0KKw0KKwkJLy8gY2hlY2sgc2VsZWN0aW9uDQorCQlpZiAoaGFzTXVsdGlMaW5lU2VsZWN0
aW9uKHRleHRXaWRnZXQpKSB7DQorCQkJZGVhY3RpdmF0ZSh0cnVlKTsNCisJCQlyZXR1cm47DQor
CQl9DQorDQorCQkvLyBpbml0aWFsaXphdGlvbg0KKwkJaWYgKCFmSXNBY3RpdmUpIHsNCisJCQl0
ZXh0V2lkZ2V0LmFkZExpbmVCYWNrZ3JvdW5kTGlzdGVuZXIodGhpcyk7DQorCQkJZklzQWN0aXZl
ID0gdHJ1ZTsNCisJCX0NCisNCisJCWludCBvbGRMYXN0TGluZU51bWJlciA9IGZMYXN0TGluZU51
bWJlcjsNCisNCisJCXVwZGF0ZUhpZ2hsaWdodExpbmUoKTsNCisJCWlmIChvbGRMYXN0TGluZU51
bWJlciAhPSAtMSAmJiBvbGRMYXN0TGluZU51bWJlciAhPSBmTGFzdExpbmVOdW1iZXIpIHsNCisJ
CQkvLyByZWNvdmVyIHRoZSBvbGQgc3R5bGVkIHJhbmdlIGJhY2tncm91bmQgY29sb3INCisJCQlp
bnQgbGluZU9mZnNldCA9IHRleHRXaWRnZXQuZ2V0T2Zmc2V0QXRMaW5lKG9sZExhc3RMaW5lTnVt
YmVyKTsNCisJCQlTdHJpbmcgbGluZSA9IHRleHRXaWRnZXQuZ2V0TGluZShvbGRMYXN0TGluZU51
bWJlcik7DQorCQkJaW50IGxpbmVMZW5ndGggPSBsaW5lLmxlbmd0aCgpOw0KKwkJCVN0eWxlUmFu
Z2VbXSByYW5nZXMgPSB0ZXh0V2lkZ2V0LmdldFN0eWxlUmFuZ2VzKGxpbmVPZmZzZXQsDQorCQkJ
CQlsaW5lTGVuZ3RoKTsNCisJCQlmb3IgKGludCBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkr
Kykgew0KKwkJCQlTdHlsZVJhbmdlIHN0eWxlUmFuZ2UgPSByYW5nZXNbaV07DQorCQkJCWlmIChz
dHlsZVJhbmdlIGluc3RhbmNlb2YgUEhQU3R5bGVSYW5nZSkgew0KKwkJCQkJUEhQU3R5bGVSYW5n
ZSBwaHBTdHlsZVJhbmdlID0gKFBIUFN0eWxlUmFuZ2UpIHN0eWxlUmFuZ2U7DQorCQkJCQlwaHBT
dHlsZVJhbmdlLnJlc2V0QmFja2dyb3VuZCgpOw0KKwkJCQkJcGhwU3R5bGVSYW5nZS5yZW1vdmVT
ZWxmKCk7DQorCQkJCX0NCisJCQl9DQorCQl9DQorDQorCQkvLyBzZXQgdGhpcyBsaW5lJ3Mgc3R5
bGVkIHJhbmdlIGJhY2tncm91bmQgY29sb3IgdG8gbnVsbA0KKwkJaW50IHN0YXJ0ID0gdGV4dFdp
ZGdldC5nZXRPZmZzZXRBdExpbmUoZkxhc3RMaW5lTnVtYmVyKTsNCisJCVN0eWxlUmFuZ2VbXSBy
YW5nZXMgPSB0ZXh0V2lkZ2V0LmdldFN0eWxlUmFuZ2VzKHN0YXJ0LCB0ZXh0V2lkZ2V0DQorCQkJ
CS5nZXRMaW5lKGZMYXN0TGluZU51bWJlcikubGVuZ3RoKCkpOw0KKwkJZm9yIChpbnQgaSA9IDA7
IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspIHsNCisJCQlTdHlsZVJhbmdlIHN0eWxlUmFuZ2UgPSBy
YW5nZXNbaV07DQorCQkJaWYgKHN0eWxlUmFuZ2UgaW5zdGFuY2VvZiBQSFBTdHlsZVJhbmdlKSB7
DQorCQkJCVBIUFN0eWxlUmFuZ2UgcGhwU3R5bGVSYW5nZSA9IChQSFBTdHlsZVJhbmdlKSBzdHls
ZVJhbmdlOw0KKwkJCQlwaHBTdHlsZVJhbmdlLmNsZWFyQmFja2dyb3VuZCgpOw0KKwkJCQlwaHBT
dHlsZVJhbmdlLnJlbW92ZVNlbGYoKTsNCisJCQl9DQorCQl9DQorCQkvLyBkcmF3IG5ldyBsaW5l
LHdlIG11c3QgY2FsbCB0aGlzIG1ldGhvZCB0byByZWRyYXcgdGhlIGN1cnJlbnQgbGluZQ0KKwkJ
Ly8gYmVjYXVzZSB3aGVuIHdlIG1vZGlmeSB0ZXh0IEN1cnNvckxpbmVQYWludGVyIHdpbGwgbm90
IHJlZHJhdyB0aGUNCisJCS8vIGN1cnJlbnQgbGluZSx0aGVuIHBocFN0eWxlUmFuZ2UuY2xlYXJC
YWNrZ3JvdW5kKCkgbWFrZXMgbm8gZWZmZWN0DQorCQlkcmF3SGlnaGxpZ2h0TGluZShmTGFzdExp
bmUpOw0KKwkJZHJhd0hpZ2hsaWdodExpbmUoZkN1cnJlbnRMaW5lKTsNCisJfQ0KKw0KKwlwcml2
YXRlIHZvaWQgZHJhd0hpZ2hsaWdodExpbmUoUG9zaXRpb24gcG9zaXRpb24pIHsNCisNCisJCS8v
IGlmIHRoZSBwb3NpdGlvbiB0aGF0IGlzIGFib3V0IHRvIGJlIGRyYXduIHdhcyBkZWxldGVkIHRo
ZW4gd2UgY2FuJ3QNCisJCWlmIChwb3NpdGlvbi5pc0RlbGV0ZWQoKSkNCisJCQlyZXR1cm47DQor
DQorCQlpbnQgd2lkZ2V0T2Zmc2V0ID0gMDsNCisJCWlmIChmVmlld2VyIGluc3RhbmNlb2YgSVRl
eHRWaWV3ZXJFeHRlbnNpb241KSB7DQorDQorCQkJSVRleHRWaWV3ZXJFeHRlbnNpb241IGV4dGVu
c2lvbiA9IChJVGV4dFZpZXdlckV4dGVuc2lvbjUpIGZWaWV3ZXI7DQorCQkJd2lkZ2V0T2Zmc2V0
ID0gZXh0ZW5zaW9uLm1vZGVsT2Zmc2V0MldpZGdldE9mZnNldChwb3NpdGlvbg0KKwkJCQkJLmdl
dE9mZnNldCgpKTsNCisJCQlpZiAod2lkZ2V0T2Zmc2V0ID09IC0xKQ0KKwkJCQlyZXR1cm47DQor
DQorCQl9IGVsc2Ugew0KKw0KKwkJCUlSZWdpb24gdmlzaWJsZSA9IGZWaWV3ZXIuZ2V0VmlzaWJs
ZVJlZ2lvbigpOw0KKwkJCXdpZGdldE9mZnNldCA9IHBvc2l0aW9uLmdldE9mZnNldCgpIC0gdmlz
aWJsZS5nZXRPZmZzZXQoKTsNCisJCQlpZiAod2lkZ2V0T2Zmc2V0IDwgMCB8fCB2aXNpYmxlLmdl
dExlbmd0aCgpIDwgd2lkZ2V0T2Zmc2V0KQ0KKwkJCQlyZXR1cm47DQorCQl9DQorDQorCQlTdHls
ZWRUZXh0IHRleHRXaWRnZXQgPSBmVmlld2VyLmdldFRleHRXaWRnZXQoKTsNCisJCS8vIGNoZWNr
IGZvciBodHRwczovL2J1Z3MuZWNsaXBzZS5vcmcvYnVncy9zaG93X2J1Zy5jZ2k/aWQ9NjQ4OTgN
CisJCS8vIHRoaXMgaXMgYSBndWFyZCBhZ2FpbnN0IHRoZSBzeW1wdG9tcyBidXQgbm90IHRoZSBh
Y3R1YWwgc29sdXRpb24NCisJCWlmICgwIDw9IHdpZGdldE9mZnNldCAmJiB3aWRnZXRPZmZzZXQg
PD0gdGV4dFdpZGdldC5nZXRDaGFyQ291bnQoKSkgew0KKwkJCVBvaW50IHVwcGVyTGVmdCA9IHRl
eHRXaWRnZXQuZ2V0TG9jYXRpb25BdE9mZnNldCh3aWRnZXRPZmZzZXQpOw0KKwkJCWludCB3aWR0
aCA9IHRleHRXaWRnZXQuZ2V0Q2xpZW50QXJlYSgpLndpZHRoDQorCQkJCQkrIHRleHRXaWRnZXQu
Z2V0SG9yaXpvbnRhbFBpeGVsKCk7DQorCQkJaW50IGhlaWdodCA9IHRleHRXaWRnZXQuZ2V0TGlu
ZUhlaWdodCh3aWRnZXRPZmZzZXQpOw0KKwkJCXRleHRXaWRnZXQucmVkcmF3KDAsIHVwcGVyTGVm
dC55LCB3aWR0aCwgaGVpZ2h0LCBmYWxzZSk7DQorCQl9DQorCX0NCisNCisJLyoqDQorCSAqIFJl
dHVybnMgPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIHdpZGdldCBoYXMgYSBzZWxlY3Rpb24gc3Bh
bm5pbmcgbXVsdGlwbGUNCisJICogbGluZXMsIDxjb2RlPmZhbHNlPC9jb2RlPiBvdGhlcndpc2Uu
DQorCSAqIA0KKwkgKiBAcGFyYW0gdGV4dFdpZGdldA0KKwkgKiAgICAgICAgICAgIHRoZSB0ZXh0
IHdpZGdldCB0byBjaGVjaw0KKwkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlmIDxjb2Rl
PnRleHRXaWRnZXQ8L2NvZGU+IGhhcyBhIG11bHRpbGluZQ0KKwkgKiAgICAgICAgIHNlbGVjdGlv
biwgPGNvZGU+ZmFsc2U8L2NvZGU+IG90aGVyd2lzZQ0KKwkgKiBAc2luY2UgMy41DQorCSAqLw0K
Kwlwcml2YXRlIGJvb2xlYW4gaGFzTXVsdGlMaW5lU2VsZWN0aW9uKFN0eWxlZFRleHQgdGV4dFdp
ZGdldCkgew0KKwkJUG9pbnQgc2VsZWN0aW9uID0gdGV4dFdpZGdldC5nZXRTZWxlY3Rpb24oKTsN
CisJCXRyeSB7DQorCQkJaW50IHN0YXJ0TGluZSA9IHRleHRXaWRnZXQuZ2V0TGluZUF0T2Zmc2V0
KHNlbGVjdGlvbi54KTsNCisJCQlpbnQgZW5kTGluZSA9IHRleHRXaWRnZXQuZ2V0TGluZUF0T2Zm
c2V0KHNlbGVjdGlvbi55KTsNCisJCQlyZXR1cm4gc3RhcnRMaW5lICE9IGVuZExpbmU7DQorCQl9
IGNhdGNoIChJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gZSkgew0KKwkJCS8vIGlnbm9yZSAtIGFw
cGFyZW50bHksIHRoZSB3aWRnZXQgaGFzIGEgc3RhbGUgc2VsZWN0aW9uDQorCQkJLy8gc2VlIGh0
dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD0yNzM3MjENCisJCQly
ZXR1cm4gZmFsc2U7DQorCQl9DQorCX0NCisNCisJLy8NCisJLy8gLyoNCisJLy8gKiBAc2VlIElQ
YWludGVyI3NldFBvc2l0aW9uTWFuYWdlcihJUGFpbnRQb3NpdGlvbk1hbmFnZXIpDQorCS8vICov
DQorCXB1YmxpYyB2b2lkIHNldFBvc2l0aW9uTWFuYWdlcihJUGFpbnRQb3NpdGlvbk1hbmFnZXIg
bWFuYWdlcikgew0KKwkJZlBvc2l0aW9uTWFuYWdlciA9IG1hbmFnZXI7DQorCX0NCit9DQpJbmRl
eDogc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3IvUEhQU291cmNlVmlld2Vy
RGVjb3JhdGlvblN1cHBvcnQuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IHNyYy9vcmcvZWNs
aXBzZS9waHAvaW50ZXJuYWwvdWkvZWRpdG9yL1BIUFNvdXJjZVZpZXdlckRlY29yYXRpb25TdXBw
b3J0LmphdmENCmRpZmYgLU4gc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91aS9lZGl0b3Iv
UEhQU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQuamF2YQ0KLS0tIC9kZXYvbnVsbAkxIEph
biAxOTcwIDAwOjAwOjAwIC0wMDAwDQorKysgc3JjL29yZy9lY2xpcHNlL3BocC9pbnRlcm5hbC91
aS9lZGl0b3IvUEhQU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQuamF2YQkxIEphbiAxOTcw
IDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDE0MyBAQA0KK3BhY2thZ2Ugb3JnLmVjbGlwc2Uu
cGhwLmludGVybmFsLnVpLmVkaXRvcjsNCisNCitpbXBvcnQgb3JnLmVjbGlwc2UuamZhY2UucHJl
ZmVyZW5jZS5JUHJlZmVyZW5jZVN0b3JlOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS5wcmVm
ZXJlbmNlLlByZWZlcmVuY2VDb252ZXJ0ZXI7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnRl
eHQuSVRleHRWaWV3ZXJFeHRlbnNpb24yOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS50ZXh0
LnNvdXJjZS5JQW5ub3RhdGlvbkFjY2VzczsNCitpbXBvcnQgb3JnLmVjbGlwc2UuamZhY2UudGV4
dC5zb3VyY2UuSU92ZXJ2aWV3UnVsZXI7DQoraW1wb3J0IG9yZy5lY2xpcHNlLmpmYWNlLnRleHQu
c291cmNlLklTaGFyZWRUZXh0Q29sb3JzOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS50ZXh0
LnNvdXJjZS5JU291cmNlVmlld2VyOw0KK2ltcG9ydCBvcmcuZWNsaXBzZS5qZmFjZS51dGlsLlBy
b3BlcnR5Q2hhbmdlRXZlbnQ7DQoraW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ncmFwaGljcy5Db2xv
cjsNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmdyYXBoaWNzLlJHQjsNCitpbXBvcnQgb3JnLmVj
bGlwc2UudWkudGV4dGVkaXRvci5Tb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9ydDsNCisNCitw
dWJsaWMgY2xhc3MgUEhQU291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQgZXh0ZW5kcw0KKwkJ
U291cmNlVmlld2VyRGVjb3JhdGlvblN1cHBvcnQgew0KKwkvKiogUHJlZmVyZW5jZSBrZXkgZm9y
IHRoZSBjdXJzb3IgbGluZSBoaWdobGlnaHRpbmcgKi8NCisJcHJpdmF0ZSBTdHJpbmcgZkN1cnNv
ckxpbmVQYWludGVyRW5hYmxlS2V5Ow0KKwkvKiogUHJlZmVyZW5jZSBrZXkgZm9yIHRoZSBjdXJz
b3IgbGluZSBiYWNrZ3JvdW5kIGNvbG9yICovDQorCXByaXZhdGUgU3RyaW5nIGZDdXJzb3JMaW5l
UGFpbnRlckNvbG9yS2V5Ow0KKwkvKiogVGhlIHByZWZlcmVuY2Ugc3RvcmUgKi8NCisJcHJpdmF0
ZSBJUHJlZmVyZW5jZVN0b3JlIGZQcmVmZXJlbmNlU3RvcmU7DQorCS8qKiBUaGUgc2hhcmVkIGNv
bG9yIG1hbmFnZXIgKi8NCisJcHJpdmF0ZSBJU2hhcmVkVGV4dENvbG9ycyBmU2hhcmVkVGV4dENv
bG9yczsNCisJLyoqIFRoZSB2aWV3ZXIgKi8NCisJcHJpdmF0ZSBJU291cmNlVmlld2VyIGZTb3Vy
Y2VWaWV3ZXI7DQorCXB1YmxpYyBQSFBTb3VyY2VWaWV3ZXJEZWNvcmF0aW9uU3VwcG9ydChJU291
cmNlVmlld2VyIHNvdXJjZVZpZXdlciwNCisJCQlJT3ZlcnZpZXdSdWxlciBvdmVydmlld1J1bGVy
LCBJQW5ub3RhdGlvbkFjY2VzcyBhbm5vdGF0aW9uQWNjZXNzLA0KKwkJCUlTaGFyZWRUZXh0Q29s
b3JzIHNoYXJlZFRleHRDb2xvcnMpIHsNCisJCXN1cGVyKHNvdXJjZVZpZXdlciwgb3ZlcnZpZXdS
dWxlciwgYW5ub3RhdGlvbkFjY2Vzcywgc2hhcmVkVGV4dENvbG9ycyk7DQorCQlmU291cmNlVmll
d2VyPSBzb3VyY2VWaWV3ZXI7DQorCQlmU2hhcmVkVGV4dENvbG9ycz0gc2hhcmVkVGV4dENvbG9y
czsNCisJfQ0KKwlAT3ZlcnJpZGUNCisJcHVibGljIHZvaWQgaW5zdGFsbChJUHJlZmVyZW5jZVN0
b3JlIHN0b3JlKSB7DQorLy8JCXN1cGVyLmluc3RhbGwoc3RvcmUpOw0KKwkJDQorCQlmUHJlZmVy
ZW5jZVN0b3JlID0gc3RvcmU7DQorCQlpZiAoaXNDdXJzb3JMaW5lU2hvd24oKSkNCisJCQlzaG93
Q3Vyc29yTGluZSgpOw0KKwkJZWxzZQ0KKwkJCWhpZGVDdXJzb3JMaW5lKCk7DQorDQorCQlzdXBl
ci5pbnN0YWxsKHN0b3JlKTsNCisJfQ0KKw0KKwkvKioNCisJICogVGVsbHMgd2hldGhlciB0aGUg
Y3Vyc29yIGxpbmUgaXMgc2hvd24uDQorCSAqDQorCSAqIEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29k
ZT4gaWYgdGhlIGN1cnNvciBsaW5lIGlzIHNob3duDQorCSAqLw0KKwlwcml2YXRlIGJvb2xlYW4g
aXNDdXJzb3JMaW5lU2hvd24oKSB7DQorCQlpZiAoZlByZWZlcmVuY2VTdG9yZSAhPSBudWxsICYm
IGZDdXJzb3JMaW5lUGFpbnRlckVuYWJsZUtleSAhPSBudWxsKQ0KKwkJCXJldHVybiBmUHJlZmVy
ZW5jZVN0b3JlLmdldEJvb2xlYW4oZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5KTsNCisJCXJl
dHVybiBmYWxzZTsNCisJfQ0KKw0KKwkvKioNCisJICogU2V0cyB0aGUgcHJlZmVyZW5jZSBrZXlz
IGZvciB0aGUgY3Vyc29yIGxpbmUgcGFpbnRlci4NCisJICogQHBhcmFtIGVuYWJsZUtleSB0aGUg
cHJlZmVyZW5jZSBrZXkgZm9yIHRoZSBjdXJzb3IgbGluZSBwYWludGVyDQorCSAqIEBwYXJhbSBj
b2xvcktleSB0aGUgcHJlZmVyZW5jZSBrZXkgZm9yIHRoZSBjb2xvciB1c2VkIGJ5IHRoZSBjdXJz
b3IgbGluZQ0KKwkgKiAgICAgICAgcGFpbnRlcg0KKwkgKi8NCisJcHVibGljIHZvaWQgc2V0Q3Vy
c29yTGluZVBhaW50ZXJQcmVmZXJlbmNlS2V5cyhTdHJpbmcgZW5hYmxlS2V5LCBTdHJpbmcgY29s
b3JLZXkpIHsNCisJCXN1cGVyLnNldEN1cnNvckxpbmVQYWludGVyUHJlZmVyZW5jZUtleXMoZW5h
YmxlS2V5LCBjb2xvcktleSk7DQorCQlmQ3Vyc29yTGluZVBhaW50ZXJFbmFibGVLZXk9IGVuYWJs
ZUtleTsNCisJCWZDdXJzb3JMaW5lUGFpbnRlckNvbG9yS2V5PSBjb2xvcktleTsNCisJfQ0KKwkN
CisJQE92ZXJyaWRlDQorCXByb3RlY3RlZCB2b2lkIGhhbmRsZVByZWZlcmVuY2VTdG9yZUNoYW5n
ZWQoUHJvcGVydHlDaGFuZ2VFdmVudCBldmVudCkgew0KKw0KKwkJU3RyaW5nIHA9IGV2ZW50Lmdl
dFByb3BlcnR5KCk7DQorCQlpZiAoZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5ICE9IG51bGwg
JiYgZkN1cnNvckxpbmVQYWludGVyRW5hYmxlS2V5LmVxdWFscyhwKSkgew0KKwkJCWlmIChpc0N1
cnNvckxpbmVTaG93bigpKQ0KKwkJCQlzaG93Q3Vyc29yTGluZSgpOw0KKwkJCWVsc2UNCisJCQkJ
aGlkZUN1cnNvckxpbmUoKTsNCisJCQlyZXR1cm47DQorCQl9DQorDQorCQkNCisJCXN1cGVyLmhh
bmRsZVByZWZlcmVuY2VTdG9yZUNoYW5nZWQoZXZlbnQpOw0KKw0KKwl9DQorCQ0KKw0KKwkvKiog
VGhlIGVkaXRvcidzIGxpbmUgcGFpbnRlciAqLw0KKwlwcml2YXRlIFBIUEN1cnNvckxpbmVQYWlu
dGVyIGZDdXJzb3JMaW5lUGFpbnRlcjsNCisJLyoqDQorCSAqIFNob3dzIHRoZSBjdXJzb3IgbGlu
ZS4NCisJICovDQorCXByaXZhdGUgdm9pZCBzaG93Q3Vyc29yTGluZSgpIHsNCisJCWlmIChmQ3Vy
c29yTGluZVBhaW50ZXIgPT0gbnVsbCkgew0KKwkJCWlmIChmU291cmNlVmlld2VyIGluc3RhbmNl
b2YgSVRleHRWaWV3ZXJFeHRlbnNpb24yKSB7DQorCQkJCWZDdXJzb3JMaW5lUGFpbnRlcj0gbmV3
IFBIUEN1cnNvckxpbmVQYWludGVyKGZTb3VyY2VWaWV3ZXIpOw0KKy8vCQkJCWZDdXJzb3JMaW5l
UGFpbnRlci5zZXRIaWdobGlnaHRDb2xvcihnZXRDb2xvcihmQ3Vyc29yTGluZVBhaW50ZXJDb2xv
cktleSkpOw0KKwkJCQlJVGV4dFZpZXdlckV4dGVuc2lvbjIgZXh0ZW5zaW9uPSAoSVRleHRWaWV3
ZXJFeHRlbnNpb24yKSBmU291cmNlVmlld2VyOw0KKwkJCQlleHRlbnNpb24uYWRkUGFpbnRlcihm
Q3Vyc29yTGluZVBhaW50ZXIpOw0KKwkJCX0NCisJCX0NCisJfQ0KKw0KKwkvKioNCisJICogUmV0
dXJucyB0aGUgc2hhcmVkIGNvbG9yIGZvciB0aGUgZ2l2ZW4ga2V5Lg0KKwkgKg0KKwkgKiBAcGFy
YW0ga2V5IHRoZSBjb2xvciBrZXkgc3RyaW5nDQorCSAqIEByZXR1cm4gdGhlIHNoYXJlZCBjb2xv
ciBmb3IgdGhlIGdpdmVuIGtleQ0KKwkgKi8NCisJcHJpdmF0ZSBDb2xvciBnZXRDb2xvcihTdHJp
bmcga2V5KSB7DQorCQlpZiAoZlByZWZlcmVuY2VTdG9yZSAhPSBudWxsKSB7DQorCQkJUkdCIHJn
Yj0gUHJlZmVyZW5jZUNvbnZlcnRlci5nZXRDb2xvcihmUHJlZmVyZW5jZVN0b3JlLCBrZXkpOw0K
KwkJCXJldHVybiBnZXRDb2xvcihyZ2IpOw0KKwkJfQ0KKwkJcmV0dXJuIG51bGw7DQorCX0NCisN
CisJLyoqDQorCSAqIFJldHVybnMgdGhlIHNoYXJlZCBjb2xvciBmb3IgdGhlIGdpdmVuIFJHQi4N
CisJICoNCisJICogQHBhcmFtIHJnYiB0aGUgUkdCDQorCSAqIEByZXR1cm4gdGhlIHNoYXJlZCBj
b2xvciBmb3IgdGhlIGdpdmVuIFJHQg0KKwkgKi8NCisJcHJpdmF0ZSBDb2xvciBnZXRDb2xvcihS
R0IgcmdiKSB7DQorCQlyZXR1cm4gZlNoYXJlZFRleHRDb2xvcnMuZ2V0Q29sb3IocmdiKTsNCisJ
fQ0KKw0KKwkvKioNCisJICogSGlkZXMgdGhlIGN1cnNvciBsaW5lLg0KKwkgKi8NCisJcHJpdmF0
ZSB2b2lkIGhpZGVDdXJzb3JMaW5lKCkgew0KKwkJaWYgKGZDdXJzb3JMaW5lUGFpbnRlciAhPSBu
dWxsKSB7DQorCQkJaWYgKGZTb3VyY2VWaWV3ZXIgaW5zdGFuY2VvZiBJVGV4dFZpZXdlckV4dGVu
c2lvbjIpIHsNCisJCQkJSVRleHRWaWV3ZXJFeHRlbnNpb24yIGV4dGVuc2lvbj0gKElUZXh0Vmll
d2VyRXh0ZW5zaW9uMikgZlNvdXJjZVZpZXdlcjsNCisJCQkJZXh0ZW5zaW9uLnJlbW92ZVBhaW50
ZXIoZkN1cnNvckxpbmVQYWludGVyKTsNCisJCQkJZkN1cnNvckxpbmVQYWludGVyLmRlYWN0aXZh
dGUodHJ1ZSk7DQorCQkJCWZDdXJzb3JMaW5lUGFpbnRlci5kaXNwb3NlKCk7DQorCQkJCWZDdXJz
b3JMaW5lUGFpbnRlcj0gbnVsbDsNCisJCQl9DQorCQl9DQorCX0NCisNCit9DQo=
</data>

          </attachment>
      

    </bug>

</bugzilla>