<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.1"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>214807</bug_id>
          
          <creation_ts>2008-01-09 15:50:00 -0500</creation_ts>
          <short_desc>[browser] xulrunner 1.9 has changed invalid certificate behaviour</short_desc>
          <delta_ts>2010-01-06 23:53:27 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>Platform</product>
          <component>SWT</component>
          <version>3.4</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>3.4.2+</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Grant Gayed">grant_gayed</reporter>
          <assigned_to name="Grant Gayed">grant_gayed</assigned_to>
          <cc>Dmitry_Karasik</cc>
    
    <cc>dominic.evans</cc>
    
    <cc>jasonxd</cc>
    
    <cc>john</cc>
    
    <cc>liujuny</cc>
    
    <cc>nnm.one</cc>
    
    <cc>peina</cc>
    
    <cc>pwebster</cc>
    
    <cc>rtaniwa</cc>
    
    <cc>Silenio_Quarti</cc>
    
    <cc>wuzhe</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="21874"
          type_id="1"
          status="+"
          setter="Silenio_Quarti"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1128447</commentid>
    <comment_count>0</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2008-01-09 15:50:45 -0500</bug_when>
    <thetext>go to https://verisign.com

- in previous versions a dialog would be shown that said &quot;invalid certificate, do you want to view it and proceed anyways?&quot;
- now it just displays an &quot;invalid certificate&quot; dialog with no opportunity to proceed
- is there a new hook for handling this case before the invalid certificate dialog is shown?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1129109</commentid>
    <comment_count>1</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2008-01-10 13:58:36 -0500</bug_when>
    <thetext>Registering an nsIBadCertListener receives notification in this scenario with xulrunner 1.8.1.3, but doesn&apos;t with xulrunner 1.9b3.

Holding off on investigating this further until xulrunner is closer to shipping.
Potentially useful:
nsID NS_BADCERTLISTENER_CID = new nsID(&quot;518e071f-1dd2-11b2-937e-c45f14def778&quot;);
String NS_BADCERTLISTENER_CONTRACTID = &quot;@mozilla.org/nsBadCertListener;1&quot;;
</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1129111</commentid>
    <comment_count>2</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2008-01-10 14:00:08 -0500</bug_when>
    <thetext>Also helpful:

nsIComponentRegistrar registrar = Mozilla.getInstance().getComponentRegistrar();
nsISimpleEnumerator enum = registrar.enumerateCIDs();
while (enum.hasMoreElements()) {
	nsISupports element = enum.getNext();
	nsISupportsID prim = (nsISupportsID)element.queryInterface(nsISupportsID.NS_ISUPPORTSID_IID);
	System.out.println(prim.getData());
}
System.out.println(&quot;-------------&quot;);
enum = registrar.enumerateContractIDs();
while (enum.hasMoreElements()) {
	nsISupports element = enum.getNext();
	nsISupportsCString prim = (nsISupportsCString)element.queryInterface(nsISupportsCString.NS_ISUPPORTSCSTRING_IID);
	System.out.println(prim.getData());
}
</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1458947</commentid>
    <comment_count>3</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2009-03-24 16:58:30 -0400</bug_when>
    <thetext>*** Bug 269858 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1458963</commentid>
    <comment_count>4</comment_count>
    <who name="Jason Duan">jasonxd</who>
    <bug_when>2009-03-24 17:18:04 -0400</bug_when>
    <thetext>Hi,

I opened the bug 269858.  It is a critical problem for us.  We need this fixed as soon as possible.  Will you please fix it?

Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1469367</commentid>
    <comment_count>5</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2009-04-08 17:05:32 -0400</bug_when>
    <thetext>I will try to investigate this for 3.5M7, but there are other problems with higher priority, so I can&apos;t say for sure whether this will be resolved.  I believe this is a relatively large work item.
</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1469745</commentid>
    <comment_count>6</comment_count>
    <who name="Jason Duan">jasonxd</who>
    <bug_when>2009-04-09 09:40:28 -0400</bug_when>
    <thetext>Hi Grant,

This is a critical defect for us.  The severity of the dup bug 269858 is critical. Without fixing this problem, our customers will see a blank page and there is no way for them to proceed.  We need it fixed as soon as possible.  Can we change the severity of this defect to critical?

Thanks,
</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1486379</commentid>
    <comment_count>7</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2009-04-29 14:11:45 -0400</bug_when>
    <thetext>Summary of the mozilla change (no new info here, just summarizing):

- mozilla &lt; 1.9 (aka firefox &lt; 3) used to show a dialog when a page with an invalid cert was encountered, which allowed the user to choose to proceed anyways
- mozilla 1.9 changed this to require the embedder (eg.- firefox) to handle the invalid cert
  -&gt; the content that firefox 3.0 shows to allow the user to proceed in this scenario is now contained in the firefox app, not in xulrunner
  -&gt; to duplicate firefox&apos;s behaviour in the Browser requires duplicating this functionality that now lives in firefox
</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1487592</commentid>
    <comment_count>8</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2009-04-30 12:24:24 -0400</bug_when>
    <thetext>On the workarounds front, possibly helpful (cert_override): http://boblord.livejournal.com/18402.html
</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1494152</commentid>
    <comment_count>9</comment_count>
      <attachid>134790</attachid>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2009-05-07 10:40:18 -0400</bug_when>
    <thetext>Created attachment 134790
progress as of 20090507

Summary of what firefox does:

- sets error reporting to show invalid cert page instead of dialog
- extends default error page to include Add Exception link
- when link is clicked
  -&gt; if user chooses to retrieve certificate (this is required to add exception)
    -&gt; initiates a new request and adds a nsIBadCertListener2 on its channel
    -&gt; gets the cert info from this callback, and then shows all of its details including why it failed
  -&gt; if user adds exception then the cert is added to the nsICertOverrideService
  -&gt; a third navigate to the site is probably now required

Attached is a patch that implements some pieces of this.  It&apos;s attached here so that it won&apos;t be lost, but it&apos;s not a working solution (for brevity it uses JavaXPCOM).  Even if it was complete and written in terms of XPCOM, it would be too destabilizing to put into an RC1-stage build.  This will be revisited post-3.5.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1533794</commentid>
    <comment_count>10</comment_count>
    <who name="P A S">nnm.one</who>
    <bug_when>2009-06-28 12:12:29 -0400</bug_when>
    <thetext>Hi

The problem is that the internal eclipse browser matches hostnames such as (https://example.com:8443) as &quot;example.com:8443&quot; against the CN common name attribute on the certificate that will be defined as &quot;example.com&quot;, for the internal browser to work with domains that use self-signed certificates you must include the port number on the CN attribute when generating the certificate (CN=example.com:8443).

But this seems to be a bug and this is only a temporary solution. I managed to access the administration consoles via the internal browser for various systems that eclipse is connected to by importing the server certificates into ~/.mozilla/eclipse and copying the cert_override.txt from the firefox profile after adding a certificate override using the external browser, and by using certificates that match against both hostname and port.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1555778</commentid>
    <comment_count>11</comment_count>
      <attachid>142130</attachid>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2009-07-21 09:33:12 -0400</bug_when>
    <thetext>Created attachment 142130
patch, fixes for xulrunner 1.9.1

This patch fixes this case for xulrunner-1.9.1 by implementing an invalid certificate prompter in swt which allows the user to see why the certificate is invalid and either proceed or cancel.  It&apos;s not particularly pretty, but given that this is likely for eclipse/swt 3.5.1, the size of the change set is already bigger than is generally desirable.

In theory this should work for xulrunner-1.9.x as well, but for some reason it fails on the very last step of adding the certificate to mozilla&apos;s certificate override service fails.  This problem is still to be investigated.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1563855</commentid>
    <comment_count>12</comment_count>
    <who name="Dominic Evans">dominic.evans</who>
    <bug_when>2009-08-04 05:40:39 -0400</bug_when>
    <thetext>so when might we be able to test this fix in a 3.5.1 or 3.6 Stream Build?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1571967</commentid>
    <comment_count>13</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2009-08-17 14:19:04 -0400</bug_when>
    <thetext>I&apos;ve just found a path that works for xulrunner 1.9.0, so an updated patch will be attached here within a couple of days, and it should be released to the 3.5.1 and 3.6 streams as well.
</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1574648</commentid>
    <comment_count>14</comment_count>
      <attachid>145030</attachid>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2009-08-19 16:07:04 -0400</bug_when>
    <thetext>Created attachment 145030
patch for 3.5 stream, fixes xulrunner 1.9.0.x and 1.9.1.x</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1574778</commentid>
    <comment_count>15</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2009-08-19 21:32:42 -0400</bug_when>
    <thetext>fixed in the 3.5.1 and 3.6 streams &gt; 20090819
</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1649255</commentid>
    <comment_count>16</comment_count>
    <who name="wuzhe">wuzhe</who>
    <bug_when>2009-12-28 02:09:18 -0500</bug_when>
    <thetext>Hi Grant,
When I navigate the below site and try to login with my intranet ID/PW, Browser will prompt a error dialog and can&apos;t go on navigation and thus fail in logging in. 
http://w3.ospf.cn.ibm.com/wps/portal/!ut/p/c0/04_SB8K8xLLM9MSSzPy8xBz9CP0os3g_f6NQNxNPQ0MLM1dDAyMzDxMnnzBPA39_U_2CbEdFAMNst2E
Eclipse 3.5.1.
It won&apos;t happen on FF3.5.x. 
Could you please help to look at this?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1649258</commentid>
    <comment_count>17</comment_count>
    <who name="John Hogenmiller">john</who>
    <bug_when>2009-12-28 03:01:50 -0500</bug_when>
    <thetext>Hi,

While I understand that the bugtracker isn&apos;t meant for technical support, my question has to do with this specific issue.  I have only been using Eclipse since August, so I am still a bit new at this.

How would I get this fix into my installation of Eclipse (on Linux)?

I have updated Eclipse, currently at: 3.5.1.R35x_v20090910-9 (
Build id: 20090920-1017) but still get the issue when navigating to a site with a self-signed certificate.  

www.example.com uses an invalid security certificate.
The certificate is not trusted because it is self-signed.
(Error code: sec_error_untrusted_issuer)


As a temporary fix, I was able to copy cert_overrides.txt and cert8.db from a working firefox profile on the system to get access to the site.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1650557</commentid>
    <comment_count>18</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2010-01-04 14:57:06 -0500</bug_when>
    <thetext>re: comment 16
There were a few certificate errors that were not handled in swt 3.5.1.  These are fixed in the post-3.4.2 and 3.5.2 streams, though I don&apos;t think they have appeared in a 3.5.2 build yet (the next 3.5.2 build should be January 6).

re: comment 17
The first release with a fix for your case will be 3.5.2, so there aren&apos;t any updates currently available with it.  To get it you can either wait for the 3.5.2 release (should be in Feburary 2010) and get it via Update, or download a 3.5.2 integration build with the fix (the January 6th one should have it).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1651995</commentid>
    <comment_count>19</comment_count>
    <who name="wuzhe">wuzhe</who>
    <bug_when>2010-01-06 21:28:35 -0500</bug_when>
    <thetext>Hi Grant,
Thank you very much for your work on this. I&apos;ve thecked the build (N20100105-2000), yes, the unwelcome error dialog won&apos;t popup. 
However, there is still a problem exist:
1)When navigate to: http://w3.ospf.cn.ibm.com/wps/portal/!ut/p/c0/04_SB8K8xLLM9MSSzPy8xBz9CP0os3g_f6NQNxNPQ0MLM1dDAyMzDxMnnzBPA39_U_2CbEdFAMNst2E
2)Input intranet ID/PW and click login button, it seems that nothing happens, that is, the login fails.
Cound you please help to look at this? Thanks a lot! :-)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1652022</commentid>
    <comment_count>20</comment_count>
    <who name="wuzhe">wuzhe</who>
    <bug_when>2010-01-06 23:42:31 -0500</bug_when>
    <thetext>(In reply to comment #19)
&gt; Hi Grant,
&gt; Thank you very much for your work on this. I&apos;ve thecked the build
&gt; (N20100105-2000), yes, the unwelcome error dialog won&apos;t popup. 
&gt; However, there is still a problem exist:
&gt; 1)When navigate to:
&gt; http://w3.ospf.cn.ibm.com/wps/portal/!ut/p/c0/04_SB8K8xLLM9MSSzPy8xBz9CP0os3g_f6NQNxNPQ0MLM1dDAyMzDxMnnzBPA39_U_2CbEdFAMNst2E
&gt; 2)Input intranet ID/PW and click login button, it seems that nothing happens,
&gt; that is, the login fails.
&gt; Cound you please help to look at this? Thanks a lot! :-)

I create another bug for tracking above issue. Bug 299013.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1652023</commentid>
    <comment_count>21</comment_count>
    <who name="John Hogenmiller">john</who>
    <bug_when>2010-01-06 23:53:27 -0500</bug_when>
    <thetext> 
&gt; re: comment 17
&gt; The first release with a fix for your case will be 3.5.2, so there aren&apos;t any
&gt; updates currently available with it.  To get it you can either wait for the
&gt; 3.5.2 release (should be in February 2010) and get it via Update, or download a
&gt; 3.5.2 integration build with the fix (the January 6th one should have it).

Thanks.  I was able to work around this by copying my certs_override.txt from my Firefox profile to ~/.mozilla/eclipse.  I may have also copied cert8.db but can&apos;t remember now.  So I will wait till the February release.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>134790</attachid>
            <date>2009-05-07 10:40:00 -0400</date>
            <delta_ts>2009-07-21 09:33:12 -0400</delta_ts>
            <desc>progress as of 20090507</desc>
            <filename>browserMOZILLA19invalidCert</filename>
            <type>text/plain</type>
            <size>9374</size>
            <attacher name="Grant Gayed">grant_gayed</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2Uuc3d0DQpJbmRl
eDogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dzZXIvTW96
aWxsYS5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvZWNsaXBzZS9vcmcuZWNs
aXBzZS5zd3QvRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dz
ZXIvTW96aWxsYS5qYXZhLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS4xMzENCmRpZmYgLXUgLXIx
LjEzMSBNb3ppbGxhLmphdmENCi0tLSBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNs
aXBzZS9zd3QvYnJvd3Nlci9Nb3ppbGxhLmphdmEJMTAgQXByIDIwMDkgMjE6MTc6MDkgLTAwMDAJ
MS4xMzENCisrKyBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJv
d3Nlci9Nb3ppbGxhLmphdmEJNCBNYXkgMjAwOSAxOTo1NjoyOSAtMDAwMA0KQEAgLTIxLDYgKzIx
LDkgQEANCiBpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmludGVybmFsLm1vemlsbGEuKjsNCiBpbXBv
cnQgb3JnLmVjbGlwc2Uuc3d0LmludGVybmFsLm1vemlsbGEuaW5pdC4qOw0KIGltcG9ydCBvcmcu
ZWNsaXBzZS5zd3QubGF5b3V0Lio7DQoraW1wb3J0IG9yZy5tb3ppbGxhLmludGVyZmFjZXMubnNJ
Q2VydE92ZXJyaWRlU2VydmljZTsNCitpbXBvcnQgb3JnLm1vemlsbGEuaW50ZXJmYWNlcy5uc0lT
U0xTdGF0dXM7DQoraW1wb3J0IG9yZy5tb3ppbGxhLmludGVyZmFjZXMubnNJWDUwOUNlcnQ7DQog
DQogY2xhc3MgTW96aWxsYSBleHRlbmRzIFdlYkJyb3dzZXIgew0KIAlpbnQgLypsb25nKi8gZW1i
ZWRIYW5kbGU7DQpAQCAtMzAsNiArMzMsNyBAQA0KIA0KIAkvKiBJbnRlcmZhY2VzIGZvciB0aGlz
IE1vemlsbGEgZW1iZWRkaW5nIG5vdGlmaWNhdGlvbiAqLw0KIAlYUENPTU9iamVjdCBzdXBwb3J0
czsNCisJWFBDT01PYmplY3QgYmFkQ2VydExpc3RlbmVyOw0KIAlYUENPTU9iamVjdCB3ZWFrUmVm
ZXJlbmNlOw0KIAlYUENPTU9iamVjdCB3ZWJQcm9ncmVzc0xpc3RlbmVyOw0KIAlYUENPTU9iamVj
dAl3ZWJCcm93c2VyQ2hyb21lOw0KQEAgLTE1MjIsNiArMTUyNiwxMyBAQA0KIAkJcHVibGljIGlu
dCAvKmxvbmcqLyBtZXRob2QzIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFF1ZXJ5UmVm
ZXJlbnQgKGFyZ3NbMF0sIGFyZ3NbMV0pO30NCiAJfTsNCiANCisJYmFkQ2VydExpc3RlbmVyID0g
bmV3IFhQQ09NT2JqZWN0IChuZXcgaW50W10gezIsIDAsIDAsIDR9KSB7DQorCQlwdWJsaWMgaW50
IC8qbG9uZyovIG1ldGhvZDAgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gUXVlcnlJbnRl
cmZhY2UgKGFyZ3NbMF0sIGFyZ3NbMV0pO30NCisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9k
MSAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBBZGRSZWYgKCk7fQ0KKwkJcHVibGljIGlu
dCAvKmxvbmcqLyBtZXRob2QyIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFJlbGVhc2Ug
KCk7fQ0KKwkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2QzIChpbnQgLypsb25nKi9bXSBhcmdz
KSB7cmV0dXJuIE5vdGlmeUNlcnRQcm9ibGVtIChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBh
cmdzWzNdKTt9DQorCX07DQorDQogCXdlYlByb2dyZXNzTGlzdGVuZXIgPSBuZXcgWFBDT01PYmpl
Y3QgKG5ldyBpbnRbXSB7MiwgMCwgMCwgNCwgNiwgMywgNCwgM30pIHsNCiAJCXB1YmxpYyBpbnQg
Lypsb25nKi8gbWV0aG9kMCAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBRdWVyeUludGVy
ZmFjZSAoYXJnc1swXSwgYXJnc1sxXSk7fQ0KIAkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2Qx
IChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIEFkZFJlZiAoKTt9DQpAQCAtMjI5OCw5ICsy
MzA5LDI5IEBADQogfQ0KIA0KIHB1YmxpYyBib29sZWFuIHNldFVybCAoU3RyaW5nIHVybCkgew0K
KwlpbnQgLypsb25nKi9bXSByZXN1bHQgPSBuZXcgaW50IC8qbG9uZyovWzFdOw0KKwkNCisJLyoN
CisJKiBUaGUgZm9sbG93aW5nIGJsb2NrIHdpbGwgc2hvdyBlcnJvciBwYWdlcyBpbnN0ZWFkIG9m
IGVycm9yIGRpYWxvZ3MsIHdoaWNoDQorCSogaXMgaG93IGZpcmVmb3ggZmluZHMgb3V0IGFib3V0
IGludmFsaWQgY2VydHMgKGl0IGFkZHMgdGhlICJhZGQgZXhjZXB0aW9uIiBidXR0b24NCisJKiB0
byB0aGUgZGVmYXVsdCBpbnZhbGlkIGNlcnQgZGlhbG9nKS4gIE5vdGUgdGhhdCBmaXJlZm94IGNv
bmZpZyBzZXR0aW5nIA0KKyAJKiBicm93c2VyLnh1bC5lcnJvcl9wYWdlcy5lbmFibGVkIGlzIG5v
dCBpbiB4dWxydW5uZXIsIHdoaWNoIGlzIHdoeSB0b3RhbGx5IHVuc3RhYmxlDQorCSogbnNJRG9j
U2hlbGwgaXMgYmVpbmcgdXNlZCBoZXJlLg0KKwkqLw0KKy8vCXsNCisvLwkJaW50IHJjID0gd2Vi
QnJvd3Nlci5RdWVyeUludGVyZmFjZSAobnNJSW50ZXJmYWNlUmVxdWVzdG9yLk5TX0lJTlRFUkZB
Q0VSRVFVRVNUT1JfSUlELCByZXN1bHQpOw0KKy8vCQlpZiAocmMgIT0gWFBDT00uTlNfT0spIGVy
cm9yIChyYyk7DQorLy8JCWlmIChyZXN1bHRbMF0gPT0gMCkgZXJyb3IgKFhQQ09NLk5TX0VSUk9S
X05PX0lOVEVSRkFDRSk7DQorLy8JCW5zSUludGVyZmFjZVJlcXVlc3RvciBpbnRlcmZhY2VSZXF1
ZXN0b3IgPSBuZXcgbnNJSW50ZXJmYWNlUmVxdWVzdG9yIChyZXN1bHRbMF0pOw0KKy8vCQlyZXN1
bHRbMF0gPSAwOw0KKy8vCQlpbnRlcmZhY2VSZXF1ZXN0b3IuR2V0SW50ZXJmYWNlKG5zSURvY1No
ZWxsXzFfOS5OU19JRE9DU0hFTExfSUlELCByZXN1bHQpOw0KKy8vCQluc0lEb2NTaGVsbF8xXzkg
ZG9jU2hlbGwgPSBuZXcgbnNJRG9jU2hlbGxfMV85KHJlc3VsdFswXSk7DQorLy8JCXJlc3VsdFsw
XSA9IDA7DQorLy8JCXJjID0gZG9jU2hlbGwuU2V0VXNlRXJyb3JQYWdlcygxKTsNCisvLwl9DQor
DQogCWh0bWxCeXRlcyA9IG51bGw7DQogDQotCWludCAvKmxvbmcqL1tdIHJlc3VsdCA9IG5ldyBp
bnQgLypsb25nKi9bMV07DQogCWludCByYyA9IHdlYkJyb3dzZXIuUXVlcnlJbnRlcmZhY2UgKG5z
SVdlYk5hdmlnYXRpb24uTlNfSVdFQk5BVklHQVRJT05fSUlELCByZXN1bHQpOw0KIAlpZiAocmMg
IT0gWFBDT00uTlNfT0spIGVycm9yIChyYyk7DQogCWlmIChyZXN1bHRbMF0gPT0gMCkgZXJyb3Ig
KFhQQ09NLk5TX0VSUk9SX05PX0lOVEVSRkFDRSk7DQpAQCAtMjQ4OSw2ICsyNTIwLDExIEBADQog
CQlBZGRSZWYgKCk7DQogCQlyZXR1cm4gWFBDT00uTlNfT0s7DQogCX0NCisJaWYgKGd1aWQuRXF1
YWxzIChuZXcgbnNJRCgiMmMzZDI2OGMtYWQ4Mi00OWYzLTk5YWEtZTlmZmRkZDdhMGRjIiAvKiBu
c0lCYWRDZXJ0TGlzdGVuZXIyIElJRCAqLykpKSB7DQorCQlYUENPTS5tZW1tb3ZlIChwcHZPYmpl
Y3QsIG5ldyBpbnQgLypsb25nKi9bXSB7YmFkQ2VydExpc3RlbmVyLmdldEFkZHJlc3MgKCl9LCBD
LlBUUl9TSVpFT0YpOw0KKwkJQWRkUmVmICgpOw0KKwkJcmV0dXJuIFhQQ09NLk5TX09LOw0KKwl9
DQogCWlmIChndWlkLkVxdWFscyAobnNJV2ViUHJvZ3Jlc3NMaXN0ZW5lci5OU19JV0VCUFJPR1JF
U1NMSVNURU5FUl9JSUQpKSB7DQogCQlYUENPTS5tZW1tb3ZlIChwcHZPYmplY3QsIG5ldyBpbnQg
Lypsb25nKi9bXSB7d2ViUHJvZ3Jlc3NMaXN0ZW5lci5nZXRBZGRyZXNzICgpfSwgQy5QVFJfU0la
RU9GKTsNCiAJCUFkZFJlZiAoKTsNCkBAIC0yNTk2LDYgKzI2MzIsMjUgQEANCiAJCWlmIChyYyAh
PSBYUENPTS5OU19PSykgZXJyb3IgKHJjKTsNCiAJCWlmIChyZXN1bHRbMF0gPT0gMCkgZXJyb3Ig
KFhQQ09NLk5TX05PSU5URVJGQUNFKTsNCiAJCXVuaG9va2VkRE9NV2luZG93cy5hZGRFbGVtZW50
IChuZXcgTE9ORyAocmVzdWx0WzBdKSk7DQorCQlyZXN1bHRbMF0gPSAwOw0KKw0KKwkJLyoNCisJ
CSogVGhlIGZvbGxvd2luZyBjYXVzZXMgbnNJQmFkQ2VydExpc3RlbmVyMiBjYWxsYmFja3MgdG8g
Y29tZSBpbiBvbiBvdXIgaW50ZXJmYWNlDQorCQkqIHJlcXVlc3Rlci4gIFRoaXMgb3ZlcnJpZGVz
IHRoZSBkZWZhdWx0IGNoYW5uZWwgbGlzdGVuZXIsIHdoaWNoIHByb2JhYmx5IGludHJvZHVjZXMN
CisJCSogdGhlIGJhZCBzaWRlIGVmZmVjdCBvZiBvdGhlciBub3RpZmljYXRpb25zIG5vIGxvbmdl
ciBiZWluZyBoYW5kbGVkLiAgRmlyZWZveCBkb2VzDQorCQkqIHRoaXMgYnkgY3JlYXRpbmcgYSBz
ZWNvbmQgcmVxdWVzdCBmb3IgdGhlIHVybCB3aGVuIGFuIGludmFsaWQgY2VydCBpcyBkZXRlY3Rl
ZCwgYW5kDQorCQkqIG9ubHkgaG9va2luZyBuc0lCYWRDZXJ0TGlzdGVuZXIyIG9uIHRoaXMgbmV3
IHRlbXBvcmFyeSByZXF1ZXN0Lg0KKwkJKi8NCisJCWlmICghSXNQcmVfMV85KSB7DQorCQkJbnNJ
UmVxdWVzdCByZXEgPSBuZXcgbnNJUmVxdWVzdCAoYVJlcXVlc3QpOw0KKwkJCXJjID0gcmVxLlF1
ZXJ5SW50ZXJmYWNlIChuc0lDaGFubmVsLk5TX0lDSEFOTkVMX0lJRCwgcmVzdWx0KTsNCisJCQlp
ZiAocmMgIT0gWFBDT00uTlNfT0spIGVycm9yIChyYyk7DQorCQkJaWYgKHJlc3VsdFswXSA9PSAw
KSBlcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOw0KKwkJCW5zSUNoYW5uZWwgY2hhbm5lbCA9
IG5ldyBuc0lDaGFubmVsIChyZXN1bHRbMF0pOw0KKwkJCXJlc3VsdFswXSA9IDA7DQorCQkJcmMg
PSBjaGFubmVsLlNldE5vdGlmaWNhdGlvbkNhbGxiYWNrcyAoaW50ZXJmYWNlUmVxdWVzdG9yLmdl
dEFkZHJlc3MgKCkpOw0KKwkJCWlmIChyYyAhPSBYUENPTS5OU19PSykgZXJyb3IgKHJjKTsNCisJ
CX0NCiAJfSBlbHNlIGlmICgoYVN0YXRlRmxhZ3MgJiBuc0lXZWJQcm9ncmVzc0xpc3RlbmVyLlNU
QVRFX1JFRElSRUNUSU5HKSAhPSAwKSB7DQogCQlpZiAocmVxdWVzdCA9PSBhUmVxdWVzdCkgcmVx
dWVzdCA9IDA7DQogCX0gZWxzZSBpZiAoKGFTdGF0ZUZsYWdzICYgbnNJV2ViUHJvZ3Jlc3NMaXN0
ZW5lci5TVEFURV9TVE9QKSAhPSAwKSB7DQpAQCAtMzc2OCw0ICszODIzLDI5IEBADQogCX0NCiAJ
cmV0dXJuIFhQQ09NLk5TX09LOw0KIH0NCisNCisvKiBuc0lCYWRDZXJ0TGlzdGVuZXIyICovDQor
DQoraW50IE5vdGlmeUNlcnRQcm9ibGVtKGludCAvKmxvbmcqLyBzb2NrZXRJbmZvLCBpbnQgLyps
b25nKi8gc3RhdHVzLCBpbnQgLypsb25nKi8gdGFyZ2V0U2l0ZSwgaW50IC8qbG9uZyovIF9zdXBw
cmVzc0Vycm9yKSB7DQorCWludCBsZW5ndGggPSBYUENPTS5uc0VtYmVkQ1N0cmluZ19MZW5ndGgg
KHRhcmdldFNpdGUpOw0KKwlpbnQgLypsb25nKi8gYnVmZmVyID0gWFBDT00ubnNFbWJlZENTdHJp
bmdfZ2V0ICh0YXJnZXRTaXRlKTsNCisJYnl0ZVtdIGRlc3QgPSBuZXcgYnl0ZVtsZW5ndGhdOw0K
KwlYUENPTS5tZW1tb3ZlIChkZXN0LCBidWZmZXIsIGxlbmd0aCk7DQorCVN0cmluZyB1cmxQb3J0
ID0gbmV3IFN0cmluZyAoZGVzdCk7DQorCWludCBzZXBhcmF0b3IgPSB1cmxQb3J0LmluZGV4T2Yo
JzonKTsNCisJU3RyaW5nIGhvc3QgPSB1cmxQb3J0LnN1YnN0cmluZygwLHNlcGFyYXRvcik7DQor
CWludCBwb3J0ID0gSW50ZWdlci52YWx1ZU9mKHVybFBvcnQuc3Vic3RyaW5nKHNlcGFyYXRvciAr
IDEpKS5pbnRWYWx1ZSgpOw0KKwlDLm1lbW1vdmUoX3N1cHByZXNzRXJyb3IsIG5ldyBpbnRbXSB7
MX0sIDQpOyAvKiBQUkludDMyICovDQorCW5zSVNTTFN0YXR1cyBzc2xTdGF0dXMgPSAob3JnLm1v
emlsbGEuaW50ZXJmYWNlcy5uc0lTU0xTdGF0dXMpb3JnLm1vemlsbGEueHBjb20uTW96aWxsYS5n
ZXRJbnN0YW5jZSgpLndyYXBYUENPTU9iamVjdChzdGF0dXMsIG5zSVNTTFN0YXR1cy5OU19JU1NM
U1RBVFVTX0lJRCk7DQorCXNzbFN0YXR1cyA9IChvcmcubW96aWxsYS5pbnRlcmZhY2VzLm5zSVNT
TFN0YXR1cylzc2xTdGF0dXMucXVlcnlJbnRlcmZhY2UobnNJU1NMU3RhdHVzLk5TX0lTU0xTVEFU
VVNfSUlEKTsNCisJb3JnLm1vemlsbGEuaW50ZXJmYWNlcy5uc0lTZXJ2aWNlTWFuYWdlciBzZXJ2
aWNlTWFuYWdlciA9IG9yZy5tb3ppbGxhLnhwY29tLk1vemlsbGEuZ2V0SW5zdGFuY2UoKS5nZXRT
ZXJ2aWNlTWFuYWdlcigpOw0KKwluc0lDZXJ0T3ZlcnJpZGVTZXJ2aWNlIG92ZXJyaWRlU2Vydmlj
ZSA9IChuc0lDZXJ0T3ZlcnJpZGVTZXJ2aWNlKXNlcnZpY2VNYW5hZ2VyLmdldFNlcnZpY2VCeUNv
bnRyYWN0SUQoIkBtb3ppbGxhLm9yZy9zZWN1cml0eS9jZXJ0b3ZlcnJpZGU7MSIsIG5zSUNlcnRP
dmVycmlkZVNlcnZpY2UuTlNfSUNFUlRPVkVSUklERVNFUlZJQ0VfSUlEKTsNCisJbnNJWDUwOUNl
cnQgY2VydCA9IHNzbFN0YXR1cy5nZXRTZXJ2ZXJDZXJ0KCk7DQorCS8qDQorCSogdGhpcyBjZXJ0
IGRvZXMgbm90IHNlZW0gdG8gYmUgd2hhdCByZW1lbWJlclZhbGlkaXR5T3ZlcnJpZGUoKQ0KKwkq
IHdhbnRzIGJlY2F1c2UgaXQgYWx3YXlzIHJldHVybnMgZXJyb3IgY29kZSBOU19FUlJPUl9GQUlM
VVJFDQorCSovDQorCW92ZXJyaWRlU2VydmljZS5yZW1lbWJlclZhbGlkaXR5T3ZlcnJpZGUoaG9z
dCwgcG9ydCwgY2VydCwgNywgZmFsc2UpOw0KKwlyZXR1cm4gWFBDT00uTlNfT0s7DQorfQ0KIH0N
CkluZGV4OiBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nl
ci9Qcm9tcHRTZXJ2aWNlMi5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvZWNs
aXBzZS9vcmcuZWNsaXBzZS5zd3QvRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlw
c2Uvc3d0L2Jyb3dzZXIvUHJvbXB0U2VydmljZTIuamF2YSx2DQpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuNA0KZGlmZiAtdSAtcjEuNCBQcm9tcHRTZXJ2aWNlMi5qYXZhDQotLS0gRWNsaXBzZSBTV1Qg
TW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dzZXIvUHJvbXB0U2VydmljZTIuamF2
YQk1IE1hciAyMDA5IDIwOjU5OjEyIC0wMDAwCTEuNA0KKysrIEVjbGlwc2UgU1dUIE1vemlsbGEv
Y29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93c2VyL1Byb21wdFNlcnZpY2UyLmphdmEJNCBNYXkg
MjAwOSAxOTo1NjoyOSAtMDAwMA0KQEAgLTE0LDYgKzE0LDEwIEBADQogaW1wb3J0IG9yZy5lY2xp
cHNlLnN3dC5pbnRlcm5hbC4qOw0KIGltcG9ydCBvcmcuZWNsaXBzZS5zd3QuaW50ZXJuYWwubW96
aWxsYS4qOw0KIGltcG9ydCBvcmcuZWNsaXBzZS5zd3Qud2lkZ2V0cy4qOw0KK2ltcG9ydCBvcmcu
bW96aWxsYS5pbnRlcmZhY2VzLm5zSUNlcnRPdmVycmlkZVNlcnZpY2U7DQoraW1wb3J0IG9yZy5t
b3ppbGxhLmludGVyZmFjZXMubnNJUmVjZW50QmFkQ2VydHNTZXJ2aWNlOw0KK2ltcG9ydCBvcmcu
bW96aWxsYS5pbnRlcmZhY2VzLm5zSVNTTFN0YXR1czsNCitpbXBvcnQgb3JnLm1vemlsbGEuaW50
ZXJmYWNlcy5uc0lYNTA5Q2VydDsNCiANCiBjbGFzcyBQcm9tcHRTZXJ2aWNlMiB7DQogCVhQQ09N
T2JqZWN0IHN1cHBvcnRzOw0KQEAgLTE2MSw2ICsxNjUsMjggQEANCiAJWFBDT00ubWVtbW92ZSAo
ZGVzdCwgYVRleHQsIGxlbmd0aCAqIDIpOw0KIAlTdHJpbmcgdGV4dExhYmVsID0gbmV3IFN0cmlu
ZyAoZGVzdCk7DQogDQorCS8qIGJvZ3VzOiBkZXRlY3QgdGhlIHNob3dpbmcgb2YgYW4gZXJyb3Ig
ZGlhbG9nIHdpdGggc3RyaW5nICJzc2xfZXJyb3JfYmFkX2NlcnRfZG9tYWluIiAqLw0KKwlpZiAo
dGV4dExhYmVsLmluZGV4T2YgKCJzc2xfZXJyb3JfYmFkX2NlcnRfZG9tYWluIikgIT0gLTEpIHsN
CisJCS8qIA0KKwkJKiBXaGVuIEZpcmVmb3ggZGV0ZXJtaW5lcyBhIGJhZCBjZXJ0IGl0IGNyZWF0
ZXMgYSBzZWNvbmQgWE1MSFRUUFJlcXVlc3QgYW5kIHNldHMNCisJCSogYW4gbnNJQmFkQ2VydExp
c3RlbmVyMiBvbiBpdCwgd2hpY2ggdGhlbiBsZXRzIHRoZSB1c2VyIGFkZCBhbiBleGNlcHRpb24u
ICBIb3dldmVyDQorCQkqIG5zSVhNTEhUVFBSZXF1ZXN0IGlzIG5vdCBpbiB0aGUgeHVscnVubmVy
IDEuOSBTREsgKEZpcmVmb3ggZG9lcyBpdCBpbiBKUyB3aXRoDQorCQkqIFhNTEhUVFBSZXF1ZXN0
KSBzbyBpbnN0ZWFkIGdldCB0aGUgYmFkIGNlcnQgZnJvbSB0aGUgbnNJUmVjZW50QmFkQ2VydHNT
ZXJ2aWNlLg0KKwkJKiBTZWUgPGZpcmVmb3g+L3NlY3VyaXR5L21hbmFnZXIvcGtpL3Jlc291cmNl
cy9jb250ZW50L2V4Y2VwdGlvbkRpYWxvZy5qcy4NCisJCSovDQorCQlvcmcubW96aWxsYS5pbnRl
cmZhY2VzLm5zSVNlcnZpY2VNYW5hZ2VyIHNlcnZpY2VNYW5hZ2VyID0gb3JnLm1vemlsbGEueHBj
b20uTW96aWxsYS5nZXRJbnN0YW5jZSgpLmdldFNlcnZpY2VNYW5hZ2VyKCk7DQorCQluc0lDZXJ0
T3ZlcnJpZGVTZXJ2aWNlIG92ZXJyaWRlU2VydmljZSA9IChuc0lDZXJ0T3ZlcnJpZGVTZXJ2aWNl
KXNlcnZpY2VNYW5hZ2VyLmdldFNlcnZpY2VCeUNvbnRyYWN0SUQoIkBtb3ppbGxhLm9yZy9zZWN1
cml0eS9jZXJ0b3ZlcnJpZGU7MSIsIG5zSUNlcnRPdmVycmlkZVNlcnZpY2UuTlNfSUNFUlRPVkVS
UklERVNFUlZJQ0VfSUlEKTsNCisJCW5zSVJlY2VudEJhZENlcnRzU2VydmljZSBiYWRDZXJ0U2Vy
dmljZSA9IChuc0lSZWNlbnRCYWRDZXJ0c1NlcnZpY2Upc2VydmljZU1hbmFnZXIuZ2V0U2Vydmlj
ZUJ5Q29udHJhY3RJRCgiQG1vemlsbGEub3JnL3NlY3VyaXR5L3JlY2VudGJhZGNlcnRzOzEiLCBu
c0lSZWNlbnRCYWRDZXJ0c1NlcnZpY2UuTlNfSVJFQ0VOVEJBRENFUlRTU0VSVklDRV9JSUQpOw0K
KwkJLyogbmVlZCB0byBkZXRlcm1pbmUgdGhlIHVybCBhbmQgcG9ydCAqLw0KKwkJbnNJU1NMU3Rh
dHVzIHN0YXR1cyA9IGJhZENlcnRTZXJ2aWNlLmdldFJlY2VudEJhZENlcnQoInZlcmlzaWduLmNv
bTo0NDMiKTsNCisJCW5zSVg1MDlDZXJ0IGNlcnQgPSBzdGF0dXMuZ2V0U2VydmVyQ2VydCgpOw0K
KwkJLyoNCisJCSogdGhpcyBjZXJ0IGRvZXMgbm90IHNlZW0gdG8gYmUgd2hhdCByZW1lbWJlclZh
bGlkaXR5T3ZlcnJpZGUoKQ0KKwkJKiB3YW50cyBiZWNhdXNlIGl0IGFsd2F5cyByZXR1cm5zIGVy
cm9yIGNvZGUgTlNfRVJST1JfRkFJTFVSRQ0KKwkJKi8NCisJCW92ZXJyaWRlU2VydmljZS5yZW1l
bWJlclZhbGlkaXR5T3ZlcnJpZGUoInZlcmlzaWduLmNvbSIsIDQ0MywgY2VydCwgMSwgdHJ1ZSk7
DQorCX0NCisJDQogCVNoZWxsIHNoZWxsID0gYnJvd3NlciA9PSBudWxsID8gbmV3IFNoZWxsICgp
IDogYnJvd3Nlci5nZXRTaGVsbCAoKTsgDQogCU1lc3NhZ2VCb3ggbWVzc2FnZUJveCA9IG5ldyBN
ZXNzYWdlQm94IChzaGVsbCwgU1dULk9LIHwgU1dULklDT05fV0FSTklORyk7DQogCW1lc3NhZ2VC
b3guc2V0VGV4dCAodGl0bGVMYWJlbCk7DQo=
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>142130</attachid>
            <date>2009-07-21 09:33:00 -0400</date>
            <delta_ts>2009-08-19 16:07:04 -0400</delta_ts>
            <desc>patch, fixes for xulrunner 1.9.1</desc>
            <filename>patch.txt</filename>
            <type>text/plain</type>
            <size>70140</size>
            <attacher name="Grant Gayed">grant_gayed</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMAojUCBvcmcuZWNsaXBzZS5zd3QKSW5kZXg6
IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93c2VyL1Byb21w
dERpYWxvZy5qYXZhCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVj
bGlwc2Uuc3d0L0VjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93
c2VyL1Byb21wdERpYWxvZy5qYXZhLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjEyCmRpZmYgLXUg
LXIxLjEyIFByb21wdERpYWxvZy5qYXZhCi0tLSBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9v
cmcvZWNsaXBzZS9zd3QvYnJvd3Nlci9Qcm9tcHREaWFsb2cuamF2YQkxIEp1bCAyMDA5IDE0OjUw
OjI4IC0wMDAwCTEuMTIKKysrIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNl
L3N3dC9icm93c2VyL1Byb21wdERpYWxvZy5qYXZhCTIxIEp1bCAyMDA5IDEzOjI4OjMyIC0wMDAw
CkBAIC0xMSw2ICsxMSw5IEBACiBwYWNrYWdlIG9yZy5lY2xpcHNlLnN3dC5icm93c2VyOwogCiBp
bXBvcnQgb3JnLmVjbGlwc2Uuc3d0Lio7CitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmN1c3RvbS5T
dHlsZWRUZXh0OworaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5ncmFwaGljcy5JbWFnZTsKK2ltcG9y
dCBvcmcuZWNsaXBzZS5zd3QuaW50ZXJuYWwuQ29tcGF0aWJpbGl0eTsKIGltcG9ydCBvcmcuZWNs
aXBzZS5zd3QubGF5b3V0Lio7CiBpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuKjsKIApA
QCAtNjksNiArNzIsNzkgQEAKIAkJfQogCX0KIAorCWJvb2xlYW4gaW52YWxpZENlcnQoU3RyaW5n
IG1lc3NhZ2UsIFN0cmluZ1tdIHByb2JsZW1zKSB7CisJCVNoZWxsIHBhcmVudCA9IGdldFBhcmVu
dCgpOworCQlEaXNwbGF5IGRpc3BsYXkgPSBwYXJlbnQuZ2V0RGlzcGxheSgpOworCQlNb25pdG9y
IG1vbml0b3IgPSBwYXJlbnQuZ2V0TW9uaXRvcigpOworCQlpbnQgbWF4V2lkdGggPSBtb25pdG9y
LmdldEJvdW5kcygpLndpZHRoICogMiAvIDM7CisJCWZpbmFsIFNoZWxsIHNoZWxsID0gbmV3IFNo
ZWxsKHBhcmVudCwgU1dULkRJQUxPR19UUklNIHwgU1dULkFQUExJQ0FUSU9OX01PREFMKTsKKwkJ
c2hlbGwuc2V0VGV4dChDb21wYXRpYmlsaXR5LmdldE1lc3NhZ2UoIlNXVF9JbnZhbGlkQ2VydF9U
aXRsZSIpKTsgLy8kTk9OLU5MUy0xJAorCQlzaGVsbC5zZXRMYXlvdXQobmV3IEdyaWRMYXlvdXQo
KSk7CisKKwkJQ29tcG9zaXRlIG1lc3NhZ2VDb21wb3NpdGUgPSBuZXcgQ29tcG9zaXRlKHNoZWxs
LCBTV1QuTk9ORSk7CisJCW1lc3NhZ2VDb21wb3NpdGUuc2V0TGF5b3V0KG5ldyBHcmlkTGF5b3V0
KDIsIGZhbHNlKSk7CisJCUltYWdlIGltYWdlID0gZGlzcGxheS5nZXRTeXN0ZW1JbWFnZShTV1Qu
SUNPTl9XQVJOSU5HKTsKKwkJbmV3IExhYmVsKG1lc3NhZ2VDb21wb3NpdGUsIFNXVC5OT05FKS5z
ZXRJbWFnZShpbWFnZSk7CisJCVRleHQgdGV4dCA9IG5ldyBUZXh0KG1lc3NhZ2VDb21wb3NpdGUs
IFNXVC5XUkFQKTsKKwkJdGV4dC5zZXRMYXlvdXREYXRhKG5ldyBHcmlkRGF0YShTV1QuRklMTCwg
U1dULkNFTlRFUiwgdHJ1ZSwgZmFsc2UpKTsKKwkJdGV4dC5zZXRFZGl0YWJsZShmYWxzZSk7CisJ
CXRleHQuc2V0QmFja2dyb3VuZChzaGVsbC5nZXRCYWNrZ3JvdW5kKCkpOworCQl0ZXh0LnNldFRl
eHQobWVzc2FnZSk7CisJCWludCB3aWR0aCA9IG1lc3NhZ2VDb21wb3NpdGUuY29tcHV0ZVNpemUo
U1dULkRFRkFVTFQsIFNXVC5ERUZBVUxUKS54OworCQlHcmlkRGF0YSBkYXRhID0gbmV3IEdyaWRE
YXRhKCk7CisJCWRhdGEud2lkdGhIaW50ID0gTWF0aC5taW4od2lkdGgsIG1heFdpZHRoKTsKKwkJ
ZGF0YS5ob3Jpem9udGFsQWxpZ25tZW50ID0gR3JpZERhdGEuRklMTDsKKwkJZGF0YS5ncmFiRXhj
ZXNzSG9yaXpvbnRhbFNwYWNlID0gdHJ1ZTsKKwkJbWVzc2FnZUNvbXBvc2l0ZS5zZXRMYXlvdXRE
YXRhKGRhdGEpOworCisJCVN0eWxlZFRleHQgcHJvYmxlbXNUZXh0ID0gbmV3IFN0eWxlZFRleHQo
c2hlbGwsIFNXVC5XUkFQKTsKKwkJcHJvYmxlbXNUZXh0LnNldE1hcmdpbnMoMzAsIDAsIDMwLCAw
KTsKKwkJcHJvYmxlbXNUZXh0LnNldEVkaXRhYmxlKGZhbHNlKTsKKwkJcHJvYmxlbXNUZXh0LnNl
dEJhY2tncm91bmQoc2hlbGwuZ2V0QmFja2dyb3VuZCgpKTsKKwkJZm9yIChpbnQgaSA9IDA7IGkg
PCBwcm9ibGVtcy5sZW5ndGg7IGkrKykgeworCQkJcHJvYmxlbXNUZXh0LmFwcGVuZCgnXG4nICsg
cHJvYmxlbXNbaV0gKyAnXG4nKTsKKwkJfQorCQl3aWR0aCA9IHByb2JsZW1zVGV4dC5jb21wdXRl
U2l6ZShTV1QuREVGQVVMVCwgU1dULkRFRkFVTFQpLng7CisJCWRhdGEgPSBuZXcgR3JpZERhdGEo
KTsKKwkJZGF0YS53aWR0aEhpbnQgPSBNYXRoLm1pbih3aWR0aCwgbWF4V2lkdGgpOworCQlkYXRh
Lmhvcml6b250YWxBbGlnbm1lbnQgPSBHcmlkRGF0YS5GSUxMOworCQlkYXRhLmdyYWJFeGNlc3NI
b3Jpem9udGFsU3BhY2UgPSB0cnVlOworCQlwcm9ibGVtc1RleHQuc2V0TGF5b3V0RGF0YShkYXRh
KTsKKworCQl0ZXh0ID0gbmV3IFRleHQoc2hlbGwsIFNXVC5TSU5HTEUpOworCQl0ZXh0LnNldEVk
aXRhYmxlKGZhbHNlKTsKKwkJdGV4dC5zZXRCYWNrZ3JvdW5kKHNoZWxsLmdldEJhY2tncm91bmQo
KSk7CisJCXRleHQuc2V0VGV4dChDb21wYXRpYmlsaXR5LmdldE1lc3NhZ2UoIlNXVF9JbnZhbGlk
Q2VydF9Db25uZWN0IikpOyAvLyROT04tTkxTLTEkCisJCQorCQlDb21wb3NpdGUgYnV0dG9uc0Nv
bXBvc2l0ZSA9IG5ldyBDb21wb3NpdGUoc2hlbGwsIFNXVC5OT05FKTsKKwkJYnV0dG9uc0NvbXBv
c2l0ZS5zZXRMYXlvdXQobmV3IEdyaWRMYXlvdXQoMiwgdHJ1ZSkpOworCQlidXR0b25zQ29tcG9z
aXRlLnNldExheW91dERhdGEobmV3IEdyaWREYXRhKFNXVC5DRU5URVIsIFNXVC5DRU5URVIsIGZh
bHNlLCBmYWxzZSkpOworCQlmaW5hbCBCdXR0b24gb2tCdXR0b24gPSBuZXcgQnV0dG9uKGJ1dHRv
bnNDb21wb3NpdGUsIFNXVC5QVVNIKTsKKwkJb2tCdXR0b24uc2V0TGF5b3V0RGF0YShuZXcgR3Jp
ZERhdGEoU1dULkZJTEwsIFNXVC5GSUxMLCBmYWxzZSwgZmFsc2UpKTsKKwkJb2tCdXR0b24uc2V0
VGV4dChDb21wYXRpYmlsaXR5LmdldE1lc3NhZ2UoIlNXVF9PSyIpKTsKKwkJQnV0dG9uIGNhbmNl
bEJ1dHRvbiA9IG5ldyBCdXR0b24oYnV0dG9uc0NvbXBvc2l0ZSwgU1dULlBVU0gpOworCQljYW5j
ZWxCdXR0b24uc2V0TGF5b3V0RGF0YShuZXcgR3JpZERhdGEoU1dULkZJTEwsIFNXVC5GSUxMLCBm
YWxzZSwgZmFsc2UpKTsKKwkJY2FuY2VsQnV0dG9uLnNldFRleHQoQ29tcGF0aWJpbGl0eS5nZXRN
ZXNzYWdlKCJTV1RfQ2FuY2VsIikpOyAvLyROT04tTkxTLTEkCisJCWZpbmFsIGJvb2xlYW5bXSBy
ZXN1bHQgPSBuZXcgYm9vbGVhblsxXTsKKwkJTGlzdGVuZXIgbGlzdGVuZXIgPSBuZXcgTGlzdGVu
ZXIoKSB7CisJCQlwdWJsaWMgdm9pZCBoYW5kbGVFdmVudChFdmVudCBldmVudCkgeworCQkJCXNo
ZWxsLmRpc3Bvc2UoKTsKKwkJCQlyZXN1bHRbMF0gPSBldmVudC53aWRnZXQgPT0gb2tCdXR0b247
CisJCQl9CisJCX07CisJCW9rQnV0dG9uLmFkZExpc3RlbmVyKFNXVC5TZWxlY3Rpb24sIGxpc3Rl
bmVyKTsKKwkJY2FuY2VsQnV0dG9uLmFkZExpc3RlbmVyKFNXVC5TZWxlY3Rpb24sIGxpc3RlbmVy
KTsKKworCQljYW5jZWxCdXR0b24uc2V0Rm9jdXMoKTsKKwkJc2hlbGwuc2V0RGVmYXVsdEJ1dHRv
bihjYW5jZWxCdXR0b24pOworCQlzaGVsbC5wYWNrKCk7CisJCXNoZWxsLm9wZW4oKTsKKwkJd2hp
bGUgKCFzaGVsbC5pc0Rpc3Bvc2VkKCkpIHsKKwkJCWlmICghZGlzcGxheS5yZWFkQW5kRGlzcGF0
Y2goKSkgZGlzcGxheS5zbGVlcCgpOworCQl9CisJCXJldHVybiByZXN1bHRbMF07CisJfQorCiAJ
dm9pZCBjb25maXJtRXgoU3RyaW5nIHRpdGxlLCBTdHJpbmcgdGV4dCwgU3RyaW5nIGNoZWNrLCBT
dHJpbmcgYnV0dG9uMCwgU3RyaW5nIGJ1dHRvbjEsIFN0cmluZyBidXR0b24yLCBpbnQgZGVmYXVs
dEluZGV4LCBmaW5hbCBpbnRbXSBjaGVja1ZhbHVlLCBmaW5hbCBpbnRbXSByZXN1bHQpIHsKIAkJ
U2hlbGwgcGFyZW50ID0gZ2V0UGFyZW50KCk7CiAJCWZpbmFsIFNoZWxsIHNoZWxsID0gbmV3IFNo
ZWxsKHBhcmVudCwgU1dULkRJQUxPR19UUklNIHwgU1dULkFQUExJQ0FUSU9OX01PREFMKTsKSW5k
ZXg6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93c2VyL01v
emlsbGEuamF2YQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xp
cHNlLnN3dC9FY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nl
ci9Nb3ppbGxhLmphdmEsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTM4CmRpZmYgLXUgLXIxLjEz
OCBNb3ppbGxhLmphdmEKLS0tIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNl
L3N3dC9icm93c2VyL01vemlsbGEuamF2YQkxIEp1bCAyMDA5IDE0OjUwOjI5IC0wMDAwCTEuMTM4
CisrKyBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nlci9N
b3ppbGxhLmphdmEJMjEgSnVsIDIwMDkgMTM6Mjg6MzIgLTAwMDAKQEAgLTQxLDEyICs0MSwxMyBA
QAogCVhQQ09NT2JqZWN0IHVyaUNvbnRlbnRMaXN0ZW5lcjsKIAlYUENPTU9iamVjdCB0b29sdGlw
TGlzdGVuZXI7CiAJWFBDT01PYmplY3QgZG9tRXZlbnRMaXN0ZW5lcjsKKwlYUENPTU9iamVjdCBi
YWRDZXJ0TGlzdGVuZXI7CiAJaW50IGNocm9tZUZsYWdzID0gbnNJV2ViQnJvd3NlckNocm9tZS5D
SFJPTUVfREVGQVVMVDsKIAlpbnQgcmVnaXN0ZXJGdW5jdGlvbnNPblN0YXRlID0gMDsKIAlpbnQg
cmVmQ291bnQsIGxhc3RLZXlDb2RlLCBsYXN0Q2hhckNvZGUsIGF1dGhDb3VudDsKIAlpbnQgLyps
b25nKi8gcmVxdWVzdDsKIAlQb2ludCBsb2NhdGlvbiwgc2l6ZTsKLQlib29sZWFuIHZpc2libGUs
IGlzQ2hpbGQsIGlnbm9yZURpc3Bvc2U7CisJYm9vbGVhbiB2aXNpYmxlLCBpc0NoaWxkLCBpZ25v
cmVEaXNwb3NlLCBpc1JldHJpZXZpbmdCYWRDZXJ0OwogCVNoZWxsIHRpcCA9IG51bGw7CiAJTGlz
dGVuZXIgbGlzdGVuZXI7CiAJVmVjdG9yIHVuaG9va2VkRE9NV2luZG93cyA9IG5ldyBWZWN0b3Ig
KCk7CkBAIC0xNjMwLDYgKzE2MzEsMTMgQEAKIAkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2Qy
IChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFJlbGVhc2UgKCk7fQogCQlwdWJsaWMgaW50
IC8qbG9uZyovIG1ldGhvZDMgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gSGFuZGxlRXZl
bnQgKGFyZ3NbMF0pO30KIAl9OworCisJYmFkQ2VydExpc3RlbmVyID0gbmV3IFhQQ09NT2JqZWN0
IChuZXcgaW50W10gezIsIDAsIDAsIDR9KSB7CisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9k
MCAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBRdWVyeUludGVyZmFjZSAoYXJnc1swXSwg
YXJnc1sxXSk7fQorCQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDEgKGludCAvKmxvbmcqL1td
IGFyZ3MpIHtyZXR1cm4gQWRkUmVmICgpO30KKwkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2Qy
IChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFJlbGVhc2UgKCk7fQorCQlwdWJsaWMgaW50
IC8qbG9uZyovIG1ldGhvZDMgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gTm90aWZ5Q2Vy
dFByb2JsZW0gKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pO30KKwl9OwogfQog
CiB2b2lkIGRlcmVnaXN0ZXJGdW5jdGlvbiAoQnJvd3NlckZ1bmN0aW9uIGZ1bmN0aW9uKSB7CkBA
IC0xNjg2LDYgKzE2OTQsMTAgQEAKIAkJZG9tRXZlbnRMaXN0ZW5lci5kaXNwb3NlICgpOwogCQlk
b21FdmVudExpc3RlbmVyID0gbnVsbDsKIAl9CisJaWYgKGJhZENlcnRMaXN0ZW5lciAhPSBudWxs
KSB7CisJCWJhZENlcnRMaXN0ZW5lci5kaXNwb3NlICgpOworCQliYWRDZXJ0TGlzdGVuZXIgPSBu
dWxsOworCX0KIH0KIAogcHVibGljIGJvb2xlYW4gZXhlY3V0ZSAoU3RyaW5nIHNjcmlwdCkgewpA
QCAtMjU0NCw2ICsyNTU2LDExIEBACiAJCUFkZFJlZiAoKTsKIAkJcmV0dXJuIFhQQ09NLk5TX09L
OwogCX0KKwlpZiAoZ3VpZC5FcXVhbHMgKG5zSUJhZENlcnRMaXN0ZW5lcjIuTlNfSUJBRENFUlRM
SVNURU5FUjJfSUlEKSkgeworCQlYUENPTS5tZW1tb3ZlIChwcHZPYmplY3QsIG5ldyBpbnQgLyps
b25nKi9bXSB7YmFkQ2VydExpc3RlbmVyLmdldEFkZHJlc3MgKCl9LCBDLlBUUl9TSVpFT0YpOwor
CQlBZGRSZWYgKCk7CisJCXJldHVybiBYUENPTS5OU19PSzsKKwl9CiAJWFBDT00ubWVtbW92ZSAo
cHB2T2JqZWN0LCBuZXcgaW50IC8qbG9uZyovW10gezB9LCBDLlBUUl9TSVpFT0YpOwogCXJldHVy
biBYUENPTS5OU19FUlJPUl9OT19JTlRFUkZBQ0U7CiB9CkBAIC0yNjAyLDYgKzI2MTksMjIgQEAK
IAogCWlmICgoYVN0YXRlRmxhZ3MgJiBuc0lXZWJQcm9ncmVzc0xpc3RlbmVyLlNUQVRFX0lTX0RP
Q1VNRU5UKSA9PSAwKSByZXR1cm4gWFBDT00uTlNfT0s7CiAJaWYgKChhU3RhdGVGbGFncyAmIG5z
SVdlYlByb2dyZXNzTGlzdGVuZXIuU1RBVEVfU1RBUlQpICE9IDApIHsKKwkJaW50IC8qbG9uZyov
W10gcmVzdWx0ID0gbmV3IGludCAvKmxvbmcqL1sxXTsKKwkJaWYgKGlzUmV0cmlldmluZ0JhZENl
cnQpIHsKKwkJCWlzUmV0cmlldmluZ0JhZENlcnQgPSBmYWxzZTsKKwkJCW5zSVJlcXVlc3QgcmVx
dWVzdCA9IG5ldyBuc0lSZXF1ZXN0IChhUmVxdWVzdCk7CisJCQlpbnQgcmMgPSByZXF1ZXN0LlF1
ZXJ5SW50ZXJmYWNlIChuc0lDaGFubmVsLk5TX0lDSEFOTkVMX0lJRCwgcmVzdWx0KTsKKwkJCWlm
IChyYyAhPSBYUENPTS5OU19PSykgZXJyb3IgKHJjKTsKKwkJCWlmIChyZXN1bHRbMF0gPT0gMCkg
ZXJyb3IgKFhQQ09NLk5TX05PSU5URVJGQUNFKTsKKworCQkJbnNJQ2hhbm5lbCBjaGFubmVsID0g
bmV3IG5zSUNoYW5uZWwgKHJlc3VsdFswXSk7CisJCQlyZXN1bHRbMF0gPSAwOworCQkJcmMgPSBj
aGFubmVsLlNldE5vdGlmaWNhdGlvbkNhbGxiYWNrcyAoaW50ZXJmYWNlUmVxdWVzdG9yLmdldEFk
ZHJlc3MgKCkpOworCQkJaWYgKHJjICE9IFhQQ09NLk5TX09LKSBlcnJvciAocmMpOworCQkJY2hh
bm5lbC5SZWxlYXNlICgpOworCQkJcmV0dXJuIFhQQ09NLk5TX09LOworCQl9CisKIAkJaWYgKHJl
cXVlc3QgPT0gMCkgcmVxdWVzdCA9IGFSZXF1ZXN0OwogCQlyZWdpc3RlckZ1bmN0aW9uc09uU3Rh
dGUgPSBuc0lXZWJQcm9ncmVzc0xpc3RlbmVyLlNUQVRFX0lTX1JFUVVFU1QgfCBuc0lXZWJQcm9n
cmVzc0xpc3RlbmVyLlNUQVRFX1NUQVJUOwogCQkvKgpAQCAtMjYxMCwxMiArMjY0MywxMiBAQAog
CQkgKiBwcm9jZXNzLiAgVGhlc2UgbGlzdGVuZXJzIGNhbm5vdCBiZSBhZGRlZCB5ZXQgYmVjYXVz
ZSB0aGUKIAkJICogbnNJRE9NV2luZG93IGlzIG5vdCByZWFkeSB0byB0YWtlIHRoZW0gYXQgdGhp
cyBzdGFnZS4KIAkJICovCi0JCWludCAvKmxvbmcqL1tdIHJlc3VsdCA9IG5ldyBpbnQgLypsb25n
Ki9bMV07CiAJCW5zSVdlYlByb2dyZXNzIHByb2dyZXNzID0gbmV3IG5zSVdlYlByb2dyZXNzIChh
V2ViUHJvZ3Jlc3MpOwogCQlpbnQgcmMgPSBwcm9ncmVzcy5HZXRET01XaW5kb3cgKHJlc3VsdCk7
CiAJCWlmIChyYyAhPSBYUENPTS5OU19PSykgZXJyb3IgKHJjKTsKIAkJaWYgKHJlc3VsdFswXSA9
PSAwKSBlcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOwogCQl1bmhvb2tlZERPTVdpbmRvd3Mu
YWRkRWxlbWVudCAobmV3IExPTkcgKHJlc3VsdFswXSkpOworCQlyZXN1bHRbMF0gPSAwOwogCX0g
ZWxzZSBpZiAoKGFTdGF0ZUZsYWdzICYgbnNJV2ViUHJvZ3Jlc3NMaXN0ZW5lci5TVEFURV9SRURJ
UkVDVElORykgIT0gMCkgewogCQlpZiAocmVxdWVzdCA9PSBhUmVxdWVzdCkgcmVxdWVzdCA9IDA7
CiAJCXJlZ2lzdGVyRnVuY3Rpb25zT25TdGF0ZSA9IG5zSVdlYlByb2dyZXNzTGlzdGVuZXIuU1RB
VEVfVFJBTlNGRVJSSU5HOwpAQCAtMzI4Nyw2ICszMzIwLDcgQEAKIC8qIG5zSVVSSUNvbnRlbnRM
aXN0ZW5lciAqLwogCiBpbnQgT25TdGFydFVSSU9wZW4gKGludCAvKmxvbmcqLyBhVVJJLCBpbnQg
Lypsb25nKi8gcmV0dmFsKSB7CisJaWYgKGlzUmV0cmlldmluZ0JhZENlcnQpIHJldHVybiBYUENP
TS5OU19PSzsKIAlhdXRoQ291bnQgPSAwOwogCiAJbnNJVVJJIGxvY2F0aW9uID0gbmV3IG5zSVVS
SSAoYVVSSSk7CkBAIC0zODE3LDQgKzM4NTEsMTM4IEBACiAJfQogCXJldHVybiBYUENPTS5OU19P
SzsKIH0KKworLyogbnNJQmFkQ2VydExpc3RlbmVyMiAqLworCitpbnQgTm90aWZ5Q2VydFByb2Js
ZW0gKGludCAvKmxvbmcqLyBzb2NrZXRJbmZvLCBpbnQgLypsb25nKi8gc3RhdHVzLCBpbnQgLyps
b25nKi8gdGFyZ2V0U2l0ZSwgaW50IC8qbG9uZyovIF9zdXBwcmVzc0Vycm9yKSB7CisJaW50IGxl
bmd0aCA9IFhQQ09NLm5zRW1iZWRDU3RyaW5nX0xlbmd0aCAodGFyZ2V0U2l0ZSk7CisJaW50IC8q
bG9uZyovIGJ1ZmZlciA9IFhQQ09NLm5zRW1iZWRDU3RyaW5nX2dldCAodGFyZ2V0U2l0ZSk7CisJ
Ynl0ZVtdIGRlc3QgPSBuZXcgYnl0ZVtsZW5ndGhdOworCVhQQ09NLm1lbW1vdmUgKGRlc3QsIGJ1
ZmZlciwgbGVuZ3RoKTsKKwlTdHJpbmcgdXJsUG9ydCA9IG5ldyBTdHJpbmcgKGRlc3QpOworCWlu
dCBpbmRleCA9IHVybFBvcnQuaW5kZXhPZiAoJzonKTsKKwlTdHJpbmcgaG9zdCA9IHVybFBvcnQu
c3Vic3RyaW5nICgwLGluZGV4KTsKKwlpbnQgcG9ydCA9IEludGVnZXIudmFsdWVPZiAodXJsUG9y
dC5zdWJzdHJpbmcgKGluZGV4ICsgMSkpLmludFZhbHVlICgpOworCUMubWVtbW92ZSAoX3N1cHBy
ZXNzRXJyb3IsIG5ldyBpbnRbXSB7MX0sIDQpOyAvKiBQUkludDMyICovCisKKwlpbnQgLypsb25n
Ki9bXSByZXN1bHQgPSBuZXcgaW50IC8qbG9uZyovWzFdOworCW5zSVN1cHBvcnRzIHN1cHBvcnRz
ID0gbmV3IG5zSVN1cHBvcnRzIChzdGF0dXMpOworCWludCByYyA9IHN1cHBvcnRzLlF1ZXJ5SW50
ZXJmYWNlIChuc0lTU0xTdGF0dXMuTlNfSVNTTFNUQVRVU19JSUQsIHJlc3VsdCk7CisJaWYgKHJj
ICE9IFhQQ09NLk5TX09LKSBlcnJvciAocmMpOworCWlmIChyZXN1bHRbMF0gPT0gMCkgZXJyb3Ig
KFhQQ09NLk5TX05PSU5URVJGQUNFKTsKKworCW5zSVNTTFN0YXR1cyBzc2xTdGF0dXMgPSBuZXcg
bnNJU1NMU3RhdHVzIChyZXN1bHRbMF0pOworCXJlc3VsdFswXSA9IDA7CisJcmMgPSBzc2xTdGF0
dXMuR2V0U2VydmVyQ2VydCAocmVzdWx0KTsKKwlpZiAocmMgIT0gWFBDT00uTlNfT0spIGVycm9y
IChyYyk7CisJaWYgKHJlc3VsdFswXSA9PSAwKSBlcnJvciAoWFBDT00uTlNfRVJST1JfTlVMTF9Q
T0lOVEVSKTsKKworCW5zSVg1MDlDZXJ0IGNlcnQgPSBuZXcgbnNJWDUwOUNlcnQgKHJlc3VsdFsw
XSk7CisJcmVzdWx0WzBdID0gMDsKKwlTdHJpbmdbXSBwcm9ibGVtcyA9IG5ldyBTdHJpbmdbM107
CisJaW50IHByb2JsZW1Db3VudCA9IDAsIGZsYWdzID0gMDsKKwlpbnRbXSBpbnRSZXN1bHQgPSBu
ZXcgaW50WzFdOworCisJcmMgPSBzc2xTdGF0dXMuR2V0SXNEb21haW5NaXNtYXRjaCAoaW50UmVz
dWx0KTsKKwlpZiAoaW50UmVzdWx0WzBdICE9IDApIHsKKwkJaW50IC8qbG9uZyovIHB0ciA9IFhQ
Q09NLm5zRW1iZWRTdHJpbmdfbmV3ICgpOworCQlyYyA9IGNlcnQuR2V0Q29tbW9uTmFtZSAocHRy
KTsKKwkJaWYgKHJjICE9IFhQQ09NLk5TX09LKSBTV1QuZXJyb3IgKHJjKTsKKwkJbGVuZ3RoID0g
WFBDT00ubnNFbWJlZFN0cmluZ19MZW5ndGggKHB0cik7CisJCWJ1ZmZlciA9IFhQQ09NLm5zRW1i
ZWRTdHJpbmdfZ2V0IChwdHIpOworCQljaGFyW10gY2hhcnMgPSBuZXcgY2hhcltsZW5ndGhdOwor
CQlYUENPTS5tZW1tb3ZlIChjaGFycywgYnVmZmVyLCBsZW5ndGggKiAyKTsKKwkJU3RyaW5nIG5h
bWUgPSBuZXcgU3RyaW5nIChjaGFycyk7CisJCXByb2JsZW1zW3Byb2JsZW1Db3VudCsrXSA9IENv
bXBhdGliaWxpdHkuZ2V0TWVzc2FnZSAoIlNXVF9JbnZhbGlkQ2VydF9JbnZhbGlkTmFtZSIsIG5l
dyBTdHJpbmdbXSB7bmFtZX0pOyAvLyROT04tTkxTLTEkCisJCWZsYWdzIHw9IG5zSUNlcnRPdmVy
cmlkZVNlcnZpY2UuRVJST1JfTUlTTUFUQ0g7CisJCVhQQ09NLm5zRW1iZWRTdHJpbmdfZGVsZXRl
IChwdHIpOworCX0KKwlpbnRSZXN1bHRbMF0gPSAwOworCisJcmMgPSBzc2xTdGF0dXMuR2V0SXNO
b3RWYWxpZEF0VGhpc1RpbWUgKGludFJlc3VsdCk7CisJaWYgKGludFJlc3VsdFswXSAhPSAwKSB7
CisJCXJjID0gY2VydC5HZXRWYWxpZGl0eSAocmVzdWx0KTsKKwkJaWYgKHJjICE9IFhQQ09NLk5T
X09LKSBTV1QuZXJyb3IgKHJjKTsKKwkJaWYgKHJlc3VsdFswXSA9PSAwKSBlcnJvciAoWFBDT00u
TlNfRVJST1JfTlVMTF9QT0lOVEVSKTsKKworCQluc0lYNTA5Q2VydFZhbGlkaXR5IHZhbGlkaXR5
ID0gbmV3IG5zSVg1MDlDZXJ0VmFsaWRpdHkocmVzdWx0WzBdKTsKKwkJcmVzdWx0WzBdID0gMDsK
KworCQlpbnQgLypsb25nKi8gcHRyID0gWFBDT00ubnNFbWJlZFN0cmluZ19uZXcgKCk7CisJCXJj
ID0gdmFsaWRpdHkuR2V0Tm90QmVmb3JlR01UIChwdHIpOworCQlpZiAocmMgIT0gWFBDT00uTlNf
T0spIFNXVC5lcnJvciAocmMpOworCQlsZW5ndGggPSBYUENPTS5uc0VtYmVkU3RyaW5nX0xlbmd0
aCAocHRyKTsKKwkJYnVmZmVyID0gWFBDT00ubnNFbWJlZFN0cmluZ19nZXQgKHB0cik7CisJCWNo
YXJbXSBjaGFycyA9IG5ldyBjaGFyW2xlbmd0aF07CisJCVhQQ09NLm1lbW1vdmUgKGNoYXJzLCBi
dWZmZXIsIGxlbmd0aCAqIDIpOworCQlTdHJpbmcgbm90QmVmb3JlID0gbmV3IFN0cmluZyAoY2hh
cnMpOworCQlYUENPTS5uc0VtYmVkU3RyaW5nX2RlbGV0ZSAocHRyKTsKKworCQlwdHIgPSBYUENP
TS5uc0VtYmVkU3RyaW5nX25ldyAoKTsKKwkJcmMgPSB2YWxpZGl0eS5HZXROb3RBZnRlckdNVCAo
cHRyKTsKKwkJaWYgKHJjICE9IFhQQ09NLk5TX09LKSBTV1QuZXJyb3IgKHJjKTsKKwkJbGVuZ3Ro
ID0gWFBDT00ubnNFbWJlZFN0cmluZ19MZW5ndGggKHB0cik7CisJCWJ1ZmZlciA9IFhQQ09NLm5z
RW1iZWRTdHJpbmdfZ2V0IChwdHIpOworCQljaGFycyA9IG5ldyBjaGFyW2xlbmd0aF07CisJCVhQ
Q09NLm1lbW1vdmUgKGNoYXJzLCBidWZmZXIsIGxlbmd0aCAqIDIpOworCQlTdHJpbmcgbm90QWZ0
ZXIgPSBuZXcgU3RyaW5nIChjaGFycyk7CisJCVhQQ09NLm5zRW1iZWRTdHJpbmdfZGVsZXRlIChw
dHIpOworCisJCVN0cmluZyByYW5nZSA9IG5vdEJlZm9yZSArICIgLSAiICsgbm90QWZ0ZXI7IC8v
JE5PTi1OTFMtMSQKKwkJcHJvYmxlbXNbcHJvYmxlbUNvdW50KytdID0gQ29tcGF0aWJpbGl0eS5n
ZXRNZXNzYWdlICgiU1dUX0ludmFsaWRDZXJ0X05vdFZhbGlkIiwgbmV3IFN0cmluZ1tdIHtyYW5n
ZX0pOyAvLyROT04tTkxTLTEkCisJCWZsYWdzIHw9IG5zSUNlcnRPdmVycmlkZVNlcnZpY2UuRVJS
T1JfVElNRTsKKwkJdmFsaWRpdHkuUmVsZWFzZSAoKTsKKwl9CisJaW50UmVzdWx0WzBdID0gMDsK
KworCXJjID0gc3NsU3RhdHVzLkdldElzVW50cnVzdGVkIChpbnRSZXN1bHQpOworCWlmIChpbnRS
ZXN1bHRbMF0gIT0gMCkgeworCQlpbnQgLypsb25nKi8gcHRyID0gWFBDT00ubnNFbWJlZFN0cmlu
Z19uZXcgKCk7CisJCXJjID0gY2VydC5HZXRJc3N1ZXJDb21tb25OYW1lIChwdHIpOworCQlpZiAo
cmMgIT0gWFBDT00uTlNfT0spIFNXVC5lcnJvciAocmMpOworCQlsZW5ndGggPSBYUENPTS5uc0Vt
YmVkU3RyaW5nX0xlbmd0aCAocHRyKTsKKwkJYnVmZmVyID0gWFBDT00ubnNFbWJlZFN0cmluZ19n
ZXQgKHB0cik7CisJCWNoYXJbXSBjaGFycyA9IG5ldyBjaGFyW2xlbmd0aF07CisJCVhQQ09NLm1l
bW1vdmUgKGNoYXJzLCBidWZmZXIsIGxlbmd0aCAqIDIpOworCQlTdHJpbmcgbmFtZSA9IG5ldyBT
dHJpbmcgKGNoYXJzKTsKKwkJcHJvYmxlbXNbcHJvYmxlbUNvdW50KytdID0gQ29tcGF0aWJpbGl0
eS5nZXRNZXNzYWdlICgiU1dUX0ludmFsaWRDZXJ0X05vdFRydXN0ZWQiLCBuZXcgU3RyaW5nW10g
e25hbWV9KTsgLy8kTk9OLU5MUy0xJAorCQlmbGFncyB8PSBuc0lDZXJ0T3ZlcnJpZGVTZXJ2aWNl
LkVSUk9SX1VOVFJVU1RFRDsKKwkJWFBDT00ubnNFbWJlZFN0cmluZ19kZWxldGUgKHB0cik7CisJ
fQorCWludFJlc3VsdFswXSA9IDA7CisJc3NsU3RhdHVzLlJlbGVhc2UgKCk7CisKKwlpZiAocHJv
YmxlbUNvdW50IDwgMykgeworCQlTdHJpbmdbXSB0ZW1wID0gbmV3IFN0cmluZ1twcm9ibGVtQ291
bnRdOworCQlTeXN0ZW0uYXJyYXljb3B5IChwcm9ibGVtcywgMCwgdGVtcCwgMCwgcHJvYmxlbUNv
dW50KTsKKwkJcHJvYmxlbXMgPSB0ZW1wOworCX0KKwlTdHJpbmcgbWVzc2FnZSA9IENvbXBhdGli
aWxpdHkuZ2V0TWVzc2FnZSAoIlNXVF9JbnZhbGlkQ2VydF9NZXNzYWdlIiwgbmV3IFN0cmluZ1td
IHt1cmxQb3J0fSk7IC8vJE5PTi1OTFMtMSQKKwlpZiAobmV3IFByb21wdERpYWxvZyAoYnJvd3Nl
ci5nZXRTaGVsbCAoKSkuaW52YWxpZENlcnQgKG1lc3NhZ2UsIHByb2JsZW1zKSkgeworCQlyYyA9
IFhQQ09NLk5TX0dldFNlcnZpY2VNYW5hZ2VyIChyZXN1bHQpOworCQlpZiAocmMgIT0gWFBDT00u
TlNfT0spIGVycm9yIChyYyk7CisJCWlmIChyZXN1bHRbMF0gPT0gMCkgZXJyb3IgKFhQQ09NLk5T
X05PSU5URVJGQUNFKTsKKworCQluc0lTZXJ2aWNlTWFuYWdlciBzZXJ2aWNlTWFuYWdlciA9IG5l
dyBuc0lTZXJ2aWNlTWFuYWdlciAocmVzdWx0WzBdKTsKKwkJcmVzdWx0WzBdID0gMDsKKwkJYnl0
ZVtdIGFDb250cmFjdElEID0gTW96aWxsYURlbGVnYXRlLndjc1RvTWJjcyAobnVsbCwgWFBDT00u
TlNfQ0VSVE9WRVJSSURFX0NPTlRSQUNUSUQsIHRydWUpOworCQlyYyA9IHNlcnZpY2VNYW5hZ2Vy
LkdldFNlcnZpY2VCeUNvbnRyYWN0SUQgKGFDb250cmFjdElELCBuc0lDZXJ0T3ZlcnJpZGVTZXJ2
aWNlLk5TX0lDRVJUT1ZFUlJJREVTRVJWSUNFX0lJRCwgcmVzdWx0KTsKKwkJaWYgKHJjICE9IFhQ
Q09NLk5TX09LKSBlcnJvciAocmMpOworCQlpZiAocmVzdWx0WzBdID09IDApIGVycm9yIChYUENP
TS5OU19OT0lOVEVSRkFDRSk7CisJCXNlcnZpY2VNYW5hZ2VyLlJlbGVhc2UgKCk7CisKKwkJbnNJ
Q2VydE92ZXJyaWRlU2VydmljZSBvdmVycmlkZVNlcnZpY2UgPSBuZXcgbnNJQ2VydE92ZXJyaWRl
U2VydmljZSAocmVzdWx0WzBdKTsKKwkJcmVzdWx0WzBdID0gMDsKKwkJYnl0ZVtdIGhvc3RCeXRl
cyA9IE1vemlsbGFEZWxlZ2F0ZS53Y3NUb01iY3MgKG51bGwsIGhvc3QsIGZhbHNlKTsKKwkJaW50
IC8qbG9uZyovIGhvc3RTdHJpbmcgPSBYUENPTS5uc0VtYmVkQ1N0cmluZ19uZXcgKGhvc3RCeXRl
cywgaG9zdEJ5dGVzLmxlbmd0aCk7CisJCXJjID0gb3ZlcnJpZGVTZXJ2aWNlLlJlbWVtYmVyVmFs
aWRpdHlPdmVycmlkZSAoaG9zdFN0cmluZywgcG9ydCwgY2VydC5nZXRBZGRyZXNzICgpLCBmbGFn
cywgMSk7CisJCWJyb3dzZXIuc2V0VXJsIChsYXN0TmF2aWdhdGVVUkwpOworCQlYUENPTS5uc0Vt
YmVkQ1N0cmluZ19kZWxldGUgKGhvc3RTdHJpbmcpOworCQlvdmVycmlkZVNlcnZpY2UuUmVsZWFz
ZSAoKTsKKwl9CisJCisJY2VydC5SZWxlYXNlICgpOworCXJldHVybiBYUENPTS5OU19PSzsKK30K
KwogfQpJbmRleDogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jy
b3dzZXIvUHJvbXB0U2VydmljZTIuamF2YQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3Zzcm9vdC9l
Y2xpcHNlL29yZy5lY2xpcHNlLnN3dC9FY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNs
aXBzZS9zd3QvYnJvd3Nlci9Qcm9tcHRTZXJ2aWNlMi5qYXZhLHYKcmV0cmlldmluZyByZXZpc2lv
biAxLjgKZGlmZiAtdSAtcjEuOCBQcm9tcHRTZXJ2aWNlMi5qYXZhCi0tLSBFY2xpcHNlIFNXVCBN
b3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nlci9Qcm9tcHRTZXJ2aWNlMi5qYXZh
CTEgSnVsIDIwMDkgMTQ6NTA6MjkgLTAwMDAJMS44CisrKyBFY2xpcHNlIFNXVCBNb3ppbGxhL2Nv
bW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nlci9Qcm9tcHRTZXJ2aWNlMi5qYXZhCTIxIEp1bCAy
MDA5IDEzOjI4OjMyIC0wMDAwCkBAIC0xNjEsNiArMTYxLDE4IEBACiAJWFBDT00ubWVtbW92ZSAo
ZGVzdCwgYVRleHQsIGxlbmd0aCAqIDIpOwogCVN0cmluZyB0ZXh0TGFiZWwgPSBuZXcgU3RyaW5n
IChkZXN0KTsKIAorCS8vIFRPRE8gZmluZCBhIGJldHRlciB3YXkgdG8gZGV0ZWN0IHRoYXQgYW4g
aW52YWxpZCBjZXJ0IHdhcyByZWNlaXZlZAorCWlmICh0ZXh0TGFiZWwuaW5kZXhPZiAoInNzbF9l
cnJvcl9iYWRfY2VydF9kb21haW4iKSAhPSAtMSB8fAorCQl0ZXh0TGFiZWwuaW5kZXhPZiAoInNl
Y19lcnJvcl91bmtub3duX2lzc3VlciIpICE9IC0xIHx8CisJCXRleHRMYWJlbC5pbmRleE9mICgi
c2VjX2Vycm9yX2V4cGlyZWRfY2VydGlmaWNhdGUiKSAhPSAtMSkgeyAvLyROT04tTkxTLTEkIC8v
JE5PTi1OTFMtMiQgLy8kTk9OLU5MUy0zJAorCQkJaWYgKGJyb3dzZXIgIT0gbnVsbCkgeworCQkJ
CU1vemlsbGEgbW96aWxsYSA9IChNb3ppbGxhKWJyb3dzZXIud2ViQnJvd3NlcjsKKwkJCQltb3pp
bGxhLmlzUmV0cmlldmluZ0JhZENlcnQgPSB0cnVlOworCQkJCWJyb3dzZXIuc2V0VXJsIChtb3pp
bGxhLmxhc3ROYXZpZ2F0ZVVSTCk7CisJCQkJcmV0dXJuIFhQQ09NLk5TX09LOworCQkJfQorCX0K
KwogCVNoZWxsIHNoZWxsID0gYnJvd3NlciA9PSBudWxsID8gbmV3IFNoZWxsICgpIDogYnJvd3Nl
ci5nZXRTaGVsbCAoKTsgCiAJTWVzc2FnZUJveCBtZXNzYWdlQm94ID0gbmV3IE1lc3NhZ2VCb3gg
KHNoZWxsLCBTV1QuT0sgfCBTV1QuSUNPTl9XQVJOSU5HKTsKIAltZXNzYWdlQm94LnNldFRleHQg
KHRpdGxlTGFiZWwpOwpJbmRleDogRWNsaXBzZSBTV1QvY29tbW9uX2oyc2Uvb3JnL2VjbGlwc2Uv
c3d0L2ludGVybmFsL1NXVE1lc3NhZ2VzLnByb3BlcnRpZXMKPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2N2c3Jvb3QvZWNsaXBzZS9vcmcuZWNsaXBzZS5zd3QvRWNsaXBzZSBTV1QvY29tbW9uX2oyc2Uv
b3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL1NXVE1lc3NhZ2VzLnByb3BlcnRpZXMsdgpyZXRyaWV2
aW5nIHJldmlzaW9uIDEuMzQKZGlmZiAtdSAtcjEuMzQgU1dUTWVzc2FnZXMucHJvcGVydGllcwot
LS0gRWNsaXBzZSBTV1QvY29tbW9uX2oyc2Uvb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL1NXVE1l
c3NhZ2VzLnByb3BlcnRpZXMJMSBKdWwgMjAwOSAxNDo1MDoyMCAtMDAwMAkxLjM0CisrKyBFY2xp
cHNlIFNXVC9jb21tb25fajJzZS9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwvU1dUTWVzc2FnZXMu
cHJvcGVydGllcwkyMSBKdWwgMjAwOSAxMzoyODozMiAtMDAwMApAQCAtNzIsNCArNzIsMTAgQEAK
IFNXVF9Eb3dubG9hZF9TdGF0dXM9RG93bmxvYWQ6IHswLG51bWJlcixpbnRlZ2VyfSBLQiBvZiB7
MSxudW1iZXIsaW50ZWdlcn0gS0IKIFNXVF9BdXRoZW50aWNhdGlvbl9SZXF1aXJlZD1BdXRoZW50
aWNhdGlvbiBSZXF1aXJlZAogU1dUX0VudGVyX1VzZXJuYW1lX2FuZF9QYXNzd29yZD1FbnRlciB1
c2VyIG5hbWUgYW5kIHBhc3N3b3JkIGZvciB7MH0gYXQgezF9Ci1TV1RfUGFnZV9Mb2FkX0ZhaWxl
ZD1QYWdlIGxvYWQgZmFpbGVkIHdpdGggZXJyb3I6IHswfQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9m
IGZpbGUKK1NXVF9QYWdlX0xvYWRfRmFpbGVkPVBhZ2UgbG9hZCBmYWlsZWQgd2l0aCBlcnJvcjog
ezB9CitTV1RfSW52YWxpZENlcnRfVGl0bGU9SW52YWxpZCBDZXJ0aWZpY2F0ZQorU1dUX0ludmFs
aWRDZXJ0X01lc3NhZ2U9VGhlIHNlY3VyaXR5IGNlcnRpZmljYXRlIHByZXNlbnRlZCBieSAiezB9
IiBoYXMgdGhlIGZvbGxvd2luZyBwcm9ibGVtKHMpOgorU1dUX0ludmFsaWRDZXJ0X0ludmFsaWRO
YW1lPUNlcnRpZmljYXRlIG5hbWUgaXMgaW52YWxpZCBvciBkb2VzIG5vdCBtYXRjaCBzaXRlIG5h
bWUuICBDZXJ0aWZpY2F0ZSBpc3N1ZWQgdG86ICJ7MH0iLiAKK1NXVF9JbnZhbGlkQ2VydF9Ob3RW
YWxpZD1DZXJ0aWZpY2F0ZSBpcyBub3QgY3VycmVudGx5IHZhbGlkLiAgVmFsaWQgZGF0ZSByYW5n
ZTogInswfSIuICAKK1NXVF9JbnZhbGlkQ2VydF9Ob3RUcnVzdGVkPUNlcnRpZmljYXRlIGlzIG5v
dCBmcm9tIGEgdHJ1c3RlZCBjZXJ0aWZ5aW5nIGF1dGhvcml0eS4gIENlcnRpZmljYXRlIGlzc3Vl
cjogInswfSIuCitTV1RfSW52YWxpZENlcnRfQ29ubmVjdD1Xb3VsZCB5b3UgbGlrZSB0byBjb25u
ZWN0IHRvIHRoaXMgc2l0ZSBhbnl3YXlzPwpJbmRleDogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21t
b24vbGlicmFyeS94cGNvbV9zdGF0cy5jcHAKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2c3Jvb3Qv
ZWNsaXBzZS9vcmcuZWNsaXBzZS5zd3QvRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vbGlicmFy
eS94cGNvbV9zdGF0cy5jcHAsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNTMKZGlmZiAtdSAtcjEu
NTMgeHBjb21fc3RhdHMuY3BwCi0tLSBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9saWJyYXJ5
L3hwY29tX3N0YXRzLmNwcAkxIEp1bCAyMDA5IDE0OjQ5OjI1IC0wMDAwCTEuNTMKKysrIEVjbGlw
c2UgU1dUIE1vemlsbGEvY29tbW9uL2xpYnJhcnkveHBjb21fc3RhdHMuY3BwCTIxIEp1bCAyMDA5
IDEzOjI4OjMyIC0wMDAwCkBAIC0xNCw4ICsxNCw4IEBACiAKICNpZmRlZiBOQVRJVkVfU1RBVFMK
IAotaW50IFhQQ09NX25hdGl2ZUZ1bmN0aW9uQ291bnQgPSAyMTM7Ci1pbnQgWFBDT01fbmF0aXZl
RnVuY3Rpb25DYWxsQ291bnRbMjEzXTsKK2ludCBYUENPTV9uYXRpdmVGdW5jdGlvbkNvdW50ID0g
MjIzOworaW50IFhQQ09NX25hdGl2ZUZ1bmN0aW9uQ2FsbENvdW50WzIyM107CiBjaGFyICogWFBD
T01fbmF0aXZlRnVuY3Rpb25OYW1lc1tdID0gewogCSJHZXRBZGRyZXNzIiwKICNpZm5kZWYgSk5J
NjQKQEAgLTEzNCw2ICsxMzQsMTEgQEAKIAkiXzFWdGJsQ2FsbF9fSUpJSUlJXzNJXzNJIiwKICNl
bmRpZgogI2lmbmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUlJSUlfM0lfM0lfM0kiLAorI2Vs
c2UKKwkiXzFWdGJsQ2FsbF9fSUpJSUlJXzNJXzNJXzNJIiwKKyNlbmRpZgorI2lmbmRlZiBKTkk2
NAogCSJfMVZ0YmxDYWxsX19JSUlJSV8zQl8zQkkiLAogI2Vsc2UKIAkiXzFWdGJsQ2FsbF9fSUpJ
SUlfM0JfM0JJIiwKQEAgLTE0OSw2ICsxNTQsMTEgQEAKIAkiXzFWdGJsQ2FsbF9fSUpJSUlfM0ki
LAogI2VuZGlmCiAjaWZuZGVmIEpOSTY0CisJIl8xVnRibENhbGxfX0lJSUlJXzNJXzNJXzNJIiwK
KyNlbHNlCisJIl8xVnRibENhbGxfX0lKSUlJXzNJXzNJXzNJIiwKKyNlbmRpZgorI2lmbmRlZiBK
Tkk2NAogCSJfMVZ0YmxDYWxsX19JSUlJSkpKSiIsCiAjZWxzZQogCSJfMVZ0YmxDYWxsX19JSklJ
SkpKSiIsCkBAIC0zMjQsMTEgKzMzNCwzMSBAQAogCSJfMVZ0YmxDYWxsX19JSklfM0kiLAogI2Vu
ZGlmCiAjaWZuZGVmIEpOSTY0CisJIl8xVnRibENhbGxfX0lJSV8zSUkiLAorI2Vsc2UKKwkiXzFW
dGJsQ2FsbF9fSUpJXzNJSSIsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKKwkiXzFWdGJsQ2FsbF9f
SUlJXzNJSiIsCisjZWxzZQorCSJfMVZ0YmxDYWxsX19JSklfM0lKIiwKKyNlbmRpZgorI2lmbmRl
ZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUlfM0lfM0lfM0kiLAorI2Vsc2UKKwkiXzFWdGJsQ2Fs
bF9fSUpJXzNJXzNJXzNJIiwKKyNlbmRpZgorI2lmbmRlZiBKTkk2NAogCSJfMVZ0YmxDYWxsX19J
SUlfM0lfM0lfM0lfM0kiLAogI2Vsc2UKIAkiXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNJXzNJIiwK
ICNlbmRpZgogI2lmbmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUlfM0lfM0lfM0oiLAorI2Vs
c2UKKwkiXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNKIiwKKyNlbmRpZgorI2lmbmRlZiBKTkk2NAog
CSJfMVZ0YmxDYWxsX19JSUoiLAogI2Vsc2UKIAkiXzFWdGJsQ2FsbF9fSUpKIiwKQEAgLTM1NCw2
ICszODQsMjYgQEAKIAkiXzFWdGJsQ2FsbF9fSUpKSUlKXzNJXzNKIiwKICNlbmRpZgogI2lmbmRl
ZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUpJSV8zSSIsCisjZWxzZQorCSJfMVZ0YmxDYWxsX19J
SkpJSV8zSSIsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKKwkiXzFWdGJsQ2FsbF9fSUlKSUpJSSIs
CisjZWxzZQorCSJfMVZ0YmxDYWxsX19JSkpJSklJIiwKKyNlbmRpZgorI2lmbmRlZiBKTkk2NAor
CSJfMVZ0YmxDYWxsX19JSUpJSkpfM0lfM0lfM0kiLAorI2Vsc2UKKwkiXzFWdGJsQ2FsbF9fSUpK
SUpKXzNJXzNJXzNJIiwKKyNlbmRpZgorI2lmbmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUpJ
Sl8zSV8zSV8zSSIsCisjZWxzZQorCSJfMVZ0YmxDYWxsX19JSkpJSl8zSV8zSV8zSSIsCisjZW5k
aWYKKyNpZm5kZWYgSk5JNjQKIAkiXzFWdGJsQ2FsbF9fSUlKSV8zSiIsCiAjZWxzZQogCSJfMVZ0
YmxDYWxsX19JSkpJXzNKIiwKSW5kZXg6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL2xpYnJh
cnkveHBjb20uY3BwCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVj
bGlwc2Uuc3d0L0VjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL2xpYnJhcnkveHBjb20uY3BwLHYK
cmV0cmlldmluZyByZXZpc2lvbiAxLjcxCmRpZmYgLXUgLXIxLjcxIHhwY29tLmNwcAotLS0gRWNs
aXBzZSBTV1QgTW96aWxsYS9jb21tb24vbGlicmFyeS94cGNvbS5jcHAJMSBKdWwgMjAwOSAxNDo0
OToyNSAtMDAwMAkxLjcxCisrKyBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9saWJyYXJ5L3hw
Y29tLmNwcAkyMSBKdWwgMjAwOSAxMzoyODozMiAtMDAwMApAQCAtNjk0LDYgKzY5NCw0MSBAQAog
fQogI2VuZGlmCiAKKyNpZiAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9fSUlJSUlJXzNJXzNJXzNJ
KSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8ICghZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSklJSUlf
M0lfM0lfM0kpICYmIGRlZmluZWQoSk5JNjQpKQorI2lmbmRlZiBKTkk2NAorZXh0ZXJuICJDIiBK
TklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUlJSUlfM0lf
M0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcx
LCBqaW50IGFyZzIsIGppbnQgYXJnMywgamludCBhcmc0LCBqaW50IGFyZzUsIGppbnRBcnJheSBh
cmc2LCBqaW50QXJyYXkgYXJnNywgamludEFycmF5IGFyZzgpOworSk5JRVhQT1JUIGppbnQgSk5J
Q0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlJSUlJXzNJXzNJXzNJKShKTklFbnYgKmVu
diwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50
IGFyZzMsIGppbnQgYXJnNCwgamludCBhcmc1LCBqaW50QXJyYXkgYXJnNiwgamludEFycmF5IGFy
ZzcsIGppbnRBcnJheSBhcmc4KQorI2Vsc2UKK2V4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5J
Q0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpJSUlJXzNJXzNJXzNJKShKTklFbnYgKmVu
diwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50
IGFyZzMsIGppbnQgYXJnNCwgamludCBhcmc1LCBqaW50QXJyYXkgYXJnNiwgamludEFycmF5IGFy
ZzcsIGppbnRBcnJheSBhcmc4KTsKK0pOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZF
KF8xVnRibENhbGxfX0lKSUlJSV8zSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBq
aW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludCBhcmczLCBqaW50IGFyZzQs
IGppbnQgYXJnNSwgamludEFycmF5IGFyZzYsIGppbnRBcnJheSBhcmc3LCBqaW50QXJyYXkgYXJn
OCkKKyNlbmRpZgoreworCWppbnQgKmxwYXJnNj1OVUxMOworCWppbnQgKmxwYXJnNz1OVUxMOwor
CWppbnQgKmxwYXJnOD1OVUxMOworCWppbnQgcmMgPSAwOworI2lmbmRlZiBKTkk2NAorCVhQQ09N
X05BVElWRV9FTlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSUlJSV8zSV8zSV8zSV9GVU5D
KTsKKyNlbHNlCisJWFBDT01fTkFUSVZFX0VOVEVSKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpJ
SUlJXzNJXzNJXzNJX0ZVTkMpOworI2VuZGlmCisJaWYgKGFyZzYpIGlmICgobHBhcmc2ID0gZW52
LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzYsIE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJ
aWYgKGFyZzcpIGlmICgobHBhcmc3ID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzcsIE5V
TEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJaWYgKGFyZzgpIGlmICgobHBhcmc4ID0gZW52LT5H
ZXRJbnRBcnJheUVsZW1lbnRzKGFyZzgsIE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJcmMg
PSAoamludCkoKGppbnQgKFNURE1FVEhPRENBTExUWVBFICopKGppbnRMb25nLCBqaW50LCBqaW50
LCBqaW50LCBqaW50LCBqaW50ICosIGppbnQgKiwgamludCAqKSkoKihqaW50TG9uZyAqKilhcmcx
KVthcmcwXSkoYXJnMSwgYXJnMiwgYXJnMywgYXJnNCwgYXJnNSwgbHBhcmc2LCBscGFyZzcsIGxw
YXJnOCk7CitmYWlsOgorCWlmIChhcmc4ICYmIGxwYXJnOCkgZW52LT5SZWxlYXNlSW50QXJyYXlF
bGVtZW50cyhhcmc4LCBscGFyZzgsIDApOworCWlmIChhcmc3ICYmIGxwYXJnNykgZW52LT5SZWxl
YXNlSW50QXJyYXlFbGVtZW50cyhhcmc3LCBscGFyZzcsIDApOworCWlmIChhcmc2ICYmIGxwYXJn
NikgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmc2LCBscGFyZzYsIDApOworI2lmbmRl
ZiBKTkk2NAorCVhQQ09NX05BVElWRV9FWElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlJSUlJ
XzNJXzNJXzNJX0ZVTkMpOworI2Vsc2UKKwlYUENPTV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIF8x
VnRibENhbGxfX0lKSUlJSV8zSV8zSV8zSV9GVU5DKTsKKyNlbmRpZgorCXJldHVybiByYzsKK30K
KyNlbmRpZgorCiAjaWYgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lJSUlJXzNCXzNCSSkgJiYg
IWRlZmluZWQoSk5JNjQpKSB8fCAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9fSUpJSUlfM0JfM0JJ
KSAmJiBkZWZpbmVkKEpOSTY0KSkKICNpZm5kZWYgSk5JNjQKIGV4dGVybiAiQyIgSk5JRVhQT1JU
IGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlJSUlfM0JfM0JJKShKTklF
bnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcy
LCBqaW50IGFyZzMsIGppbnQgYXJnNCwgamJ5dGVBcnJheSBhcmc1LCBqYnl0ZUFycmF5IGFyZzYs
IGppbnQgYXJnNyk7CkBAIC03ODQsNiArODE5LDQxIEBACiB9CiAjZW5kaWYKIAorI2lmICghZGVm
aW5lZChOT19fMVZ0YmxDYWxsX19JSUlJSV8zSV8zSV8zSSkgJiYgIWRlZmluZWQoSk5JNjQpKSB8
fCAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9fSUpJSUlfM0lfM0lfM0kpICYmIGRlZmluZWQoSk5J
NjQpKQorI2lmbmRlZiBKTkk2NAorZXh0ZXJuICJDIiBKTklFWFBPUlQgamludCBKTklDQUxMIFhQ
Q09NX05BVElWRShfMVZ0YmxDYWxsX19JSUlJSV8zSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFz
cyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludCBhcmczLCBq
aW50IGFyZzQsIGppbnRBcnJheSBhcmc1LCBqaW50QXJyYXkgYXJnNiwgamludEFycmF5IGFyZzcp
OworSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlJSUlf
M0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBh
cmcxLCBqaW50IGFyZzIsIGppbnQgYXJnMywgamludCBhcmc0LCBqaW50QXJyYXkgYXJnNSwgamlu
dEFycmF5IGFyZzYsIGppbnRBcnJheSBhcmc3KQorI2Vsc2UKK2V4dGVybiAiQyIgSk5JRVhQT1JU
IGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpJSUlfM0lfM0lfM0kpKEpO
SUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqaW50IGFy
ZzIsIGppbnQgYXJnMywgamludCBhcmc0LCBqaW50QXJyYXkgYXJnNSwgamludEFycmF5IGFyZzYs
IGppbnRBcnJheSBhcmc3KTsKK0pOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8x
VnRibENhbGxfX0lKSUlJXzNJXzNJXzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQg
YXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50IGFyZzMsIGppbnQgYXJnNCwgamlu
dEFycmF5IGFyZzUsIGppbnRBcnJheSBhcmc2LCBqaW50QXJyYXkgYXJnNykKKyNlbmRpZgorewor
CWppbnQgKmxwYXJnNT1OVUxMOworCWppbnQgKmxwYXJnNj1OVUxMOworCWppbnQgKmxwYXJnNz1O
VUxMOworCWppbnQgcmMgPSAwOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9FTlRFUihl
bnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSUlJXzNJXzNJXzNJX0ZVTkMpOworI2Vsc2UKKwlYUENP
TV9OQVRJVkVfRU5URVIoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSklJSV8zSV8zSV8zSV9GVU5D
KTsKKyNlbmRpZgorCWlmIChhcmc1KSBpZiAoKGxwYXJnNSA9IGVudi0+R2V0SW50QXJyYXlFbGVt
ZW50cyhhcmc1LCBOVUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOworCWlmIChhcmc2KSBpZiAoKGxw
YXJnNiA9IGVudi0+R2V0SW50QXJyYXlFbGVtZW50cyhhcmc2LCBOVUxMKSkgPT0gTlVMTCkgZ290
byBmYWlsOworCWlmIChhcmc3KSBpZiAoKGxwYXJnNyA9IGVudi0+R2V0SW50QXJyYXlFbGVtZW50
cyhhcmc3LCBOVUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOworCXJjID0gKGppbnQpKChqaW50IChT
VERNRVRIT0RDQUxMVFlQRSAqKShqaW50TG9uZywgamludCwgamludCwgamludCwgamludCAqLCBq
aW50ICosIGppbnQgKikpKCooamludExvbmcgKiopYXJnMSlbYXJnMF0pKGFyZzEsIGFyZzIsIGFy
ZzMsIGFyZzQsIGxwYXJnNSwgbHBhcmc2LCBscGFyZzcpOworZmFpbDoKKwlpZiAoYXJnNyAmJiBs
cGFyZzcpIGVudi0+UmVsZWFzZUludEFycmF5RWxlbWVudHMoYXJnNywgbHBhcmc3LCAwKTsKKwlp
ZiAoYXJnNiAmJiBscGFyZzYpIGVudi0+UmVsZWFzZUludEFycmF5RWxlbWVudHMoYXJnNiwgbHBh
cmc2LCAwKTsKKwlpZiAoYXJnNSAmJiBscGFyZzUpIGVudi0+UmVsZWFzZUludEFycmF5RWxlbWVu
dHMoYXJnNSwgbHBhcmc1LCAwKTsKKyNpZm5kZWYgSk5JNjQKKwlYUENPTV9OQVRJVkVfRVhJVChl
bnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSUlJXzNJXzNJXzNJX0ZVTkMpOworI2Vsc2UKKwlYUENP
TV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSUlJXzNJXzNJXzNJX0ZVTkMp
OworI2VuZGlmCisJcmV0dXJuIHJjOworfQorI2VuZGlmCisKICNpZiAoIWRlZmluZWQoTk9fXzFW
dGJsQ2FsbF9fSUlJSUpKSkopICYmICFkZWZpbmVkKEpOSTY0KSkgfHwgKCFkZWZpbmVkKE5PX18x
VnRibENhbGxfX0lKSUlKSkpKKSAmJiBkZWZpbmVkKEpOSTY0KSkKICNpZm5kZWYgSk5JNjQKIGV4
dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9f
SUlJSUpKSkopKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBh
cmcxLCBqaW50IGFyZzIsIGppbnQgYXJnMywgamxvbmcgYXJnNCwgamxvbmcgYXJnNSwgamxvbmcg
YXJnNiwgamxvbmcgYXJnNyk7CkBAIC0xOTIzLDYgKzE5OTMsOTkgQEAKIH0KICNlbmRpZgogCisj
aWYgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lJSV8zSUkpICYmICFkZWZpbmVkKEpOSTY0KSkg
fHwgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lKSV8zSUkpICYmIGRlZmluZWQoSk5JNjQpKQor
I2lmbmRlZiBKTkk2NAorZXh0ZXJuICJDIiBKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05B
VElWRShfMVZ0YmxDYWxsX19JSUlfM0lJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQg
YXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50QXJyYXkgYXJnMywgamludCBhcmc0
KTsKK0pOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJSV8z
SUkpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBq
aW50IGFyZzIsIGppbnRBcnJheSBhcmczLCBqaW50IGFyZzQpCisjZWxzZQorZXh0ZXJuICJDIiBK
TklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSklfM0lJKShK
TklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBh
cmcyLCBqaW50QXJyYXkgYXJnMywgamludCBhcmc0KTsKK0pOSUVYUE9SVCBqaW50IEpOSUNBTEwg
WFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lKSV8zSUkpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhh
dCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqaW50IGFyZzIsIGppbnRBcnJheSBhcmczLCBq
aW50IGFyZzQpCisjZW5kaWYKK3sKKwlqaW50ICpscGFyZzM9TlVMTDsKKwlqaW50IHJjID0gMDsK
KyNpZm5kZWYgSk5JNjQKKwlYUENPTV9OQVRJVkVfRU5URVIoZW52LCB0aGF0LCBfMVZ0YmxDYWxs
X19JSUlfM0lJX0ZVTkMpOworI2Vsc2UKKwlYUENPTV9OQVRJVkVfRU5URVIoZW52LCB0aGF0LCBf
MVZ0YmxDYWxsX19JSklfM0lJX0ZVTkMpOworI2VuZGlmCisJaWYgKGFyZzMpIGlmICgobHBhcmcz
ID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzMsIE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZh
aWw7CisJcmMgPSAoamludCkoKGppbnQgKFNURE1FVEhPRENBTExUWVBFICopKGppbnRMb25nLCBq
aW50LCBqaW50ICosIGppbnQpKSgqKGppbnRMb25nICoqKWFyZzEpW2FyZzBdKShhcmcxLCBhcmcy
LCBscGFyZzMsIGFyZzQpOworZmFpbDoKKwlpZiAoYXJnMyAmJiBscGFyZzMpIGVudi0+UmVsZWFz
ZUludEFycmF5RWxlbWVudHMoYXJnMywgbHBhcmczLCAwKTsKKyNpZm5kZWYgSk5JNjQKKwlYUENP
TV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSV8zSUlfRlVOQyk7CisjZWxz
ZQorCVhQQ09NX05BVElWRV9FWElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpJXzNJSV9GVU5D
KTsKKyNlbmRpZgorCXJldHVybiByYzsKK30KKyNlbmRpZgorCisjaWYgKCFkZWZpbmVkKE5PX18x
VnRibENhbGxfX0lJSV8zSUopICYmICFkZWZpbmVkKEpOSTY0KSkgfHwgKCFkZWZpbmVkKE5PX18x
VnRibENhbGxfX0lKSV8zSUopICYmIGRlZmluZWQoSk5JNjQpKQorI2lmbmRlZiBKTkk2NAorZXh0
ZXJuICJDIiBKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19J
SUlfM0lKKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJn
MSwgamludCBhcmcyLCBqaW50QXJyYXkgYXJnMywgamxvbmcgYXJnNCk7CitKTklFWFBPUlQgamlu
dCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUlfM0lKKShKTklFbnYgKmVudiwg
amNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50QXJy
YXkgYXJnMywgamxvbmcgYXJnNCkKKyNlbHNlCitleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpO
SUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lKSV8zSUopKEpOSUVudiAqZW52LCBqY2xh
c3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqaW50IGFyZzIsIGppbnRBcnJheSBh
cmczLCBqbG9uZyBhcmc0KTsKK0pOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8x
VnRibENhbGxfX0lKSV8zSUopKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBq
aW50TG9uZyBhcmcxLCBqaW50IGFyZzIsIGppbnRBcnJheSBhcmczLCBqbG9uZyBhcmc0KQorI2Vu
ZGlmCit7CisJamludCAqbHBhcmczPU5VTEw7CisJamludCByYyA9IDA7CisjaWZuZGVmIEpOSTY0
CisJWFBDT01fTkFUSVZFX0VOVEVSKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlJXzNJSl9GVU5D
KTsKKyNlbHNlCisJWFBDT01fTkFUSVZFX0VOVEVSKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpJ
XzNJSl9GVU5DKTsKKyNlbmRpZgorCWlmIChhcmczKSBpZiAoKGxwYXJnMyA9IGVudi0+R2V0SW50
QXJyYXlFbGVtZW50cyhhcmczLCBOVUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOworCXJjID0gKGpp
bnQpKChqaW50IChTVERNRVRIT0RDQUxMVFlQRSAqKShqaW50TG9uZywgamludCwgamludCAqLCBq
bG9uZykpKCooamludExvbmcgKiopYXJnMSlbYXJnMF0pKGFyZzEsIGFyZzIsIGxwYXJnMywgYXJn
NCk7CitmYWlsOgorCWlmIChhcmczICYmIGxwYXJnMykgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVt
ZW50cyhhcmczLCBscGFyZzMsIDApOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9FWElU
KGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlJXzNJSl9GVU5DKTsKKyNlbHNlCisJWFBDT01fTkFU
SVZFX0VYSVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSklfM0lKX0ZVTkMpOworI2VuZGlmCisJ
cmV0dXJuIHJjOworfQorI2VuZGlmCisKKyNpZiAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9fSUlJ
XzNJXzNJXzNJKSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8ICghZGVmaW5lZChOT19fMVZ0YmxDYWxs
X19JSklfM0lfM0lfM0kpICYmIGRlZmluZWQoSk5JNjQpKQorI2lmbmRlZiBKTkk2NAorZXh0ZXJu
ICJDIiBKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUlf
M0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBh
cmcxLCBqaW50IGFyZzIsIGppbnRBcnJheSBhcmczLCBqaW50QXJyYXkgYXJnNCwgamludEFycmF5
IGFyZzUpOworSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9f
SUlJXzNJXzNJXzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExv
bmcgYXJnMSwgamludCBhcmcyLCBqaW50QXJyYXkgYXJnMywgamludEFycmF5IGFyZzQsIGppbnRB
cnJheSBhcmc1KQorI2Vsc2UKK2V4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENP
TV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRo
YXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50QXJyYXkgYXJnMywg
amludEFycmF5IGFyZzQsIGppbnRBcnJheSBhcmc1KTsKK0pOSUVYUE9SVCBqaW50IEpOSUNBTEwg
WFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lKSV8zSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFz
cyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludEFycmF5IGFy
ZzMsIGppbnRBcnJheSBhcmc0LCBqaW50QXJyYXkgYXJnNSkKKyNlbmRpZgoreworCWppbnQgKmxw
YXJnMz1OVUxMOworCWppbnQgKmxwYXJnND1OVUxMOworCWppbnQgKmxwYXJnNT1OVUxMOworCWpp
bnQgcmMgPSAwOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9FTlRFUihlbnYsIHRoYXQs
IF8xVnRibENhbGxfX0lJSV8zSV8zSV8zSV9GVU5DKTsKKyNlbHNlCisJWFBDT01fTkFUSVZFX0VO
VEVSKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNJX0ZVTkMpOworI2VuZGlmCisJ
aWYgKGFyZzMpIGlmICgobHBhcmczID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzMsIE5V
TEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJaWYgKGFyZzQpIGlmICgobHBhcmc0ID0gZW52LT5H
ZXRJbnRBcnJheUVsZW1lbnRzKGFyZzQsIE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJaWYg
KGFyZzUpIGlmICgobHBhcmc1ID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzUsIE5VTEwp
KSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJcmMgPSAoamludCkoKGppbnQgKFNURE1FVEhPRENBTExU
WVBFICopKGppbnRMb25nLCBqaW50LCBqaW50ICosIGppbnQgKiwgamludCAqKSkoKihqaW50TG9u
ZyAqKilhcmcxKVthcmcwXSkoYXJnMSwgYXJnMiwgbHBhcmczLCBscGFyZzQsIGxwYXJnNSk7Citm
YWlsOgorCWlmIChhcmc1ICYmIGxwYXJnNSkgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhh
cmc1LCBscGFyZzUsIDApOworCWlmIChhcmc0ICYmIGxwYXJnNCkgZW52LT5SZWxlYXNlSW50QXJy
YXlFbGVtZW50cyhhcmc0LCBscGFyZzQsIDApOworCWlmIChhcmczICYmIGxwYXJnMykgZW52LT5S
ZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmczLCBscGFyZzMsIDApOworI2lmbmRlZiBKTkk2NAor
CVhQQ09NX05BVElWRV9FWElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlJXzNJXzNJXzNJX0ZV
TkMpOworI2Vsc2UKKwlYUENPTV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lK
SV8zSV8zSV8zSV9GVU5DKTsKKyNlbmRpZgorCXJldHVybiByYzsKK30KKyNlbmRpZgorCiAjaWYg
KCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lJSV8zSV8zSV8zSV8zSSkgJiYgIWRlZmluZWQoSk5J
NjQpKSB8fCAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNJXzNJKSAmJiBkZWZp
bmVkKEpOSTY0KSkKICNpZm5kZWYgSk5JNjQKIGV4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5J
Q0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlJXzNJXzNJXzNJXzNJKShKTklFbnYgKmVu
diwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50
QXJyYXkgYXJnMywgamludEFycmF5IGFyZzQsIGppbnRBcnJheSBhcmc1LCBqaW50QXJyYXkgYXJn
Nik7CkBAIC0xOTYxLDYgKzIxMjQsNDEgQEAKIH0KICNlbmRpZgogCisjaWYgKCFkZWZpbmVkKE5P
X18xVnRibENhbGxfX0lJSV8zSV8zSV8zSikgJiYgIWRlZmluZWQoSk5JNjQpKSB8fCAoIWRlZmlu
ZWQoTk9fXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNKKSAmJiBkZWZpbmVkKEpOSTY0KSkKKyNpZm5k
ZWYgSk5JNjQKK2V4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUo
XzFWdGJsQ2FsbF9fSUlJXzNJXzNJXzNKKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQg
YXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50QXJyYXkgYXJnMywgamludEFycmF5
IGFyZzQsIGpsb25nQXJyYXkgYXJnNSk7CitKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05B
VElWRShfMVZ0YmxDYWxsX19JSUlfM0lfM0lfM0opKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwg
amludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqaW50IGFyZzIsIGppbnRBcnJheSBhcmczLCBqaW50
QXJyYXkgYXJnNCwgamxvbmdBcnJheSBhcmc1KQorI2Vsc2UKK2V4dGVybiAiQyIgSk5JRVhQT1JU
IGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNKKShKTklF
bnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcy
LCBqaW50QXJyYXkgYXJnMywgamludEFycmF5IGFyZzQsIGpsb25nQXJyYXkgYXJnNSk7CitKTklF
WFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSklfM0lfM0lfM0op
KEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqaW50
IGFyZzIsIGppbnRBcnJheSBhcmczLCBqaW50QXJyYXkgYXJnNCwgamxvbmdBcnJheSBhcmc1KQor
I2VuZGlmCit7CisJamludCAqbHBhcmczPU5VTEw7CisJamludCAqbHBhcmc0PU5VTEw7CisJamxv
bmcgKmxwYXJnNT1OVUxMOworCWppbnQgcmMgPSAwOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05B
VElWRV9FTlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSV8zSV8zSV8zSl9GVU5DKTsKKyNl
bHNlCisJWFBDT01fTkFUSVZFX0VOVEVSKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpJXzNJXzNJ
XzNKX0ZVTkMpOworI2VuZGlmCisJaWYgKGFyZzMpIGlmICgobHBhcmczID0gZW52LT5HZXRJbnRB
cnJheUVsZW1lbnRzKGFyZzMsIE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJaWYgKGFyZzQp
IGlmICgobHBhcmc0ID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzQsIE5VTEwpKSA9PSBO
VUxMKSBnb3RvIGZhaWw7CisJaWYgKGFyZzUpIGlmICgobHBhcmc1ID0gZW52LT5HZXRMb25nQXJy
YXlFbGVtZW50cyhhcmc1LCBOVUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOworCXJjID0gKGppbnQp
KChqaW50IChTVERNRVRIT0RDQUxMVFlQRSAqKShqaW50TG9uZywgamludCwgamludCAqLCBqaW50
ICosIGpsb25nICopKSgqKGppbnRMb25nICoqKWFyZzEpW2FyZzBdKShhcmcxLCBhcmcyLCBscGFy
ZzMsIGxwYXJnNCwgbHBhcmc1KTsKK2ZhaWw6CisJaWYgKGFyZzUgJiYgbHBhcmc1KSBlbnYtPlJl
bGVhc2VMb25nQXJyYXlFbGVtZW50cyhhcmc1LCBscGFyZzUsIDApOworCWlmIChhcmc0ICYmIGxw
YXJnNCkgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmc0LCBscGFyZzQsIDApOworCWlm
IChhcmczICYmIGxwYXJnMykgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmczLCBscGFy
ZzMsIDApOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9FWElUKGVudiwgdGhhdCwgXzFW
dGJsQ2FsbF9fSUlJXzNJXzNJXzNKX0ZVTkMpOworI2Vsc2UKKwlYUENPTV9OQVRJVkVfRVhJVChl
bnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSV8zSV8zSV8zSl9GVU5DKTsKKyNlbmRpZgorCXJldHVy
biByYzsKK30KKyNlbmRpZgorCiAjaWYgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lJSikgJiYg
IWRlZmluZWQoSk5JNjQpKSB8fCAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9fSUpKKSAmJiBkZWZp
bmVkKEpOSTY0KSkKICNpZm5kZWYgSk5JNjQKIGV4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5J
Q0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlKKShKTklFbnYgKmVudiwgamNsYXNzIHRo
YXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamxvbmcgYXJnMik7CkBAIC0yMDkzLDYgKzIy
OTEsMTMwIEBACiB9CiAjZW5kaWYKIAorI2lmICghZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSUpJ
SV8zSSkgJiYgIWRlZmluZWQoSk5JNjQpKSB8fCAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9fSUpK
SUlfM0kpICYmIGRlZmluZWQoSk5JNjQpKQorI2lmbmRlZiBKTkk2NAorZXh0ZXJuICJDIiBKTklF
WFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUpJSV8zSSkoSk5J
RW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25nIGFy
ZzIsIGppbnQgYXJnMywgamludCBhcmc0LCBqaW50QXJyYXkgYXJnNSk7CitKTklFWFBPUlQgamlu
dCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUpJSV8zSSkoSk5JRW52ICplbnYs
IGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25nIGFyZzIsIGppbnQg
YXJnMywgamludCBhcmc0LCBqaW50QXJyYXkgYXJnNSkKKyNlbHNlCitleHRlcm4gIkMiIEpOSUVY
UE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lKSklJXzNJKShKTklF
bnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamxvbmcgYXJn
MiwgamludCBhcmczLCBqaW50IGFyZzQsIGppbnRBcnJheSBhcmc1KTsKK0pOSUVYUE9SVCBqaW50
IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lKSklJXzNJKShKTklFbnYgKmVudiwg
amNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamxvbmcgYXJnMiwgamludCBh
cmczLCBqaW50IGFyZzQsIGppbnRBcnJheSBhcmc1KQorI2VuZGlmCit7CisJamludCAqbHBhcmc1
PU5VTEw7CisJamludCByYyA9IDA7CisjaWZuZGVmIEpOSTY0CisJWFBDT01fTkFUSVZFX0VOVEVS
KGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlKSUlfM0lfRlVOQyk7CisjZWxzZQorCVhQQ09NX05B
VElWRV9FTlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSklJXzNJX0ZVTkMpOworI2VuZGlm
CisJaWYgKGFyZzUpIGlmICgobHBhcmc1ID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzUs
IE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJcmMgPSAoamludCkoKGppbnQgKFNURE1FVEhP
RENBTExUWVBFICopKGppbnRMb25nLCBqbG9uZywgamludCwgamludCwgamludCAqKSkoKihqaW50
TG9uZyAqKilhcmcxKVthcmcwXSkoYXJnMSwgYXJnMiwgYXJnMywgYXJnNCwgbHBhcmc1KTsKK2Zh
aWw6CisJaWYgKGFyZzUgJiYgbHBhcmc1KSBlbnYtPlJlbGVhc2VJbnRBcnJheUVsZW1lbnRzKGFy
ZzUsIGxwYXJnNSwgMCk7CisjaWZuZGVmIEpOSTY0CisJWFBDT01fTkFUSVZFX0VYSVQoZW52LCB0
aGF0LCBfMVZ0YmxDYWxsX19JSUpJSV8zSV9GVU5DKTsKKyNlbHNlCisJWFBDT01fTkFUSVZFX0VY
SVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSkpJSV8zSV9GVU5DKTsKKyNlbmRpZgorCXJldHVy
biByYzsKK30KKyNlbmRpZgorCisjaWYgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lJSklKSUkp
ICYmICFkZWZpbmVkKEpOSTY0KSkgfHwgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lKSklKSUkp
ICYmIGRlZmluZWQoSk5JNjQpKQorI2lmbmRlZiBKTkk2NAorZXh0ZXJuICJDIiBKTklFWFBPUlQg
amludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUpJSklJKShKTklFbnYgKmVu
diwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamxvbmcgYXJnMiwgamlu
dCBhcmczLCBqbG9uZyBhcmc0LCBqaW50IGFyZzUsIGppbnQgYXJnNik7CitKTklFWFBPUlQgamlu
dCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUpJSklJKShKTklFbnYgKmVudiwg
amNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamxvbmcgYXJnMiwgamludCBh
cmczLCBqbG9uZyBhcmc0LCBqaW50IGFyZzUsIGppbnQgYXJnNikKKyNlbHNlCitleHRlcm4gIkMi
IEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lKSklKSUkp
KEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9u
ZyBhcmcyLCBqaW50IGFyZzMsIGpsb25nIGFyZzQsIGppbnQgYXJnNSwgamludCBhcmc2KTsKK0pO
SUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lKSklKSUkpKEpO
SUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBh
cmcyLCBqaW50IGFyZzMsIGpsb25nIGFyZzQsIGppbnQgYXJnNSwgamludCBhcmc2KQorI2VuZGlm
Cit7CisJamludCByYyA9IDA7CisjaWZuZGVmIEpOSTY0CisJWFBDT01fTkFUSVZFX0VOVEVSKGVu
diwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlKSUpJSV9GVU5DKTsKKyNlbHNlCisJWFBDT01fTkFUSVZF
X0VOVEVSKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpKSUpJSV9GVU5DKTsKKyNlbmRpZgorCXJj
ID0gKGppbnQpKChqaW50IChTVERNRVRIT0RDQUxMVFlQRSAqKShqaW50TG9uZywgamxvbmcsIGpp
bnQsIGpsb25nLCBqaW50LCBqaW50KSkoKihqaW50TG9uZyAqKilhcmcxKVthcmcwXSkoYXJnMSwg
YXJnMiwgYXJnMywgYXJnNCwgYXJnNSwgYXJnNik7CisjaWZuZGVmIEpOSTY0CisJWFBDT01fTkFU
SVZFX0VYSVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSUpJSklJX0ZVTkMpOworI2Vsc2UKKwlY
UENPTV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSklKSUlfRlVOQyk7Cisj
ZW5kaWYKKwlyZXR1cm4gcmM7Cit9CisjZW5kaWYKKworI2lmICghZGVmaW5lZChOT19fMVZ0YmxD
YWxsX19JSUpJSkpfM0lfM0lfM0kpICYmICFkZWZpbmVkKEpOSTY0KSkgfHwgKCFkZWZpbmVkKE5P
X18xVnRibENhbGxfX0lKSklKSl8zSV8zSV8zSSkgJiYgZGVmaW5lZChKTkk2NCkpCisjaWZuZGVm
IEpOSTY0CitleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8x
VnRibENhbGxfX0lJSklKSl8zSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50
IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25nIGFyZzIsIGppbnQgYXJnMywgamxvbmcgYXJnNCwg
amxvbmcgYXJnNSwgamludEFycmF5IGFyZzYsIGppbnRBcnJheSBhcmc3LCBqaW50QXJyYXkgYXJn
OCk7CitKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUpJ
SkpfM0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9u
ZyBhcmcxLCBqbG9uZyBhcmcyLCBqaW50IGFyZzMsIGpsb25nIGFyZzQsIGpsb25nIGFyZzUsIGpp
bnRBcnJheSBhcmc2LCBqaW50QXJyYXkgYXJnNywgamludEFycmF5IGFyZzgpCisjZWxzZQorZXh0
ZXJuICJDIiBKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19J
SkpJSkpfM0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50
TG9uZyBhcmcxLCBqbG9uZyBhcmcyLCBqaW50IGFyZzMsIGpsb25nIGFyZzQsIGpsb25nIGFyZzUs
IGppbnRBcnJheSBhcmc2LCBqaW50QXJyYXkgYXJnNywgamludEFycmF5IGFyZzgpOworSk5JRVhQ
T1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpKSUpKXzNJXzNJXzNJ
KShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamxv
bmcgYXJnMiwgamludCBhcmczLCBqbG9uZyBhcmc0LCBqbG9uZyBhcmc1LCBqaW50QXJyYXkgYXJn
NiwgamludEFycmF5IGFyZzcsIGppbnRBcnJheSBhcmc4KQorI2VuZGlmCit7CisJamludCAqbHBh
cmc2PU5VTEw7CisJamludCAqbHBhcmc3PU5VTEw7CisJamludCAqbHBhcmc4PU5VTEw7CisJamlu
dCByYyA9IDA7CisjaWZuZGVmIEpOSTY0CisJWFBDT01fTkFUSVZFX0VOVEVSKGVudiwgdGhhdCwg
XzFWdGJsQ2FsbF9fSUlKSUpKXzNJXzNJXzNJX0ZVTkMpOworI2Vsc2UKKwlYUENPTV9OQVRJVkVf
RU5URVIoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSkpJSkpfM0lfM0lfM0lfRlVOQyk7CisjZW5k
aWYKKwlpZiAoYXJnNikgaWYgKChscGFyZzYgPSBlbnYtPkdldEludEFycmF5RWxlbWVudHMoYXJn
NiwgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsKKwlpZiAoYXJnNykgaWYgKChscGFyZzcgPSBl
bnYtPkdldEludEFycmF5RWxlbWVudHMoYXJnNywgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsK
KwlpZiAoYXJnOCkgaWYgKChscGFyZzggPSBlbnYtPkdldEludEFycmF5RWxlbWVudHMoYXJnOCwg
TlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsKKwlyYyA9IChqaW50KSgoamludCAoU1RETUVUSE9E
Q0FMTFRZUEUgKikoamludExvbmcsIGpsb25nLCBqaW50LCBqbG9uZywgamxvbmcsIGppbnQgKiwg
amludCAqLCBqaW50ICopKSgqKGppbnRMb25nICoqKWFyZzEpW2FyZzBdKShhcmcxLCBhcmcyLCBh
cmczLCBhcmc0LCBhcmc1LCBscGFyZzYsIGxwYXJnNywgbHBhcmc4KTsKK2ZhaWw6CisJaWYgKGFy
ZzggJiYgbHBhcmc4KSBlbnYtPlJlbGVhc2VJbnRBcnJheUVsZW1lbnRzKGFyZzgsIGxwYXJnOCwg
MCk7CisJaWYgKGFyZzcgJiYgbHBhcmc3KSBlbnYtPlJlbGVhc2VJbnRBcnJheUVsZW1lbnRzKGFy
ZzcsIGxwYXJnNywgMCk7CisJaWYgKGFyZzYgJiYgbHBhcmc2KSBlbnYtPlJlbGVhc2VJbnRBcnJh
eUVsZW1lbnRzKGFyZzYsIGxwYXJnNiwgMCk7CisjaWZuZGVmIEpOSTY0CisJWFBDT01fTkFUSVZF
X0VYSVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSUpJSkpfM0lfM0lfM0lfRlVOQyk7CisjZWxz
ZQorCVhQQ09NX05BVElWRV9FWElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpKSUpKXzNJXzNJ
XzNJX0ZVTkMpOworI2VuZGlmCisJcmV0dXJuIHJjOworfQorI2VuZGlmCisKKyNpZiAoIWRlZmlu
ZWQoTk9fXzFWdGJsQ2FsbF9fSUlKSUpfM0lfM0lfM0kpICYmICFkZWZpbmVkKEpOSTY0KSkgfHwg
KCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lKSklKXzNJXzNJXzNJKSAmJiBkZWZpbmVkKEpOSTY0
KSkKKyNpZm5kZWYgSk5JNjQKK2V4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENP
TV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlKSUpfM0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3Mg
dGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBhcmcyLCBqaW50IGFyZzMsIGps
b25nIGFyZzQsIGppbnRBcnJheSBhcmc1LCBqaW50QXJyYXkgYXJnNiwgamludEFycmF5IGFyZzcp
OworSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlKSUpf
M0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBh
cmcxLCBqbG9uZyBhcmcyLCBqaW50IGFyZzMsIGpsb25nIGFyZzQsIGppbnRBcnJheSBhcmc1LCBq
aW50QXJyYXkgYXJnNiwgamludEFycmF5IGFyZzcpCisjZWxzZQorZXh0ZXJuICJDIiBKTklFWFBP
UlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSkpJSl8zSV8zSV8zSSko
Sk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25n
IGFyZzIsIGppbnQgYXJnMywgamxvbmcgYXJnNCwgamludEFycmF5IGFyZzUsIGppbnRBcnJheSBh
cmc2LCBqaW50QXJyYXkgYXJnNyk7CitKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElW
RShfMVZ0YmxDYWxsX19JSkpJSl8zSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBq
aW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25nIGFyZzIsIGppbnQgYXJnMywgamxvbmcgYXJn
NCwgamludEFycmF5IGFyZzUsIGppbnRBcnJheSBhcmc2LCBqaW50QXJyYXkgYXJnNykKKyNlbmRp
ZgoreworCWppbnQgKmxwYXJnNT1OVUxMOworCWppbnQgKmxwYXJnNj1OVUxMOworCWppbnQgKmxw
YXJnNz1OVUxMOworCWppbnQgcmMgPSAwOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9F
TlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSklKXzNJXzNJXzNJX0ZVTkMpOworI2Vsc2UK
KwlYUENPTV9OQVRJVkVfRU5URVIoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSkpJSl8zSV8zSV8z
SV9GVU5DKTsKKyNlbmRpZgorCWlmIChhcmc1KSBpZiAoKGxwYXJnNSA9IGVudi0+R2V0SW50QXJy
YXlFbGVtZW50cyhhcmc1LCBOVUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOworCWlmIChhcmc2KSBp
ZiAoKGxwYXJnNiA9IGVudi0+R2V0SW50QXJyYXlFbGVtZW50cyhhcmc2LCBOVUxMKSkgPT0gTlVM
TCkgZ290byBmYWlsOworCWlmIChhcmc3KSBpZiAoKGxwYXJnNyA9IGVudi0+R2V0SW50QXJyYXlF
bGVtZW50cyhhcmc3LCBOVUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOworCXJjID0gKGppbnQpKChq
aW50IChTVERNRVRIT0RDQUxMVFlQRSAqKShqaW50TG9uZywgamxvbmcsIGppbnQsIGpsb25nLCBq
aW50ICosIGppbnQgKiwgamludCAqKSkoKihqaW50TG9uZyAqKilhcmcxKVthcmcwXSkoYXJnMSwg
YXJnMiwgYXJnMywgYXJnNCwgbHBhcmc1LCBscGFyZzYsIGxwYXJnNyk7CitmYWlsOgorCWlmIChh
cmc3ICYmIGxwYXJnNykgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmc3LCBscGFyZzcs
IDApOworCWlmIChhcmc2ICYmIGxwYXJnNikgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhh
cmc2LCBscGFyZzYsIDApOworCWlmIChhcmc1ICYmIGxwYXJnNSkgZW52LT5SZWxlYXNlSW50QXJy
YXlFbGVtZW50cyhhcmc1LCBscGFyZzUsIDApOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElW
RV9FWElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlKSUpfM0lfM0lfM0lfRlVOQyk7CisjZWxz
ZQorCVhQQ09NX05BVElWRV9FWElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpKSUpfM0lfM0lf
M0lfRlVOQyk7CisjZW5kaWYKKwlyZXR1cm4gcmM7Cit9CisjZW5kaWYKKwogI2lmICghZGVmaW5l
ZChOT19fMVZ0YmxDYWxsX19JSUpJXzNKKSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8ICghZGVmaW5l
ZChOT19fMVZ0YmxDYWxsX19JSkpJXzNKKSAmJiBkZWZpbmVkKEpOSTY0KSkKICNpZm5kZWYgSk5J
NjQKIGV4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJs
Q2FsbF9fSUlKSV8zSikoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRM
b25nIGFyZzEsIGpsb25nIGFyZzIsIGppbnQgYXJnMywgamxvbmdBcnJheSBhcmc0KTsKSW5kZXg6
IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL2xpYnJhcnkveHBjb21fc3RhdHMuaAo9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09ClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xpcHNlLnN3dC9FY2xpcHNlIFNX
VCBNb3ppbGxhL2NvbW1vbi9saWJyYXJ5L3hwY29tX3N0YXRzLmgsdgpyZXRyaWV2aW5nIHJldmlz
aW9uIDEuNTMKZGlmZiAtdSAtcjEuNTMgeHBjb21fc3RhdHMuaAotLS0gRWNsaXBzZSBTV1QgTW96
aWxsYS9jb21tb24vbGlicmFyeS94cGNvbV9zdGF0cy5oCTEgSnVsIDIwMDkgMTQ6NDk6MjYgLTAw
MDAJMS41MworKysgRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vbGlicmFyeS94cGNvbV9zdGF0
cy5oCTIxIEp1bCAyMDA5IDEzOjI4OjMyIC0wMDAwCkBAIC0xNDIsNiArMTQyLDExIEBACiAJXzFW
dGJsQ2FsbF9fSUpJSUlJXzNJXzNJX0ZVTkMsCiAjZW5kaWYKICNpZm5kZWYgSk5JNjQKKwlfMVZ0
YmxDYWxsX19JSUlJSUlfM0lfM0lfM0lfRlVOQywKKyNlbHNlCisJXzFWdGJsQ2FsbF9fSUpJSUlJ
XzNJXzNJXzNJX0ZVTkMsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKIAlfMVZ0YmxDYWxsX19JSUlJ
SV8zQl8zQklfRlVOQywKICNlbHNlCiAJXzFWdGJsQ2FsbF9fSUpJSUlfM0JfM0JJX0ZVTkMsCkBA
IC0xNTcsNiArMTYyLDExIEBACiAJXzFWdGJsQ2FsbF9fSUpJSUlfM0lfRlVOQywKICNlbmRpZgog
I2lmbmRlZiBKTkk2NAorCV8xVnRibENhbGxfX0lJSUlJXzNJXzNJXzNJX0ZVTkMsCisjZWxzZQor
CV8xVnRibENhbGxfX0lKSUlJXzNJXzNJXzNJX0ZVTkMsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQK
IAlfMVZ0YmxDYWxsX19JSUlJSkpKSl9GVU5DLAogI2Vsc2UKIAlfMVZ0YmxDYWxsX19JSklJSkpK
Sl9GVU5DLApAQCAtMzMyLDExICszNDIsMzEgQEAKIAlfMVZ0YmxDYWxsX19JSklfM0lfRlVOQywK
ICNlbmRpZgogI2lmbmRlZiBKTkk2NAorCV8xVnRibENhbGxfX0lJSV8zSUlfRlVOQywKKyNlbHNl
CisJXzFWdGJsQ2FsbF9fSUpJXzNJSV9GVU5DLAorI2VuZGlmCisjaWZuZGVmIEpOSTY0CisJXzFW
dGJsQ2FsbF9fSUlJXzNJSl9GVU5DLAorI2Vsc2UKKwlfMVZ0YmxDYWxsX19JSklfM0lKX0ZVTkMs
CisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKKwlfMVZ0YmxDYWxsX19JSUlfM0lfM0lfM0lfRlVOQywK
KyNlbHNlCisJXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNJX0ZVTkMsCisjZW5kaWYKKyNpZm5kZWYg
Sk5JNjQKIAlfMVZ0YmxDYWxsX19JSUlfM0lfM0lfM0lfM0lfRlVOQywKICNlbHNlCiAJXzFWdGJs
Q2FsbF9fSUpJXzNJXzNJXzNJXzNJX0ZVTkMsCiAjZW5kaWYKICNpZm5kZWYgSk5JNjQKKwlfMVZ0
YmxDYWxsX19JSUlfM0lfM0lfM0pfRlVOQywKKyNlbHNlCisJXzFWdGJsQ2FsbF9fSUpJXzNJXzNJ
XzNKX0ZVTkMsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKIAlfMVZ0YmxDYWxsX19JSUpfRlVOQywK
ICNlbHNlCiAJXzFWdGJsQ2FsbF9fSUpKX0ZVTkMsCkBAIC0zNjIsNiArMzkyLDI2IEBACiAJXzFW
dGJsQ2FsbF9fSUpKSUlKXzNJXzNKX0ZVTkMsCiAjZW5kaWYKICNpZm5kZWYgSk5JNjQKKwlfMVZ0
YmxDYWxsX19JSUpJSV8zSV9GVU5DLAorI2Vsc2UKKwlfMVZ0YmxDYWxsX19JSkpJSV8zSV9GVU5D
LAorI2VuZGlmCisjaWZuZGVmIEpOSTY0CisJXzFWdGJsQ2FsbF9fSUlKSUpJSV9GVU5DLAorI2Vs
c2UKKwlfMVZ0YmxDYWxsX19JSkpJSklJX0ZVTkMsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKKwlf
MVZ0YmxDYWxsX19JSUpJSkpfM0lfM0lfM0lfRlVOQywKKyNlbHNlCisJXzFWdGJsQ2FsbF9fSUpK
SUpKXzNJXzNJXzNJX0ZVTkMsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKKwlfMVZ0YmxDYWxsX19J
SUpJSl8zSV8zSV8zSV9GVU5DLAorI2Vsc2UKKwlfMVZ0YmxDYWxsX19JSkpJSl8zSV8zSV8zSV9G
VU5DLAorI2VuZGlmCisjaWZuZGVmIEpOSTY0CiAJXzFWdGJsQ2FsbF9fSUlKSV8zSl9GVU5DLAog
I2Vsc2UKIAlfMVZ0YmxDYWxsX19JSkpJXzNKX0ZVTkMsCkluZGV4OiBFY2xpcHNlIFNXVCBNb3pp
bGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwvbW96aWxsYS9YUENPTS5qYXZhCj09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVjbGlwc2Uuc3d0L0VjbGlw
c2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL1hQ
Q09NLmphdmEsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTAyCmRpZmYgLXUgLXIxLjEwMiBYUENP
TS5qYXZhCi0tLSBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50
ZXJuYWwvbW96aWxsYS9YUENPTS5qYXZhCTEgSnVsIDIwMDkgMTQ6NDg6NTMgLTAwMDAJMS4xMDIK
KysrIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9t
b3ppbGxhL1hQQ09NLmphdmEJMjEgSnVsIDIwMDkgMTM6Mjg6MzIgLTAwMDAKQEAgLTYxLDYgKzYx
LDcgQEAKIAlwdWJsaWMgc3RhdGljIGZpbmFsIG5zSUQgTlNfUFJPTVBUU0VSVklDRV9DSUQgPSBu
ZXcgbnNJRCgiYTIxMTJkNmEtMGUyOC00MjFmLWI0NmEtMjVjMGIzMDhjYmQwIik7IC8vJE5PTi1O
TFMtMSQKIAogCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEVYVEVSTkFMX0NPTlRSQUNUSUQg
PSAiQGVjbGlwc2Uub3JnL2V4dGVybmFsOzEiOyAvLyROT04tTkxTLTEkCisJcHVibGljIHN0YXRp
YyBmaW5hbCBTdHJpbmcgTlNfQ0VSVE9WRVJSSURFX0NPTlRSQUNUSUQgPSAiQG1vemlsbGEub3Jn
L3NlY3VyaXR5L2NlcnRvdmVycmlkZTsxIjsgLy8kTk9OLU5MUy0xJAogCXB1YmxpYyBzdGF0aWMg
ZmluYWwgU3RyaW5nIE5TX0NPTlRFWFRTVEFDS19DT05UUkFDVElEID0gIkBtb3ppbGxhLm9yZy9q
cy94cGMvQ29udGV4dFN0YWNrOzEiOyAvLyROT04tTkxTLTEkCiAJcHVibGljIHN0YXRpYyBmaW5h
bCBTdHJpbmcgTlNfQ09PS0lFTUFOQUdFUl9DT05UUkFDVElEID0gIkBtb3ppbGxhLm9yZy9jb29r
aWVtYW5hZ2VyOzEiOyAvLyROT04tTkxTLTEkCiAJcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcg
TlNfQ09PS0lFU0VSVklDRV9DT05UUkFDVElEID0gIkBtb3ppbGxhLm9yZy9jb29raWVTZXJ2aWNl
OzEiOyAvLyROT04tTkxTLTEkCkBAIC05MDQsNiArOTA1LDI0IEBACiAJCWxvY2sudW5sb2NrKCk7
CiAJfQogfQorc3RhdGljIGZpbmFsIG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwg
aW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGludFtdIGFyZzEsIGludCBhcmcyKTsKK3N0
YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJs
LCBpbnQgYXJnMCwgaW50W10gYXJnMSwgaW50IGFyZzIpIHsKKwlsb2NrLmxvY2soKTsKKwl0cnkg
eworCQlyZXR1cm4gX1Z0YmxDYWxsKGZuTnVtYmVyLCBwcFZ0YmwsIGFyZzAsIGFyZzEsIGFyZzIp
OworCX0gZmluYWxseSB7CisJCWxvY2sudW5sb2NrKCk7CisJfQorfQorc3RhdGljIGZpbmFsIG5h
dGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50
IGFyZzAsIGludFtdIGFyZzEsIGxvbmcgYXJnMik7CitzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxs
KGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGludFtdIGFyZzEs
IGxvbmcgYXJnMikgeworCWxvY2subG9jaygpOworCXRyeSB7CisJCXJldHVybiBfVnRibENhbGwo
Zm5OdW1iZXIsIHBwVnRibCwgYXJnMCwgYXJnMSwgYXJnMik7CisJfSBmaW5hbGx5IHsKKwkJbG9j
ay51bmxvY2soKTsKKwl9Cit9CiBzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50
IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBsb25nIFtdIGFyZzAsIGxvbmcgW10gYXJn
MSwgbG9uZyBbXSBhcmcyKTsKIHN0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVy
LCBpbnQgLypsb25nKi8gcHBWdGJsLCBsb25nIFtdIGFyZzAsIGxvbmcgW10gYXJnMSwgbG9uZyBb
XSBhcmcyKSB7CiAJbG9jay5sb2NrKCk7CkBAIC0xNDU2LDYgKzE0NzUsMjQgQEAKIAkJbG9jay51
bmxvY2soKTsKIAl9CiB9CitzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50IGZu
TnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgaW50W10gYXJnMSwgaW50W10g
YXJnMiwgaW50W10gYXJnMyk7CitzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJl
ciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGludFtdIGFyZzEsIGludFtdIGFyZzIs
IGludFtdIGFyZzMpIHsKKwlsb2NrLmxvY2soKTsKKwl0cnkgeworCQlyZXR1cm4gX1Z0YmxDYWxs
KGZuTnVtYmVyLCBwcFZ0YmwsIGFyZzAsIGFyZzEsIGFyZzIsIGFyZzMpOworCX0gZmluYWxseSB7
CisJCWxvY2sudW5sb2NrKCk7CisJfQorfQorc3RhdGljIGZpbmFsIG5hdGl2ZSBpbnQgX1Z0YmxD
YWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGludFtdIGFy
ZzEsIGludFtdIGFyZzIsIGxvbmdbXSBhcmczKTsKK3N0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwo
aW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgaW50W10gYXJnMSwg
aW50W10gYXJnMiwgbG9uZ1tdIGFyZzMpIHsKKwlsb2NrLmxvY2soKTsKKwl0cnkgeworCQlyZXR1
cm4gX1Z0YmxDYWxsKGZuTnVtYmVyLCBwcFZ0YmwsIGFyZzAsIGFyZzEsIGFyZzIsIGFyZzMpOwor
CX0gZmluYWxseSB7CisJCWxvY2sudW5sb2NrKCk7CisJfQorfQogc3RhdGljIGZpbmFsIG5hdGl2
ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgbnNJRCBh
cmcwLCBieXRlW10gYXJnMSwgYnl0ZVtdIGFyZzIsIGludCBhcmczKTsKIHN0YXRpYyBmaW5hbCBp
bnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBuc0lEIGFyZzAs
IGJ5dGVbXSBhcmcxLCBieXRlW10gYXJnMiwgaW50IGFyZzMpIHsKIAlsb2NrLmxvY2soKTsKQEAg
LTE1NjQsNiArMTYwMSwxNSBAQAogCQlsb2NrLnVubG9jaygpOwogCX0KIH0KK3N0YXRpYyBmaW5h
bCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0Ymws
IGxvbmcgYXJnMCwgaW50IGFyZzEsIGludCBhcmcyLCBpbnRbXSBhcmczKTsKK3N0YXRpYyBmaW5h
bCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBsb25nIGFy
ZzAsIGludCBhcmcxLCBpbnQgYXJnMiwgaW50W10gYXJnMykgeworCWxvY2subG9jaygpOworCXRy
eSB7CisJCXJldHVybiBfVnRibENhbGwoZm5OdW1iZXIsIHBwVnRibCwgYXJnMCwgYXJnMSwgYXJn
MiwgYXJnMyk7CisJfSBmaW5hbGx5IHsKKwkJbG9jay51bmxvY2soKTsKKwl9Cit9CiAKIHN0YXRp
YyBmaW5hbCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBw
cFZ0YmwsIGNoYXJbXSBhcmcwLCBpbnQgYXJnMSwgaW50IGFyZzIsIGludCBhcmczLCBpbnQgYXJn
NCk7CiBzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyov
IHBwVnRibCwgY2hhcltdIGFyZzAsIGludCBhcmcxLCBpbnQgYXJnMiwgaW50IGFyZzMsIGludCBh
cmc0KSB7CkBAIC0xNjgzLDYgKzE3MjksMTUgQEAKIAkJbG9jay51bmxvY2soKTsKIAl9CiB9Citz
dGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25n
Ki8gcHBWdGJsLCBsb25nIGFyZzAsIGludCBhcmcxLCBsb25nIGFyZzIsIGludCBhcmczLCBpbnQg
YXJnNCk7CitzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9u
ZyovIHBwVnRibCwgbG9uZyBhcmcwLCBpbnQgYXJnMSwgbG9uZyBhcmcyLCBpbnQgYXJnMywgaW50
IGFyZzQpIHsKKwlsb2NrLmxvY2soKTsKKwl0cnkgeworCQlyZXR1cm4gX1Z0YmxDYWxsKGZuTnVt
YmVyLCBwcFZ0YmwsIGFyZzAsIGFyZzEsIGFyZzIsIGFyZzMsIGFyZzQpOworCX0gZmluYWxseSB7
CisJCWxvY2sudW5sb2NrKCk7CisJfQorfQogCiBzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRi
bENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgYnl0ZVtd
IGFyZzEsIGJ5dGVbXSBhcmcyLCBieXRlW10gYXJnMywgaW50IGFyZzQsIGludFtdIGFyZzUpOwog
c3RhdGljIGZpbmFsIGludCBWdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0
YmwsIGludCBhcmcwLCBieXRlW10gYXJnMSwgYnl0ZVtdIGFyZzIsIGJ5dGVbXSBhcmczLCBpbnQg
YXJnNCwgaW50W10gYXJnNSkgewpAQCAtMTkyMCw3ICsxOTc1LDI0IEBACiAJCWxvY2sudW5sb2Nr
KCk7CiAJfQogfQotCitzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50IGZuTnVt
YmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgaW50IGFyZzEsIGludCBhcmcyLCBp
bnRbXSBhcmczLCBpbnRbXSBhcmc0LCBpbnRbXSBhcmc1KTsKK3N0YXRpYyBmaW5hbCBpbnQgVnRi
bENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgaW50IGFy
ZzEsIGludCBhcmcyLCBpbnRbXSBhcmczLCBpbnRbXSBhcmc0LCBpbnRbXSBhcmc1KSB7CisJbG9j
ay5sb2NrKCk7CisJdHJ5IHsKKwkJcmV0dXJuIF9WdGJsQ2FsbChmbk51bWJlciwgcHBWdGJsLCBh
cmcwLCBhcmcxLCBhcmcyLCBhcmczLCBhcmc0LCBhcmc1KTsKKwl9IGZpbmFsbHkgeworCQlsb2Nr
LnVubG9jaygpOworCX0KK30KK3N0YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQg
Zm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwgaW50IGFyZzEsIGxvbmcg
YXJnMiwgaW50W10gYXJnMywgaW50W10gYXJnNCwgaW50W10gYXJnNSk7CitzdGF0aWMgZmluYWwg
aW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgbG9uZyBhcmcw
LCBpbnQgYXJnMSwgbG9uZyBhcmcyLCBpbnRbXSBhcmczLCBpbnRbXSBhcmc0LCBpbnRbXSBhcmc1
KSB7CisJbG9jay5sb2NrKCk7CisJdHJ5IHsKKwkJcmV0dXJuIF9WdGJsQ2FsbChmbk51bWJlciwg
cHBWdGJsLCBhcmcwLCBhcmcxLCBhcmcyLCBhcmczLCBhcmc0LCBhcmc1KTsKKwl9IGZpbmFsbHkg
eworCQlsb2NrLnVubG9jaygpOworCX0KK30KIHN0YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9WdGJs
Q2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGludCBhcmcwLCBjaGFyW10g
YXJnMSwgY2hhcltdIGFyZzIsIGludCBhcmczLCBpbnRbXSBhcmc0LCBpbnRbXSBhcmc1LCBpbnRb
XSBhcmc2KTsKIHN0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLyps
b25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgY2hhcltdIGFyZzEsIGNoYXJbXSBhcmcyLCBpbnQgYXJn
MywgaW50W10gYXJnNCwgaW50W10gYXJnNSwgaW50W10gYXJnNikgewogCWxvY2subG9jaygpOwpA
QCAtMTkzMCw3ICsyMDAyLDYgQEAKIAkJbG9jay51bmxvY2soKTsKIAl9CiB9Ci0KIHN0YXRpYyBm
aW5hbCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0
YmwsIGxvbmcgYXJnMCwgY2hhcltdIGFyZzEsIGNoYXJbXSBhcmcyLCBpbnQgYXJnMywgbG9uZ1td
IGFyZzQsIGludFtdIGFyZzUsIGludFtdIGFyZzYpOwogc3RhdGljIGZpbmFsIGludCBWdGJsQ2Fs
bChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwgY2hhcltdIGFy
ZzEsIGNoYXJbXSBhcmcyLCBpbnQgYXJnMywgbG9uZ1tdIGFyZzQsIGludFtdIGFyZzUsIGludFtd
IGFyZzYpIHsKIAlsb2NrLmxvY2soKTsKQEAgLTE5NDAsNyArMjAxMSw2IEBACiAJCWxvY2sudW5s
b2NrKCk7CiAJfQogfQotCiBzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50IGZu
TnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgY2hhcltdIGFyZzEsIGNoYXJb
XSBhcmcyLCBpbnRbXSBhcmczLCBjaGFyW10gYXJnNCwgaW50W10gYXJnNSwgaW50W10gYXJnNik7
CiBzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBw
VnRibCwgaW50IGFyZzAsIGNoYXJbXSBhcmcxLCBjaGFyW10gYXJnMiwgaW50W10gYXJnMywgY2hh
cltdIGFyZzQsIGludFtdIGFyZzUsIGludFtdIGFyZzYpIHsKIAlsb2NrLmxvY2soKTsKQEAgLTE5
NTAsNyArMjAyMCw2IEBACiAJCWxvY2sudW5sb2NrKCk7CiAJfQogfQotCiBzdGF0aWMgZmluYWwg
bmF0aXZlIGludCBfVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBs
b25nIGFyZzAsIGNoYXJbXSBhcmcxLCBjaGFyW10gYXJnMiwgbG9uZ1tdIGFyZzMsIGNoYXJbXSBh
cmc0LCBpbnRbXSBhcmc1LCBpbnRbXSBhcmc2KTsKIHN0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwo
aW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBsb25nIGFyZzAsIGNoYXJbXSBhcmcx
LCBjaGFyW10gYXJnMiwgbG9uZ1tdIGFyZzMsIGNoYXJbXSBhcmc0LCBpbnRbXSBhcmc1LCBpbnRb
XSBhcmc2KSB7CiAJbG9jay5sb2NrKCk7CkBAIC0xOTYwLDcgKzIwMjksNiBAQAogCQlsb2NrLnVu
bG9jaygpOwogCX0KIH0KLQogc3RhdGljIGZpbmFsIG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBm
bk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGludCBhcmcxLCBpbnQgYXJn
MiwgaW50IGFyZzMsIGNoYXJbXSBhcmc0LCBpbnRbXSBhcmc1LCBpbnRbXSBhcmc2KTsKIHN0YXRp
YyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBp
bnQgYXJnMCwgaW50IGFyZzEsIGludCBhcmcyLCBpbnQgYXJnMywgY2hhcltdIGFyZzQsIGludFtd
IGFyZzUsIGludFtdIGFyZzYpIHsKIAlsb2NrLmxvY2soKTsKQEAgLTE5NzAsNyArMjAzOCw2IEBA
CiAJCWxvY2sudW5sb2NrKCk7CiAJfQogfQotCiBzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRi
bENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBsb25nIGFyZzAsIGxvbmcg
YXJnMSwgaW50IGFyZzIsIGxvbmcgYXJnMywgY2hhcltdIGFyZzQsIGludFtdIGFyZzUsIGludFtd
IGFyZzYpOwogc3RhdGljIGZpbmFsIGludCBWdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxv
bmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwgbG9uZyBhcmcxLCBpbnQgYXJnMiwgbG9uZyBhcmczLCBj
aGFyW10gYXJnNCwgaW50W10gYXJnNSwgaW50W10gYXJnNikgewogCWxvY2subG9jaygpOwpAQCAt
MTk4MCw3ICsyMDQ3LDYgQEAKIAkJbG9jay51bmxvY2soKTsKIAl9CiB9Ci0KIHN0YXRpYyBmaW5h
bCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0Ymws
IGludCBhcmcwLCBpbnQgYXJnMSwgaW50IGFyZzIsIGludCBhcmczLCBsb25nIGFyZzQsIGludCBh
cmc1LCBpbnQgYXJnNik7CiBzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwg
aW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGludCBhcmcxLCBpbnQgYXJnMiwgaW50IGFy
ZzMsIGxvbmcgYXJnNCwgaW50IGFyZzUsIGludCBhcmc2KSB7CiAJbG9jay5sb2NrKCk7CkBAIC0x
OTkwLDcgKzIwNTYsNiBAQAogCQlsb2NrLnVubG9jaygpOwogCX0KIH0KLQogc3RhdGljIGZpbmFs
IG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwg
bG9uZyBhcmcwLCBsb25nIGFyZzEsIGxvbmcgYXJnMiwgbG9uZyBhcmczLCBsb25nIGFyZzQsIGxv
bmcgYXJnNSwgbG9uZyBhcmc2KTsKIHN0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVt
YmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBsb25nIGFyZzAsIGxvbmcgYXJnMSwgbG9uZyBhcmcy
LCBsb25nIGFyZzMsIGxvbmcgYXJnNCwgbG9uZyBhcmc1LCBsb25nIGFyZzYpIHsKIAlsb2NrLmxv
Y2soKTsKQEAgLTIwMDAsNyArMjA2NSwyNSBAQAogCQlsb2NrLnVubG9jaygpOwogCX0KIH0KK3N0
YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcq
LyBwcFZ0YmwsIGludCBhcmcwLCBpbnQgYXJnMSwgaW50IGFyZzIsIGludCBhcmczLCBpbnRbXSBh
cmc0LCBpbnRbXSBhcmc1LCBpbnRbXSBhcmc2KTsKK3N0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwo
aW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgaW50IGFyZzEsIGlu
dCBhcmcyLCBpbnQgYXJnMywgaW50W10gYXJnNCwgaW50W10gYXJnNSwgaW50W10gYXJnNikgewor
CWxvY2subG9jaygpOworCXRyeSB7CisJCXJldHVybiBfVnRibENhbGwoZm5OdW1iZXIsIHBwVnRi
bCwgYXJnMCwgYXJnMSwgYXJnMiwgYXJnMywgYXJnNCwgYXJnNSwgYXJnNik7CisJfSBmaW5hbGx5
IHsKKwkJbG9jay51bmxvY2soKTsKKwl9Cit9CiAKK3N0YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9W
dGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwgaW50
IGFyZzEsIGxvbmcgYXJnMiwgbG9uZyBhcmczLCBpbnRbXSBhcmc0LCBpbnRbXSBhcmc1LCBpbnRb
XSBhcmc2KTsKK3N0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLyps
b25nKi8gcHBWdGJsLCBsb25nIGFyZzAsIGludCBhcmcxLCBsb25nIGFyZzIsIGxvbmcgYXJnMywg
aW50W10gYXJnNCwgaW50W10gYXJnNSwgaW50W10gYXJnNikgeworCWxvY2subG9jaygpOworCXRy
eSB7CisJCXJldHVybiBfVnRibENhbGwoZm5OdW1iZXIsIHBwVnRibCwgYXJnMCwgYXJnMSwgYXJn
MiwgYXJnMywgYXJnNCwgYXJnNSwgYXJnNik7CisJfSBmaW5hbGx5IHsKKwkJbG9jay51bmxvY2so
KTsKKwl9Cit9CiBzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50IGZuTnVtYmVy
LCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgY2hhcltdIGFyZzEsIGNoYXJbXSBhcmcy
LCBpbnRbXSBhcmczLCBpbnRbXSBhcmc0LCBjaGFyW10gYXJnNSwgaW50W10gYXJnNiwgaW50W10g
YXJnNyk7CiBzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9u
ZyovIHBwVnRibCwgaW50IGFyZzAsIGNoYXJbXSBhcmcxLCBjaGFyW10gYXJnMiwgaW50W10gYXJn
MywgaW50W10gYXJnNCwgY2hhcltdIGFyZzUsIGludFtdIGFyZzYsIGludFtdIGFyZzcpIHsKIAls
b2NrLmxvY2soKTsKSW5kZXg6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNl
L3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSVg1MDlDZXJ0VmFsaWRpdHkuamF2YQo9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50
ZXJuYWwvbW96aWxsYS9uc0lYNTA5Q2VydFZhbGlkaXR5LmphdmEKZGlmZiAtTiBFY2xpcHNlIFNX
VCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwvbW96aWxsYS9uc0lYNTA5
Q2VydFZhbGlkaXR5LmphdmEKLS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAw
CisrKyBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwv
bW96aWxsYS9uc0lYNTA5Q2VydFZhbGlkaXR5LmphdmEJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAw
MApAQCAtMCwwICsxLDc1IEBACisvKiAqKioqKiBCRUdJTiBMSUNFTlNFIEJMT0NLICoqKioqCisg
KiBWZXJzaW9uOiBNUEwgMS4xCisgKgorICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUg
c3ViamVjdCB0byB0aGUgTW96aWxsYSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uCisgKiAxLjEgKHRo
ZSAiTGljZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh
bmNlIHdpdGgKKyAqIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp
Y2Vuc2UgYXQKKyAqIGh0dHA6Ly93d3cubW96aWxsYS5vcmcvTVBMLworICoKKyAqIFNvZnR3YXJl
IGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJ
UyIgYmFzaXMsCisgKiBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVz
cyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UKKyAqIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3Vh
Z2UgZ292ZXJuaW5nIHJpZ2h0cyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlCisgKiBMaWNlbnNl
LgorICoKKyAqIFRoZSBPcmlnaW5hbCBDb2RlIGlzIE1vemlsbGEgQ29tbXVuaWNhdG9yIGNsaWVu
dCBjb2RlLCByZWxlYXNlZCBNYXJjaCAzMSwgMTk5OC4KKyAqCisgKiBUaGUgSW5pdGlhbCBEZXZl
bG9wZXIgb2YgdGhlIE9yaWdpbmFsIENvZGUgaXMKKyAqIE5ldHNjYXBlIENvbW11bmljYXRpb25z
IENvcnBvcmF0aW9uLgorICogUG9ydGlvbnMgY3JlYXRlZCBieSBOZXRzY2FwZSBhcmUgQ29weXJp
Z2h0IChDKSAxOTk4LTE5OTkKKyAqIE5ldHNjYXBlIENvbW11bmljYXRpb25zIENvcnBvcmF0aW9u
LiAgQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqCisgKiBDb250cmlidXRvcihzKToKKyAqCisgKiBJ
Qk0KKyAqIC0gIEJpbmRpbmcgdG8gcGVybWl0IGludGVyZmFjaW5nIGJldHdlZW4gTW96aWxsYSBh
bmQgU1dUCisgKiAtICBDb3B5cmlnaHQgKEMpIDIwMDMsIDIwMDggSUJNIENvcnAuICBBbGwgUmln
aHRzIFJlc2VydmVkLgorICoKKyAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICovCitw
YWNrYWdlIG9yZy5lY2xpcHNlLnN3dC5pbnRlcm5hbC5tb3ppbGxhOworCitwdWJsaWMgY2xhc3Mg
bnNJWDUwOUNlcnRWYWxpZGl0eSBleHRlbmRzIG5zSVN1cHBvcnRzIHsKKworCXN0YXRpYyBmaW5h
bCBpbnQgTEFTVF9NRVRIT0RfSUQgPSBuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDg7CisK
KwlwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBOU19JWDUwOUNFUlRWQUxJRElUWV9JSURfU1RS
ID0KKwkJImU3MDFkZmQ4LTFkZDEtMTFiMi1hMTcyLWZmYTZjYzYxNTZhZCI7CisKKwlwdWJsaWMg
c3RhdGljIGZpbmFsIG5zSUQgTlNfSVg1MDlDRVJUVkFMSURJVFlfSUlEID0KKwkJbmV3IG5zSUQo
TlNfSVg1MDlDRVJUVkFMSURJVFlfSUlEX1NUUik7CisKKwlwdWJsaWMgIG5zSVg1MDlDZXJ0VmFs
aWRpdHkoaW50IC8qbG9uZyovIGFkZHJlc3MpIHsKKwkJc3VwZXIoYWRkcmVzcyk7CisJfQorCisJ
cHVibGljIGludCBHZXROb3RCZWZvcmUoaW50IC8qbG9uZyovIGFOb3RCZWZvcmUpIHsKKwkJcmV0
dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMSwgZ2V0QWRk
cmVzcygpLCBhTm90QmVmb3JlKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldE5vdEJlZm9yZUxvY2Fs
VGltZShpbnQgLypsb25nKi8gYU5vdEJlZm9yZUxvY2FsVGltZSkgeworCQlyZXR1cm4gWFBDT00u
VnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAyLCBnZXRBZGRyZXNzKCksIGFO
b3RCZWZvcmVMb2NhbFRpbWUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0Tm90QmVmb3JlTG9jYWxE
YXkoaW50IC8qbG9uZyovIGFOb3RCZWZvcmVMb2NhbERheSkgeworCQlyZXR1cm4gWFBDT00uVnRi
bENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAzLCBnZXRBZGRyZXNzKCksIGFOb3RC
ZWZvcmVMb2NhbERheSk7CisJfQorCisJcHVibGljIGludCBHZXROb3RCZWZvcmVHTVQoaW50IC8q
bG9uZyovIGFOb3RCZWZvcmVHTVQpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBv
cnRzLkxBU1RfTUVUSE9EX0lEICsgNCwgZ2V0QWRkcmVzcygpLCBhTm90QmVmb3JlR01UKTsKKwl9
CisKKwlwdWJsaWMgaW50IEdldE5vdEFmdGVyKGludCAvKmxvbmcqLyBhTm90QWZ0ZXIpIHsKKwkJ
cmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgNSwgZ2V0
QWRkcmVzcygpLCBhTm90QWZ0ZXIpOworCX0KKworCXB1YmxpYyBpbnQgR2V0Tm90QWZ0ZXJMb2Nh
bFRpbWUoaW50IC8qbG9uZyovIGFOb3RBZnRlckxvY2FsVGltZSkgeworCQlyZXR1cm4gWFBDT00u
VnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyA2LCBnZXRBZGRyZXNzKCksIGFO
b3RBZnRlckxvY2FsVGltZSk7CisJfQorCisJcHVibGljIGludCBHZXROb3RBZnRlckxvY2FsRGF5
KGludCAvKmxvbmcqLyBhTm90QWZ0ZXJMb2NhbERheSkgeworCQlyZXR1cm4gWFBDT00uVnRibENh
bGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyA3LCBnZXRBZGRyZXNzKCksIGFOb3RBZnRl
ckxvY2FsRGF5KTsKKwl9CisKKwlwdWJsaWMgaW50IEdldE5vdEFmdGVyR01UKGludCAvKmxvbmcq
LyBhTm90QWZ0ZXJHTVQpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxB
U1RfTUVUSE9EX0lEICsgOCwgZ2V0QWRkcmVzcygpLCBhTm90QWZ0ZXJHTVQpOworCX0KK30KXCBO
byBuZXdsaW5lIGF0IGVuZCBvZiBmaWxlCkluZGV4OiBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1v
bi9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwvbW96aWxsYS9uc0lDZXJ0T3ZlcnJpZGVTZXJ2aWNl
LmphdmEKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3Jn
L2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJQ2VydE92ZXJyaWRlU2VydmljZS5qYXZh
CmRpZmYgLU4gRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVy
bmFsL21vemlsbGEvbnNJQ2VydE92ZXJyaWRlU2VydmljZS5qYXZhCi0tLSAvZGV2L251bGwJMSBK
YW4gMTk3MCAwMDowMDowMCAtMDAwMAorKysgRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3Jn
L2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJQ2VydE92ZXJyaWRlU2VydmljZS5qYXZh
CTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDAKQEAgLTAsMCArMSw3MyBAQAorLyogKioqKiogQkVH
SU4gTElDRU5TRSBCTE9DSyAqKioqKgorICogVmVyc2lvbjogTVBMIDEuMQorICoKKyAqIFRoZSBj
b250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExp
Y2Vuc2UgVmVyc2lvbgorICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRo
aXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCisgKiB0aGUgTGljZW5zZS4gWW91IG1h
eSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CisgKiBodHRwOi8vd3d3Lm1vemlsbGEu
b3JnL01QTC8KKyAqCisgKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBp
cyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAorICogV0lUSE9VVCBXQVJSQU5UWSBP
RiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCisg
KiBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRp
b25zIHVuZGVyIHRoZQorICogTGljZW5zZS4KKyAqCisgKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBN
b3ppbGxhIENvbW11bmljYXRvciBjbGllbnQgY29kZSwgcmVsZWFzZWQgTWFyY2ggMzEsIDE5OTgu
CisgKgorICogVGhlIEluaXRpYWwgRGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCisg
KiBOZXRzY2FwZSBDb21tdW5pY2F0aW9ucyBDb3Jwb3JhdGlvbi4KKyAqIFBvcnRpb25zIGNyZWF0
ZWQgYnkgTmV0c2NhcGUgYXJlIENvcHlyaWdodCAoQykgMTk5OC0xOTk5CisgKiBOZXRzY2FwZSBD
b21tdW5pY2F0aW9ucyBDb3Jwb3JhdGlvbi4gIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICog
Q29udHJpYnV0b3Iocyk6CisgKgorICogSUJNCisgKiAtICBCaW5kaW5nIHRvIHBlcm1pdCBpbnRl
cmZhY2luZyBiZXR3ZWVuIE1vemlsbGEgYW5kIFNXVAorICogLSAgQ29weXJpZ2h0IChDKSAyMDAz
LCAyMDA4IElCTSBDb3JwLiAgQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqCisgKiAqKioqKiBFTkQg
TElDRU5TRSBCTE9DSyAqKioqKiAqLworcGFja2FnZSBvcmcuZWNsaXBzZS5zd3QuaW50ZXJuYWwu
bW96aWxsYTsKKworcHVibGljIGNsYXNzIG5zSUNlcnRPdmVycmlkZVNlcnZpY2UgZXh0ZW5kcyBu
c0lTdXBwb3J0cyB7CisKKwlzdGF0aWMgZmluYWwgaW50IExBU1RfTUVUSE9EX0lEID0gbnNJU3Vw
cG9ydHMuTEFTVF9NRVRIT0RfSUQgKyA2OworCisJcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcg
TlNfSUNFUlRPVkVSUklERVNFUlZJQ0VfSUlEX1NUUiA9CisJCSIzMTczOGQyYS03N2QzLTQzNTkt
ODRjOS00YmUyZjM4ZmI4YzUiOworCisJcHVibGljIHN0YXRpYyBmaW5hbCBuc0lEIE5TX0lDRVJU
T1ZFUlJJREVTRVJWSUNFX0lJRCA9CisJCW5ldyBuc0lEKE5TX0lDRVJUT1ZFUlJJREVTRVJWSUNF
X0lJRF9TVFIpOworCisJcHVibGljICBuc0lDZXJ0T3ZlcnJpZGVTZXJ2aWNlKGludCAvKmxvbmcq
LyBhZGRyZXNzKSB7CisJCXN1cGVyKGFkZHJlc3MpOworCX0KKworCXB1YmxpYyBzdGF0aWMgZmlu
YWwgaW50IEVSUk9SX1VOVFJVU1RFRCA9IDE7CisKKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBF
UlJPUl9NSVNNQVRDSCA9IDI7CisKKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBFUlJPUl9USU1F
ID0gNDsKKworCXB1YmxpYyBpbnQgUmVtZW1iZXJWYWxpZGl0eU92ZXJyaWRlKGludCAvKmxvbmcq
LyBhSG9zdE5hbWUsIGludCBhUG9ydCwgaW50IC8qbG9uZyovIGFDZXJ0LCBpbnQgYU92ZXJyaWRl
Qml0cywgaW50IGFUZW1wb3JhcnkpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBv
cnRzLkxBU1RfTUVUSE9EX0lEICsgMSwgZ2V0QWRkcmVzcygpLCBhSG9zdE5hbWUsIGFQb3J0LCBh
Q2VydCwgYU92ZXJyaWRlQml0cywgYVRlbXBvcmFyeSk7CisJfQorCisJcHVibGljIGludCBIYXNN
YXRjaGluZ092ZXJyaWRlKGludCAvKmxvbmcqLyBhSG9zdE5hbWUsIGludCBhUG9ydCwgaW50IC8q
bG9uZyovIGFDZXJ0LCBpbnRbXSBhT3ZlcnJpZGVCaXRzLCBpbnRbXSBhSXNUZW1wb3JhcnksIGlu
dFtdIF9yZXR2YWwpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1Rf
TUVUSE9EX0lEICsgMiwgZ2V0QWRkcmVzcygpLCBhSG9zdE5hbWUsIGFQb3J0LCBhQ2VydCwgYU92
ZXJyaWRlQml0cywgYUlzVGVtcG9yYXJ5LCBfcmV0dmFsKTsKKwl9CisKKwlwdWJsaWMgaW50IEdl
dFZhbGlkaXR5T3ZlcnJpZGUoaW50IC8qbG9uZyovIGFIb3N0TmFtZSwgaW50IGFQb3J0LCBpbnQg
Lypsb25nKi8gYUhhc2hBbGcsIGludCAvKmxvbmcqLyBhRmluZ2VycHJpbnQsIGludFtdIGFPdmVy
cmlkZUJpdHMsIGludFtdIGFJc1RlbXBvcmFyeSwgaW50W10gX3JldHZhbCkgeworCQlyZXR1cm4g
WFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAzLCBnZXRBZGRyZXNz
KCksIGFIb3N0TmFtZSwgYVBvcnQsIGFIYXNoQWxnLCBhRmluZ2VycHJpbnQsIGFPdmVycmlkZUJp
dHMsIGFJc1RlbXBvcmFyeSwgX3JldHZhbCk7CisJfQorCisJcHVibGljIGludCBDbGVhclZhbGlk
aXR5T3ZlcnJpZGUoaW50IC8qbG9uZyovIGFIb3N0TmFtZSwgaW50IGFQb3J0KSB7CisJCXJldHVy
biBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDQsIGdldEFkZHJl
c3MoKSwgYUhvc3ROYW1lLCBhUG9ydCk7CisJfQorCisJcHVibGljIGludCBHZXRBbGxPdmVycmlk
ZUhvc3RzV2l0aFBvcnRzKGludFtdIGFDb3VudCwgaW50IC8qbG9uZyovW10gYUhvc3RzV2l0aFBv
cnRzQXJyYXkpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVU
SE9EX0lEICsgNSwgZ2V0QWRkcmVzcygpLCBhQ291bnQsIGFIb3N0c1dpdGhQb3J0c0FycmF5KTsK
Kwl9CisKKwlwdWJsaWMgaW50IElzQ2VydFVzZWRGb3JPdmVycmlkZXMoaW50IC8qbG9uZyovIGFD
ZXJ0LCBpbnQgYUNoZWNrVGVtcG9yYXJpZXMsIGludCBhQ2hlY2tQZXJtYW5lbnRzLCBpbnRbXSBf
cmV0dmFsKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhP
RF9JRCArIDYsIGdldEFkZHJlc3MoKSwgYUNlcnQsIGFDaGVja1RlbXBvcmFyaWVzLCBhQ2hlY2tQ
ZXJtYW5lbnRzLCBfcmV0dmFsKTsKKwl9Cit9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2YgZmlsZQpJ
bmRleDogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFs
L21vemlsbGEvbnNJU1NMU3RhdHVzLmphdmEKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogRWNsaXBzZSBT
V1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJU1NM
U3RhdHVzLmphdmEKZGlmZiAtTiBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBz
ZS9zd3QvaW50ZXJuYWwvbW96aWxsYS9uc0lTU0xTdGF0dXMuamF2YQotLS0gL2Rldi9udWxsCTEg
SmFuIDE5NzAgMDA6MDA6MDAgLTAwMDAKKysrIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29y
Zy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSVNTTFN0YXR1cy5qYXZhCTEgSmFuIDE5
NzAgMDA6MDA6MDAgLTAwMDAKQEAgLTAsMCArMSw3MSBAQAorLyogKioqKiogQkVHSU4gTElDRU5T
RSBCTE9DSyAqKioqKgorICogVmVyc2lvbjogTVBMIDEuMQorICoKKyAqIFRoZSBjb250ZW50cyBv
ZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vuc2UgVmVy
c2lvbgorICogMS4xICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBl
eGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoCisgKiB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4g
YSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CisgKiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL01QTC8K
KyAqCisgKiBTb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmli
dXRlZCBvbiBhbiAiQVMgSVMiIGJhc2lzLAorICogV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lO
RCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCisgKiBmb3IgdGhl
IHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVuZGVy
IHRoZQorICogTGljZW5zZS4KKyAqCisgKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBNb3ppbGxhIENv
bW11bmljYXRvciBjbGllbnQgY29kZSwgcmVsZWFzZWQgTWFyY2ggMzEsIDE5OTguCisgKgorICog
VGhlIEluaXRpYWwgRGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCisgKiBOZXRzY2Fw
ZSBDb21tdW5pY2F0aW9ucyBDb3Jwb3JhdGlvbi4KKyAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgTmV0
c2NhcGUgYXJlIENvcHlyaWdodCAoQykgMTk5OC0xOTk5CisgKiBOZXRzY2FwZSBDb21tdW5pY2F0
aW9ucyBDb3Jwb3JhdGlvbi4gIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogQ29udHJpYnV0
b3Iocyk6CisgKgorICogSUJNCisgKiAtICBCaW5kaW5nIHRvIHBlcm1pdCBpbnRlcmZhY2luZyBi
ZXR3ZWVuIE1vemlsbGEgYW5kIFNXVAorICogLSAgQ29weXJpZ2h0IChDKSAyMDAzLCAyMDA4IElC
TSBDb3JwLiAgQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqCisgKiAqKioqKiBFTkQgTElDRU5TRSBC
TE9DSyAqKioqKiAqLworcGFja2FnZSBvcmcuZWNsaXBzZS5zd3QuaW50ZXJuYWwubW96aWxsYTsK
KworcHVibGljIGNsYXNzIG5zSVNTTFN0YXR1cyBleHRlbmRzIG5zSVN1cHBvcnRzIHsKKworCXN0
YXRpYyBmaW5hbCBpbnQgTEFTVF9NRVRIT0RfSUQgPSBuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9J
RCArIDc7CisKKwlwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBOU19JU1NMU1RBVFVTX0lJRF9T
VFIgPQorCQkiY2ZlZGU5MzktZGVmMS00OWJlLTgxZWQtZDQwMWIzYTA3ZDFjIjsKKworCXB1Ymxp
YyBzdGF0aWMgZmluYWwgbnNJRCBOU19JU1NMU1RBVFVTX0lJRCA9CisJCW5ldyBuc0lEKE5TX0lT
U0xTVEFUVVNfSUlEX1NUUik7CisKKwlwdWJsaWMgIG5zSVNTTFN0YXR1cyhpbnQgLypsb25nKi8g
YWRkcmVzcykgeworCQlzdXBlcihhZGRyZXNzKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldFNlcnZl
ckNlcnQoaW50IC8qbG9uZyovW10gYVNlcnZlckNlcnQpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxD
YWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMSwgZ2V0QWRkcmVzcygpLCBhU2VydmVy
Q2VydCk7CisJfQorCisJcHVibGljIGludCBHZXRDaXBoZXJOYW1lKGludCAvKmxvbmcqL1tdIGFD
aXBoZXJOYW1lKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01F
VEhPRF9JRCArIDIsIGdldEFkZHJlc3MoKSwgYUNpcGhlck5hbWUpOworCX0KKworCXB1YmxpYyBp
bnQgR2V0S2V5TGVuZ3RoKGludFtdIGFLZXlMZW5ndGgpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxD
YWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMywgZ2V0QWRkcmVzcygpLCBhS2V5TGVu
Z3RoKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldFNlY3JldEtleUxlbmd0aChpbnRbXSBhU2VjcmV0
S2V5TGVuZ3RoKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01F
VEhPRF9JRCArIDQsIGdldEFkZHJlc3MoKSwgYVNlY3JldEtleUxlbmd0aCk7CisJfQorCisJcHVi
bGljIGludCBHZXRJc0RvbWFpbk1pc21hdGNoKGludFtdIGFJc0RvbWFpbk1pc21hdGNoKSB7CisJ
CXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDUsIGdl
dEFkZHJlc3MoKSwgYUlzRG9tYWluTWlzbWF0Y2gpOworCX0KKworCXB1YmxpYyBpbnQgR2V0SXNO
b3RWYWxpZEF0VGhpc1RpbWUoaW50W10gYUlzTm90VmFsaWRBdFRoaXNUaW1lKSB7CisJCXJldHVy
biBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDYsIGdldEFkZHJl
c3MoKSwgYUlzTm90VmFsaWRBdFRoaXNUaW1lKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldElzVW50
cnVzdGVkKGludFtdIGFJc1VudHJ1c3RlZCkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJ
U3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyA3LCBnZXRBZGRyZXNzKCksIGFJc1VudHJ1c3RlZCk7
CisJfQorfQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUKSW5kZXg6IEVjbGlwc2UgU1dUIE1v
emlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSVg1MDlDZXJ0
LmphdmEKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3Jn
L2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJWDUwOUNlcnQuamF2YQpkaWZmIC1OIEVj
bGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxh
L25zSVg1MDlDZXJ0LmphdmEKLS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAw
CisrKyBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwv
bW96aWxsYS9uc0lYNTA5Q2VydC5qYXZhCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDAKQEAgLTAs
MCArMSwyMDMgQEAKKy8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioKKyAqIFZlcnNp
b246IE1QTCAxLjEKKyAqCisgKiBUaGUgY29udGVudHMgb2YgdGhpcyBmaWxlIGFyZSBzdWJqZWN0
IHRvIHRoZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24KKyAqIDEuMSAodGhlICJMaWNl
bnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0
aAorICogdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBh
dAorICogaHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwvCisgKgorICogU29mdHdhcmUgZGlzdHJp
YnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBiYXNp
cywKKyAqIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt
cGxpZWQuIFNlZSB0aGUgTGljZW5zZQorICogZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zl
cm5pbmcgcmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUKKyAqIExpY2Vuc2UuCisgKgor
ICogVGhlIE9yaWdpbmFsIENvZGUgaXMgTW96aWxsYSBDb21tdW5pY2F0b3IgY2xpZW50IGNvZGUs
IHJlbGVhc2VkIE1hcmNoIDMxLCAxOTk4LgorICoKKyAqIFRoZSBJbml0aWFsIERldmVsb3BlciBv
ZiB0aGUgT3JpZ2luYWwgQ29kZSBpcworICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9y
YXRpb24uCisgKiBQb3J0aW9ucyBjcmVhdGVkIGJ5IE5ldHNjYXBlIGFyZSBDb3B5cmlnaHQgKEMp
IDE5OTgtMTk5OQorICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24uICBBbGwg
UmlnaHRzIFJlc2VydmVkLgorICoKKyAqIENvbnRyaWJ1dG9yKHMpOgorICoKKyAqIElCTQorICog
LSAgQmluZGluZyB0byBwZXJtaXQgaW50ZXJmYWNpbmcgYmV0d2VlbiBNb3ppbGxhIGFuZCBTV1QK
KyAqIC0gIENvcHlyaWdodCAoQykgMjAwMywgMjAwOCBJQk0gQ29ycC4gIEFsbCBSaWdodHMgUmVz
ZXJ2ZWQuCisgKgorICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi8KK3BhY2thZ2Ug
b3JnLmVjbGlwc2Uuc3d0LmludGVybmFsLm1vemlsbGE7CisKK3B1YmxpYyBjbGFzcyBuc0lYNTA5
Q2VydCBleHRlbmRzIG5zSVN1cHBvcnRzIHsKKworCXN0YXRpYyBmaW5hbCBpbnQgTEFTVF9NRVRI
T0RfSUQgPSBuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDI3OworCisJcHVibGljIHN0YXRp
YyBmaW5hbCBTdHJpbmcgTlNfSVg1MDlDRVJUX0lJRF9TVFIgPQorCQkiZjA5ODBmNjAtZWUzZC0x
MWQ0LTk5OGItMDBiMGQwMjM1NGEwIjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgbnNJRCBOU19J
WDUwOUNFUlRfSUlEID0KKwkJbmV3IG5zSUQoTlNfSVg1MDlDRVJUX0lJRF9TVFIpOworCisJcHVi
bGljICBuc0lYNTA5Q2VydChpbnQgLypsb25nKi8gYWRkcmVzcykgeworCQlzdXBlcihhZGRyZXNz
KTsKKwl9CisKKwlwdWJsaWMgaW50IEdldE5pY2tuYW1lKGludCAvKmxvbmcqLyBhTmlja25hbWUp
IHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsg
MSwgZ2V0QWRkcmVzcygpLCBhTmlja25hbWUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0RW1haWxB
ZGRyZXNzKGludCAvKmxvbmcqLyBhRW1haWxBZGRyZXNzKSB7CisJCXJldHVybiBYUENPTS5WdGJs
Q2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDIsIGdldEFkZHJlc3MoKSwgYUVtYWls
QWRkcmVzcyk7CisJfQorCisJcHVibGljIGludCBHZXRFbWFpbEFkZHJlc3NlcyhpbnRbXSBsZW5n
dGgsIGludCAvKmxvbmcqL1tdIGFkZHJlc3NlcykgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwo
bnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAzLCBnZXRBZGRyZXNzKCksIGxlbmd0aCwgYWRk
cmVzc2VzKTsKKwl9CisKKwlwdWJsaWMgaW50IENvbnRhaW5zRW1haWxBZGRyZXNzKGludCAvKmxv
bmcqLyBhRW1haWxBZGRyZXNzLCBpbnRbXSBfcmV0dmFsKSB7CisJCXJldHVybiBYUENPTS5WdGJs
Q2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDQsIGdldEFkZHJlc3MoKSwgYUVtYWls
QWRkcmVzcywgX3JldHZhbCk7CisJfQorCisJcHVibGljIGludCBHZXRTdWJqZWN0TmFtZShpbnQg
Lypsb25nKi8gYVN1YmplY3ROYW1lKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBw
b3J0cy5MQVNUX01FVEhPRF9JRCArIDUsIGdldEFkZHJlc3MoKSwgYVN1YmplY3ROYW1lKTsKKwl9
CisKKwlwdWJsaWMgaW50IEdldENvbW1vbk5hbWUoaW50IC8qbG9uZyovIGFDb21tb25OYW1lKSB7
CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDYs
IGdldEFkZHJlc3MoKSwgYUNvbW1vbk5hbWUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0T3JnYW5p
emF0aW9uKGludCAvKmxvbmcqLyBhT3JnYW5pemF0aW9uKSB7CisJCXJldHVybiBYUENPTS5WdGJs
Q2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDcsIGdldEFkZHJlc3MoKSwgYU9yZ2Fu
aXphdGlvbik7CisJfQorCisJcHVibGljIGludCBHZXRPcmdhbml6YXRpb25hbFVuaXQoaW50IC8q
bG9uZyovIGFPcmdhbml6YXRpb25hbFVuaXQpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5z
SVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgOCwgZ2V0QWRkcmVzcygpLCBhT3JnYW5pemF0aW9u
YWxVbml0KTsKKwl9CisKKwlwdWJsaWMgaW50IEdldFNoYTFGaW5nZXJwcmludChpbnQgLypsb25n
Ki8gYVNoYTFGaW5nZXJwcmludCkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9y
dHMuTEFTVF9NRVRIT0RfSUQgKyA5LCBnZXRBZGRyZXNzKCksIGFTaGExRmluZ2VycHJpbnQpOwor
CX0KKworCXB1YmxpYyBpbnQgR2V0TWQ1RmluZ2VycHJpbnQoaW50IC8qbG9uZyovIGFNZDVGaW5n
ZXJwcmludCkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRI
T0RfSUQgKyAxMCwgZ2V0QWRkcmVzcygpLCBhTWQ1RmluZ2VycHJpbnQpOworCX0KKworCXB1Ymxp
YyBpbnQgR2V0VG9rZW5OYW1lKGludCAvKmxvbmcqLyBhVG9rZW5OYW1lKSB7CisJCXJldHVybiBY
UENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDExLCBnZXRBZGRyZXNz
KCksIGFUb2tlbk5hbWUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0SXNzdWVyTmFtZShpbnQgLyps
b25nKi8gYUlzc3Vlck5hbWUpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRz
LkxBU1RfTUVUSE9EX0lEICsgMTIsIGdldEFkZHJlc3MoKSwgYUlzc3Vlck5hbWUpOworCX0KKwor
CXB1YmxpYyBpbnQgR2V0U2VyaWFsTnVtYmVyKGludCAvKmxvbmcqLyBhU2VyaWFsTnVtYmVyKSB7
CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDEz
LCBnZXRBZGRyZXNzKCksIGFTZXJpYWxOdW1iZXIpOworCX0KKworCXB1YmxpYyBpbnQgR2V0SXNz
dWVyQ29tbW9uTmFtZShpbnQgLypsb25nKi8gYUlzc3VlckNvbW1vbk5hbWUpIHsKKwkJcmV0dXJu
IFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMTQsIGdldEFkZHJl
c3MoKSwgYUlzc3VlckNvbW1vbk5hbWUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0SXNzdWVyT3Jn
YW5pemF0aW9uKGludCAvKmxvbmcqLyBhSXNzdWVyT3JnYW5pemF0aW9uKSB7CisJCXJldHVybiBY
UENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDE1LCBnZXRBZGRyZXNz
KCksIGFJc3N1ZXJPcmdhbml6YXRpb24pOworCX0KKworCXB1YmxpYyBpbnQgR2V0SXNzdWVyT3Jn
YW5pemF0aW9uVW5pdChpbnQgLypsb25nKi8gYUlzc3Vlck9yZ2FuaXphdGlvblVuaXQpIHsKKwkJ
cmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMTYsIGdl
dEFkZHJlc3MoKSwgYUlzc3Vlck9yZ2FuaXphdGlvblVuaXQpOworCX0KKworCXB1YmxpYyBpbnQg
R2V0SXNzdWVyKGludCAvKmxvbmcqL1tdIGFJc3N1ZXIpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxD
YWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMTcsIGdldEFkZHJlc3MoKSwgYUlzc3Vl
cik7CisJfQorCisJcHVibGljIGludCBHZXRWYWxpZGl0eShpbnQgLypsb25nKi9bXSBhVmFsaWRp
dHkpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lE
ICsgMTgsIGdldEFkZHJlc3MoKSwgYVZhbGlkaXR5KTsKKwl9CisKKwlwdWJsaWMgaW50IEdldERi
S2V5KGludCAvKmxvbmcqL1tdIGFEYktleSkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJ
U3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAxOSwgZ2V0QWRkcmVzcygpLCBhRGJLZXkpOworCX0K
KworCXB1YmxpYyBpbnQgR2V0V2luZG93VGl0bGUoaW50IC8qbG9uZyovW10gYVdpbmRvd1RpdGxl
KSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCAr
IDIwLCBnZXRBZGRyZXNzKCksIGFXaW5kb3dUaXRsZSk7CisJfQorCisJcHVibGljIHN0YXRpYyBm
aW5hbCBpbnQgVU5LTk9XTl9DRVJUID0gMDsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IENB
X0NFUlQgPSAxOworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgVVNFUl9DRVJUID0gMjsKKwor
CXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEVNQUlMX0NFUlQgPSA0OworCisJcHVibGljIHN0YXRp
YyBmaW5hbCBpbnQgU0VSVkVSX0NFUlQgPSA4OworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQg
VkVSSUZJRURfT0sgPSAwOworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgTk9UX1ZFUklGSUVE
X1VOS05PV04gPSAxOworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9SRVZPS0VEID0g
MjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IENFUlRfRVhQSVJFRCA9IDQ7CisKKwlwdWJs
aWMgc3RhdGljIGZpbmFsIGludCBDRVJUX05PVF9UUlVTVEVEID0gODsKKworCXB1YmxpYyBzdGF0
aWMgZmluYWwgaW50IElTU1VFUl9OT1RfVFJVU1RFRCA9IDE2OworCisJcHVibGljIHN0YXRpYyBm
aW5hbCBpbnQgSVNTVUVSX1VOS05PV04gPSAzMjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50
IElOVkFMSURfQ0EgPSA2NDsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFVTQUdFX05PVF9B
TExPV0VEID0gMTI4OworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9TU0xD
bGllbnQgPSAwOworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9TU0xTZXJ2
ZXIgPSAxOworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9TU0xTZXJ2ZXJX
aXRoU3RlcFVwID0gMjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IENFUlRfVVNBR0VfU1NM
Q0EgPSAzOworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9FbWFpbFNpZ25l
ciA9IDQ7CisKKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBDRVJUX1VTQUdFX0VtYWlsUmVjaXBp
ZW50ID0gNTsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IENFUlRfVVNBR0VfT2JqZWN0U2ln
bmVyID0gNjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IENFUlRfVVNBR0VfVXNlckNlcnRJ
bXBvcnQgPSA3OworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9WZXJpZnlD
QSA9IDg7CisKKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBDRVJUX1VTQUdFX1Byb3RlY3RlZE9i
amVjdFNpZ25lciA9IDk7CisKKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBDRVJUX1VTQUdFX1N0
YXR1c1Jlc3BvbmRlciA9IDEwOworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FH
RV9BbnlDQSA9IDExOworCisJcHVibGljIGludCBHZXRDaGFpbihpbnQgLypsb25nKi9bXSBfcmV0
dmFsKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9J
RCArIDIxLCBnZXRBZGRyZXNzKCksIF9yZXR2YWwpOworCX0KKworCXB1YmxpYyBpbnQgR2V0VXNh
Z2VzQXJyYXkoaW50IGlnbm9yZU9jc3AsIGludFtdIHZlcmlmaWVkLCBpbnRbXSBjb3VudCwgaW50
IC8qbG9uZyovW10gdXNhZ2VzKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0
cy5MQVNUX01FVEhPRF9JRCArIDIyLCBnZXRBZGRyZXNzKCksIGlnbm9yZU9jc3AsIHZlcmlmaWVk
LCBjb3VudCwgdXNhZ2VzKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldFVzYWdlc1N0cmluZyhpbnQg
aWdub3JlT2NzcCwgaW50W10gdmVyaWZpZWQsIGludCAvKmxvbmcqLyB1c2FnZXMpIHsKKwkJcmV0
dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMjMsIGdldEFk
ZHJlc3MoKSwgaWdub3JlT2NzcCwgdmVyaWZpZWQsIHVzYWdlcyk7CisJfQorCisJcHVibGljIGlu
dCBWZXJpZnlGb3JVc2FnZShpbnQgdXNhZ2UsIGludFtdIF9yZXR2YWwpIHsKKwkJcmV0dXJuIFhQ
Q09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMjQsIGdldEFkZHJlc3Mo
KSwgdXNhZ2UsIF9yZXR2YWwpOworCX0KKworCXB1YmxpYyBpbnQgR2V0QVNOMVN0cnVjdHVyZShp
bnQgLypsb25nKi9bXSBhQVNOMVN0cnVjdHVyZSkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwo
bnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAyNSwgZ2V0QWRkcmVzcygpLCBhQVNOMVN0cnVj
dHVyZSk7CisJfQorCisJcHVibGljIGludCBHZXRSYXdERVIoaW50W10gbGVuZ3RoLCBpbnQgLyps
b25nKi9bXSBkYXRhKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNU
X01FVEhPRF9JRCArIDI2LCBnZXRBZGRyZXNzKCksIGxlbmd0aCwgZGF0YSk7CisJfQorCisJcHVi
bGljIGludCBFcXVhbHMoaW50IC8qbG9uZyovIG90aGVyLCBpbnRbXSBfcmV0dmFsKSB7CisJCXJl
dHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDI3LCBnZXRB
ZGRyZXNzKCksIG90aGVyLCBfcmV0dmFsKTsKKwl9Cit9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2Yg
ZmlsZQpJbmRleDogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2lu
dGVybmFsL21vemlsbGEvbnNJQmFkQ2VydExpc3RlbmVyMi5qYXZhCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZp
bGU6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9t
b3ppbGxhL25zSUJhZENlcnRMaXN0ZW5lcjIuamF2YQpkaWZmIC1OIEVjbGlwc2UgU1dUIE1vemls
bGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSUJhZENlcnRMaXN0
ZW5lcjIuamF2YQotLS0gL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDAKKysrIEVj
bGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxh
L25zSUJhZENlcnRMaXN0ZW5lcjIuamF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwCkBAIC0w
LDAgKzEsNDcgQEAKKy8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioKKyAqIFZlcnNp
b246IE1QTCAxLjEKKyAqCisgKiBUaGUgY29udGVudHMgb2YgdGhpcyBmaWxlIGFyZSBzdWJqZWN0
IHRvIHRoZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24KKyAqIDEuMSAodGhlICJMaWNl
bnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0
aAorICogdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBh
dAorICogaHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwvCisgKgorICogU29mdHdhcmUgZGlzdHJp
YnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBiYXNp
cywKKyAqIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt
cGxpZWQuIFNlZSB0aGUgTGljZW5zZQorICogZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zl
cm5pbmcgcmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUKKyAqIExpY2Vuc2UuCisgKgor
ICogVGhlIE9yaWdpbmFsIENvZGUgaXMgTW96aWxsYSBDb21tdW5pY2F0b3IgY2xpZW50IGNvZGUs
IHJlbGVhc2VkIE1hcmNoIDMxLCAxOTk4LgorICoKKyAqIFRoZSBJbml0aWFsIERldmVsb3BlciBv
ZiB0aGUgT3JpZ2luYWwgQ29kZSBpcworICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9y
YXRpb24uCisgKiBQb3J0aW9ucyBjcmVhdGVkIGJ5IE5ldHNjYXBlIGFyZSBDb3B5cmlnaHQgKEMp
IDE5OTgtMTk5OQorICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24uICBBbGwg
UmlnaHRzIFJlc2VydmVkLgorICoKKyAqIENvbnRyaWJ1dG9yKHMpOgorICoKKyAqIElCTQorICog
LSAgQmluZGluZyB0byBwZXJtaXQgaW50ZXJmYWNpbmcgYmV0d2VlbiBNb3ppbGxhIGFuZCBTV1QK
KyAqIC0gIENvcHlyaWdodCAoQykgMjAwMywgMjAwOCBJQk0gQ29ycC4gIEFsbCBSaWdodHMgUmVz
ZXJ2ZWQuCisgKgorICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi8KK3BhY2thZ2Ug
b3JnLmVjbGlwc2Uuc3d0LmludGVybmFsLm1vemlsbGE7CisKK3B1YmxpYyBjbGFzcyBuc0lCYWRD
ZXJ0TGlzdGVuZXIyIGV4dGVuZHMgbnNJU3VwcG9ydHMgeworCisJc3RhdGljIGZpbmFsIGludCBM
QVNUX01FVEhPRF9JRCA9IG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMTsKKworCXB1Ymxp
YyBzdGF0aWMgZmluYWwgU3RyaW5nIE5TX0lCQURDRVJUTElTVEVORVIyX0lJRF9TVFIgPQorCQki
MmMzZDI2OGMtYWQ4Mi00OWYzLTk5YWEtZTlmZmRkZDdhMGRjIjsKKworCXB1YmxpYyBzdGF0aWMg
ZmluYWwgbnNJRCBOU19JQkFEQ0VSVExJU1RFTkVSMl9JSUQgPQorCQluZXcgbnNJRChOU19JQkFE
Q0VSVExJU1RFTkVSMl9JSURfU1RSKTsKKworCXB1YmxpYyAgbnNJQmFkQ2VydExpc3RlbmVyMihp
bnQgLypsb25nKi8gYWRkcmVzcykgeworCQlzdXBlcihhZGRyZXNzKTsKKwl9CisKKwlwdWJsaWMg
aW50IE5vdGlmeUNlcnRQcm9ibGVtKGludCAvKmxvbmcqLyBzb2NrZXRJbmZvLCBpbnQgLypsb25n
Ki8gc3RhdHVzLCBpbnQgLypsb25nKi8gdGFyZ2V0U2l0ZSwgaW50W10gX3JldHZhbCkgeworCQly
ZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAxLCBnZXRB
ZGRyZXNzKCksIHNvY2tldEluZm8sIHN0YXR1cywgdGFyZ2V0U2l0ZSwgX3JldHZhbCk7CisJfQor
fQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUK
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>145030</attachid>
            <date>2009-08-19 16:07:00 -0400</date>
            <delta_ts>2009-08-19 16:07:04 -0400</delta_ts>
            <desc>patch for 3.5 stream, fixes xulrunner 1.9.0.x and 1.9.1.x</desc>
            <filename>patch-3.5</filename>
            <type>text/plain</type>
            <size>88701</size>
            <attacher name="Grant Gayed">grant_gayed</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMAojUCBvcmcuZWNsaXBzZS5zd3QKSW5kZXg6
IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93c2VyL1Byb21w
dERpYWxvZy5qYXZhCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVj
bGlwc2Uuc3d0L0VjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93
c2VyL1Byb21wdERpYWxvZy5qYXZhLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjEwCmRpZmYgLXUg
LXIxLjEwIFByb21wdERpYWxvZy5qYXZhCi0tLSBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9v
cmcvZWNsaXBzZS9zd3QvYnJvd3Nlci9Qcm9tcHREaWFsb2cuamF2YQkyMCBOb3YgMjAwNyAyMDox
MDo0NSAtMDAwMAkxLjEwCisrKyBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBz
ZS9zd3QvYnJvd3Nlci9Qcm9tcHREaWFsb2cuamF2YQkxOSBBdWcgMjAwOSAxOTo1NzoyMyAtMDAw
MApAQCAtMTEsNiArMTEsMTAgQEAKIHBhY2thZ2Ugb3JnLmVjbGlwc2Uuc3d0LmJyb3dzZXI7CiAK
IGltcG9ydCBvcmcuZWNsaXBzZS5zd3QuKjsKK2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuY3VzdG9t
Lio7CitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmdyYXBoaWNzLio7CitpbXBvcnQgb3JnLmVjbGlw
c2Uuc3d0LmludGVybmFsLkNvbXBhdGliaWxpdHk7CitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0Lmlu
dGVybmFsLm1vemlsbGEuKjsKIGltcG9ydCBvcmcuZWNsaXBzZS5zd3QubGF5b3V0Lio7CiBpbXBv
cnQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuKjsKIApAQCAtNjksNiArNzMsMTQwIEBACiAJCX0K
IAl9CiAKKwlib29sZWFuIGludmFsaWRDZXJ0KGZpbmFsIEJyb3dzZXIgYnJvd3NlciwgU3RyaW5n
IG1lc3NhZ2UsIFN0cmluZ1tdIHByb2JsZW1zLCBmaW5hbCBuc0lYNTA5Q2VydCBjZXJ0KSB7CisJ
CVNoZWxsIHBhcmVudCA9IGdldFBhcmVudCgpOworCQlEaXNwbGF5IGRpc3BsYXkgPSBwYXJlbnQu
Z2V0RGlzcGxheSgpOworCQlNb25pdG9yIG1vbml0b3IgPSBwYXJlbnQuZ2V0TW9uaXRvcigpOwor
CQlpbnQgbWF4V2lkdGggPSBtb25pdG9yLmdldEJvdW5kcygpLndpZHRoICogMiAvIDM7CisJCWZp
bmFsIFNoZWxsIHNoZWxsID0gbmV3IFNoZWxsKHBhcmVudCwgU1dULkRJQUxPR19UUklNIHwgU1dU
LkFQUExJQ0FUSU9OX01PREFMKTsKKwkJc2hlbGwuc2V0VGV4dChDb21wYXRpYmlsaXR5LmdldE1l
c3NhZ2UoIlNXVF9JbnZhbGlkQ2VydF9UaXRsZSIpKTsgLy8kTk9OLU5MUy0xJAorCQlzaGVsbC5z
ZXRMYXlvdXQobmV3IEdyaWRMYXlvdXQoKSk7CisKKwkJQ29tcG9zaXRlIG1lc3NhZ2VDb21wb3Np
dGUgPSBuZXcgQ29tcG9zaXRlKHNoZWxsLCBTV1QuTk9ORSk7CisJCW1lc3NhZ2VDb21wb3NpdGUu
c2V0TGF5b3V0KG5ldyBHcmlkTGF5b3V0KDIsIGZhbHNlKSk7CisJCUltYWdlIGltYWdlID0gZGlz
cGxheS5nZXRTeXN0ZW1JbWFnZShTV1QuSUNPTl9XQVJOSU5HKTsKKwkJbmV3IExhYmVsKG1lc3Nh
Z2VDb21wb3NpdGUsIFNXVC5OT05FKS5zZXRJbWFnZShpbWFnZSk7CisJCVRleHQgdGV4dCA9IG5l
dyBUZXh0KG1lc3NhZ2VDb21wb3NpdGUsIFNXVC5XUkFQKTsKKwkJdGV4dC5zZXRMYXlvdXREYXRh
KG5ldyBHcmlkRGF0YShTV1QuRklMTCwgU1dULkNFTlRFUiwgdHJ1ZSwgZmFsc2UpKTsKKwkJdGV4
dC5zZXRFZGl0YWJsZShmYWxzZSk7CisJCXRleHQuc2V0QmFja2dyb3VuZChzaGVsbC5nZXRCYWNr
Z3JvdW5kKCkpOworCQl0ZXh0LnNldFRleHQobWVzc2FnZSk7CisJCWludCB3aWR0aCA9IG1lc3Nh
Z2VDb21wb3NpdGUuY29tcHV0ZVNpemUoU1dULkRFRkFVTFQsIFNXVC5ERUZBVUxUKS54OworCQlH
cmlkRGF0YSBkYXRhID0gbmV3IEdyaWREYXRhKCk7CisJCWRhdGEud2lkdGhIaW50ID0gTWF0aC5t
aW4od2lkdGgsIG1heFdpZHRoKTsKKwkJZGF0YS5ob3Jpem9udGFsQWxpZ25tZW50ID0gR3JpZERh
dGEuRklMTDsKKwkJZGF0YS5ncmFiRXhjZXNzSG9yaXpvbnRhbFNwYWNlID0gdHJ1ZTsKKwkJbWVz
c2FnZUNvbXBvc2l0ZS5zZXRMYXlvdXREYXRhKGRhdGEpOworCisJCVN0eWxlZFRleHQgcHJvYmxl
bXNUZXh0ID0gbmV3IFN0eWxlZFRleHQoc2hlbGwsIFNXVC5XUkFQKTsKKwkJcHJvYmxlbXNUZXh0
LnNldE1hcmdpbnMoMzAsIDAsIDMwLCAwKTsKKwkJcHJvYmxlbXNUZXh0LnNldEVkaXRhYmxlKGZh
bHNlKTsKKwkJcHJvYmxlbXNUZXh0LnNldEJhY2tncm91bmQoc2hlbGwuZ2V0QmFja2dyb3VuZCgp
KTsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBwcm9ibGVtcy5sZW5ndGg7IGkrKykgeworCQkJcHJv
YmxlbXNUZXh0LmFwcGVuZChwcm9ibGVtc1tpXSArICdcbicpOworCQl9CisJCVN0eWxlUmFuZ2Ug
c3R5bGUgPSBuZXcgU3R5bGVSYW5nZSgpOworCQlzdHlsZS5tZXRyaWNzID0gbmV3IEdseXBoTWV0
cmljcygwLCAwLCAzMCk7CisJCUJ1bGxldCBidWxsZXQwID0gbmV3IEJ1bGxldCAoc3R5bGUpOwor
CQlwcm9ibGVtc1RleHQuc2V0TGluZUJ1bGxldCgwLCBwcm9ibGVtcy5sZW5ndGgsIGJ1bGxldDAp
OworCQl3aWR0aCA9IHByb2JsZW1zVGV4dC5jb21wdXRlU2l6ZShTV1QuREVGQVVMVCwgU1dULkRF
RkFVTFQpLng7CisJCWRhdGEgPSBuZXcgR3JpZERhdGEoKTsKKwkJZGF0YS53aWR0aEhpbnQgPSBN
YXRoLm1pbih3aWR0aCwgbWF4V2lkdGgpOworCQlkYXRhLmhvcml6b250YWxBbGlnbm1lbnQgPSBH
cmlkRGF0YS5GSUxMOworCQlkYXRhLmdyYWJFeGNlc3NIb3Jpem9udGFsU3BhY2UgPSB0cnVlOwor
CQlwcm9ibGVtc1RleHQuc2V0TGF5b3V0RGF0YShkYXRhKTsKKworCQl0ZXh0ID0gbmV3IFRleHQo
c2hlbGwsIFNXVC5TSU5HTEUpOworCQl0ZXh0LnNldEVkaXRhYmxlKGZhbHNlKTsKKwkJdGV4dC5z
ZXRCYWNrZ3JvdW5kKHNoZWxsLmdldEJhY2tncm91bmQoKSk7CisJCXRleHQuc2V0VGV4dChDb21w
YXRpYmlsaXR5LmdldE1lc3NhZ2UoIlNXVF9JbnZhbGlkQ2VydF9Db25uZWN0IikpOyAvLyROT04t
TkxTLTEkCisKKwkJbmV3IExhYmVsKHNoZWxsLCBTV1QuTk9ORSk7IC8qIHZlcnRpY2FsIHNwYWNl
ciAqLworCisJCS8qCisJCSogQ3JlYXRlIGEgbG9jYWwgaW52aXNpYmxlIEJyb3dzZXIgdG8gYmUg
cGFzc2VkIHRvIHRoZSBWaWV3Q2VydCBjYWxsLAorCQkqIHNvIHRoYXQgdGhpcyBwcm9tcHRlciBj
YW4gYmUgdGhlIGNlcnRpZmljYXRlIHZpZXcgZGlhbG9nJ3MgcGFyZW50LgorCQkqLworCQlmaW5h
bCBCcm93c2VyIGxvY2FsQnJvd3NlciA9IG5ldyBCcm93c2VyKHNoZWxsLCBicm93c2VyLmdldFN0
eWxlKCkpOworCQlkYXRhID0gbmV3IEdyaWREYXRhKCk7CisJCWRhdGEuZXhjbHVkZSA9IHRydWU7
CisJCWxvY2FsQnJvd3Nlci5zZXRMYXlvdXREYXRhKGRhdGEpOworCisJCUNvbXBvc2l0ZSBidXR0
b25zQ29tcG9zaXRlID0gbmV3IENvbXBvc2l0ZShzaGVsbCwgU1dULk5PTkUpOworCQlidXR0b25z
Q29tcG9zaXRlLnNldExheW91dChuZXcgR3JpZExheW91dCgzLCB0cnVlKSk7CisJCWJ1dHRvbnND
b21wb3NpdGUuc2V0TGF5b3V0RGF0YShuZXcgR3JpZERhdGEoU1dULkNFTlRFUiwgU1dULkNFTlRF
UiwgZmFsc2UsIGZhbHNlKSk7CisKKwkJQnV0dG9uIHZpZXdDZXJ0QnV0dG9uID0gbmV3IEJ1dHRv
bihidXR0b25zQ29tcG9zaXRlLCBTV1QuUFVTSCk7CisJCXZpZXdDZXJ0QnV0dG9uLnNldExheW91
dERhdGEobmV3IEdyaWREYXRhKFNXVC5GSUxMLCBTV1QuRklMTCwgZmFsc2UsIGZhbHNlKSk7CisJ
CXZpZXdDZXJ0QnV0dG9uLnNldFRleHQoQ29tcGF0aWJpbGl0eS5nZXRNZXNzYWdlKCJWaWV3IENl
cnRpZmljYXRlIikpOyAvLyROT04tTkxTLTEkCisJCXZpZXdDZXJ0QnV0dG9uLmFkZExpc3RlbmVy
KFNXVC5TZWxlY3Rpb24sIG5ldyBMaXN0ZW5lcigpIHsKKwkJCXB1YmxpYyB2b2lkIGhhbmRsZUV2
ZW50KEV2ZW50IGV2ZW50KSB7CisJCQkJaW50IC8qbG9uZyovW10gcmVzdWx0ID0gbmV3IGludCAv
KmxvbmcqL1sxXTsKKwkJCQlpbnQgcmMgPSBYUENPTS5OU19HZXRTZXJ2aWNlTWFuYWdlciAocmVz
dWx0KTsKKwkJCQlpZiAocmMgIT0gWFBDT00uTlNfT0spIE1vemlsbGEuZXJyb3IgKHJjKTsKKwkJ
CQlpZiAocmVzdWx0WzBdID09IDApIE1vemlsbGEuZXJyb3IgKFhQQ09NLk5TX05PSU5URVJGQUNF
KTsKKworCQkJCW5zSVNlcnZpY2VNYW5hZ2VyIHNlcnZpY2VNYW5hZ2VyID0gbmV3IG5zSVNlcnZp
Y2VNYW5hZ2VyKHJlc3VsdFswXSk7CisJCQkJcmVzdWx0WzBdID0gMDsKKwkJCQlieXRlW10gYUNv
bnRyYWN0SUQgPSBNb3ppbGxhRGVsZWdhdGUud2NzVG9NYmNzIChudWxsLCBYUENPTS5OU19DRVJU
SUZJQ0FURURJQUxPR1NfQ09OVFJBQ1RJRCwgdHJ1ZSk7CisJCQkJcmMgPSBzZXJ2aWNlTWFuYWdl
ci5HZXRTZXJ2aWNlQnlDb250cmFjdElEIChhQ29udHJhY3RJRCwgbnNJQ2VydGlmaWNhdGVEaWFs
b2dzLk5TX0lDRVJUSUZJQ0FURURJQUxPR1NfSUlELCByZXN1bHQpOworCQkJCWlmIChyYyAhPSBY
UENPTS5OU19PSykgTW96aWxsYS5lcnJvciAocmMpOworCQkJCWlmIChyZXN1bHRbMF0gPT0gMCkg
TW96aWxsYS5lcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOworCQkJCXNlcnZpY2VNYW5hZ2Vy
LlJlbGVhc2UoKTsKKwkJCQkKKwkJCQluc0lDZXJ0aWZpY2F0ZURpYWxvZ3MgZGlhbG9ncyA9IG5l
dyBuc0lDZXJ0aWZpY2F0ZURpYWxvZ3MocmVzdWx0WzBdKTsKKwkJCQlyZXN1bHRbMF0gPSAwOwor
CQkJCQorCQkJCS8qCisJCQkJKiBCdWcgaW4gTW96aWxsYS4gIFRoZSBjZXJ0aWZpY2F0ZSB2aWV3
ZXIgZGlhbG9nIGRvZXMgbm90IHNob3cgaXRzIGNvbnRlbnQgd2hlbgorCQkJCSogb3BlbmVkLiAg
VGhlIHdvcmthcm91bmQgaXMgdG8gcGVyaW9kaWNhbGx5IHdha2UgdXAgdGhlIFVJIHRocmVhZC4K
KwkJCQkqLworCQkJCVJ1bm5hYmxlIHJ1bm5hYmxlID0gbmV3IFJ1bm5hYmxlKCkgeworCQkJCQlw
dWJsaWMgdm9pZCBydW4oKSB7CisJCQkJCQlicm93c2VyLmdldERpc3BsYXkoKS50aW1lckV4ZWMo
MTAwMCwgdGhpcyk7CisJCQkJCX0KKwkJCQl9OworCQkJCXJ1bm5hYmxlLnJ1bigpOworCisJCQkJ
cmMgPSAoKE1vemlsbGEpbG9jYWxCcm93c2VyLndlYkJyb3dzZXIpLndlYkJyb3dzZXIuR2V0Q29u
dGVudERPTVdpbmRvdyhyZXN1bHQpOworCQkJCWlmIChyYyAhPSBYUENPTS5OU19PSykgTW96aWxs
YS5lcnJvciAocmMpOworCQkJCWlmIChyZXN1bHRbMF0gPT0gMCkgTW96aWxsYS5lcnJvciAoWFBD
T00uTlNfTk9JTlRFUkZBQ0UpOworCQkJCW5zSURPTVdpbmRvdyB3aW5kb3cgPSBuZXcgbnNJRE9N
V2luZG93KHJlc3VsdFswXSk7CisJCQkJcmVzdWx0WzBdID0gMDsKKworCQkJCXJjID0gZGlhbG9n
cy5WaWV3Q2VydCh3aW5kb3cuZ2V0QWRkcmVzcygpLCBjZXJ0LmdldEFkZHJlc3MoKSk7CisJCQkJ
YnJvd3Nlci5nZXREaXNwbGF5KCkudGltZXJFeGVjKC0xLCBydW5uYWJsZSk7CisJCQkJd2luZG93
LlJlbGVhc2UoKTsKKwkJCQlkaWFsb2dzLlJlbGVhc2UoKTsKKwkJCX0KKwkJfSk7CisKKwkJZmlu
YWwgQnV0dG9uIG9rQnV0dG9uID0gbmV3IEJ1dHRvbihidXR0b25zQ29tcG9zaXRlLCBTV1QuUFVT
SCk7CisJCW9rQnV0dG9uLnNldExheW91dERhdGEobmV3IEdyaWREYXRhKFNXVC5GSUxMLCBTV1Qu
RklMTCwgZmFsc2UsIGZhbHNlKSk7CisJCW9rQnV0dG9uLnNldFRleHQoQ29tcGF0aWJpbGl0eS5n
ZXRNZXNzYWdlKCJTV1RfT0siKSk7IC8vJE5PTi1OTFMtMSQKKwkJQnV0dG9uIGNhbmNlbEJ1dHRv
biA9IG5ldyBCdXR0b24oYnV0dG9uc0NvbXBvc2l0ZSwgU1dULlBVU0gpOworCQljYW5jZWxCdXR0
b24uc2V0TGF5b3V0RGF0YShuZXcgR3JpZERhdGEoU1dULkZJTEwsIFNXVC5GSUxMLCBmYWxzZSwg
ZmFsc2UpKTsKKwkJY2FuY2VsQnV0dG9uLnNldFRleHQoQ29tcGF0aWJpbGl0eS5nZXRNZXNzYWdl
KCJTV1RfQ2FuY2VsIikpOyAvLyROT04tTkxTLTEkCisJCWZpbmFsIGJvb2xlYW5bXSByZXN1bHQg
PSBuZXcgYm9vbGVhblsxXTsKKwkJTGlzdGVuZXIgbGlzdGVuZXIgPSBuZXcgTGlzdGVuZXIoKSB7
CisJCQlwdWJsaWMgdm9pZCBoYW5kbGVFdmVudChFdmVudCBldmVudCkgeworCQkJCXNoZWxsLmRp
c3Bvc2UoKTsKKwkJCQlyZXN1bHRbMF0gPSBldmVudC53aWRnZXQgPT0gb2tCdXR0b247CisJCQl9
CisJCX07CisJCW9rQnV0dG9uLmFkZExpc3RlbmVyKFNXVC5TZWxlY3Rpb24sIGxpc3RlbmVyKTsK
KwkJY2FuY2VsQnV0dG9uLmFkZExpc3RlbmVyKFNXVC5TZWxlY3Rpb24sIGxpc3RlbmVyKTsKKwor
CQljYW5jZWxCdXR0b24uc2V0Rm9jdXMoKTsKKwkJc2hlbGwuc2V0RGVmYXVsdEJ1dHRvbihjYW5j
ZWxCdXR0b24pOworCQlzaGVsbC5wYWNrKCk7CisJCXNoZWxsLm9wZW4oKTsKKwkJd2hpbGUgKCFz
aGVsbC5pc0Rpc3Bvc2VkKCkpIHsKKwkJCWlmICghZGlzcGxheS5yZWFkQW5kRGlzcGF0Y2goKSkg
ZGlzcGxheS5zbGVlcCgpOworCQl9CisJCXJldHVybiByZXN1bHRbMF07CisJfQorCiAJdm9pZCBj
b25maXJtRXgoU3RyaW5nIHRpdGxlLCBTdHJpbmcgdGV4dCwgU3RyaW5nIGNoZWNrLCBTdHJpbmcg
YnV0dG9uMCwgU3RyaW5nIGJ1dHRvbjEsIFN0cmluZyBidXR0b24yLCBpbnQgZGVmYXVsdEluZGV4
LCBmaW5hbCBpbnRbXSBjaGVja1ZhbHVlLCBmaW5hbCBpbnRbXSByZXN1bHQpIHsKIAkJU2hlbGwg
cGFyZW50ID0gZ2V0UGFyZW50KCk7CiAJCWZpbmFsIFNoZWxsIHNoZWxsID0gbmV3IFNoZWxsKHBh
cmVudCwgU1dULkRJQUxPR19UUklNIHwgU1dULkFQUExJQ0FUSU9OX01PREFMKTsKSW5kZXg6IEVj
bGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93c2VyL01vemlsbGEu
amF2YQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xpcHNlLnN3
dC9FY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nlci9Nb3pp
bGxhLmphdmEsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTMzLjQuMQpkaWZmIC11IC1yMS4xMzMu
NC4xIE1vemlsbGEuamF2YQotLS0gRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlw
c2Uvc3d0L2Jyb3dzZXIvTW96aWxsYS5qYXZhCTI3IEp1bCAyMDA5IDIwOjM1OjQ3IC0wMDAwCTEu
MTMzLjQuMQorKysgRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jy
b3dzZXIvTW96aWxsYS5qYXZhCTE5IEF1ZyAyMDA5IDE5OjU3OjIzIC0wMDAwCkBAIC00MSwxMSAr
NDEsMTIgQEAKIAlYUENPTU9iamVjdCB1cmlDb250ZW50TGlzdGVuZXI7CiAJWFBDT01PYmplY3Qg
dG9vbHRpcExpc3RlbmVyOwogCVhQQ09NT2JqZWN0IGRvbUV2ZW50TGlzdGVuZXI7CisJWFBDT01P
YmplY3QgYmFkQ2VydExpc3RlbmVyOwogCWludCBjaHJvbWVGbGFncyA9IG5zSVdlYkJyb3dzZXJD
aHJvbWUuQ0hST01FX0RFRkFVTFQ7CiAJaW50IHJlZkNvdW50LCBsYXN0S2V5Q29kZSwgbGFzdENo
YXJDb2RlLCBhdXRoQ291bnQ7CiAJaW50IC8qbG9uZyovIHJlcXVlc3Q7CiAJUG9pbnQgbG9jYXRp
b24sIHNpemU7Ci0JYm9vbGVhbiB2aXNpYmxlLCBpc0NoaWxkLCBpZ25vcmVEaXNwb3NlOworCWJv
b2xlYW4gdmlzaWJsZSwgaXNDaGlsZCwgaWdub3JlRGlzcG9zZSwgaXNSZXRyaWV2aW5nQmFkQ2Vy
dCwgaXNWaWV3aW5nRXJyb3JQYWdlOwogCVNoZWxsIHRpcCA9IG51bGw7CiAJTGlzdGVuZXIgbGlz
dGVuZXI7CiAJVmVjdG9yIHVuaG9va2VkRE9NV2luZG93cyA9IG5ldyBWZWN0b3IgKCk7CkBAIC01
NzksNiArNTgwLDEwIEBACiAJCQkJQy5mcmVlIChmdW5jdGlvbkxvYWQuZnVuY3Rpb24pOwogCQkJ
CUMuZnJlZSAoZnVuY3Rpb25Mb2FkLmZ1bmN0aW9uTmFtZSk7CiAJCQkJQy5mcmVlIChwdHIpOwor
CQkJCWlmIChmdW5jdGlvblB0ciA9PSAwKSB7CisgICAgICAgICAgICAJCWJyb3dzZXIuZGlzcG9z
ZSAoKTsKKyAgICAgICAgICAgIAkJZXJyb3IgKFhQQ09NLk5TX0VSUk9SX05VTExfUE9JTlRFUik7
CisJCQkJfQogCQkJCXJjID0gWFBDT00uQ2FsbCAoZnVuY3Rpb25QdHIsIGxvY2FsRmlsZS5nZXRB
ZGRyZXNzICgpLCBsb2NhbEZpbGUuZ2V0QWRkcmVzcyAoKSwgTG9jYXRpb25Qcm92aWRlci5nZXRB
ZGRyZXNzICgpLCAwLCAwKTsKIAkJCQlpZiAocmMgPT0gWFBDT00uTlNfT0spIHsKIAkJCQkJU3lz
dGVtLnNldFByb3BlcnR5IChYVUxSVU5ORVJfUEFUSCwgbW96aWxsYVBhdGgpOwpAQCAtNzg1LDYg
Kzc5MCwzNSBAQAogCQkJCWVycm9yIChyYyk7CiAJCQl9CiAJCQlvYnNlcnZlclNlcnZpY2UuUmVs
ZWFzZSAoKTsKKworCSAgICAgICAgaWYgKElzWFVMUnVubmVyKSB7CisJCQkJaW50IHNpemUgPSBY
UENPTS5uc0R5bmFtaWNGdW5jdGlvbkxvYWRfc2l6ZW9mICgpOworCQkJCS8qIGFsbG9jIG1lbW9y
eSBmb3IgdHdvIHN0cnVjdHMsIHRoZSBzZWNvbmQgaXMgZW1wdHkgdG8gc2lnbmlmeSB0aGUgZW5k
IG9mIHRoZSBsaXN0ICovCisJCQkJcHRyID0gQy5tYWxsb2MgKHNpemUgKiAyKTsKKwkJCQlDLm1l
bXNldCAocHRyLCAwLCBzaXplICogMik7CisJCQkJbnNEeW5hbWljRnVuY3Rpb25Mb2FkIGZ1bmN0
aW9uTG9hZCA9IG5ldyBuc0R5bmFtaWNGdW5jdGlvbkxvYWQgKCk7CisJCQkJYnl0ZVtdIGJ5dGVz
ID0gTW96aWxsYURlbGVnYXRlLndjc1RvTWJjcyAobnVsbCwgIlhSRV9Ob3RpZnlQcm9maWxlIiwg
dHJ1ZSk7IC8vJE5PTi1OTFMtMSQKKwkJCQlmdW5jdGlvbkxvYWQuZnVuY3Rpb25OYW1lID0gQy5t
YWxsb2MgKGJ5dGVzLmxlbmd0aCk7CisJCQkJQy5tZW1tb3ZlIChmdW5jdGlvbkxvYWQuZnVuY3Rp
b25OYW1lLCBieXRlcywgYnl0ZXMubGVuZ3RoKTsKKwkJCQlmdW5jdGlvbkxvYWQuZnVuY3Rpb24g
PSBDLm1hbGxvYyAoQy5QVFJfU0laRU9GKTsKKwkJCQlDLm1lbW1vdmUgKGZ1bmN0aW9uTG9hZC5m
dW5jdGlvbiwgbmV3IGludCAvKmxvbmcqL1tdIHswfSAsIEMuUFRSX1NJWkVPRik7CisJCQkJWFBD
T00ubWVtbW92ZSAocHRyLCBmdW5jdGlvbkxvYWQsIFhQQ09NLm5zRHluYW1pY0Z1bmN0aW9uTG9h
ZF9zaXplb2YgKCkpOworCQkJCVhQQ09NLlhQQ09NR2x1ZUxvYWRYVUxGdW5jdGlvbnMgKHB0cik7
CisJCQkJQy5tZW1tb3ZlIChyZXN1bHQsIGZ1bmN0aW9uTG9hZC5mdW5jdGlvbiwgQy5QVFJfU0la
RU9GKTsKKwkJCQlpbnQgLypsb25nKi8gZnVuY3Rpb25QdHIgPSByZXN1bHRbMF07CisJCQkJcmVz
dWx0WzBdID0gMDsKKwkJCQlDLmZyZWUgKGZ1bmN0aW9uTG9hZC5mdW5jdGlvbik7CisJCQkJQy5m
cmVlIChmdW5jdGlvbkxvYWQuZnVuY3Rpb25OYW1lKTsKKwkJCQlDLmZyZWUgKHB0cik7CisJCQkJ
LyogZnVuY3Rpb25QdHIgPT0gMCBmb3IgeHVscnVubmVyIDwgMS45ICovCisJCQkJaWYgKGZ1bmN0
aW9uUHRyICE9IDApIHsKKwkJCQkJcmMgPSBYUENPTS5DYWxsIChmdW5jdGlvblB0cik7CisJICAg
ICAgICAgICAgCWlmIChyYyAhPSBYUENPTS5OU19PSykgeworCSAgICAgICAgICAgIAkJYnJvd3Nl
ci5kaXNwb3NlICgpOworCSAgICAgICAgICAgIAkJZXJyb3IgKHJjKTsKKwkgICAgICAgICAgICAJ
fQorCQkJCX0KKwkgICAgICAgIH0KIAkJfQogCiAJCS8qCkBAIC0xNjIwLDYgKzE2NTQsMTMgQEAK
IAkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2QyIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0
dXJuIFJlbGVhc2UgKCk7fQogCQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDMgKGludCAvKmxv
bmcqL1tdIGFyZ3MpIHtyZXR1cm4gSGFuZGxlRXZlbnQgKGFyZ3NbMF0pO30KIAl9OworCisJYmFk
Q2VydExpc3RlbmVyID0gbmV3IFhQQ09NT2JqZWN0IChuZXcgaW50W10gezIsIDAsIDAsIDR9KSB7
CisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kMCAoaW50IC8qbG9uZyovW10gYXJncykge3Jl
dHVybiBRdWVyeUludGVyZmFjZSAoYXJnc1swXSwgYXJnc1sxXSk7fQorCQlwdWJsaWMgaW50IC8q
bG9uZyovIG1ldGhvZDEgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gQWRkUmVmICgpO30K
KwkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2QyIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0
dXJuIFJlbGVhc2UgKCk7fQorCQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDMgKGludCAvKmxv
bmcqL1tdIGFyZ3MpIHtyZXR1cm4gTm90aWZ5Q2VydFByb2JsZW0gKGFyZ3NbMF0sIGFyZ3NbMV0s
IGFyZ3NbMl0sIGFyZ3NbM10pO30KKwl9OwogfQogCiB2b2lkIGRlcmVnaXN0ZXJGdW5jdGlvbiAo
QnJvd3NlckZ1bmN0aW9uIGZ1bmN0aW9uKSB7CkBAIC0xNjc2LDYgKzE3MTcsMTAgQEAKIAkJZG9t
RXZlbnRMaXN0ZW5lci5kaXNwb3NlICgpOwogCQlkb21FdmVudExpc3RlbmVyID0gbnVsbDsKIAl9
CisJaWYgKGJhZENlcnRMaXN0ZW5lciAhPSBudWxsKSB7CisJCWJhZENlcnRMaXN0ZW5lci5kaXNw
b3NlICgpOworCQliYWRDZXJ0TGlzdGVuZXIgPSBudWxsOworCX0KIH0KIAogcHVibGljIGJvb2xl
YW4gZXhlY3V0ZSAoU3RyaW5nIHNjcmlwdCkgewpAQCAtMjUzNCw2ICsyNTc5LDExIEBACiAJCUFk
ZFJlZiAoKTsKIAkJcmV0dXJuIFhQQ09NLk5TX09LOwogCX0KKwlpZiAoZ3VpZC5FcXVhbHMgKG5z
SUJhZENlcnRMaXN0ZW5lcjIuTlNfSUJBRENFUlRMSVNURU5FUjJfSUlEKSkgeworCQlYUENPTS5t
ZW1tb3ZlIChwcHZPYmplY3QsIG5ldyBpbnQgLypsb25nKi9bXSB7YmFkQ2VydExpc3RlbmVyLmdl
dEFkZHJlc3MgKCl9LCBDLlBUUl9TSVpFT0YpOworCQlBZGRSZWYgKCk7CisJCXJldHVybiBYUENP
TS5OU19PSzsKKwl9CiAJWFBDT00ubWVtbW92ZSAocHB2T2JqZWN0LCBuZXcgaW50IC8qbG9uZyov
W10gezB9LCBDLlBUUl9TSVpFT0YpOwogCXJldHVybiBYUENPTS5OU19FUlJPUl9OT19JTlRFUkZB
Q0U7CiB9CkBAIC0yNTgzLDYgKzI2MzMsMjcgQEAKIGludCBPblN0YXRlQ2hhbmdlIChpbnQgLyps
b25nKi8gYVdlYlByb2dyZXNzLCBpbnQgLypsb25nKi8gYVJlcXVlc3QsIGludCBhU3RhdGVGbGFn
cywgaW50IGFTdGF0dXMpIHsKIAlpZiAoKGFTdGF0ZUZsYWdzICYgbnNJV2ViUHJvZ3Jlc3NMaXN0
ZW5lci5TVEFURV9JU19ET0NVTUVOVCkgPT0gMCkgcmV0dXJuIFhQQ09NLk5TX09LOwogCWlmICgo
YVN0YXRlRmxhZ3MgJiBuc0lXZWJQcm9ncmVzc0xpc3RlbmVyLlNUQVRFX1NUQVJUKSAhPSAwKSB7
CisJCWludCAvKmxvbmcqL1tdIHJlc3VsdCA9IG5ldyBpbnQgLypsb25nKi9bMV07CisKKwkJLyoK
KwkJKiBXaGVuIG5hdmlnYXRpbmcgdG8gYSBzaXRlIHRoYXQgaXMga25vd24gdG8gaGF2ZSBhIGJh
ZCBjZXJ0aWZpY2F0ZSwgcmVxdWVzdCBub3RpZmljYXRpb24KKwkJKiBjYWxsYmFja3Mgb24gdGhl
IGNoYW5uZWwgc28gdGhhdCBvdXIgbnNJQmFkQ2VydExpc3RlbmVyMiB3aWxsIGJlIGludm9rZWQu
CisJCSovCisJCWlmIChpc1JldHJpZXZpbmdCYWRDZXJ0KSB7CisJCQlpc1JldHJpZXZpbmdCYWRD
ZXJ0ID0gZmFsc2U7CisJCQluc0lSZXF1ZXN0IHJlcXVlc3QgPSBuZXcgbnNJUmVxdWVzdCAoYVJl
cXVlc3QpOworCQkJaW50IHJjID0gcmVxdWVzdC5RdWVyeUludGVyZmFjZSAobnNJQ2hhbm5lbC5O
U19JQ0hBTk5FTF9JSUQsIHJlc3VsdCk7CisJCQlpZiAocmMgIT0gWFBDT00uTlNfT0spIGVycm9y
IChyYyk7CisJCQlpZiAocmVzdWx0WzBdID09IDApIGVycm9yIChYUENPTS5OU19OT0lOVEVSRkFD
RSk7CisKKwkJCW5zSUNoYW5uZWwgY2hhbm5lbCA9IG5ldyBuc0lDaGFubmVsIChyZXN1bHRbMF0p
OworCQkJcmVzdWx0WzBdID0gMDsKKwkJCXJjID0gY2hhbm5lbC5TZXROb3RpZmljYXRpb25DYWxs
YmFja3MgKGludGVyZmFjZVJlcXVlc3Rvci5nZXRBZGRyZXNzICgpKTsKKwkJCWlmIChyYyAhPSBY
UENPTS5OU19PSykgZXJyb3IgKHJjKTsKKwkJCWNoYW5uZWwuUmVsZWFzZSAoKTsKKwkJCXJldHVy
biBYUENPTS5OU19PSzsKKwkJfQorCiAJCWlmIChyZXF1ZXN0ID09IDApIHJlcXVlc3QgPSBhUmVx
dWVzdDsKIAkJLyoKIAkJICogQWRkIHRoZSBwYWdlJ3MgbnNJRE9NV2luZG93IHRvIHRoZSBjb2xs
ZWN0aW9uIG9mIHdpbmRvd3MgdGhhdCB3aWxsCkBAIC0yNTkwLDcgKzI2NjEsNiBAQAogCQkgKiBw
cm9jZXNzLiAgVGhlc2UgbGlzdGVuZXJzIGNhbm5vdCBiZSBhZGRlZCB5ZXQgYmVjYXVzZSB0aGUK
IAkJICogbnNJRE9NV2luZG93IGlzIG5vdCByZWFkeSB0byB0YWtlIHRoZW0gYXQgdGhpcyBzdGFn
ZS4KIAkJICovCi0JCWludCAvKmxvbmcqL1tdIHJlc3VsdCA9IG5ldyBpbnQgLypsb25nKi9bMV07
CiAJCW5zSVdlYlByb2dyZXNzIHByb2dyZXNzID0gbmV3IG5zSVdlYlByb2dyZXNzIChhV2ViUHJv
Z3Jlc3MpOwogCQlpbnQgcmMgPSBwcm9ncmVzcy5HZXRET01XaW5kb3cgKHJlc3VsdCk7CiAJCWlm
IChyYyAhPSBYUENPTS5OU19PSykgZXJyb3IgKHJjKTsKQEAgLTMyNTcsNiArMzMyNyw3IEBACiAv
KiBuc0lVUklDb250ZW50TGlzdGVuZXIgKi8KIAogaW50IE9uU3RhcnRVUklPcGVuIChpbnQgLyps
b25nKi8gYVVSSSwgaW50IC8qbG9uZyovIHJldHZhbCkgeworCWlmIChpc1JldHJpZXZpbmdCYWRD
ZXJ0KSByZXR1cm4gWFBDT00uTlNfT0s7CiAJYXV0aENvdW50ID0gMDsKIAogCW5zSVVSSSBsb2Nh
dGlvbiA9IG5ldyBuc0lVUkkgKGFVUkkpOwpAQCAtMzI2OSw2ICszMzQwLDIxIEBACiAJWFBDT00u
bWVtbW92ZSAoZGVzdCwgYnVmZmVyLCBsZW5ndGgpOwogCVhQQ09NLm5zRW1iZWRDU3RyaW5nX2Rl
bGV0ZSAoYVNwZWMpOwogCVN0cmluZyB2YWx1ZSA9IG5ldyBTdHJpbmcgKGRlc3QpOworCisJLyoK
KwkqIE5hdmlnYXRpbmcgdG8gIi4uLmFib3V0Q2VydEVycm9yLnhodG1sIiwgb3IgdG8gImphdmFz
Y3JpcHQ6c2hvd1NlY3VyaXR5U2VjdGlvbigpIiB3aGVuCisJKiB0aGUgcGFnZSAibmV0RXJyb3Iu
eGh0bWwiIGlzIHNob3dpbmcsIGluZGljYXRlcyB0aGF0IHRoZSBsYXN0IGF0dGVtcHRlZCBwYWdl
IHZpZXcgaGFkCisJKiBhbiBpbnZhbGlkIGNlcnRpZmljYXRlLiAgV2hlbiB0aGlzIGhhcHBlbnMs
IHZldG8gdGhlIGN1cnJlbnQgbmF2aWdhdGUgYW5kIHJlLW5hdmlnYXRlCisJKiB0byB0aGUgcGFn
ZSB3aXRoIHRoZSBiYWQgY2VydGlmaWNhdGUgc28gdGhhdCBOb3RpZnlDZXJ0UHJvYmxlbSB3aWxs
IGJlIGludm9rZWQuCisJKi8KKwlpZiAodmFsdWUuaW5kZXhPZiAoImFib3V0Q2VydEVycm9yLnho
dG1sIikgIT0gLTEgfHwgKGlzVmlld2luZ0Vycm9yUGFnZSAmJiB2YWx1ZS5pbmRleE9mICgiamF2
YXNjcmlwdDpzaG93U2VjdXJpdHlTZWN0aW9uIikgIT0gLTEpKSB7IC8vJE5PTi1OTFMtMSQgLy8k
Tk9OLU5MUy0yJAorCQlYUENPTS5tZW1tb3ZlIChyZXR2YWwsIG5ldyBpbnRbXSB7MX0sIDQpOyAv
KiBQUkJvb2wgKi8KKwkJaXNSZXRyaWV2aW5nQmFkQ2VydCA9IHRydWU7CisJCXNldFVybCAobGFz
dE5hdmlnYXRlVVJMKTsKKwkJcmV0dXJuIFhQQ09NLk5TX09LOworCX0KKwlpc1ZpZXdpbmdFcnJv
clBhZ2UgPSB2YWx1ZS5pbmRleE9mICgibmV0RXJyb3IueGh0bWwiKSAhPSAtMTsgLy8kTk9OLU5M
Uy0xJAorCiAJYm9vbGVhbiBkb2l0ID0gdHJ1ZTsKIAlpZiAocmVxdWVzdCA9PSAwKSB7CiAJCS8q
IApAQCAtMzMwOCw3ICszMzk0LDcgQEAKIAkJCQkJaWYgKHJjICE9IFhQQ09NLk5TX09LKSBlcnJv
ciAocmMpOwogCQkJCQlzZXR1cC5SZWxlYXNlICgpOwogCQkJCX0KLQkJCQlsYXN0TmF2aWdhdGVV
UkwgPSB2YWx1ZTsKKwkJCQlpZiAoIWlzVmlld2luZ0Vycm9yUGFnZSkgbGFzdE5hdmlnYXRlVVJM
ID0gdmFsdWU7CiAJCQl9CiAJCX0KIAl9CkBAIC0zNzg3LDQgKzM4NzMsMTUyIEBACiAJfQogCXJl
dHVybiBYUENPTS5OU19PSzsKIH0KKworLyogbnNJQmFkQ2VydExpc3RlbmVyMiAqLworCitpbnQg
Tm90aWZ5Q2VydFByb2JsZW0gKGludCAvKmxvbmcqLyBzb2NrZXRJbmZvLCBpbnQgLypsb25nKi8g
c3RhdHVzLCBpbnQgLypsb25nKi8gdGFyZ2V0U2l0ZSwgaW50IC8qbG9uZyovIF9zdXBwcmVzc0Vy
cm9yKSB7CisJLyogZGV0ZXJtaW5lIHRoZSBob3N0IG5hbWUgYW5kIHBvcnQgKi8KKwlpbnQgbGVu
Z3RoID0gWFBDT00ubnNFbWJlZENTdHJpbmdfTGVuZ3RoICh0YXJnZXRTaXRlKTsKKwlpbnQgLyps
b25nKi8gYnVmZmVyID0gWFBDT00ubnNFbWJlZENTdHJpbmdfZ2V0ICh0YXJnZXRTaXRlKTsKKwli
eXRlW10gZGVzdCA9IG5ldyBieXRlW2xlbmd0aF07CisJWFBDT00ubWVtbW92ZSAoZGVzdCwgYnVm
ZmVyLCBsZW5ndGgpOworCWZpbmFsIFN0cmluZyB1cmxQb3J0ID0gbmV3IFN0cmluZyAoZGVzdCk7
CisJaW50IGluZGV4ID0gdXJsUG9ydC5pbmRleE9mICgnOicpOworCWZpbmFsIFN0cmluZyBob3N0
ID0gdXJsUG9ydC5zdWJzdHJpbmcgKDAsaW5kZXgpOworCWZpbmFsIGludCBwb3J0ID0gSW50ZWdl
ci52YWx1ZU9mICh1cmxQb3J0LnN1YnN0cmluZyAoaW5kZXggKyAxKSkuaW50VmFsdWUgKCk7CisK
KwkvKiBjcmVhdGUgdGV4dCBkZXNjcmlwdGlvbnMgb2YgdGhlIGNlcnRpZmljYXRlIHByb2JsZW0o
cykgKi8KKworCWludCAvKmxvbmcqL1tdIHJlc3VsdCA9IG5ldyBpbnQgLypsb25nKi9bMV07CisJ
bnNJU3VwcG9ydHMgc3VwcG9ydHMgPSBuZXcgbnNJU3VwcG9ydHMgKHN0YXR1cyk7CisJaW50IHJj
ID0gc3VwcG9ydHMuUXVlcnlJbnRlcmZhY2UgKG5zSVNTTFN0YXR1cy5OU19JU1NMU1RBVFVTX0lJ
RCwgcmVzdWx0KTsKKwlpZiAocmMgIT0gWFBDT00uTlNfT0spIGVycm9yIChyYyk7CisJaWYgKHJl
c3VsdFswXSA9PSAwKSBlcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOworCisJbnNJU1NMU3Rh
dHVzIHNzbFN0YXR1cyA9IG5ldyBuc0lTU0xTdGF0dXMgKHJlc3VsdFswXSk7CisJcmVzdWx0WzBd
ID0gMDsKKwlyYyA9IHNzbFN0YXR1cy5HZXRTZXJ2ZXJDZXJ0IChyZXN1bHQpOworCWlmIChyYyAh
PSBYUENPTS5OU19PSykgZXJyb3IgKHJjKTsKKwlpZiAocmVzdWx0WzBdID09IDApIGVycm9yIChY
UENPTS5OU19FUlJPUl9OVUxMX1BPSU5URVIpOworCisJZmluYWwgbnNJWDUwOUNlcnQgY2VydCA9
IG5ldyBuc0lYNTA5Q2VydCAocmVzdWx0WzBdKTsKKwlyZXN1bHRbMF0gPSAwOworCVN0cmluZ1td
IHByb2JsZW1zID0gbmV3IFN0cmluZ1szXTsKKwlpbnQgcHJvYmxlbUNvdW50ID0gMCwgZmxhZ3Mg
PSAwOworCWludFtdIGludFJlc3VsdCA9IG5ldyBpbnRbMV07CisKKwlyYyA9IHNzbFN0YXR1cy5H
ZXRJc0RvbWFpbk1pc21hdGNoIChpbnRSZXN1bHQpOworCWlmIChpbnRSZXN1bHRbMF0gIT0gMCkg
eworCQlpbnQgLypsb25nKi8gcHRyID0gWFBDT00ubnNFbWJlZFN0cmluZ19uZXcgKCk7CisJCXJj
ID0gY2VydC5HZXRDb21tb25OYW1lIChwdHIpOworCQlpZiAocmMgIT0gWFBDT00uTlNfT0spIFNX
VC5lcnJvciAocmMpOworCQlsZW5ndGggPSBYUENPTS5uc0VtYmVkU3RyaW5nX0xlbmd0aCAocHRy
KTsKKwkJYnVmZmVyID0gWFBDT00ubnNFbWJlZFN0cmluZ19nZXQgKHB0cik7CisJCWNoYXJbXSBj
aGFycyA9IG5ldyBjaGFyW2xlbmd0aF07CisJCVhQQ09NLm1lbW1vdmUgKGNoYXJzLCBidWZmZXIs
IGxlbmd0aCAqIDIpOworCQlTdHJpbmcgbmFtZSA9IG5ldyBTdHJpbmcgKGNoYXJzKTsKKwkJcHJv
YmxlbXNbcHJvYmxlbUNvdW50KytdID0gQ29tcGF0aWJpbGl0eS5nZXRNZXNzYWdlICgiU1dUX0lu
dmFsaWRDZXJ0X0ludmFsaWROYW1lIiwgbmV3IFN0cmluZ1tdIHtuYW1lfSk7IC8vJE5PTi1OTFMt
MSQKKwkJZmxhZ3MgfD0gbnNJQ2VydE92ZXJyaWRlU2VydmljZS5FUlJPUl9NSVNNQVRDSDsKKwkJ
WFBDT00ubnNFbWJlZFN0cmluZ19kZWxldGUgKHB0cik7CisJfQorCWludFJlc3VsdFswXSA9IDA7
CisKKwlyYyA9IHNzbFN0YXR1cy5HZXRJc05vdFZhbGlkQXRUaGlzVGltZSAoaW50UmVzdWx0KTsK
KwlpZiAoaW50UmVzdWx0WzBdICE9IDApIHsKKwkJcmMgPSBjZXJ0LkdldFZhbGlkaXR5IChyZXN1
bHQpOworCQlpZiAocmMgIT0gWFBDT00uTlNfT0spIFNXVC5lcnJvciAocmMpOworCQlpZiAocmVz
dWx0WzBdID09IDApIGVycm9yIChYUENPTS5OU19FUlJPUl9OVUxMX1BPSU5URVIpOworCisJCW5z
SVg1MDlDZXJ0VmFsaWRpdHkgdmFsaWRpdHkgPSBuZXcgbnNJWDUwOUNlcnRWYWxpZGl0eShyZXN1
bHRbMF0pOworCQlyZXN1bHRbMF0gPSAwOworCisJCWludCAvKmxvbmcqLyBwdHIgPSBYUENPTS5u
c0VtYmVkU3RyaW5nX25ldyAoKTsKKwkJcmMgPSB2YWxpZGl0eS5HZXROb3RCZWZvcmVHTVQgKHB0
cik7CisJCWlmIChyYyAhPSBYUENPTS5OU19PSykgU1dULmVycm9yIChyYyk7CisJCWxlbmd0aCA9
IFhQQ09NLm5zRW1iZWRTdHJpbmdfTGVuZ3RoIChwdHIpOworCQlidWZmZXIgPSBYUENPTS5uc0Vt
YmVkU3RyaW5nX2dldCAocHRyKTsKKwkJY2hhcltdIGNoYXJzID0gbmV3IGNoYXJbbGVuZ3RoXTsK
KwkJWFBDT00ubWVtbW92ZSAoY2hhcnMsIGJ1ZmZlciwgbGVuZ3RoICogMik7CisJCVN0cmluZyBu
b3RCZWZvcmUgPSBuZXcgU3RyaW5nIChjaGFycyk7CisJCVhQQ09NLm5zRW1iZWRTdHJpbmdfZGVs
ZXRlIChwdHIpOworCisJCXB0ciA9IFhQQ09NLm5zRW1iZWRTdHJpbmdfbmV3ICgpOworCQlyYyA9
IHZhbGlkaXR5LkdldE5vdEFmdGVyR01UIChwdHIpOworCQlpZiAocmMgIT0gWFBDT00uTlNfT0sp
IFNXVC5lcnJvciAocmMpOworCQlsZW5ndGggPSBYUENPTS5uc0VtYmVkU3RyaW5nX0xlbmd0aCAo
cHRyKTsKKwkJYnVmZmVyID0gWFBDT00ubnNFbWJlZFN0cmluZ19nZXQgKHB0cik7CisJCWNoYXJz
ID0gbmV3IGNoYXJbbGVuZ3RoXTsKKwkJWFBDT00ubWVtbW92ZSAoY2hhcnMsIGJ1ZmZlciwgbGVu
Z3RoICogMik7CisJCVN0cmluZyBub3RBZnRlciA9IG5ldyBTdHJpbmcgKGNoYXJzKTsKKwkJWFBD
T00ubnNFbWJlZFN0cmluZ19kZWxldGUgKHB0cik7CisKKwkJU3RyaW5nIHJhbmdlID0gbm90QmVm
b3JlICsgIiAtICIgKyBub3RBZnRlcjsgLy8kTk9OLU5MUy0xJAorCQlwcm9ibGVtc1twcm9ibGVt
Q291bnQrK10gPSBDb21wYXRpYmlsaXR5LmdldE1lc3NhZ2UgKCJTV1RfSW52YWxpZENlcnRfTm90
VmFsaWQiLCBuZXcgU3RyaW5nW10ge3JhbmdlfSk7IC8vJE5PTi1OTFMtMSQKKwkJZmxhZ3MgfD0g
bnNJQ2VydE92ZXJyaWRlU2VydmljZS5FUlJPUl9USU1FOworCQl2YWxpZGl0eS5SZWxlYXNlICgp
OworCX0KKwlpbnRSZXN1bHRbMF0gPSAwOworCisJcmMgPSBzc2xTdGF0dXMuR2V0SXNVbnRydXN0
ZWQgKGludFJlc3VsdCk7CisJaWYgKGludFJlc3VsdFswXSAhPSAwKSB7CisJCWludCAvKmxvbmcq
LyBwdHIgPSBYUENPTS5uc0VtYmVkU3RyaW5nX25ldyAoKTsKKwkJcmMgPSBjZXJ0LkdldElzc3Vl
ckNvbW1vbk5hbWUgKHB0cik7CisJCWlmIChyYyAhPSBYUENPTS5OU19PSykgU1dULmVycm9yIChy
Yyk7CisJCWxlbmd0aCA9IFhQQ09NLm5zRW1iZWRTdHJpbmdfTGVuZ3RoIChwdHIpOworCQlidWZm
ZXIgPSBYUENPTS5uc0VtYmVkU3RyaW5nX2dldCAocHRyKTsKKwkJY2hhcltdIGNoYXJzID0gbmV3
IGNoYXJbbGVuZ3RoXTsKKwkJWFBDT00ubWVtbW92ZSAoY2hhcnMsIGJ1ZmZlciwgbGVuZ3RoICog
Mik7CisJCVN0cmluZyBuYW1lID0gbmV3IFN0cmluZyAoY2hhcnMpOworCQlwcm9ibGVtc1twcm9i
bGVtQ291bnQrK10gPSBDb21wYXRpYmlsaXR5LmdldE1lc3NhZ2UgKCJTV1RfSW52YWxpZENlcnRf
Tm90VHJ1c3RlZCIsIG5ldyBTdHJpbmdbXSB7bmFtZX0pOyAvLyROT04tTkxTLTEkCisJCWZsYWdz
IHw9IG5zSUNlcnRPdmVycmlkZVNlcnZpY2UuRVJST1JfVU5UUlVTVEVEOworCQlYUENPTS5uc0Vt
YmVkU3RyaW5nX2RlbGV0ZSAocHRyKTsKKwl9CisJaW50UmVzdWx0WzBdID0gMDsKKwlzc2xTdGF0
dXMuUmVsZWFzZSAoKTsKKworCS8qCisJKiBUaGUgaW52YWxpZCBjZXJ0aWZpY2F0ZSBkaWFsb2cg
bXVzdCBiZSBzaG93biBhc3luY2hyb25vdXNseSBiZWNhdXNlCisJKiBOb3RpZnlDZXJ0UHJvYmxl
bSBpbXBsZW1lbnRhdGlvbnMgY2Fubm90IGJsb2NrLgorCSovCisJZmluYWwgaW50IGZpbmFsRmxh
Z3MgPSBmbGFnczsKKwlmaW5hbCBTdHJpbmdbXSBmaW5hbFByb2JsZW1zID0gbmV3IFN0cmluZ1tw
cm9ibGVtQ291bnRdOworCVN5c3RlbS5hcnJheWNvcHkgKHByb2JsZW1zLCAwLCBmaW5hbFByb2Js
ZW1zLCAwLCBwcm9ibGVtQ291bnQpOworCWZpbmFsIFN0cmluZyB1cmwgPSBsYXN0TmF2aWdhdGVV
Ukw7CisJYnJvd3Nlci5nZXREaXNwbGF5KCkuYXN5bmNFeGVjKG5ldyBSdW5uYWJsZSgpIHsKKwkJ
cHVibGljIHZvaWQgcnVuKCkgeworCQkJaWYgKGJyb3dzZXIuaXNEaXNwb3NlZCAoKSkgcmV0dXJu
OworCQkJaWYgKCF1cmwuZXF1YWxzIChsYXN0TmF2aWdhdGVVUkwpKSByZXR1cm47CS8qIHVzZXIg
aGFzIG5hdmlnYXRlZCBlbHNld2hlcmUgKi8KKworCQkJU3RyaW5nIG1lc3NhZ2UgPSBDb21wYXRp
YmlsaXR5LmdldE1lc3NhZ2UgKCJTV1RfSW52YWxpZENlcnRfTWVzc2FnZSIsIG5ldyBTdHJpbmdb
XSB7dXJsUG9ydH0pOyAvLyROT04tTkxTLTEkCisJCQlpZiAobmV3IFByb21wdERpYWxvZyAoYnJv
d3Nlci5nZXRTaGVsbCAoKSkuaW52YWxpZENlcnQgKGJyb3dzZXIsIG1lc3NhZ2UsIGZpbmFsUHJv
YmxlbXMsIGNlcnQpKSB7CisJCQkJaW50IC8qbG9uZyovW10gcmVzdWx0ID0gbmV3IGludCAvKmxv
bmcqL1sxXTsKKwkJCQlpbnQgcmMgPSBYUENPTS5OU19HZXRTZXJ2aWNlTWFuYWdlciAocmVzdWx0
KTsKKwkJCQlpZiAocmMgIT0gWFBDT00uTlNfT0spIGVycm9yIChyYyk7CisJCQkJaWYgKHJlc3Vs
dFswXSA9PSAwKSBlcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOworCQkKKwkJCQluc0lTZXJ2
aWNlTWFuYWdlciBzZXJ2aWNlTWFuYWdlciA9IG5ldyBuc0lTZXJ2aWNlTWFuYWdlciAocmVzdWx0
WzBdKTsKKwkJCQlyZXN1bHRbMF0gPSAwOworCQkJCWJ5dGVbXSBhQ29udHJhY3RJRCA9IE1vemls
bGFEZWxlZ2F0ZS53Y3NUb01iY3MgKG51bGwsIFhQQ09NLk5TX0NFUlRPVkVSUklERV9DT05UUkFD
VElELCB0cnVlKTsKKwkJCQlyYyA9IHNlcnZpY2VNYW5hZ2VyLkdldFNlcnZpY2VCeUNvbnRyYWN0
SUQgKGFDb250cmFjdElELCBuc0lDZXJ0T3ZlcnJpZGVTZXJ2aWNlLk5TX0lDRVJUT1ZFUlJJREVT
RVJWSUNFX0lJRCwgcmVzdWx0KTsKKwkJCQlpZiAocmMgIT0gWFBDT00uTlNfT0spIGVycm9yIChy
Yyk7CisJCQkJaWYgKHJlc3VsdFswXSA9PSAwKSBlcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0Up
OworCQkJCXNlcnZpY2VNYW5hZ2VyLlJlbGVhc2UgKCk7CisJCQorCQkJCW5zSUNlcnRPdmVycmlk
ZVNlcnZpY2Ugb3ZlcnJpZGVTZXJ2aWNlID0gbmV3IG5zSUNlcnRPdmVycmlkZVNlcnZpY2UgKHJl
c3VsdFswXSk7CisJCQkJcmVzdWx0WzBdID0gMDsKKwkJCQlieXRlW10gaG9zdEJ5dGVzID0gTW96
aWxsYURlbGVnYXRlLndjc1RvTWJjcyAobnVsbCwgaG9zdCwgZmFsc2UpOworCQkJCWludCAvKmxv
bmcqLyBob3N0U3RyaW5nID0gWFBDT00ubnNFbWJlZENTdHJpbmdfbmV3IChob3N0Qnl0ZXMsIGhv
c3RCeXRlcy5sZW5ndGgpOworCQkJCXJjID0gb3ZlcnJpZGVTZXJ2aWNlLlJlbWVtYmVyVmFsaWRp
dHlPdmVycmlkZSAoaG9zdFN0cmluZywgcG9ydCwgY2VydC5nZXRBZGRyZXNzICgpLCBmaW5hbEZs
YWdzLCAxKTsKKwkJCQlicm93c2VyLnNldFVybCAodXJsKTsKKwkJCQlYUENPTS5uc0VtYmVkQ1N0
cmluZ19kZWxldGUgKGhvc3RTdHJpbmcpOworCQkJCW92ZXJyaWRlU2VydmljZS5SZWxlYXNlICgp
OworCQkJfQorCQkJY2VydC5SZWxlYXNlICgpOworCQl9CisJfSk7CisKKwlDLm1lbW1vdmUgKF9z
dXBwcmVzc0Vycm9yLCBuZXcgaW50W10gezF9LCA0KTsgLyogUFJJbnQzMiAqLworCXJldHVybiBY
UENPTS5OU19PSzsKK30KKwogfQpJbmRleDogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3Jn
L2VjbGlwc2Uvc3d0L2Jyb3dzZXIvUHJvbXB0U2VydmljZTIuamF2YQo9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBm
aWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xpcHNlLnN3dC9FY2xpcHNlIFNXVCBNb3ppbGxh
L2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nlci9Qcm9tcHRTZXJ2aWNlMi5qYXZhLHYKcmV0
cmlldmluZyByZXZpc2lvbiAxLjYKZGlmZiAtdSAtcjEuNiBQcm9tcHRTZXJ2aWNlMi5qYXZhCi0t
LSBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nlci9Qcm9t
cHRTZXJ2aWNlMi5qYXZhCTI5IE1heSAyMDA5IDIxOjMwOjIzIC0wMDAwCTEuNgorKysgRWNsaXBz
ZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dzZXIvUHJvbXB0U2Vydmlj
ZTIuamF2YQkxOSBBdWcgMjAwOSAxOTo1NzoyMyAtMDAwMApAQCAtMTQ5LDcgKzE0OSw3IEBACiAv
KiBuc0lQcm9tcHRTZXJ2aWNlICovCiAKIGludCBBbGVydCAoaW50IC8qbG9uZyovIGFQYXJlbnQs
IGludCAvKmxvbmcqLyBhRGlhbG9nVGl0bGUsIGludCAvKmxvbmcqLyBhVGV4dCkgewotCUJyb3dz
ZXIgYnJvd3NlciA9IGdldEJyb3dzZXIgKGFQYXJlbnQpOworCWZpbmFsIEJyb3dzZXIgYnJvd3Nl
ciA9IGdldEJyb3dzZXIgKGFQYXJlbnQpOwogCQogCWludCBsZW5ndGggPSBYUENPTS5zdHJsZW5f
UFJVbmljaGFyIChhRGlhbG9nVGl0bGUpOwogCWNoYXJbXSBkZXN0ID0gbmV3IGNoYXJbbGVuZ3Ro
XTsKQEAgLTE2MSw2ICsxNjEsMjUgQEAKIAlYUENPTS5tZW1tb3ZlIChkZXN0LCBhVGV4dCwgbGVu
Z3RoICogMik7CiAJU3RyaW5nIHRleHRMYWJlbCA9IG5ldyBTdHJpbmcgKGRlc3QpOwogCisJLyoK
KwkqIElmIG1vemlsbGEgaXMgc2hvd2luZyBpdHMgZXJyb3JzIHdpdGggZGlhbG9ncyAoYXMgb3Bw
b3NlZCB0byBwYWdlcykgdGhlbiB0aGUgb25seQorCSogb3Bwb3J0dW5pdHkgdG8gZGV0ZWN0IHRo
YXQgYSBwYWdlIGhhcyBhbiBpbnZhbGlkIGNlcnRpZmljYXRlLCB3aXRob3V0IHJlY2VpdmluZwor
CSogYWxsIG5vdGlmaWNhdGlvbiBjYWxsYmFja3Mgb24gdGhlIGNoYW5uZWwsIGlzIHRvIGRldGVj
dCB0aGUgZGlzcGxheWluZyBvZiBhbiBhbGVydAorCSogd2hvc2UgbWVzc2FnZSBjb250YWlucyBh
biBpbnRlcm5hbCBjZXJ0IGVycm9yIGNvZGUuICBJZiBhIHN1Y2ggYSBtZXNzYWdlIGlzCisJKiBk
ZXRlY3RlZCB0aGVuIGluc3RlYWQgb2Ygc2hvd2luZyBpdCwgcmUtbmF2aWdhdGUgdG8gdGhlIHBh
Z2Ugd2l0aCB0aGUgaW52YWxpZAorCSogY2VydGlmaWNhdGUgc28gdGhhdCB0aGUgYnJvd3Nlcidz
IG5zSUJhZENlcnRMaXN0ZW5lcjIgd2lsbCBiZSBpbnZva2VkLgorCSovCisJaWYgKHRleHRMYWJl
bC5pbmRleE9mICgic3NsX2Vycm9yX2JhZF9jZXJ0X2RvbWFpbiIpICE9IC0xIHx8CisJCXRleHRM
YWJlbC5pbmRleE9mICgic2VjX2Vycm9yX3Vua25vd25faXNzdWVyIikgIT0gLTEgfHwKKwkJdGV4
dExhYmVsLmluZGV4T2YgKCJzZWNfZXJyb3JfZXhwaXJlZF9jZXJ0aWZpY2F0ZSIpICE9IC0xKSB7
IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJCAvLyROT04tTkxTLTMkCisJCQlpZiAoYnJvd3Nl
ciAhPSBudWxsKSB7CisJCQkJTW96aWxsYSBtb3ppbGxhID0gKE1vemlsbGEpYnJvd3Nlci53ZWJC
cm93c2VyOworCQkJCW1vemlsbGEuaXNSZXRyaWV2aW5nQmFkQ2VydCA9IHRydWU7CisJCQkJYnJv
d3Nlci5zZXRVcmwgKG1vemlsbGEubGFzdE5hdmlnYXRlVVJMKTsKKwkJCQlyZXR1cm4gWFBDT00u
TlNfT0s7CisJCQl9CisJfQorCiAJU2hlbGwgc2hlbGwgPSBicm93c2VyID09IG51bGwgPyBuZXcg
U2hlbGwgKCkgOiBicm93c2VyLmdldFNoZWxsICgpOyAKIAlNZXNzYWdlQm94IG1lc3NhZ2VCb3gg
PSBuZXcgTWVzc2FnZUJveCAoc2hlbGwsIFNXVC5PSyB8IFNXVC5JQ09OX1dBUk5JTkcpOwogCW1l
c3NhZ2VCb3guc2V0VGV4dCAodGl0bGVMYWJlbCk7CkluZGV4OiBFY2xpcHNlIFNXVC9jb21tb25f
ajJzZS9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwvU1dUTWVzc2FnZXMucHJvcGVydGllcwo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09ClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xpcHNlLnN3dC9FY2xpcHNl
IFNXVC9jb21tb25fajJzZS9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwvU1dUTWVzc2FnZXMucHJv
cGVydGllcyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zMgpkaWZmIC11IC1yMS4zMiBTV1RNZXNz
YWdlcy5wcm9wZXJ0aWVzCi0tLSBFY2xpcHNlIFNXVC9jb21tb25fajJzZS9vcmcvZWNsaXBzZS9z
d3QvaW50ZXJuYWwvU1dUTWVzc2FnZXMucHJvcGVydGllcwkyOSBNYXkgMjAwOSAyMTozMDoyMiAt
MDAwMAkxLjMyCisrKyBFY2xpcHNlIFNXVC9jb21tb25fajJzZS9vcmcvZWNsaXBzZS9zd3QvaW50
ZXJuYWwvU1dUTWVzc2FnZXMucHJvcGVydGllcwkxOSBBdWcgMjAwOSAxOTo1NzoyMyAtMDAwMApA
QCAtNzIsNCArNzIsMTAgQEAKIFNXVF9Eb3dubG9hZF9TdGF0dXM9RG93bmxvYWQ6IHswLG51bWJl
cixpbnRlZ2VyfSBLQiBvZiB7MSxudW1iZXIsaW50ZWdlcn0gS0IKIFNXVF9BdXRoZW50aWNhdGlv
bl9SZXF1aXJlZD1BdXRoZW50aWNhdGlvbiBSZXF1aXJlZAogU1dUX0VudGVyX1VzZXJuYW1lX2Fu
ZF9QYXNzd29yZD1FbnRlciB1c2VyIG5hbWUgYW5kIHBhc3N3b3JkIGZvciB7MH0gYXQgezF9Ci1T
V1RfUGFnZV9Mb2FkX0ZhaWxlZD1QYWdlIGxvYWQgZmFpbGVkIHdpdGggZXJyb3I6IHswfQpcIE5v
IG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUKK1NXVF9QYWdlX0xvYWRfRmFpbGVkPVBhZ2UgbG9hZCBm
YWlsZWQgd2l0aCBlcnJvcjogezB9CitTV1RfSW52YWxpZENlcnRfVGl0bGU9SW52YWxpZCBDZXJ0
aWZpY2F0ZQorU1dUX0ludmFsaWRDZXJ0X01lc3NhZ2U9VGhlIHNlY3VyaXR5IGNlcnRpZmljYXRl
IHByZXNlbnRlZCBieSAiezB9IiBoYXMgdGhlIGZvbGxvd2luZyBwcm9ibGVtKHMpOgorU1dUX0lu
dmFsaWRDZXJ0X0ludmFsaWROYW1lPUNlcnRpZmljYXRlIG5hbWUgaXMgaW52YWxpZCBvciBkb2Vz
IG5vdCBtYXRjaCBzaXRlIG5hbWUuICBDZXJ0aWZpY2F0ZSBpc3N1ZWQgdG86ICJ7MH0iLiAKK1NX
VF9JbnZhbGlkQ2VydF9Ob3RWYWxpZD1DZXJ0aWZpY2F0ZSBpcyBub3QgY3VycmVudGx5IHZhbGlk
LiAgVmFsaWQgZGF0ZSByYW5nZTogInswfSIuICAKK1NXVF9JbnZhbGlkQ2VydF9Ob3RUcnVzdGVk
PUNlcnRpZmljYXRlIGlzIG5vdCBmcm9tIGEgdHJ1c3RlZCBjZXJ0aWZ5aW5nIGF1dGhvcml0eS4g
IENlcnRpZmljYXRlIGlzc3VlcjogInswfSIuCitTV1RfSW52YWxpZENlcnRfQ29ubmVjdD1Xb3Vs
ZCB5b3UgbGlrZSB0byBjb25uZWN0IHRvIHRoaXMgc2l0ZSBhbnl3YXlzPwpJbmRleDogRWNsaXBz
ZSBTV1QgTW96aWxsYS9jb21tb24vbGlicmFyeS94cGNvbV9zdGF0cy5jcHAKPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpS
Q1MgZmlsZTogL2N2c3Jvb3QvZWNsaXBzZS9vcmcuZWNsaXBzZS5zd3QvRWNsaXBzZSBTV1QgTW96
aWxsYS9jb21tb24vbGlicmFyeS94cGNvbV9zdGF0cy5jcHAsdgpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuNTEKZGlmZiAtdSAtcjEuNTEgeHBjb21fc3RhdHMuY3BwCi0tLSBFY2xpcHNlIFNXVCBNb3pp
bGxhL2NvbW1vbi9saWJyYXJ5L3hwY29tX3N0YXRzLmNwcAkyOSBNYXkgMjAwOSAyMTozMDoxMyAt
MDAwMAkxLjUxCisrKyBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9saWJyYXJ5L3hwY29tX3N0
YXRzLmNwcAkxOSBBdWcgMjAwOSAxOTo1NzoyMyAtMDAwMApAQCAtMTQsOCArMTQsOCBAQAogCiAj
aWZkZWYgTkFUSVZFX1NUQVRTCiAKLWludCBYUENPTV9uYXRpdmVGdW5jdGlvbkNvdW50ID0gMjEz
OwotaW50IFhQQ09NX25hdGl2ZUZ1bmN0aW9uQ2FsbENvdW50WzIxM107CitpbnQgWFBDT01fbmF0
aXZlRnVuY3Rpb25Db3VudCA9IDIyNjsKK2ludCBYUENPTV9uYXRpdmVGdW5jdGlvbkNhbGxDb3Vu
dFsyMjZdOwogY2hhciAqIFhQQ09NX25hdGl2ZUZ1bmN0aW9uTmFtZXNbXSA9IHsKIAkiR2V0QWRk
cmVzcyIsCiAjaWZuZGVmIEpOSTY0CkBAIC0xMzQsNiArMTM0LDExIEBACiAJIl8xVnRibENhbGxf
X0lKSUlJSV8zSV8zSSIsCiAjZW5kaWYKICNpZm5kZWYgSk5JNjQKKwkiXzFWdGJsQ2FsbF9fSUlJ
SUlJXzNJXzNJXzNJIiwKKyNlbHNlCisJIl8xVnRibENhbGxfX0lKSUlJSV8zSV8zSV8zSSIsCisj
ZW5kaWYKKyNpZm5kZWYgSk5JNjQKIAkiXzFWdGJsQ2FsbF9fSUlJSUlfM0JfM0JJIiwKICNlbHNl
CiAJIl8xVnRibENhbGxfX0lKSUlJXzNCXzNCSSIsCkBAIC0xNDksNiArMTU0LDExIEBACiAJIl8x
VnRibENhbGxfX0lKSUlJXzNJIiwKICNlbmRpZgogI2lmbmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxs
X19JSUlJSV8zSV8zSV8zSSIsCisjZWxzZQorCSJfMVZ0YmxDYWxsX19JSklJSV8zSV8zSV8zSSIs
CisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKIAkiXzFWdGJsQ2FsbF9fSUlJSUpKSkoiLAogI2Vsc2UK
IAkiXzFWdGJsQ2FsbF9fSUpJSUpKSkoiLApAQCAtMTk5LDYgKzIwOSwxMSBAQAogCSJfMVZ0YmxD
YWxsX19JSklJXzNJIiwKICNlbmRpZgogI2lmbmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUlJ
XzNJXzNJIiwKKyNlbHNlCisJIl8xVnRibENhbGxfX0lKSUlfM0lfM0kiLAorI2VuZGlmCisjaWZu
ZGVmIEpOSTY0CiAJIl8xVnRibENhbGxfX0lJSUlfM0oiLAogI2Vsc2UKIAkiXzFWdGJsQ2FsbF9f
SUpJSV8zSiIsCkBAIC0zMjQsMTEgKzMzOSwzMSBAQAogCSJfMVZ0YmxDYWxsX19JSklfM0kiLAog
I2VuZGlmCiAjaWZuZGVmIEpOSTY0CisJIl8xVnRibENhbGxfX0lJSV8zSUkiLAorI2Vsc2UKKwki
XzFWdGJsQ2FsbF9fSUpJXzNJSSIsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKKwkiXzFWdGJsQ2Fs
bF9fSUlJXzNJSiIsCisjZWxzZQorCSJfMVZ0YmxDYWxsX19JSklfM0lKIiwKKyNlbmRpZgorI2lm
bmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUlfM0lfM0lfM0kiLAorI2Vsc2UKKwkiXzFWdGJs
Q2FsbF9fSUpJXzNJXzNJXzNJIiwKKyNlbmRpZgorI2lmbmRlZiBKTkk2NAogCSJfMVZ0YmxDYWxs
X19JSUlfM0lfM0lfM0lfM0kiLAogI2Vsc2UKIAkiXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNJXzNJ
IiwKICNlbmRpZgogI2lmbmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUlfM0lfM0lfM0oiLAor
I2Vsc2UKKwkiXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNKIiwKKyNlbmRpZgorI2lmbmRlZiBKTkk2
NAogCSJfMVZ0YmxDYWxsX19JSUoiLAogI2Vsc2UKIAkiXzFWdGJsQ2FsbF9fSUpKIiwKQEAgLTM1
NCw2ICszODksMjYgQEAKIAkiXzFWdGJsQ2FsbF9fSUpKSUlKXzNJXzNKIiwKICNlbmRpZgogI2lm
bmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUpJSV8zSSIsCisjZWxzZQorCSJfMVZ0YmxDYWxs
X19JSkpJSV8zSSIsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKKwkiXzFWdGJsQ2FsbF9fSUlKSUpJ
SSIsCisjZWxzZQorCSJfMVZ0YmxDYWxsX19JSkpJSklJIiwKKyNlbmRpZgorI2lmbmRlZiBKTkk2
NAorCSJfMVZ0YmxDYWxsX19JSUpJSkpfM0lfM0lfM0kiLAorI2Vsc2UKKwkiXzFWdGJsQ2FsbF9f
SUpKSUpKXzNJXzNJXzNJIiwKKyNlbmRpZgorI2lmbmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19J
SUpJSl8zSV8zSV8zSSIsCisjZWxzZQorCSJfMVZ0YmxDYWxsX19JSkpJSl8zSV8zSV8zSSIsCisj
ZW5kaWYKKyNpZm5kZWYgSk5JNjQKIAkiXzFWdGJsQ2FsbF9fSUlKSV8zSiIsCiAjZWxzZQogCSJf
MVZ0YmxDYWxsX19JSkpJXzNKIiwKQEAgLTQ0NCw2ICs0OTksMTEgQEAKIAkiXzFWdGJsQ2FsbF9f
SUpKSkpfM0JfM0JKIiwKICNlbmRpZgogI2lmbmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUpK
Sl8zSSIsCisjZWxzZQorCSJfMVZ0YmxDYWxsX19JSkpKSl8zSSIsCisjZW5kaWYKKyNpZm5kZWYg
Sk5JNjQKIAkiXzFWdGJsQ2FsbF9fSUlKSkpfM0oiLAogI2Vsc2UKIAkiXzFWdGJsQ2FsbF9fSUpK
SkpfM0oiLApAQCAtNDg5LDYgKzU0OSwxMSBAQAogCSJfMVZ0YmxDYWxsX19JSkpKXzNJIiwKICNl
bmRpZgogI2lmbmRlZiBKTkk2NAorCSJfMVZ0YmxDYWxsX19JSUpKXzNJXzNJIiwKKyNlbHNlCisJ
Il8xVnRibENhbGxfX0lKSkpfM0lfM0kiLAorI2VuZGlmCisjaWZuZGVmIEpOSTY0CiAJIl8xVnRi
bENhbGxfX0lJSkpfM0oiLAogI2Vsc2UKIAkiXzFWdGJsQ2FsbF9fSUpKSl8zSiIsCkluZGV4OiBF
Y2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9saWJyYXJ5L3hwY29tLmNwcAo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJD
UyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xpcHNlLnN3dC9FY2xpcHNlIFNXVCBNb3pp
bGxhL2NvbW1vbi9saWJyYXJ5L3hwY29tLmNwcCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS42OQpk
aWZmIC11IC1yMS42OSB4cGNvbS5jcHAKLS0tIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL2xp
YnJhcnkveHBjb20uY3BwCTI5IE1heSAyMDA5IDIxOjMwOjEzIC0wMDAwCTEuNjkKKysrIEVjbGlw
c2UgU1dUIE1vemlsbGEvY29tbW9uL2xpYnJhcnkveHBjb20uY3BwCTE5IEF1ZyAyMDA5IDE5OjU3
OjIzIC0wMDAwCkBAIC02OTQsNiArNjk0LDQxIEBACiB9CiAjZW5kaWYKIAorI2lmICghZGVmaW5l
ZChOT19fMVZ0YmxDYWxsX19JSUlJSUlfM0lfM0lfM0kpICYmICFkZWZpbmVkKEpOSTY0KSkgfHwg
KCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lKSUlJSV8zSV8zSV8zSSkgJiYgZGVmaW5lZChKTkk2
NCkpCisjaWZuZGVmIEpOSTY0CitleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBD
T01fTkFUSVZFKF8xVnRibENhbGxfX0lJSUlJSV8zSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFz
cyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludCBhcmczLCBq
aW50IGFyZzQsIGppbnQgYXJnNSwgamludEFycmF5IGFyZzYsIGppbnRBcnJheSBhcmc3LCBqaW50
QXJyYXkgYXJnOCk7CitKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxD
YWxsX19JSUlJSUlfM0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcw
LCBqaW50TG9uZyBhcmcxLCBqaW50IGFyZzIsIGppbnQgYXJnMywgamludCBhcmc0LCBqaW50IGFy
ZzUsIGppbnRBcnJheSBhcmc2LCBqaW50QXJyYXkgYXJnNywgamludEFycmF5IGFyZzgpCisjZWxz
ZQorZXh0ZXJuICJDIiBKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxD
YWxsX19JSklJSUlfM0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcw
LCBqaW50TG9uZyBhcmcxLCBqaW50IGFyZzIsIGppbnQgYXJnMywgamludCBhcmc0LCBqaW50IGFy
ZzUsIGppbnRBcnJheSBhcmc2LCBqaW50QXJyYXkgYXJnNywgamludEFycmF5IGFyZzgpOworSk5J
RVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpJSUlJXzNJXzNJ
XzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwg
amludCBhcmcyLCBqaW50IGFyZzMsIGppbnQgYXJnNCwgamludCBhcmc1LCBqaW50QXJyYXkgYXJn
NiwgamludEFycmF5IGFyZzcsIGppbnRBcnJheSBhcmc4KQorI2VuZGlmCit7CisJamludCAqbHBh
cmc2PU5VTEw7CisJamludCAqbHBhcmc3PU5VTEw7CisJamludCAqbHBhcmc4PU5VTEw7CisJamlu
dCByYyA9IDA7CisjaWZuZGVmIEpOSTY0CisJWFBDT01fTkFUSVZFX0VOVEVSKGVudiwgdGhhdCwg
XzFWdGJsQ2FsbF9fSUlJSUlJXzNJXzNJXzNJX0ZVTkMpOworI2Vsc2UKKwlYUENPTV9OQVRJVkVf
RU5URVIoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSklJSUlfM0lfM0lfM0lfRlVOQyk7CisjZW5k
aWYKKwlpZiAoYXJnNikgaWYgKChscGFyZzYgPSBlbnYtPkdldEludEFycmF5RWxlbWVudHMoYXJn
NiwgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsKKwlpZiAoYXJnNykgaWYgKChscGFyZzcgPSBl
bnYtPkdldEludEFycmF5RWxlbWVudHMoYXJnNywgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsK
KwlpZiAoYXJnOCkgaWYgKChscGFyZzggPSBlbnYtPkdldEludEFycmF5RWxlbWVudHMoYXJnOCwg
TlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsKKwlyYyA9IChqaW50KSgoamludCAoU1RETUVUSE9E
Q0FMTFRZUEUgKikoamludExvbmcsIGppbnQsIGppbnQsIGppbnQsIGppbnQsIGppbnQgKiwgamlu
dCAqLCBqaW50ICopKSgqKGppbnRMb25nICoqKWFyZzEpW2FyZzBdKShhcmcxLCBhcmcyLCBhcmcz
LCBhcmc0LCBhcmc1LCBscGFyZzYsIGxwYXJnNywgbHBhcmc4KTsKK2ZhaWw6CisJaWYgKGFyZzgg
JiYgbHBhcmc4KSBlbnYtPlJlbGVhc2VJbnRBcnJheUVsZW1lbnRzKGFyZzgsIGxwYXJnOCwgMCk7
CisJaWYgKGFyZzcgJiYgbHBhcmc3KSBlbnYtPlJlbGVhc2VJbnRBcnJheUVsZW1lbnRzKGFyZzcs
IGxwYXJnNywgMCk7CisJaWYgKGFyZzYgJiYgbHBhcmc2KSBlbnYtPlJlbGVhc2VJbnRBcnJheUVs
ZW1lbnRzKGFyZzYsIGxwYXJnNiwgMCk7CisjaWZuZGVmIEpOSTY0CisJWFBDT01fTkFUSVZFX0VY
SVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSUlJSUlfM0lfM0lfM0lfRlVOQyk7CisjZWxzZQor
CVhQQ09NX05BVElWRV9FWElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpJSUlJXzNJXzNJXzNJ
X0ZVTkMpOworI2VuZGlmCisJcmV0dXJuIHJjOworfQorI2VuZGlmCisKICNpZiAoIWRlZmluZWQo
Tk9fXzFWdGJsQ2FsbF9fSUlJSUlfM0JfM0JJKSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8ICghZGVm
aW5lZChOT19fMVZ0YmxDYWxsX19JSklJSV8zQl8zQkkpICYmIGRlZmluZWQoSk5JNjQpKQogI2lm
bmRlZiBKTkk2NAogZXh0ZXJuICJDIiBKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElW
RShfMVZ0YmxDYWxsX19JSUlJSV8zQl8zQkkpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamlu
dCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqaW50IGFyZzIsIGppbnQgYXJnMywgamludCBhcmc0LCBq
Ynl0ZUFycmF5IGFyZzUsIGpieXRlQXJyYXkgYXJnNiwgamludCBhcmc3KTsKQEAgLTc4NCw2ICs4
MTksNDEgQEAKIH0KICNlbmRpZgogCisjaWYgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lJSUlJ
XzNJXzNJXzNJKSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8ICghZGVmaW5lZChOT19fMVZ0YmxDYWxs
X19JSklJSV8zSV8zSV8zSSkgJiYgZGVmaW5lZChKTkk2NCkpCisjaWZuZGVmIEpOSTY0CitleHRl
cm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJ
SUlJXzNJXzNJXzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExv
bmcgYXJnMSwgamludCBhcmcyLCBqaW50IGFyZzMsIGppbnQgYXJnNCwgamludEFycmF5IGFyZzUs
IGppbnRBcnJheSBhcmc2LCBqaW50QXJyYXkgYXJnNyk7CitKTklFWFBPUlQgamludCBKTklDQUxM
IFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUlJSV8zSV8zSV8zSSkoSk5JRW52ICplbnYsIGpj
bGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludCBhcmcz
LCBqaW50IGFyZzQsIGppbnRBcnJheSBhcmc1LCBqaW50QXJyYXkgYXJnNiwgamludEFycmF5IGFy
ZzcpCisjZWxzZQorZXh0ZXJuICJDIiBKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElW
RShfMVZ0YmxDYWxsX19JSklJSV8zSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBq
aW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludCBhcmczLCBqaW50IGFyZzQs
IGppbnRBcnJheSBhcmc1LCBqaW50QXJyYXkgYXJnNiwgamludEFycmF5IGFyZzcpOworSk5JRVhQ
T1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpJSUlfM0lfM0lfM0kp
KEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqaW50
IGFyZzIsIGppbnQgYXJnMywgamludCBhcmc0LCBqaW50QXJyYXkgYXJnNSwgamludEFycmF5IGFy
ZzYsIGppbnRBcnJheSBhcmc3KQorI2VuZGlmCit7CisJamludCAqbHBhcmc1PU5VTEw7CisJamlu
dCAqbHBhcmc2PU5VTEw7CisJamludCAqbHBhcmc3PU5VTEw7CisJamludCByYyA9IDA7CisjaWZu
ZGVmIEpOSTY0CisJWFBDT01fTkFUSVZFX0VOVEVSKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlJ
SUlfM0lfM0lfM0lfRlVOQyk7CisjZWxzZQorCVhQQ09NX05BVElWRV9FTlRFUihlbnYsIHRoYXQs
IF8xVnRibENhbGxfX0lKSUlJXzNJXzNJXzNJX0ZVTkMpOworI2VuZGlmCisJaWYgKGFyZzUpIGlm
ICgobHBhcmc1ID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzUsIE5VTEwpKSA9PSBOVUxM
KSBnb3RvIGZhaWw7CisJaWYgKGFyZzYpIGlmICgobHBhcmc2ID0gZW52LT5HZXRJbnRBcnJheUVs
ZW1lbnRzKGFyZzYsIE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJaWYgKGFyZzcpIGlmICgo
bHBhcmc3ID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzcsIE5VTEwpKSA9PSBOVUxMKSBn
b3RvIGZhaWw7CisJcmMgPSAoamludCkoKGppbnQgKFNURE1FVEhPRENBTExUWVBFICopKGppbnRM
b25nLCBqaW50LCBqaW50LCBqaW50LCBqaW50ICosIGppbnQgKiwgamludCAqKSkoKihqaW50TG9u
ZyAqKilhcmcxKVthcmcwXSkoYXJnMSwgYXJnMiwgYXJnMywgYXJnNCwgbHBhcmc1LCBscGFyZzYs
IGxwYXJnNyk7CitmYWlsOgorCWlmIChhcmc3ICYmIGxwYXJnNykgZW52LT5SZWxlYXNlSW50QXJy
YXlFbGVtZW50cyhhcmc3LCBscGFyZzcsIDApOworCWlmIChhcmc2ICYmIGxwYXJnNikgZW52LT5S
ZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmc2LCBscGFyZzYsIDApOworCWlmIChhcmc1ICYmIGxw
YXJnNSkgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmc1LCBscGFyZzUsIDApOworI2lm
bmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9FWElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlJ
SUlfM0lfM0lfM0lfRlVOQyk7CisjZWxzZQorCVhQQ09NX05BVElWRV9FWElUKGVudiwgdGhhdCwg
XzFWdGJsQ2FsbF9fSUpJSUlfM0lfM0lfM0lfRlVOQyk7CisjZW5kaWYKKwlyZXR1cm4gcmM7Cit9
CisjZW5kaWYKKwogI2lmICghZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSUlJSkpKSikgJiYgIWRl
ZmluZWQoSk5JNjQpKSB8fCAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9fSUpJSUpKSkopICYmIGRl
ZmluZWQoSk5JNjQpKQogI2lmbmRlZiBKTkk2NAogZXh0ZXJuICJDIiBKTklFWFBPUlQgamludCBK
TklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUlJSkpKSikoSk5JRW52ICplbnYsIGpj
bGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludCBhcmcz
LCBqbG9uZyBhcmc0LCBqbG9uZyBhcmc1LCBqbG9uZyBhcmc2LCBqbG9uZyBhcmc3KTsKQEAgLTEw
NzksNiArMTE0OSwzOCBAQAogfQogI2VuZGlmCiAKKyNpZiAoIWRlZmluZWQoTk9fXzFWdGJsQ2Fs
bF9fSUlJSV8zSV8zSSkgJiYgIWRlZmluZWQoSk5JNjQpKSB8fCAoIWRlZmluZWQoTk9fXzFWdGJs
Q2FsbF9fSUpJSV8zSV8zSSkgJiYgZGVmaW5lZChKTkk2NCkpCisjaWZuZGVmIEpOSTY0CitleHRl
cm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJ
SUlfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBh
cmcxLCBqaW50IGFyZzIsIGppbnQgYXJnMywgamludEFycmF5IGFyZzQsIGppbnRBcnJheSBhcmc1
KTsKK0pOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJSUlf
M0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcx
LCBqaW50IGFyZzIsIGppbnQgYXJnMywgamludEFycmF5IGFyZzQsIGppbnRBcnJheSBhcmc1KQor
I2Vsc2UKK2V4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFW
dGJsQ2FsbF9fSUpJSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAs
IGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludCBhcmczLCBqaW50QXJyYXkgYXJnNCwgamlu
dEFycmF5IGFyZzUpOworSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJs
Q2FsbF9fSUpJSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGpp
bnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludCBhcmczLCBqaW50QXJyYXkgYXJnNCwgamludEFy
cmF5IGFyZzUpCisjZW5kaWYKK3sKKwlqaW50ICpscGFyZzQ9TlVMTDsKKwlqaW50ICpscGFyZzU9
TlVMTDsKKwlqaW50IHJjID0gMDsKKyNpZm5kZWYgSk5JNjQKKwlYUENPTV9OQVRJVkVfRU5URVIo
ZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSUlJXzNJXzNJX0ZVTkMpOworI2Vsc2UKKwlYUENPTV9O
QVRJVkVfRU5URVIoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSklJXzNJXzNJX0ZVTkMpOworI2Vu
ZGlmCisJaWYgKGFyZzQpIGlmICgobHBhcmc0ID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFy
ZzQsIE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJaWYgKGFyZzUpIGlmICgobHBhcmc1ID0g
ZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzUsIE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7
CisJcmMgPSAoamludCkoKGppbnQgKFNURE1FVEhPRENBTExUWVBFICopKGppbnRMb25nLCBqaW50
LCBqaW50LCBqaW50ICosIGppbnQgKikpKCooamludExvbmcgKiopYXJnMSlbYXJnMF0pKGFyZzEs
IGFyZzIsIGFyZzMsIGxwYXJnNCwgbHBhcmc1KTsKK2ZhaWw6CisJaWYgKGFyZzUgJiYgbHBhcmc1
KSBlbnYtPlJlbGVhc2VJbnRBcnJheUVsZW1lbnRzKGFyZzUsIGxwYXJnNSwgMCk7CisJaWYgKGFy
ZzQgJiYgbHBhcmc0KSBlbnYtPlJlbGVhc2VJbnRBcnJheUVsZW1lbnRzKGFyZzQsIGxwYXJnNCwg
MCk7CisjaWZuZGVmIEpOSTY0CisJWFBDT01fTkFUSVZFX0VYSVQoZW52LCB0aGF0LCBfMVZ0YmxD
YWxsX19JSUlJXzNJXzNJX0ZVTkMpOworI2Vsc2UKKwlYUENPTV9OQVRJVkVfRVhJVChlbnYsIHRo
YXQsIF8xVnRibENhbGxfX0lKSUlfM0lfM0lfRlVOQyk7CisjZW5kaWYKKwlyZXR1cm4gcmM7Cit9
CisjZW5kaWYKKwogI2lmICghZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSUlJXzNKKSAmJiAhZGVm
aW5lZChKTkk2NCkpIHx8ICghZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSklJXzNKKSAmJiBkZWZp
bmVkKEpOSTY0KSkKICNpZm5kZWYgSk5JNjQKIGV4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5J
Q0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlJSV8zSikoSk5JRW52ICplbnYsIGpjbGFz
cyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludCBhcmczLCBq
bG9uZ0FycmF5IGFyZzQpOwpAQCAtMTkyMyw2ICsyMDI1LDk5IEBACiB9CiAjZW5kaWYKIAorI2lm
ICghZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSUlfM0lJKSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8
ICghZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSklfM0lJKSAmJiBkZWZpbmVkKEpOSTY0KSkKKyNp
Zm5kZWYgSk5JNjQKK2V4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJ
VkUoXzFWdGJsQ2FsbF9fSUlJXzNJSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFy
ZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludEFycmF5IGFyZzMsIGppbnQgYXJnNCk7
CitKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSUlfM0lJ
KShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamlu
dCBhcmcyLCBqaW50QXJyYXkgYXJnMywgamludCBhcmc0KQorI2Vsc2UKK2V4dGVybiAiQyIgSk5J
RVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpJXzNJSSkoSk5J
RW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJn
MiwgamludEFycmF5IGFyZzMsIGppbnQgYXJnNCk7CitKTklFWFBPUlQgamludCBKTklDQUxMIFhQ
Q09NX05BVElWRShfMVZ0YmxDYWxsX19JSklfM0lJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQs
IGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50QXJyYXkgYXJnMywgamlu
dCBhcmc0KQorI2VuZGlmCit7CisJamludCAqbHBhcmczPU5VTEw7CisJamludCByYyA9IDA7Cisj
aWZuZGVmIEpOSTY0CisJWFBDT01fTkFUSVZFX0VOVEVSKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9f
SUlJXzNJSV9GVU5DKTsKKyNlbHNlCisJWFBDT01fTkFUSVZFX0VOVEVSKGVudiwgdGhhdCwgXzFW
dGJsQ2FsbF9fSUpJXzNJSV9GVU5DKTsKKyNlbmRpZgorCWlmIChhcmczKSBpZiAoKGxwYXJnMyA9
IGVudi0+R2V0SW50QXJyYXlFbGVtZW50cyhhcmczLCBOVUxMKSkgPT0gTlVMTCkgZ290byBmYWls
OworCXJjID0gKGppbnQpKChqaW50IChTVERNRVRIT0RDQUxMVFlQRSAqKShqaW50TG9uZywgamlu
dCwgamludCAqLCBqaW50KSkoKihqaW50TG9uZyAqKilhcmcxKVthcmcwXSkoYXJnMSwgYXJnMiwg
bHBhcmczLCBhcmc0KTsKK2ZhaWw6CisJaWYgKGFyZzMgJiYgbHBhcmczKSBlbnYtPlJlbGVhc2VJ
bnRBcnJheUVsZW1lbnRzKGFyZzMsIGxwYXJnMywgMCk7CisjaWZuZGVmIEpOSTY0CisJWFBDT01f
TkFUSVZFX0VYSVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSUlfM0lJX0ZVTkMpOworI2Vsc2UK
KwlYUENPTV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSV8zSUlfRlVOQyk7
CisjZW5kaWYKKwlyZXR1cm4gcmM7Cit9CisjZW5kaWYKKworI2lmICghZGVmaW5lZChOT19fMVZ0
YmxDYWxsX19JSUlfM0lKKSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8ICghZGVmaW5lZChOT19fMVZ0
YmxDYWxsX19JSklfM0lKKSAmJiBkZWZpbmVkKEpOSTY0KSkKKyNpZm5kZWYgSk5JNjQKK2V4dGVy
biAiQyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlJ
XzNJSikoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEs
IGppbnQgYXJnMiwgamludEFycmF5IGFyZzMsIGpsb25nIGFyZzQpOworSk5JRVhQT1JUIGppbnQg
Sk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlJXzNJSikoSk5JRW52ICplbnYsIGpj
bGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludEFycmF5
IGFyZzMsIGpsb25nIGFyZzQpCisjZWxzZQorZXh0ZXJuICJDIiBKTklFWFBPUlQgamludCBKTklD
QUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSklfM0lKKShKTklFbnYgKmVudiwgamNsYXNz
IHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50QXJyYXkgYXJn
MywgamxvbmcgYXJnNCk7CitKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0
YmxDYWxsX19JSklfM0lKKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamlu
dExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50QXJyYXkgYXJnMywgamxvbmcgYXJnNCkKKyNlbmRp
ZgoreworCWppbnQgKmxwYXJnMz1OVUxMOworCWppbnQgcmMgPSAwOworI2lmbmRlZiBKTkk2NAor
CVhQQ09NX05BVElWRV9FTlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSV8zSUpfRlVOQyk7
CisjZWxzZQorCVhQQ09NX05BVElWRV9FTlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSV8z
SUpfRlVOQyk7CisjZW5kaWYKKwlpZiAoYXJnMykgaWYgKChscGFyZzMgPSBlbnYtPkdldEludEFy
cmF5RWxlbWVudHMoYXJnMywgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsKKwlyYyA9IChqaW50
KSgoamludCAoU1RETUVUSE9EQ0FMTFRZUEUgKikoamludExvbmcsIGppbnQsIGppbnQgKiwgamxv
bmcpKSgqKGppbnRMb25nICoqKWFyZzEpW2FyZzBdKShhcmcxLCBhcmcyLCBscGFyZzMsIGFyZzQp
OworZmFpbDoKKwlpZiAoYXJnMyAmJiBscGFyZzMpIGVudi0+UmVsZWFzZUludEFycmF5RWxlbWVu
dHMoYXJnMywgbHBhcmczLCAwKTsKKyNpZm5kZWYgSk5JNjQKKwlYUENPTV9OQVRJVkVfRVhJVChl
bnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSV8zSUpfRlVOQyk7CisjZWxzZQorCVhQQ09NX05BVElW
RV9FWElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpJXzNJSl9GVU5DKTsKKyNlbmRpZgorCXJl
dHVybiByYzsKK30KKyNlbmRpZgorCisjaWYgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lJSV8z
SV8zSV8zSSkgJiYgIWRlZmluZWQoSk5JNjQpKSB8fCAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9f
SUpJXzNJXzNJXzNJKSAmJiBkZWZpbmVkKEpOSTY0KSkKKyNpZm5kZWYgSk5JNjQKK2V4dGVybiAi
QyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlJXzNJ
XzNJXzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJn
MSwgamludCBhcmcyLCBqaW50QXJyYXkgYXJnMywgamludEFycmF5IGFyZzQsIGppbnRBcnJheSBh
cmc1KTsKK0pOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJ
SV8zSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25n
IGFyZzEsIGppbnQgYXJnMiwgamludEFycmF5IGFyZzMsIGppbnRBcnJheSBhcmc0LCBqaW50QXJy
YXkgYXJnNSkKKyNlbHNlCitleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01f
TkFUSVZFKF8xVnRibENhbGxfX0lKSV8zSV8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0
LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludEFycmF5IGFyZzMsIGpp
bnRBcnJheSBhcmc0LCBqaW50QXJyYXkgYXJnNSk7CitKTklFWFBPUlQgamludCBKTklDQUxMIFhQ
Q09NX05BVElWRShfMVZ0YmxDYWxsX19JSklfM0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3Mg
dGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqaW50IGFyZzIsIGppbnRBcnJheSBhcmcz
LCBqaW50QXJyYXkgYXJnNCwgamludEFycmF5IGFyZzUpCisjZW5kaWYKK3sKKwlqaW50ICpscGFy
ZzM9TlVMTDsKKwlqaW50ICpscGFyZzQ9TlVMTDsKKwlqaW50ICpscGFyZzU9TlVMTDsKKwlqaW50
IHJjID0gMDsKKyNpZm5kZWYgSk5JNjQKKwlYUENPTV9OQVRJVkVfRU5URVIoZW52LCB0aGF0LCBf
MVZ0YmxDYWxsX19JSUlfM0lfM0lfM0lfRlVOQyk7CisjZWxzZQorCVhQQ09NX05BVElWRV9FTlRF
UihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSV8zSV8zSV8zSV9GVU5DKTsKKyNlbmRpZgorCWlm
IChhcmczKSBpZiAoKGxwYXJnMyA9IGVudi0+R2V0SW50QXJyYXlFbGVtZW50cyhhcmczLCBOVUxM
KSkgPT0gTlVMTCkgZ290byBmYWlsOworCWlmIChhcmc0KSBpZiAoKGxwYXJnNCA9IGVudi0+R2V0
SW50QXJyYXlFbGVtZW50cyhhcmc0LCBOVUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOworCWlmIChh
cmc1KSBpZiAoKGxwYXJnNSA9IGVudi0+R2V0SW50QXJyYXlFbGVtZW50cyhhcmc1LCBOVUxMKSkg
PT0gTlVMTCkgZ290byBmYWlsOworCXJjID0gKGppbnQpKChqaW50IChTVERNRVRIT0RDQUxMVFlQ
RSAqKShqaW50TG9uZywgamludCwgamludCAqLCBqaW50ICosIGppbnQgKikpKCooamludExvbmcg
KiopYXJnMSlbYXJnMF0pKGFyZzEsIGFyZzIsIGxwYXJnMywgbHBhcmc0LCBscGFyZzUpOworZmFp
bDoKKwlpZiAoYXJnNSAmJiBscGFyZzUpIGVudi0+UmVsZWFzZUludEFycmF5RWxlbWVudHMoYXJn
NSwgbHBhcmc1LCAwKTsKKwlpZiAoYXJnNCAmJiBscGFyZzQpIGVudi0+UmVsZWFzZUludEFycmF5
RWxlbWVudHMoYXJnNCwgbHBhcmc0LCAwKTsKKwlpZiAoYXJnMyAmJiBscGFyZzMpIGVudi0+UmVs
ZWFzZUludEFycmF5RWxlbWVudHMoYXJnMywgbHBhcmczLCAwKTsKKyNpZm5kZWYgSk5JNjQKKwlY
UENPTV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSV8zSV8zSV8zSV9GVU5D
KTsKKyNlbHNlCisJWFBDT01fTkFUSVZFX0VYSVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSklf
M0lfM0lfM0lfRlVOQyk7CisjZW5kaWYKKwlyZXR1cm4gcmM7Cit9CisjZW5kaWYKKwogI2lmICgh
ZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSUlfM0lfM0lfM0lfM0kpICYmICFkZWZpbmVkKEpOSTY0
KSkgfHwgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lKSV8zSV8zSV8zSV8zSSkgJiYgZGVmaW5l
ZChKTkk2NCkpCiAjaWZuZGVmIEpOSTY0CiBleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNB
TEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJSV8zSV8zSV8zSV8zSSkoSk5JRW52ICplbnYs
IGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludEFy
cmF5IGFyZzMsIGppbnRBcnJheSBhcmc0LCBqaW50QXJyYXkgYXJnNSwgamludEFycmF5IGFyZzYp
OwpAQCAtMTk2MSw2ICsyMTU2LDQxIEBACiB9CiAjZW5kaWYKIAorI2lmICghZGVmaW5lZChOT19f
MVZ0YmxDYWxsX19JSUlfM0lfM0lfM0opICYmICFkZWZpbmVkKEpOSTY0KSkgfHwgKCFkZWZpbmVk
KE5PX18xVnRibENhbGxfX0lKSV8zSV8zSV8zSikgJiYgZGVmaW5lZChKTkk2NCkpCisjaWZuZGVm
IEpOSTY0CitleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8x
VnRibENhbGxfX0lJSV8zSV8zSV8zSikoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFy
ZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwgamludEFycmF5IGFyZzMsIGppbnRBcnJheSBh
cmc0LCBqbG9uZ0FycmF5IGFyZzUpOworSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJ
VkUoXzFWdGJsQ2FsbF9fSUlJXzNJXzNJXzNKKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGpp
bnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBhcmcyLCBqaW50QXJyYXkgYXJnMywgamludEFy
cmF5IGFyZzQsIGpsb25nQXJyYXkgYXJnNSkKKyNlbHNlCitleHRlcm4gIkMiIEpOSUVYUE9SVCBq
aW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lKSV8zSV8zSV8zSikoSk5JRW52
ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGppbnQgYXJnMiwg
amludEFycmF5IGFyZzMsIGppbnRBcnJheSBhcmc0LCBqbG9uZ0FycmF5IGFyZzUpOworSk5JRVhQ
T1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpJXzNJXzNJXzNKKShK
TklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamludCBh
cmcyLCBqaW50QXJyYXkgYXJnMywgamludEFycmF5IGFyZzQsIGpsb25nQXJyYXkgYXJnNSkKKyNl
bmRpZgoreworCWppbnQgKmxwYXJnMz1OVUxMOworCWppbnQgKmxwYXJnND1OVUxMOworCWpsb25n
ICpscGFyZzU9TlVMTDsKKwlqaW50IHJjID0gMDsKKyNpZm5kZWYgSk5JNjQKKwlYUENPTV9OQVRJ
VkVfRU5URVIoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSUlfM0lfM0lfM0pfRlVOQyk7CisjZWxz
ZQorCVhQQ09NX05BVElWRV9FTlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSV8zSV8zSV8z
Sl9GVU5DKTsKKyNlbmRpZgorCWlmIChhcmczKSBpZiAoKGxwYXJnMyA9IGVudi0+R2V0SW50QXJy
YXlFbGVtZW50cyhhcmczLCBOVUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOworCWlmIChhcmc0KSBp
ZiAoKGxwYXJnNCA9IGVudi0+R2V0SW50QXJyYXlFbGVtZW50cyhhcmc0LCBOVUxMKSkgPT0gTlVM
TCkgZ290byBmYWlsOworCWlmIChhcmc1KSBpZiAoKGxwYXJnNSA9IGVudi0+R2V0TG9uZ0FycmF5
RWxlbWVudHMoYXJnNSwgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsKKwlyYyA9IChqaW50KSgo
amludCAoU1RETUVUSE9EQ0FMTFRZUEUgKikoamludExvbmcsIGppbnQsIGppbnQgKiwgamludCAq
LCBqbG9uZyAqKSkoKihqaW50TG9uZyAqKilhcmcxKVthcmcwXSkoYXJnMSwgYXJnMiwgbHBhcmcz
LCBscGFyZzQsIGxwYXJnNSk7CitmYWlsOgorCWlmIChhcmc1ICYmIGxwYXJnNSkgZW52LT5SZWxl
YXNlTG9uZ0FycmF5RWxlbWVudHMoYXJnNSwgbHBhcmc1LCAwKTsKKwlpZiAoYXJnNCAmJiBscGFy
ZzQpIGVudi0+UmVsZWFzZUludEFycmF5RWxlbWVudHMoYXJnNCwgbHBhcmc0LCAwKTsKKwlpZiAo
YXJnMyAmJiBscGFyZzMpIGVudi0+UmVsZWFzZUludEFycmF5RWxlbWVudHMoYXJnMywgbHBhcmcz
LCAwKTsKKyNpZm5kZWYgSk5JNjQKKwlYUENPTV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIF8xVnRi
bENhbGxfX0lJSV8zSV8zSV8zSl9GVU5DKTsKKyNlbHNlCisJWFBDT01fTkFUSVZFX0VYSVQoZW52
LCB0aGF0LCBfMVZ0YmxDYWxsX19JSklfM0lfM0lfM0pfRlVOQyk7CisjZW5kaWYKKwlyZXR1cm4g
cmM7Cit9CisjZW5kaWYKKwogI2lmICghZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSUopICYmICFk
ZWZpbmVkKEpOSTY0KSkgfHwgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lKSikgJiYgZGVmaW5l
ZChKTkk2NCkpCiAjaWZuZGVmIEpOSTY0CiBleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNB
TEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJSikoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0
LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25nIGFyZzIpOwpAQCAtMjA5Myw2ICsyMzIz
LDEzMCBAQAogfQogI2VuZGlmCiAKKyNpZiAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9fSUlKSUlf
M0kpICYmICFkZWZpbmVkKEpOSTY0KSkgfHwgKCFkZWZpbmVkKE5PX18xVnRibENhbGxfX0lKSklJ
XzNJKSAmJiBkZWZpbmVkKEpOSTY0KSkKKyNpZm5kZWYgSk5JNjQKK2V4dGVybiAiQyIgSk5JRVhQ
T1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlKSUlfM0kpKEpOSUVu
diAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBhcmcy
LCBqaW50IGFyZzMsIGppbnQgYXJnNCwgamludEFycmF5IGFyZzUpOworSk5JRVhQT1JUIGppbnQg
Sk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlKSUlfM0kpKEpOSUVudiAqZW52LCBq
Y2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBhcmcyLCBqaW50IGFy
ZzMsIGppbnQgYXJnNCwgamludEFycmF5IGFyZzUpCisjZWxzZQorZXh0ZXJuICJDIiBKTklFWFBP
UlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSkpJSV8zSSkoSk5JRW52
ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25nIGFyZzIs
IGppbnQgYXJnMywgamludCBhcmc0LCBqaW50QXJyYXkgYXJnNSk7CitKTklFWFBPUlQgamludCBK
TklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSkpJSV8zSSkoSk5JRW52ICplbnYsIGpj
bGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25nIGFyZzIsIGppbnQgYXJn
MywgamludCBhcmc0LCBqaW50QXJyYXkgYXJnNSkKKyNlbmRpZgoreworCWppbnQgKmxwYXJnNT1O
VUxMOworCWppbnQgcmMgPSAwOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9FTlRFUihl
bnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSklJXzNJX0ZVTkMpOworI2Vsc2UKKwlYUENPTV9OQVRJ
VkVfRU5URVIoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSkpJSV8zSV9GVU5DKTsKKyNlbmRpZgor
CWlmIChhcmc1KSBpZiAoKGxwYXJnNSA9IGVudi0+R2V0SW50QXJyYXlFbGVtZW50cyhhcmc1LCBO
VUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOworCXJjID0gKGppbnQpKChqaW50IChTVERNRVRIT0RD
QUxMVFlQRSAqKShqaW50TG9uZywgamxvbmcsIGppbnQsIGppbnQsIGppbnQgKikpKCooamludExv
bmcgKiopYXJnMSlbYXJnMF0pKGFyZzEsIGFyZzIsIGFyZzMsIGFyZzQsIGxwYXJnNSk7CitmYWls
OgorCWlmIChhcmc1ICYmIGxwYXJnNSkgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmc1
LCBscGFyZzUsIDApOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9FWElUKGVudiwgdGhh
dCwgXzFWdGJsQ2FsbF9fSUlKSUlfM0lfRlVOQyk7CisjZWxzZQorCVhQQ09NX05BVElWRV9FWElU
KGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpKSUlfM0lfRlVOQyk7CisjZW5kaWYKKwlyZXR1cm4g
cmM7Cit9CisjZW5kaWYKKworI2lmICghZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSUpJSklJKSAm
JiAhZGVmaW5lZChKTkk2NCkpIHx8ICghZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSkpJSklJKSAm
JiBkZWZpbmVkKEpOSTY0KSkKKyNpZm5kZWYgSk5JNjQKK2V4dGVybiAiQyIgSk5JRVhQT1JUIGpp
bnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlKSUpJSSkoSk5JRW52ICplbnYs
IGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25nIGFyZzIsIGppbnQg
YXJnMywgamxvbmcgYXJnNCwgamludCBhcmc1LCBqaW50IGFyZzYpOworSk5JRVhQT1JUIGppbnQg
Sk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlKSUpJSSkoSk5JRW52ICplbnYsIGpj
bGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25nIGFyZzIsIGppbnQgYXJn
MywgamxvbmcgYXJnNCwgamludCBhcmc1LCBqaW50IGFyZzYpCisjZWxzZQorZXh0ZXJuICJDIiBK
TklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSkpJSklJKShK
TklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamxvbmcg
YXJnMiwgamludCBhcmczLCBqbG9uZyBhcmc0LCBqaW50IGFyZzUsIGppbnQgYXJnNik7CitKTklF
WFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0YmxDYWxsX19JSkpJSklJKShKTklF
bnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamxvbmcgYXJn
MiwgamludCBhcmczLCBqbG9uZyBhcmc0LCBqaW50IGFyZzUsIGppbnQgYXJnNikKKyNlbmRpZgor
eworCWppbnQgcmMgPSAwOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9FTlRFUihlbnYs
IHRoYXQsIF8xVnRibENhbGxfX0lJSklKSUlfRlVOQyk7CisjZWxzZQorCVhQQ09NX05BVElWRV9F
TlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSklKSUlfRlVOQyk7CisjZW5kaWYKKwlyYyA9
IChqaW50KSgoamludCAoU1RETUVUSE9EQ0FMTFRZUEUgKikoamludExvbmcsIGpsb25nLCBqaW50
LCBqbG9uZywgamludCwgamludCkpKCooamludExvbmcgKiopYXJnMSlbYXJnMF0pKGFyZzEsIGFy
ZzIsIGFyZzMsIGFyZzQsIGFyZzUsIGFyZzYpOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElW
RV9FWElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlKSUpJSV9GVU5DKTsKKyNlbHNlCisJWFBD
T01fTkFUSVZFX0VYSVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSkpJSklJX0ZVTkMpOworI2Vu
ZGlmCisJcmV0dXJuIHJjOworfQorI2VuZGlmCisKKyNpZiAoIWRlZmluZWQoTk9fXzFWdGJsQ2Fs
bF9fSUlKSUpKXzNJXzNJXzNJKSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8ICghZGVmaW5lZChOT19f
MVZ0YmxDYWxsX19JSkpJSkpfM0lfM0lfM0kpICYmIGRlZmluZWQoSk5JNjQpKQorI2lmbmRlZiBK
Tkk2NAorZXh0ZXJuICJDIiBKTklFWFBPUlQgamludCBKTklDQUxMIFhQQ09NX05BVElWRShfMVZ0
YmxDYWxsX19JSUpJSkpfM0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBh
cmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBhcmcyLCBqaW50IGFyZzMsIGpsb25nIGFyZzQsIGps
b25nIGFyZzUsIGppbnRBcnJheSBhcmc2LCBqaW50QXJyYXkgYXJnNywgamludEFycmF5IGFyZzgp
OworSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlKSUpK
XzNJXzNJXzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcg
YXJnMSwgamxvbmcgYXJnMiwgamludCBhcmczLCBqbG9uZyBhcmc0LCBqbG9uZyBhcmc1LCBqaW50
QXJyYXkgYXJnNiwgamludEFycmF5IGFyZzcsIGppbnRBcnJheSBhcmc4KQorI2Vsc2UKK2V4dGVy
biAiQyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpK
SUpKXzNJXzNJXzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExv
bmcgYXJnMSwgamxvbmcgYXJnMiwgamludCBhcmczLCBqbG9uZyBhcmc0LCBqbG9uZyBhcmc1LCBq
aW50QXJyYXkgYXJnNiwgamludEFycmF5IGFyZzcsIGppbnRBcnJheSBhcmc4KTsKK0pOSUVYUE9S
VCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lKSklKSl8zSV8zSV8zSSko
Sk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25n
IGFyZzIsIGppbnQgYXJnMywgamxvbmcgYXJnNCwgamxvbmcgYXJnNSwgamludEFycmF5IGFyZzYs
IGppbnRBcnJheSBhcmc3LCBqaW50QXJyYXkgYXJnOCkKKyNlbmRpZgoreworCWppbnQgKmxwYXJn
Nj1OVUxMOworCWppbnQgKmxwYXJnNz1OVUxMOworCWppbnQgKmxwYXJnOD1OVUxMOworCWppbnQg
cmMgPSAwOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9FTlRFUihlbnYsIHRoYXQsIF8x
VnRibENhbGxfX0lJSklKSl8zSV8zSV8zSV9GVU5DKTsKKyNlbHNlCisJWFBDT01fTkFUSVZFX0VO
VEVSKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpKSUpKXzNJXzNJXzNJX0ZVTkMpOworI2VuZGlm
CisJaWYgKGFyZzYpIGlmICgobHBhcmc2ID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzYs
IE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJaWYgKGFyZzcpIGlmICgobHBhcmc3ID0gZW52
LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzcsIE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJ
aWYgKGFyZzgpIGlmICgobHBhcmc4ID0gZW52LT5HZXRJbnRBcnJheUVsZW1lbnRzKGFyZzgsIE5V
TEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7CisJcmMgPSAoamludCkoKGppbnQgKFNURE1FVEhPRENB
TExUWVBFICopKGppbnRMb25nLCBqbG9uZywgamludCwgamxvbmcsIGpsb25nLCBqaW50ICosIGpp
bnQgKiwgamludCAqKSkoKihqaW50TG9uZyAqKilhcmcxKVthcmcwXSkoYXJnMSwgYXJnMiwgYXJn
MywgYXJnNCwgYXJnNSwgbHBhcmc2LCBscGFyZzcsIGxwYXJnOCk7CitmYWlsOgorCWlmIChhcmc4
ICYmIGxwYXJnOCkgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmc4LCBscGFyZzgsIDAp
OworCWlmIChhcmc3ICYmIGxwYXJnNykgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmc3
LCBscGFyZzcsIDApOworCWlmIChhcmc2ICYmIGxwYXJnNikgZW52LT5SZWxlYXNlSW50QXJyYXlF
bGVtZW50cyhhcmc2LCBscGFyZzYsIDApOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9F
WElUKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlKSUpKXzNJXzNJXzNJX0ZVTkMpOworI2Vsc2UK
KwlYUENPTV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSklKSl8zSV8zSV8z
SV9GVU5DKTsKKyNlbmRpZgorCXJldHVybiByYzsKK30KKyNlbmRpZgorCisjaWYgKCFkZWZpbmVk
KE5PX18xVnRibENhbGxfX0lJSklKXzNJXzNJXzNJKSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8ICgh
ZGVmaW5lZChOT19fMVZ0YmxDYWxsX19JSkpJSl8zSV8zSV8zSSkgJiYgZGVmaW5lZChKTkk2NCkp
CisjaWZuZGVmIEpOSTY0CitleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01f
TkFUSVZFKF8xVnRibENhbGxfX0lJSklKXzNJXzNJXzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRo
YXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamxvbmcgYXJnMiwgamludCBhcmczLCBqbG9u
ZyBhcmc0LCBqaW50QXJyYXkgYXJnNSwgamludEFycmF5IGFyZzYsIGppbnRBcnJheSBhcmc3KTsK
K0pOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJSklKXzNJ
XzNJXzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJn
MSwgamxvbmcgYXJnMiwgamludCBhcmczLCBqbG9uZyBhcmc0LCBqaW50QXJyYXkgYXJnNSwgamlu
dEFycmF5IGFyZzYsIGppbnRBcnJheSBhcmc3KQorI2Vsc2UKK2V4dGVybiAiQyIgSk5JRVhQT1JU
IGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpKSUpfM0lfM0lfM0kpKEpO
SUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBh
cmcyLCBqaW50IGFyZzMsIGpsb25nIGFyZzQsIGppbnRBcnJheSBhcmc1LCBqaW50QXJyYXkgYXJn
NiwgamludEFycmF5IGFyZzcpOworSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUo
XzFWdGJsQ2FsbF9fSUpKSUpfM0lfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamlu
dCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBhcmcyLCBqaW50IGFyZzMsIGpsb25nIGFyZzQs
IGppbnRBcnJheSBhcmc1LCBqaW50QXJyYXkgYXJnNiwgamludEFycmF5IGFyZzcpCisjZW5kaWYK
K3sKKwlqaW50ICpscGFyZzU9TlVMTDsKKwlqaW50ICpscGFyZzY9TlVMTDsKKwlqaW50ICpscGFy
Zzc9TlVMTDsKKwlqaW50IHJjID0gMDsKKyNpZm5kZWYgSk5JNjQKKwlYUENPTV9OQVRJVkVfRU5U
RVIoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSUpJSl8zSV8zSV8zSV9GVU5DKTsKKyNlbHNlCisJ
WFBDT01fTkFUSVZFX0VOVEVSKGVudiwgdGhhdCwgXzFWdGJsQ2FsbF9fSUpKSUpfM0lfM0lfM0lf
RlVOQyk7CisjZW5kaWYKKwlpZiAoYXJnNSkgaWYgKChscGFyZzUgPSBlbnYtPkdldEludEFycmF5
RWxlbWVudHMoYXJnNSwgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsKKwlpZiAoYXJnNikgaWYg
KChscGFyZzYgPSBlbnYtPkdldEludEFycmF5RWxlbWVudHMoYXJnNiwgTlVMTCkpID09IE5VTEwp
IGdvdG8gZmFpbDsKKwlpZiAoYXJnNykgaWYgKChscGFyZzcgPSBlbnYtPkdldEludEFycmF5RWxl
bWVudHMoYXJnNywgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsKKwlyYyA9IChqaW50KSgoamlu
dCAoU1RETUVUSE9EQ0FMTFRZUEUgKikoamludExvbmcsIGpsb25nLCBqaW50LCBqbG9uZywgamlu
dCAqLCBqaW50ICosIGppbnQgKikpKCooamludExvbmcgKiopYXJnMSlbYXJnMF0pKGFyZzEsIGFy
ZzIsIGFyZzMsIGFyZzQsIGxwYXJnNSwgbHBhcmc2LCBscGFyZzcpOworZmFpbDoKKwlpZiAoYXJn
NyAmJiBscGFyZzcpIGVudi0+UmVsZWFzZUludEFycmF5RWxlbWVudHMoYXJnNywgbHBhcmc3LCAw
KTsKKwlpZiAoYXJnNiAmJiBscGFyZzYpIGVudi0+UmVsZWFzZUludEFycmF5RWxlbWVudHMoYXJn
NiwgbHBhcmc2LCAwKTsKKwlpZiAoYXJnNSAmJiBscGFyZzUpIGVudi0+UmVsZWFzZUludEFycmF5
RWxlbWVudHMoYXJnNSwgbHBhcmc1LCAwKTsKKyNpZm5kZWYgSk5JNjQKKwlYUENPTV9OQVRJVkVf
RVhJVChlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSklKXzNJXzNJXzNJX0ZVTkMpOworI2Vsc2UK
KwlYUENPTV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSklKXzNJXzNJXzNJ
X0ZVTkMpOworI2VuZGlmCisJcmV0dXJuIHJjOworfQorI2VuZGlmCisKICNpZiAoIWRlZmluZWQo
Tk9fXzFWdGJsQ2FsbF9fSUlKSV8zSikgJiYgIWRlZmluZWQoSk5JNjQpKSB8fCAoIWRlZmluZWQo
Tk9fXzFWdGJsQ2FsbF9fSUpKSV8zSikgJiYgZGVmaW5lZChKTkk2NCkpCiAjaWZuZGVmIEpOSTY0
CiBleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENh
bGxfX0lJSklfM0opKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9u
ZyBhcmcxLCBqbG9uZyBhcmcyLCBqaW50IGFyZzMsIGpsb25nQXJyYXkgYXJnNCk7CkBAIC0yNjA5
LDYgKzI5NjMsMzUgQEAKIH0KICNlbmRpZgogCisjaWYgKCFkZWZpbmVkKE5PX18xVnRibENhbGxf
X0lJSkpKXzNJKSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8ICghZGVmaW5lZChOT19fMVZ0YmxDYWxs
X19JSkpKSl8zSSkgJiYgZGVmaW5lZChKTkk2NCkpCisjaWZuZGVmIEpOSTY0CitleHRlcm4gIkMi
IEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJSkpKXzNJ
KShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwgamxv
bmcgYXJnMiwgamxvbmcgYXJnMywgamxvbmcgYXJnNCwgamludEFycmF5IGFyZzUpOworSk5JRVhQ
T1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUlKSkpfM0kpKEpOSUVu
diAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBhcmcy
LCBqbG9uZyBhcmczLCBqbG9uZyBhcmc0LCBqaW50QXJyYXkgYXJnNSkKKyNlbHNlCitleHRlcm4g
IkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lKSkpK
XzNJKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJnMSwg
amxvbmcgYXJnMiwgamxvbmcgYXJnMywgamxvbmcgYXJnNCwgamludEFycmF5IGFyZzUpOworSk5J
RVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2FsbF9fSUpKSkpfM0kpKEpO
SUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBh
cmcyLCBqbG9uZyBhcmczLCBqbG9uZyBhcmc0LCBqaW50QXJyYXkgYXJnNSkKKyNlbmRpZgorewor
CWppbnQgKmxwYXJnNT1OVUxMOworCWppbnQgcmMgPSAwOworI2lmbmRlZiBKTkk2NAorCVhQQ09N
X05BVElWRV9FTlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSkpKXzNJX0ZVTkMpOworI2Vs
c2UKKwlYUENPTV9OQVRJVkVfRU5URVIoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSkpKSl8zSV9G
VU5DKTsKKyNlbmRpZgorCWlmIChhcmc1KSBpZiAoKGxwYXJnNSA9IGVudi0+R2V0SW50QXJyYXlF
bGVtZW50cyhhcmc1LCBOVUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOworCXJjID0gKGppbnQpKChq
aW50IChTVERNRVRIT0RDQUxMVFlQRSAqKShqaW50TG9uZywgamxvbmcsIGpsb25nLCBqbG9uZywg
amludCAqKSkoKihqaW50TG9uZyAqKilhcmcxKVthcmcwXSkoYXJnMSwgYXJnMiwgYXJnMywgYXJn
NCwgbHBhcmc1KTsKK2ZhaWw6CisJaWYgKGFyZzUgJiYgbHBhcmc1KSBlbnYtPlJlbGVhc2VJbnRB
cnJheUVsZW1lbnRzKGFyZzUsIGxwYXJnNSwgMCk7CisjaWZuZGVmIEpOSTY0CisJWFBDT01fTkFU
SVZFX0VYSVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSUpKSl8zSV9GVU5DKTsKKyNlbHNlCisJ
WFBDT01fTkFUSVZFX0VYSVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSkpKSl8zSV9GVU5DKTsK
KyNlbmRpZgorCXJldHVybiByYzsKK30KKyNlbmRpZgorCiAjaWYgKCFkZWZpbmVkKE5PX18xVnRi
bENhbGxfX0lJSkpKXzNKKSAmJiAhZGVmaW5lZChKTkk2NCkpIHx8ICghZGVmaW5lZChOT19fMVZ0
YmxDYWxsX19JSkpKSl8zSikgJiYgZGVmaW5lZChKTkk2NCkpCiAjaWZuZGVmIEpOSTY0CiBleHRl
cm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJ
SkpKXzNKKShKTklFbnYgKmVudiwgamNsYXNzIHRoYXQsIGppbnQgYXJnMCwgamludExvbmcgYXJn
MSwgamxvbmcgYXJnMiwgamxvbmcgYXJnMywgamxvbmcgYXJnNCwgamxvbmdBcnJheSBhcmc1KTsK
QEAgLTI4NzksNiArMzI2MiwzOCBAQAogfQogI2VuZGlmCiAKKyNpZiAoIWRlZmluZWQoTk9fXzFW
dGJsQ2FsbF9fSUlKSl8zSV8zSSkgJiYgIWRlZmluZWQoSk5JNjQpKSB8fCAoIWRlZmluZWQoTk9f
XzFWdGJsQ2FsbF9fSUpKSl8zSV8zSSkgJiYgZGVmaW5lZChKTkk2NCkpCisjaWZuZGVmIEpOSTY0
CitleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENh
bGxfX0lJSkpfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50
TG9uZyBhcmcxLCBqbG9uZyBhcmcyLCBqbG9uZyBhcmczLCBqaW50QXJyYXkgYXJnNCwgamludEFy
cmF5IGFyZzUpOworSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoXzFWdGJsQ2Fs
bF9fSUlKSl8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnRM
b25nIGFyZzEsIGpsb25nIGFyZzIsIGpsb25nIGFyZzMsIGppbnRBcnJheSBhcmc0LCBqaW50QXJy
YXkgYXJnNSkKKyNlbHNlCitleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01f
TkFUSVZFKF8xVnRibENhbGxfX0lKSkpfM0lfM0kpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwg
amludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBhcmcyLCBqbG9uZyBhcmczLCBqaW50QXJy
YXkgYXJnNCwgamludEFycmF5IGFyZzUpOworSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9O
QVRJVkUoXzFWdGJsQ2FsbF9fSUpKSl8zSV8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBq
aW50IGFyZzAsIGppbnRMb25nIGFyZzEsIGpsb25nIGFyZzIsIGpsb25nIGFyZzMsIGppbnRBcnJh
eSBhcmc0LCBqaW50QXJyYXkgYXJnNSkKKyNlbmRpZgoreworCWppbnQgKmxwYXJnND1OVUxMOwor
CWppbnQgKmxwYXJnNT1OVUxMOworCWppbnQgcmMgPSAwOworI2lmbmRlZiBKTkk2NAorCVhQQ09N
X05BVElWRV9FTlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lJSkpfM0lfM0lfRlVOQyk7Cisj
ZWxzZQorCVhQQ09NX05BVElWRV9FTlRFUihlbnYsIHRoYXQsIF8xVnRibENhbGxfX0lKSkpfM0lf
M0lfRlVOQyk7CisjZW5kaWYKKwlpZiAoYXJnNCkgaWYgKChscGFyZzQgPSBlbnYtPkdldEludEFy
cmF5RWxlbWVudHMoYXJnNCwgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsKKwlpZiAoYXJnNSkg
aWYgKChscGFyZzUgPSBlbnYtPkdldEludEFycmF5RWxlbWVudHMoYXJnNSwgTlVMTCkpID09IE5V
TEwpIGdvdG8gZmFpbDsKKwlyYyA9IChqaW50KSgoamludCAoU1RETUVUSE9EQ0FMTFRZUEUgKiko
amludExvbmcsIGpsb25nLCBqbG9uZywgamludCAqLCBqaW50ICopKSgqKGppbnRMb25nICoqKWFy
ZzEpW2FyZzBdKShhcmcxLCBhcmcyLCBhcmczLCBscGFyZzQsIGxwYXJnNSk7CitmYWlsOgorCWlm
IChhcmc1ICYmIGxwYXJnNSkgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50cyhhcmc1LCBscGFy
ZzUsIDApOworCWlmIChhcmc0ICYmIGxwYXJnNCkgZW52LT5SZWxlYXNlSW50QXJyYXlFbGVtZW50
cyhhcmc0LCBscGFyZzQsIDApOworI2lmbmRlZiBKTkk2NAorCVhQQ09NX05BVElWRV9FWElUKGVu
diwgdGhhdCwgXzFWdGJsQ2FsbF9fSUlKSl8zSV8zSV9GVU5DKTsKKyNlbHNlCisJWFBDT01fTkFU
SVZFX0VYSVQoZW52LCB0aGF0LCBfMVZ0YmxDYWxsX19JSkpKXzNJXzNJX0ZVTkMpOworI2VuZGlm
CisJcmV0dXJuIHJjOworfQorI2VuZGlmCisKICNpZiAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9f
SUlKSl8zSikgJiYgIWRlZmluZWQoSk5JNjQpKSB8fCAoIWRlZmluZWQoTk9fXzFWdGJsQ2FsbF9f
SUpKSl8zSikgJiYgZGVmaW5lZChKTkk2NCkpCiAjaWZuZGVmIEpOSTY0CiBleHRlcm4gIkMiIEpO
SUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKF8xVnRibENhbGxfX0lJSkpfM0opKEpO
SUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50TG9uZyBhcmcxLCBqbG9uZyBh
cmcyLCBqbG9uZyBhcmczLCBqbG9uZ0FycmF5IGFyZzQpOwpJbmRleDogRWNsaXBzZSBTV1QgTW96
aWxsYS9jb21tb24vbGlicmFyeS94cGNvbV9zdGF0cy5oCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9j
dnNyb290L2VjbGlwc2Uvb3JnLmVjbGlwc2Uuc3d0L0VjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9u
L2xpYnJhcnkveHBjb21fc3RhdHMuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS41MQpkaWZmIC11
IC1yMS41MSB4cGNvbV9zdGF0cy5oCi0tLSBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9saWJy
YXJ5L3hwY29tX3N0YXRzLmgJMjkgTWF5IDIwMDkgMjE6MzA6MTMgLTAwMDAJMS41MQorKysgRWNs
aXBzZSBTV1QgTW96aWxsYS9jb21tb24vbGlicmFyeS94cGNvbV9zdGF0cy5oCTE5IEF1ZyAyMDA5
IDE5OjU3OjIzIC0wMDAwCkBAIC0xNDIsNiArMTQyLDExIEBACiAJXzFWdGJsQ2FsbF9fSUpJSUlJ
XzNJXzNJX0ZVTkMsCiAjZW5kaWYKICNpZm5kZWYgSk5JNjQKKwlfMVZ0YmxDYWxsX19JSUlJSUlf
M0lfM0lfM0lfRlVOQywKKyNlbHNlCisJXzFWdGJsQ2FsbF9fSUpJSUlJXzNJXzNJXzNJX0ZVTkMs
CisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKIAlfMVZ0YmxDYWxsX19JSUlJSV8zQl8zQklfRlVOQywK
ICNlbHNlCiAJXzFWdGJsQ2FsbF9fSUpJSUlfM0JfM0JJX0ZVTkMsCkBAIC0xNTcsNiArMTYyLDEx
IEBACiAJXzFWdGJsQ2FsbF9fSUpJSUlfM0lfRlVOQywKICNlbmRpZgogI2lmbmRlZiBKTkk2NAor
CV8xVnRibENhbGxfX0lJSUlJXzNJXzNJXzNJX0ZVTkMsCisjZWxzZQorCV8xVnRibENhbGxfX0lK
SUlJXzNJXzNJXzNJX0ZVTkMsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKIAlfMVZ0YmxDYWxsX19J
SUlJSkpKSl9GVU5DLAogI2Vsc2UKIAlfMVZ0YmxDYWxsX19JSklJSkpKSl9GVU5DLApAQCAtMjA3
LDYgKzIxNywxMSBAQAogCV8xVnRibENhbGxfX0lKSUlfM0lfRlVOQywKICNlbmRpZgogI2lmbmRl
ZiBKTkk2NAorCV8xVnRibENhbGxfX0lJSUlfM0lfM0lfRlVOQywKKyNlbHNlCisJXzFWdGJsQ2Fs
bF9fSUpJSV8zSV8zSV9GVU5DLAorI2VuZGlmCisjaWZuZGVmIEpOSTY0CiAJXzFWdGJsQ2FsbF9f
SUlJSV8zSl9GVU5DLAogI2Vsc2UKIAlfMVZ0YmxDYWxsX19JSklJXzNKX0ZVTkMsCkBAIC0zMzIs
MTEgKzM0NywzMSBAQAogCV8xVnRibENhbGxfX0lKSV8zSV9GVU5DLAogI2VuZGlmCiAjaWZuZGVm
IEpOSTY0CisJXzFWdGJsQ2FsbF9fSUlJXzNJSV9GVU5DLAorI2Vsc2UKKwlfMVZ0YmxDYWxsX19J
SklfM0lJX0ZVTkMsCisjZW5kaWYKKyNpZm5kZWYgSk5JNjQKKwlfMVZ0YmxDYWxsX19JSUlfM0lK
X0ZVTkMsCisjZWxzZQorCV8xVnRibENhbGxfX0lKSV8zSUpfRlVOQywKKyNlbmRpZgorI2lmbmRl
ZiBKTkk2NAorCV8xVnRibENhbGxfX0lJSV8zSV8zSV8zSV9GVU5DLAorI2Vsc2UKKwlfMVZ0YmxD
YWxsX19JSklfM0lfM0lfM0lfRlVOQywKKyNlbmRpZgorI2lmbmRlZiBKTkk2NAogCV8xVnRibENh
bGxfX0lJSV8zSV8zSV8zSV8zSV9GVU5DLAogI2Vsc2UKIAlfMVZ0YmxDYWxsX19JSklfM0lfM0lf
M0lfM0lfRlVOQywKICNlbmRpZgogI2lmbmRlZiBKTkk2NAorCV8xVnRibENhbGxfX0lJSV8zSV8z
SV8zSl9GVU5DLAorI2Vsc2UKKwlfMVZ0YmxDYWxsX19JSklfM0lfM0lfM0pfRlVOQywKKyNlbmRp
ZgorI2lmbmRlZiBKTkk2NAogCV8xVnRibENhbGxfX0lJSl9GVU5DLAogI2Vsc2UKIAlfMVZ0YmxD
YWxsX19JSkpfRlVOQywKQEAgLTM2Miw2ICszOTcsMjYgQEAKIAlfMVZ0YmxDYWxsX19JSkpJSUpf
M0lfM0pfRlVOQywKICNlbmRpZgogI2lmbmRlZiBKTkk2NAorCV8xVnRibENhbGxfX0lJSklJXzNJ
X0ZVTkMsCisjZWxzZQorCV8xVnRibENhbGxfX0lKSklJXzNJX0ZVTkMsCisjZW5kaWYKKyNpZm5k
ZWYgSk5JNjQKKwlfMVZ0YmxDYWxsX19JSUpJSklJX0ZVTkMsCisjZWxzZQorCV8xVnRibENhbGxf
X0lKSklKSUlfRlVOQywKKyNlbmRpZgorI2lmbmRlZiBKTkk2NAorCV8xVnRibENhbGxfX0lJSklK
Sl8zSV8zSV8zSV9GVU5DLAorI2Vsc2UKKwlfMVZ0YmxDYWxsX19JSkpJSkpfM0lfM0lfM0lfRlVO
QywKKyNlbmRpZgorI2lmbmRlZiBKTkk2NAorCV8xVnRibENhbGxfX0lJSklKXzNJXzNJXzNJX0ZV
TkMsCisjZWxzZQorCV8xVnRibENhbGxfX0lKSklKXzNJXzNJXzNJX0ZVTkMsCisjZW5kaWYKKyNp
Zm5kZWYgSk5JNjQKIAlfMVZ0YmxDYWxsX19JSUpJXzNKX0ZVTkMsCiAjZWxzZQogCV8xVnRibENh
bGxfX0lKSklfM0pfRlVOQywKQEAgLTQ1Miw2ICs1MDcsMTEgQEAKIAlfMVZ0YmxDYWxsX19JSkpK
Sl8zQl8zQkpfRlVOQywKICNlbmRpZgogI2lmbmRlZiBKTkk2NAorCV8xVnRibENhbGxfX0lJSkpK
XzNJX0ZVTkMsCisjZWxzZQorCV8xVnRibENhbGxfX0lKSkpKXzNJX0ZVTkMsCisjZW5kaWYKKyNp
Zm5kZWYgSk5JNjQKIAlfMVZ0YmxDYWxsX19JSUpKSl8zSl9GVU5DLAogI2Vsc2UKIAlfMVZ0YmxD
YWxsX19JSkpKSl8zSl9GVU5DLApAQCAtNDk3LDYgKzU1NywxMSBAQAogCV8xVnRibENhbGxfX0lK
SkpfM0lfRlVOQywKICNlbmRpZgogI2lmbmRlZiBKTkk2NAorCV8xVnRibENhbGxfX0lJSkpfM0lf
M0lfRlVOQywKKyNlbHNlCisJXzFWdGJsQ2FsbF9fSUpKSl8zSV8zSV9GVU5DLAorI2VuZGlmCisj
aWZuZGVmIEpOSTY0CiAJXzFWdGJsQ2FsbF9fSUlKSl8zSl9GVU5DLAogI2Vsc2UKIAlfMVZ0YmxD
YWxsX19JSkpKXzNKX0ZVTkMsCkluZGV4OiBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcv
ZWNsaXBzZS9zd3QvaW50ZXJuYWwvbW96aWxsYS9YUENPTS5qYXZhCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZp
bGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVjbGlwc2Uuc3d0L0VjbGlwc2UgU1dUIE1vemlsbGEv
Y29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL1hQQ09NLmphdmEsdgpyZXRy
aWV2aW5nIHJldmlzaW9uIDEuMTAwCmRpZmYgLXUgLXIxLjEwMCBYUENPTS5qYXZhCi0tLSBFY2xp
cHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwvbW96aWxsYS9Y
UENPTS5qYXZhCTggQXByIDIwMDkgMTk6NTg6MzkgLTAwMDAJMS4xMDAKKysrIEVjbGlwc2UgU1dU
IE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL1hQQ09NLmph
dmEJMTkgQXVnIDIwMDkgMTk6NTc6MjMgLTAwMDAKQEAgLTYxLDYgKzYxLDggQEAKIAlwdWJsaWMg
c3RhdGljIGZpbmFsIG5zSUQgTlNfUFJPTVBUU0VSVklDRV9DSUQgPSBuZXcgbnNJRCgiYTIxMTJk
NmEtMGUyOC00MjFmLWI0NmEtMjVjMGIzMDhjYmQwIik7IC8vJE5PTi1OTFMtMSQKIAogCXB1Ymxp
YyBzdGF0aWMgZmluYWwgU3RyaW5nIEVYVEVSTkFMX0NPTlRSQUNUSUQgPSAiQGVjbGlwc2Uub3Jn
L2V4dGVybmFsOzEiOyAvLyROT04tTkxTLTEkCisJcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcg
TlNfQ0VSVE9WRVJSSURFX0NPTlRSQUNUSUQgPSAiQG1vemlsbGEub3JnL3NlY3VyaXR5L2NlcnRv
dmVycmlkZTsxIjsgLy8kTk9OLU5MUy0xJAorCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIE5T
X0NFUlRJRklDQVRFRElBTE9HU19DT05UUkFDVElEID0gIkBtb3ppbGxhLm9yZy9uc0NlcnRpZmlj
YXRlRGlhbG9nczsxIjsgLy8kTk9OLU5MUy0xJAogCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5n
IE5TX0NPTlRFWFRTVEFDS19DT05UUkFDVElEID0gIkBtb3ppbGxhLm9yZy9qcy94cGMvQ29udGV4
dFN0YWNrOzEiOyAvLyROT04tTkxTLTEkCiAJcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgTlNf
Q09PS0lFTUFOQUdFUl9DT05UUkFDVElEID0gIkBtb3ppbGxhLm9yZy9jb29raWVtYW5hZ2VyOzEi
OyAvLyROT04tTkxTLTEkCiAJcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgTlNfQ09PS0lFU0VS
VklDRV9DT05UUkFDVElEID0gIkBtb3ppbGxhLm9yZy9jb29raWVTZXJ2aWNlOzEiOyAvLyROT04t
TkxTLTEkCkBAIC05MDQsNiArOTA2LDI0IEBACiAJCWxvY2sudW5sb2NrKCk7CiAJfQogfQorc3Rh
dGljIGZpbmFsIG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyov
IHBwVnRibCwgaW50IGFyZzAsIGludFtdIGFyZzEsIGludCBhcmcyKTsKK3N0YXRpYyBmaW5hbCBp
bnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwg
aW50W10gYXJnMSwgaW50IGFyZzIpIHsKKwlsb2NrLmxvY2soKTsKKwl0cnkgeworCQlyZXR1cm4g
X1Z0YmxDYWxsKGZuTnVtYmVyLCBwcFZ0YmwsIGFyZzAsIGFyZzEsIGFyZzIpOworCX0gZmluYWxs
eSB7CisJCWxvY2sudW5sb2NrKCk7CisJfQorfQorc3RhdGljIGZpbmFsIG5hdGl2ZSBpbnQgX1Z0
YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGludFtd
IGFyZzEsIGxvbmcgYXJnMik7CitzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJl
ciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGludFtdIGFyZzEsIGxvbmcgYXJnMikg
eworCWxvY2subG9jaygpOworCXRyeSB7CisJCXJldHVybiBfVnRibENhbGwoZm5OdW1iZXIsIHBw
VnRibCwgYXJnMCwgYXJnMSwgYXJnMik7CisJfSBmaW5hbGx5IHsKKwkJbG9jay51bmxvY2soKTsK
Kwl9Cit9CiBzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50IGZuTnVtYmVyLCBp
bnQgLypsb25nKi8gcHBWdGJsLCBsb25nIFtdIGFyZzAsIGxvbmcgW10gYXJnMSwgbG9uZyBbXSBh
cmcyKTsKIHN0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25n
Ki8gcHBWdGJsLCBsb25nIFtdIGFyZzAsIGxvbmcgW10gYXJnMSwgbG9uZyBbXSBhcmcyKSB7CiAJ
bG9jay5sb2NrKCk7CkBAIC0xNDI5LDYgKzE0NDksMTUgQEAKIAkJbG9jay51bmxvY2soKTsKIAl9
CiB9CitzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQg
Lypsb25nKi8gcHBWdGJsLCBsb25nIGFyZzAsIGxvbmcgYXJnMSwgbG9uZyBhcmcyLCBpbnRbXSBh
cmczKTsKK3N0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25n
Ki8gcHBWdGJsLCBsb25nIGFyZzAsIGxvbmcgYXJnMSwgbG9uZyBhcmcyLCBpbnRbXSBhcmczKSB7
CisJbG9jay5sb2NrKCk7CisJdHJ5IHsKKwkJcmV0dXJuIF9WdGJsQ2FsbChmbk51bWJlciwgcHBW
dGJsLCBhcmcwLCBhcmcxLCBhcmcyLCBhcmczKTsKKwl9IGZpbmFsbHkgeworCQlsb2NrLnVubG9j
aygpOworCX0KK30KIHN0YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQgZm5OdW1i
ZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwgbG9uZyBhcmcxLCBsb25nIGFyZzIs
IGxvbmdbXSBhcmczKTsKIHN0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBp
bnQgLypsb25nKi8gcHBWdGJsLCBsb25nIGFyZzAsIGxvbmcgYXJnMSwgbG9uZyBhcmcyLCBsb25n
W10gYXJnMykgewogCWxvY2subG9jaygpOwpAQCAtMTQ1Niw2ICsxNDg1LDI0IEBACiAJCWxvY2su
dW5sb2NrKCk7CiAJfQogfQorc3RhdGljIGZpbmFsIG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBm
bk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGludFtdIGFyZzEsIGludFtd
IGFyZzIsIGludFtdIGFyZzMpOworc3RhdGljIGZpbmFsIGludCBWdGJsQ2FsbChpbnQgZm5OdW1i
ZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGludCBhcmcwLCBpbnRbXSBhcmcxLCBpbnRbXSBhcmcy
LCBpbnRbXSBhcmczKSB7CisJbG9jay5sb2NrKCk7CisJdHJ5IHsKKwkJcmV0dXJuIF9WdGJsQ2Fs
bChmbk51bWJlciwgcHBWdGJsLCBhcmcwLCBhcmcxLCBhcmcyLCBhcmczKTsKKwl9IGZpbmFsbHkg
eworCQlsb2NrLnVubG9jaygpOworCX0KK30KK3N0YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9WdGJs
Q2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGludCBhcmcwLCBpbnRbXSBh
cmcxLCBpbnRbXSBhcmcyLCBsb25nW10gYXJnMyk7CitzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxs
KGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGludFtdIGFyZzEs
IGludFtdIGFyZzIsIGxvbmdbXSBhcmczKSB7CisJbG9jay5sb2NrKCk7CisJdHJ5IHsKKwkJcmV0
dXJuIF9WdGJsQ2FsbChmbk51bWJlciwgcHBWdGJsLCBhcmcwLCBhcmcxLCBhcmcyLCBhcmczKTsK
Kwl9IGZpbmFsbHkgeworCQlsb2NrLnVubG9jaygpOworCX0KK30KIHN0YXRpYyBmaW5hbCBuYXRp
dmUgaW50IF9WdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIG5zSUQg
YXJnMCwgYnl0ZVtdIGFyZzEsIGJ5dGVbXSBhcmcyLCBpbnQgYXJnMyk7CiBzdGF0aWMgZmluYWwg
aW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgbnNJRCBhcmcw
LCBieXRlW10gYXJnMSwgYnl0ZVtdIGFyZzIsIGludCBhcmczKSB7CiAJbG9jay5sb2NrKCk7CkBA
IC0xNTY0LDYgKzE2MTEsMzMgQEAKIAkJbG9jay51bmxvY2soKTsKIAl9CiB9CitzdGF0aWMgZmlu
YWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJs
LCBsb25nIGFyZzAsIGludCBhcmcxLCBpbnQgYXJnMiwgaW50W10gYXJnMyk7CitzdGF0aWMgZmlu
YWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgbG9uZyBh
cmcwLCBpbnQgYXJnMSwgaW50IGFyZzIsIGludFtdIGFyZzMpIHsKKwlsb2NrLmxvY2soKTsKKwl0
cnkgeworCQlyZXR1cm4gX1Z0YmxDYWxsKGZuTnVtYmVyLCBwcFZ0YmwsIGFyZzAsIGFyZzEsIGFy
ZzIsIGFyZzMpOworCX0gZmluYWxseSB7CisJCWxvY2sudW5sb2NrKCk7CisJfQorfQorc3RhdGlj
IGZpbmFsIG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBw
VnRibCwgaW50IGFyZzAsIGludCBhcmcxLCBpbnRbXSBhcmcyLCBpbnRbXSBhcmczKTsKK3N0YXRp
YyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBp
bnQgYXJnMCwgaW50IGFyZzEsIGludFtdIGFyZzIsIGludFtdIGFyZzMpIHsKKwlsb2NrLmxvY2so
KTsKKwl0cnkgeworCQlyZXR1cm4gX1Z0YmxDYWxsKGZuTnVtYmVyLCBwcFZ0YmwsIGFyZzAsIGFy
ZzEsIGFyZzIsIGFyZzMpOworCX0gZmluYWxseSB7CisJCWxvY2sudW5sb2NrKCk7CisJfQorfQor
c3RhdGljIGZpbmFsIG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9u
ZyovIHBwVnRibCwgbG9uZyBhcmcwLCBsb25nIGFyZzEsIGludFtdIGFyZzIsIGludFtdIGFyZzMp
Oworc3RhdGljIGZpbmFsIGludCBWdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBw
cFZ0YmwsIGxvbmcgYXJnMCwgbG9uZyBhcmcxLCBpbnRbXSBhcmcyLCBpbnRbXSBhcmczKSB7CisJ
bG9jay5sb2NrKCk7CisJdHJ5IHsKKwkJcmV0dXJuIF9WdGJsQ2FsbChmbk51bWJlciwgcHBWdGJs
LCBhcmcwLCBhcmcxLCBhcmcyLCBhcmczKTsKKwl9IGZpbmFsbHkgeworCQlsb2NrLnVubG9jaygp
OworCX0KK30KIAogc3RhdGljIGZpbmFsIG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJl
ciwgaW50IC8qbG9uZyovIHBwVnRibCwgY2hhcltdIGFyZzAsIGludCBhcmcxLCBpbnQgYXJnMiwg
aW50IGFyZzMsIGludCBhcmc0KTsKIHN0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVt
YmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBjaGFyW10gYXJnMCwgaW50IGFyZzEsIGludCBhcmcy
LCBpbnQgYXJnMywgaW50IGFyZzQpIHsKQEAgLTE2ODMsNiArMTc1NywxNSBAQAogCQlsb2NrLnVu
bG9jaygpOwogCX0KIH0KK3N0YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQgZm5O
dW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwgaW50IGFyZzEsIGxvbmcgYXJn
MiwgaW50IGFyZzMsIGludCBhcmc0KTsKK3N0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZu
TnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBsb25nIGFyZzAsIGludCBhcmcxLCBsb25nIGFy
ZzIsIGludCBhcmczLCBpbnQgYXJnNCkgeworCWxvY2subG9jaygpOworCXRyeSB7CisJCXJldHVy
biBfVnRibENhbGwoZm5OdW1iZXIsIHBwVnRibCwgYXJnMCwgYXJnMSwgYXJnMiwgYXJnMywgYXJn
NCk7CisJfSBmaW5hbGx5IHsKKwkJbG9jay51bmxvY2soKTsKKwl9Cit9CiAKIHN0YXRpYyBmaW5h
bCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0Ymws
IGludCBhcmcwLCBieXRlW10gYXJnMSwgYnl0ZVtdIGFyZzIsIGJ5dGVbXSBhcmczLCBpbnQgYXJn
NCwgaW50W10gYXJnNSk7CiBzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwg
aW50IC8qbG9uZyovIHBwVnRibCwgaW50IGFyZzAsIGJ5dGVbXSBhcmcxLCBieXRlW10gYXJnMiwg
Ynl0ZVtdIGFyZzMsIGludCBhcmc0LCBpbnRbXSBhcmc1KSB7CkBAIC0xOTIwLDYgKzIwMDMsMjQg
QEAKIAkJbG9jay51bmxvY2soKTsKIAl9CiB9CitzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRi
bENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgaW50IGFy
ZzEsIGludCBhcmcyLCBpbnRbXSBhcmczLCBpbnRbXSBhcmc0LCBpbnRbXSBhcmc1KTsKK3N0YXRp
YyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBp
bnQgYXJnMCwgaW50IGFyZzEsIGludCBhcmcyLCBpbnRbXSBhcmczLCBpbnRbXSBhcmc0LCBpbnRb
XSBhcmc1KSB7CisJbG9jay5sb2NrKCk7CisJdHJ5IHsKKwkJcmV0dXJuIF9WdGJsQ2FsbChmbk51
bWJlciwgcHBWdGJsLCBhcmcwLCBhcmcxLCBhcmcyLCBhcmczLCBhcmc0LCBhcmc1KTsKKwl9IGZp
bmFsbHkgeworCQlsb2NrLnVubG9jaygpOworCX0KK30KK3N0YXRpYyBmaW5hbCBuYXRpdmUgaW50
IF9WdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwg
aW50IGFyZzEsIGxvbmcgYXJnMiwgaW50W10gYXJnMywgaW50W10gYXJnNCwgaW50W10gYXJnNSk7
CitzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBw
VnRibCwgbG9uZyBhcmcwLCBpbnQgYXJnMSwgbG9uZyBhcmcyLCBpbnRbXSBhcmczLCBpbnRbXSBh
cmc0LCBpbnRbXSBhcmc1KSB7CisJbG9jay5sb2NrKCk7CisJdHJ5IHsKKwkJcmV0dXJuIF9WdGJs
Q2FsbChmbk51bWJlciwgcHBWdGJsLCBhcmcwLCBhcmcxLCBhcmcyLCBhcmczLCBhcmc0LCBhcmc1
KTsKKwl9IGZpbmFsbHkgeworCQlsb2NrLnVubG9jaygpOworCX0KK30KIAogc3RhdGljIGZpbmFs
IG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwg
aW50IGFyZzAsIGNoYXJbXSBhcmcxLCBjaGFyW10gYXJnMiwgaW50IGFyZzMsIGludFtdIGFyZzQs
IGludFtdIGFyZzUsIGludFtdIGFyZzYpOwogc3RhdGljIGZpbmFsIGludCBWdGJsQ2FsbChpbnQg
Zm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGludCBhcmcwLCBjaGFyW10gYXJnMSwgY2hh
cltdIGFyZzIsIGludCBhcmczLCBpbnRbXSBhcmc0LCBpbnRbXSBhcmc1LCBpbnRbXSBhcmc2KSB7
CkBAIC0xOTMwLDcgKzIwMzEsNiBAQAogCQlsb2NrLnVubG9jaygpOwogCX0KIH0KLQogc3RhdGlj
IGZpbmFsIG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBw
VnRibCwgbG9uZyBhcmcwLCBjaGFyW10gYXJnMSwgY2hhcltdIGFyZzIsIGludCBhcmczLCBsb25n
W10gYXJnNCwgaW50W10gYXJnNSwgaW50W10gYXJnNik7CiBzdGF0aWMgZmluYWwgaW50IFZ0YmxD
YWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgbG9uZyBhcmcwLCBjaGFyW10g
YXJnMSwgY2hhcltdIGFyZzIsIGludCBhcmczLCBsb25nW10gYXJnNCwgaW50W10gYXJnNSwgaW50
W10gYXJnNikgewogCWxvY2subG9jaygpOwpAQCAtMTk0MCw3ICsyMDQwLDYgQEAKIAkJbG9jay51
bmxvY2soKTsKIAl9CiB9Ci0KIHN0YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQg
Zm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGludCBhcmcwLCBjaGFyW10gYXJnMSwgY2hh
cltdIGFyZzIsIGludFtdIGFyZzMsIGNoYXJbXSBhcmc0LCBpbnRbXSBhcmc1LCBpbnRbXSBhcmc2
KTsKIHN0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8g
cHBWdGJsLCBpbnQgYXJnMCwgY2hhcltdIGFyZzEsIGNoYXJbXSBhcmcyLCBpbnRbXSBhcmczLCBj
aGFyW10gYXJnNCwgaW50W10gYXJnNSwgaW50W10gYXJnNikgewogCWxvY2subG9jaygpOwpAQCAt
MTk1MCw3ICsyMDQ5LDYgQEAKIAkJbG9jay51bmxvY2soKTsKIAl9CiB9Ci0KIHN0YXRpYyBmaW5h
bCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0Ymws
IGxvbmcgYXJnMCwgY2hhcltdIGFyZzEsIGNoYXJbXSBhcmcyLCBsb25nW10gYXJnMywgY2hhcltd
IGFyZzQsIGludFtdIGFyZzUsIGludFtdIGFyZzYpOwogc3RhdGljIGZpbmFsIGludCBWdGJsQ2Fs
bChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwgY2hhcltdIGFy
ZzEsIGNoYXJbXSBhcmcyLCBsb25nW10gYXJnMywgY2hhcltdIGFyZzQsIGludFtdIGFyZzUsIGlu
dFtdIGFyZzYpIHsKIAlsb2NrLmxvY2soKTsKQEAgLTE5NjAsNyArMjA1OCw2IEBACiAJCWxvY2su
dW5sb2NrKCk7CiAJfQogfQotCiBzdGF0aWMgZmluYWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50
IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgaW50IGFyZzEsIGludCBh
cmcyLCBpbnQgYXJnMywgY2hhcltdIGFyZzQsIGludFtdIGFyZzUsIGludFtdIGFyZzYpOwogc3Rh
dGljIGZpbmFsIGludCBWdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0Ymws
IGludCBhcmcwLCBpbnQgYXJnMSwgaW50IGFyZzIsIGludCBhcmczLCBjaGFyW10gYXJnNCwgaW50
W10gYXJnNSwgaW50W10gYXJnNikgewogCWxvY2subG9jaygpOwpAQCAtMTk3MCw3ICsyMDY3LDYg
QEAKIAkJbG9jay51bmxvY2soKTsKIAl9CiB9Ci0KIHN0YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9W
dGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwgbG9u
ZyBhcmcxLCBpbnQgYXJnMiwgbG9uZyBhcmczLCBjaGFyW10gYXJnNCwgaW50W10gYXJnNSwgaW50
W10gYXJnNik7CiBzdGF0aWMgZmluYWwgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8q
bG9uZyovIHBwVnRibCwgbG9uZyBhcmcwLCBsb25nIGFyZzEsIGludCBhcmcyLCBsb25nIGFyZzMs
IGNoYXJbXSBhcmc0LCBpbnRbXSBhcmc1LCBpbnRbXSBhcmc2KSB7CiAJbG9jay5sb2NrKCk7CkBA
IC0xOTgwLDcgKzIwNzYsNiBAQAogCQlsb2NrLnVubG9jaygpOwogCX0KIH0KLQogc3RhdGljIGZp
bmFsIG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRi
bCwgaW50IGFyZzAsIGludCBhcmcxLCBpbnQgYXJnMiwgaW50IGFyZzMsIGxvbmcgYXJnNCwgaW50
IGFyZzUsIGludCBhcmc2KTsKIHN0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVy
LCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgaW50IGFyZzEsIGludCBhcmcyLCBpbnQg
YXJnMywgbG9uZyBhcmc0LCBpbnQgYXJnNSwgaW50IGFyZzYpIHsKIAlsb2NrLmxvY2soKTsKQEAg
LTE5OTAsNyArMjA4NSw2IEBACiAJCWxvY2sudW5sb2NrKCk7CiAJfQogfQotCiBzdGF0aWMgZmlu
YWwgbmF0aXZlIGludCBfVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJs
LCBsb25nIGFyZzAsIGxvbmcgYXJnMSwgbG9uZyBhcmcyLCBsb25nIGFyZzMsIGxvbmcgYXJnNCwg
bG9uZyBhcmc1LCBsb25nIGFyZzYpOwogc3RhdGljIGZpbmFsIGludCBWdGJsQ2FsbChpbnQgZm5O
dW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwgbG9uZyBhcmcxLCBsb25nIGFy
ZzIsIGxvbmcgYXJnMywgbG9uZyBhcmc0LCBsb25nIGFyZzUsIGxvbmcgYXJnNikgewogCWxvY2su
bG9jaygpOwpAQCAtMjAwMCw2ICsyMDk0LDI0IEBACiAJCWxvY2sudW5sb2NrKCk7CiAJfQogfQor
c3RhdGljIGZpbmFsIG5hdGl2ZSBpbnQgX1Z0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9u
ZyovIHBwVnRibCwgaW50IGFyZzAsIGludCBhcmcxLCBpbnQgYXJnMiwgaW50IGFyZzMsIGludFtd
IGFyZzQsIGludFtdIGFyZzUsIGludFtdIGFyZzYpOworc3RhdGljIGZpbmFsIGludCBWdGJsQ2Fs
bChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGludCBhcmcwLCBpbnQgYXJnMSwg
aW50IGFyZzIsIGludCBhcmczLCBpbnRbXSBhcmc0LCBpbnRbXSBhcmc1LCBpbnRbXSBhcmc2KSB7
CisJbG9jay5sb2NrKCk7CisJdHJ5IHsKKwkJcmV0dXJuIF9WdGJsQ2FsbChmbk51bWJlciwgcHBW
dGJsLCBhcmcwLCBhcmcxLCBhcmcyLCBhcmczLCBhcmc0LCBhcmc1LCBhcmc2KTsKKwl9IGZpbmFs
bHkgeworCQlsb2NrLnVubG9jaygpOworCX0KK30KK3N0YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9W
dGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGxvbmcgYXJnMCwgaW50
IGFyZzEsIGxvbmcgYXJnMiwgbG9uZyBhcmczLCBpbnRbXSBhcmc0LCBpbnRbXSBhcmc1LCBpbnRb
XSBhcmc2KTsKK3N0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLyps
b25nKi8gcHBWdGJsLCBsb25nIGFyZzAsIGludCBhcmcxLCBsb25nIGFyZzIsIGxvbmcgYXJnMywg
aW50W10gYXJnNCwgaW50W10gYXJnNSwgaW50W10gYXJnNikgeworCWxvY2subG9jaygpOworCXRy
eSB7CisJCXJldHVybiBfVnRibENhbGwoZm5OdW1iZXIsIHBwVnRibCwgYXJnMCwgYXJnMSwgYXJn
MiwgYXJnMywgYXJnNCwgYXJnNSwgYXJnNik7CisJfSBmaW5hbGx5IHsKKwkJbG9jay51bmxvY2so
KTsKKwl9Cit9CiAKIHN0YXRpYyBmaW5hbCBuYXRpdmUgaW50IF9WdGJsQ2FsbChpbnQgZm5OdW1i
ZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGludCBhcmcwLCBjaGFyW10gYXJnMSwgY2hhcltdIGFy
ZzIsIGludFtdIGFyZzMsIGludFtdIGFyZzQsIGNoYXJbXSBhcmc1LCBpbnRbXSBhcmc2LCBpbnRb
XSBhcmc3KTsKIHN0YXRpYyBmaW5hbCBpbnQgVnRibENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLyps
b25nKi8gcHBWdGJsLCBpbnQgYXJnMCwgY2hhcltdIGFyZzEsIGNoYXJbXSBhcmcyLCBpbnRbXSBh
cmczLCBpbnRbXSBhcmc0LCBjaGFyW10gYXJnNSwgaW50W10gYXJnNiwgaW50W10gYXJnNykgewpJ
bmRleDogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFs
L21vemlsbGEvbnNJWDUwOUNlcnRWYWxpZGl0eS5qYXZhCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IEVj
bGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxh
L25zSVg1MDlDZXJ0VmFsaWRpdHkuamF2YQpkaWZmIC1OIEVjbGlwc2UgU1dUIE1vemlsbGEvY29t
bW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSVg1MDlDZXJ0VmFsaWRpdHku
amF2YQotLS0gL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDAKKysrIEVjbGlwc2Ug
U1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSVg1
MDlDZXJ0VmFsaWRpdHkuamF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwCkBAIC0wLDAgKzEs
NzUgQEAKKy8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioKKyAqIFZlcnNpb246IE1Q
TCAxLjEKKyAqCisgKiBUaGUgY29udGVudHMgb2YgdGhpcyBmaWxlIGFyZSBzdWJqZWN0IHRvIHRo
ZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24KKyAqIDEuMSAodGhlICJMaWNlbnNlIik7
IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aAorICog
dGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAorICog
aHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwvCisgKgorICogU29mdHdhcmUgZGlzdHJpYnV0ZWQg
dW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBiYXNpcywKKyAq
IFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQu
IFNlZSB0aGUgTGljZW5zZQorICogZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcg
cmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUKKyAqIExpY2Vuc2UuCisgKgorICogVGhl
IE9yaWdpbmFsIENvZGUgaXMgTW96aWxsYSBDb21tdW5pY2F0b3IgY2xpZW50IGNvZGUsIHJlbGVh
c2VkIE1hcmNoIDMxLCAxOTk4LgorICoKKyAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUg
T3JpZ2luYWwgQ29kZSBpcworICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24u
CisgKiBQb3J0aW9ucyBjcmVhdGVkIGJ5IE5ldHNjYXBlIGFyZSBDb3B5cmlnaHQgKEMpIDE5OTgt
MTk5OQorICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24uICBBbGwgUmlnaHRz
IFJlc2VydmVkLgorICoKKyAqIENvbnRyaWJ1dG9yKHMpOgorICoKKyAqIElCTQorICogLSAgQmlu
ZGluZyB0byBwZXJtaXQgaW50ZXJmYWNpbmcgYmV0d2VlbiBNb3ppbGxhIGFuZCBTV1QKKyAqIC0g
IENvcHlyaWdodCAoQykgMjAwMywgMjAwOSBJQk0gQ29ycC4gIEFsbCBSaWdodHMgUmVzZXJ2ZWQu
CisgKgorICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi8KK3BhY2thZ2Ugb3JnLmVj
bGlwc2Uuc3d0LmludGVybmFsLm1vemlsbGE7CisKK3B1YmxpYyBjbGFzcyBuc0lYNTA5Q2VydFZh
bGlkaXR5IGV4dGVuZHMgbnNJU3VwcG9ydHMgeworCisJc3RhdGljIGZpbmFsIGludCBMQVNUX01F
VEhPRF9JRCA9IG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgODsKKworCXB1YmxpYyBzdGF0
aWMgZmluYWwgU3RyaW5nIE5TX0lYNTA5Q0VSVFZBTElESVRZX0lJRF9TVFIgPQorCQkiZTcwMWRm
ZDgtMWRkMS0xMWIyLWExNzItZmZhNmNjNjE1NmFkIjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwg
bnNJRCBOU19JWDUwOUNFUlRWQUxJRElUWV9JSUQgPQorCQluZXcgbnNJRChOU19JWDUwOUNFUlRW
QUxJRElUWV9JSURfU1RSKTsKKworCXB1YmxpYyAgbnNJWDUwOUNlcnRWYWxpZGl0eShpbnQgLyps
b25nKi8gYWRkcmVzcykgeworCQlzdXBlcihhZGRyZXNzKTsKKwl9CisKKwlwdWJsaWMgaW50IEdl
dE5vdEJlZm9yZShpbnQgLypsb25nKi8gYU5vdEJlZm9yZSkgeworCQlyZXR1cm4gWFBDT00uVnRi
bENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAxLCBnZXRBZGRyZXNzKCksIGFOb3RC
ZWZvcmUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0Tm90QmVmb3JlTG9jYWxUaW1lKGludCAvKmxv
bmcqLyBhTm90QmVmb3JlTG9jYWxUaW1lKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lT
dXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDIsIGdldEFkZHJlc3MoKSwgYU5vdEJlZm9yZUxvY2Fs
VGltZSk7CisJfQorCisJcHVibGljIGludCBHZXROb3RCZWZvcmVMb2NhbERheShpbnQgLypsb25n
Ki8gYU5vdEJlZm9yZUxvY2FsRGF5KSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBw
b3J0cy5MQVNUX01FVEhPRF9JRCArIDMsIGdldEFkZHJlc3MoKSwgYU5vdEJlZm9yZUxvY2FsRGF5
KTsKKwl9CisKKwlwdWJsaWMgaW50IEdldE5vdEJlZm9yZUdNVChpbnQgLypsb25nKi8gYU5vdEJl
Zm9yZUdNVCkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRI
T0RfSUQgKyA0LCBnZXRBZGRyZXNzKCksIGFOb3RCZWZvcmVHTVQpOworCX0KKworCXB1YmxpYyBp
bnQgR2V0Tm90QWZ0ZXIoaW50IC8qbG9uZyovIGFOb3RBZnRlcikgeworCQlyZXR1cm4gWFBDT00u
VnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyA1LCBnZXRBZGRyZXNzKCksIGFO
b3RBZnRlcik7CisJfQorCisJcHVibGljIGludCBHZXROb3RBZnRlckxvY2FsVGltZShpbnQgLyps
b25nKi8gYU5vdEFmdGVyTG9jYWxUaW1lKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lT
dXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDYsIGdldEFkZHJlc3MoKSwgYU5vdEFmdGVyTG9jYWxU
aW1lKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldE5vdEFmdGVyTG9jYWxEYXkoaW50IC8qbG9uZyov
IGFOb3RBZnRlckxvY2FsRGF5KSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0
cy5MQVNUX01FVEhPRF9JRCArIDcsIGdldEFkZHJlc3MoKSwgYU5vdEFmdGVyTG9jYWxEYXkpOwor
CX0KKworCXB1YmxpYyBpbnQgR2V0Tm90QWZ0ZXJHTVQoaW50IC8qbG9uZyovIGFOb3RBZnRlckdN
VCkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQg
KyA4LCBnZXRBZGRyZXNzKCksIGFOb3RBZnRlckdNVCk7CisJfQorfQpcIE5vIG5ld2xpbmUgYXQg
ZW5kIG9mIGZpbGUKSW5kZXg6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNl
L3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSUNlcnRpZmljYXRlRGlhbG9ncy5qYXZhCj09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0KUkNTIGZpbGU6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9p
bnRlcm5hbC9tb3ppbGxhL25zSUNlcnRpZmljYXRlRGlhbG9ncy5qYXZhCmRpZmYgLU4gRWNsaXBz
ZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJ
Q2VydGlmaWNhdGVEaWFsb2dzLmphdmEKLS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAw
IC0wMDAwCisrKyBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50
ZXJuYWwvbW96aWxsYS9uc0lDZXJ0aWZpY2F0ZURpYWxvZ3MuamF2YQkxIEphbiAxOTcwIDAwOjAw
OjAwIC0wMDAwCkBAIC0wLDAgKzEsNjcgQEAKKy8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sg
KioqKioKKyAqIFZlcnNpb246IE1QTCAxLjEKKyAqCisgKiBUaGUgY29udGVudHMgb2YgdGhpcyBm
aWxlIGFyZSBzdWJqZWN0IHRvIHRoZSBNb3ppbGxhIFB1YmxpYyBMaWNlbnNlIFZlcnNpb24KKyAq
IDEuMSAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGlu
IGNvbXBsaWFuY2Ugd2l0aAorICogdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBv
ZiB0aGUgTGljZW5zZSBhdAorICogaHR0cDovL3d3dy5tb3ppbGxhLm9yZy9NUEwvCisgKgorICog
U29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24g
YW4gIkFTIElTIiBiYXNpcywKKyAqIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIGVpdGhl
ciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZQorICogZm9yIHRoZSBzcGVjaWZp
YyBsYW5ndWFnZSBnb3Zlcm5pbmcgcmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUKKyAq
IExpY2Vuc2UuCisgKgorICogVGhlIE9yaWdpbmFsIENvZGUgaXMgTW96aWxsYSBDb21tdW5pY2F0
b3IgY2xpZW50IGNvZGUsIHJlbGVhc2VkIE1hcmNoIDMxLCAxOTk4LgorICoKKyAqIFRoZSBJbml0
aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2luYWwgQ29kZSBpcworICogTmV0c2NhcGUgQ29tbXVu
aWNhdGlvbnMgQ29ycG9yYXRpb24uCisgKiBQb3J0aW9ucyBjcmVhdGVkIGJ5IE5ldHNjYXBlIGFy
ZSBDb3B5cmlnaHQgKEMpIDE5OTgtMTk5OQorICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29y
cG9yYXRpb24uICBBbGwgUmlnaHRzIFJlc2VydmVkLgorICoKKyAqIENvbnRyaWJ1dG9yKHMpOgor
ICoKKyAqIElCTQorICogLSAgQmluZGluZyB0byBwZXJtaXQgaW50ZXJmYWNpbmcgYmV0d2VlbiBN
b3ppbGxhIGFuZCBTV1QKKyAqIC0gIENvcHlyaWdodCAoQykgMjAwMywgMjAwOSBJQk0gQ29ycC4g
IEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioq
KiogKi8KK3BhY2thZ2Ugb3JnLmVjbGlwc2Uuc3d0LmludGVybmFsLm1vemlsbGE7CisKK3B1Ymxp
YyBjbGFzcyBuc0lDZXJ0aWZpY2F0ZURpYWxvZ3MgZXh0ZW5kcyBuc0lTdXBwb3J0cyB7CisKKwlz
dGF0aWMgZmluYWwgaW50IExBU1RfTUVUSE9EX0lEID0gbnNJU3VwcG9ydHMuTEFTVF9NRVRIT0Rf
SUQgKyA2OworCisJcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgTlNfSUNFUlRJRklDQVRFRElB
TE9HU19JSURfU1RSID0KKwkJImEwM2NhOTQwLTA5YmUtMTFkNS1hYzVkLTAwMDA2NDY1NzM3NCI7
CisKKwlwdWJsaWMgc3RhdGljIGZpbmFsIG5zSUQgTlNfSUNFUlRJRklDQVRFRElBTE9HU19JSUQg
PQorCQluZXcgbnNJRChOU19JQ0VSVElGSUNBVEVESUFMT0dTX0lJRF9TVFIpOworCisJcHVibGlj
IG5zSUNlcnRpZmljYXRlRGlhbG9ncyhpbnQgLypsb25nKi8gYWRkcmVzcykgeworCQlzdXBlcihh
ZGRyZXNzKTsKKwl9CisKKwlwdWJsaWMgaW50IENvbmZpcm1Eb3dubG9hZENBQ2VydChpbnQgLyps
b25nKi8gY3R4LCBpbnQgLypsb25nKi8gY2VydCwgaW50W10gdHJ1c3QsIGludFtdIF9yZXR2YWwp
IHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsg
MSwgZ2V0QWRkcmVzcygpLCBjdHgsIGNlcnQsIHRydXN0LCBfcmV0dmFsKTsKKwl9CisKKwlwdWJs
aWMgaW50IE5vdGlmeUNBQ2VydEV4aXN0cyhpbnQgLypsb25nKi8gY3R4KSB7CisJCXJldHVybiBY
UENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDIsIGdldEFkZHJlc3Mo
KSwgY3R4KTsKKwl9CisKKwlwdWJsaWMgaW50IFNldFBLQ1MxMkZpbGVQYXNzd29yZChpbnQgLyps
b25nKi8gY3R4LCBpbnQgLypsb25nKi8gcGFzc3dvcmQsIGludFtdIF9yZXR2YWwpIHsKKwkJcmV0
dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMywgZ2V0QWRk
cmVzcygpLCBjdHgsIHBhc3N3b3JkLCBfcmV0dmFsKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldFBL
Q1MxMkZpbGVQYXNzd29yZChpbnQgLypsb25nKi8gY3R4LCBpbnQgLypsb25nKi8gcGFzc3dvcmQs
IGludFtdIF9yZXR2YWwpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxB
U1RfTUVUSE9EX0lEICsgNCwgZ2V0QWRkcmVzcygpLCBjdHgsIHBhc3N3b3JkLCBfcmV0dmFsKTsK
Kwl9CisKKwlwdWJsaWMgaW50IFZpZXdDZXJ0KGludCAvKmxvbmcqLyBjdHgsIGludCAvKmxvbmcq
LyBjZXJ0KSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhP
RF9JRCArIDUsIGdldEFkZHJlc3MoKSwgY3R4LCBjZXJ0KTsKKwl9CisKKwlwdWJsaWMgaW50IENy
bEltcG9ydFN0YXR1c0RpYWxvZyhpbnQgLypsb25nKi8gY3R4LCBpbnQgLypsb25nKi8gY3JsKSB7
CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDYs
IGdldEFkZHJlc3MoKSwgY3R4LCBjcmwpOworCX0KK30KXCBObyBuZXdsaW5lIGF0IGVuZCBvZiBm
aWxlCkluZGV4OiBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50
ZXJuYWwvbW96aWxsYS9uc0lDZXJ0T3ZlcnJpZGVTZXJ2aWNlLmphdmEKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFs
L21vemlsbGEvbnNJQ2VydE92ZXJyaWRlU2VydmljZS5qYXZhCmRpZmYgLU4gRWNsaXBzZSBTV1Qg
TW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJQ2VydE92
ZXJyaWRlU2VydmljZS5qYXZhCi0tLSAvZGV2L251bGwJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAw
MAorKysgRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFs
L21vemlsbGEvbnNJQ2VydE92ZXJyaWRlU2VydmljZS5qYXZhCTEgSmFuIDE5NzAgMDA6MDA6MDAg
LTAwMDAKQEAgLTAsMCArMSw3MyBAQAorLyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioq
KgorICogVmVyc2lvbjogTVBMIDEuMQorICoKKyAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUg
YXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vuc2UgVmVyc2lvbgorICogMS4x
ICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29t
cGxpYW5jZSB3aXRoCisgKiB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRo
ZSBMaWNlbnNlIGF0CisgKiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL01QTC8KKyAqCisgKiBTb2Z0
d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAi
QVMgSVMiIGJhc2lzLAorICogV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4
cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCisgKiBmb3IgdGhlIHNwZWNpZmljIGxh
bmd1YWdlIGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZQorICogTGlj
ZW5zZS4KKyAqCisgKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBNb3ppbGxhIENvbW11bmljYXRvciBj
bGllbnQgY29kZSwgcmVsZWFzZWQgTWFyY2ggMzEsIDE5OTguCisgKgorICogVGhlIEluaXRpYWwg
RGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCisgKiBOZXRzY2FwZSBDb21tdW5pY2F0
aW9ucyBDb3Jwb3JhdGlvbi4KKyAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgTmV0c2NhcGUgYXJlIENv
cHlyaWdodCAoQykgMTk5OC0xOTk5CisgKiBOZXRzY2FwZSBDb21tdW5pY2F0aW9ucyBDb3Jwb3Jh
dGlvbi4gIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogQ29udHJpYnV0b3Iocyk6CisgKgor
ICogSUJNCisgKiAtICBCaW5kaW5nIHRvIHBlcm1pdCBpbnRlcmZhY2luZyBiZXR3ZWVuIE1vemls
bGEgYW5kIFNXVAorICogLSAgQ29weXJpZ2h0IChDKSAyMDAzLCAyMDA5IElCTSBDb3JwLiAgQWxs
IFJpZ2h0cyBSZXNlcnZlZC4KKyAqCisgKiAqKioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAq
LworcGFja2FnZSBvcmcuZWNsaXBzZS5zd3QuaW50ZXJuYWwubW96aWxsYTsKKworcHVibGljIGNs
YXNzIG5zSUNlcnRPdmVycmlkZVNlcnZpY2UgZXh0ZW5kcyBuc0lTdXBwb3J0cyB7CisKKwlzdGF0
aWMgZmluYWwgaW50IExBU1RfTUVUSE9EX0lEID0gbnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQg
KyA2OworCisJcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgTlNfSUNFUlRPVkVSUklERVNFUlZJ
Q0VfSUlEX1NUUiA9CisJCSIzMTczOGQyYS03N2QzLTQzNTktODRjOS00YmUyZjM4ZmI4YzUiOwor
CisJcHVibGljIHN0YXRpYyBmaW5hbCBuc0lEIE5TX0lDRVJUT1ZFUlJJREVTRVJWSUNFX0lJRCA9
CisJCW5ldyBuc0lEKE5TX0lDRVJUT1ZFUlJJREVTRVJWSUNFX0lJRF9TVFIpOworCisJcHVibGlj
ICBuc0lDZXJ0T3ZlcnJpZGVTZXJ2aWNlKGludCAvKmxvbmcqLyBhZGRyZXNzKSB7CisJCXN1cGVy
KGFkZHJlc3MpOworCX0KKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEVSUk9SX1VOVFJVU1RF
RCA9IDE7CisKKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBFUlJPUl9NSVNNQVRDSCA9IDI7CisK
KwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBFUlJPUl9USU1FID0gNDsKKworCXB1YmxpYyBpbnQg
UmVtZW1iZXJWYWxpZGl0eU92ZXJyaWRlKGludCAvKmxvbmcqLyBhSG9zdE5hbWUsIGludCBhUG9y
dCwgaW50IC8qbG9uZyovIGFDZXJ0LCBpbnQgYU92ZXJyaWRlQml0cywgaW50IGFUZW1wb3Jhcnkp
IHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsg
MSwgZ2V0QWRkcmVzcygpLCBhSG9zdE5hbWUsIGFQb3J0LCBhQ2VydCwgYU92ZXJyaWRlQml0cywg
YVRlbXBvcmFyeSk7CisJfQorCisJcHVibGljIGludCBIYXNNYXRjaGluZ092ZXJyaWRlKGludCAv
KmxvbmcqLyBhSG9zdE5hbWUsIGludCBhUG9ydCwgaW50IC8qbG9uZyovIGFDZXJ0LCBpbnRbXSBh
T3ZlcnJpZGVCaXRzLCBpbnRbXSBhSXNUZW1wb3JhcnksIGludFtdIF9yZXR2YWwpIHsKKwkJcmV0
dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMiwgZ2V0QWRk
cmVzcygpLCBhSG9zdE5hbWUsIGFQb3J0LCBhQ2VydCwgYU92ZXJyaWRlQml0cywgYUlzVGVtcG9y
YXJ5LCBfcmV0dmFsKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldFZhbGlkaXR5T3ZlcnJpZGUoaW50
IC8qbG9uZyovIGFIb3N0TmFtZSwgaW50IGFQb3J0LCBpbnQgLypsb25nKi8gYUhhc2hBbGcsIGlu
dCAvKmxvbmcqLyBhRmluZ2VycHJpbnQsIGludFtdIGFPdmVycmlkZUJpdHMsIGludFtdIGFJc1Rl
bXBvcmFyeSwgaW50W10gX3JldHZhbCkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3Vw
cG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAzLCBnZXRBZGRyZXNzKCksIGFIb3N0TmFtZSwgYVBvcnQs
IGFIYXNoQWxnLCBhRmluZ2VycHJpbnQsIGFPdmVycmlkZUJpdHMsIGFJc1RlbXBvcmFyeSwgX3Jl
dHZhbCk7CisJfQorCisJcHVibGljIGludCBDbGVhclZhbGlkaXR5T3ZlcnJpZGUoaW50IC8qbG9u
ZyovIGFIb3N0TmFtZSwgaW50IGFQb3J0KSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lT
dXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDQsIGdldEFkZHJlc3MoKSwgYUhvc3ROYW1lLCBhUG9y
dCk7CisJfQorCisJcHVibGljIGludCBHZXRBbGxPdmVycmlkZUhvc3RzV2l0aFBvcnRzKGludFtd
IGFDb3VudCwgaW50IC8qbG9uZyovW10gYUhvc3RzV2l0aFBvcnRzQXJyYXkpIHsKKwkJcmV0dXJu
IFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgNSwgZ2V0QWRkcmVz
cygpLCBhQ291bnQsIGFIb3N0c1dpdGhQb3J0c0FycmF5KTsKKwl9CisKKwlwdWJsaWMgaW50IElz
Q2VydFVzZWRGb3JPdmVycmlkZXMoaW50IC8qbG9uZyovIGFDZXJ0LCBpbnQgYUNoZWNrVGVtcG9y
YXJpZXMsIGludCBhQ2hlY2tQZXJtYW5lbnRzLCBpbnRbXSBfcmV0dmFsKSB7CisJCXJldHVybiBY
UENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDYsIGdldEFkZHJlc3Mo
KSwgYUNlcnQsIGFDaGVja1RlbXBvcmFyaWVzLCBhQ2hlY2tQZXJtYW5lbnRzLCBfcmV0dmFsKTsK
Kwl9Cit9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2YgZmlsZQpJbmRleDogRWNsaXBzZSBTV1QgTW96
aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJU1NMU3RhdHVz
LmphdmEKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3Jn
L2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJU1NMU3RhdHVzLmphdmEKZGlmZiAtTiBF
Y2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwvbW96aWxs
YS9uc0lTU0xTdGF0dXMuamF2YQotLS0gL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAw
MDAKKysrIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5h
bC9tb3ppbGxhL25zSVNTTFN0YXR1cy5qYXZhCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDAKQEAg
LTAsMCArMSw3MSBAQAorLyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKgorICogVmVy
c2lvbjogTVBMIDEuMQorICoKKyAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1Ympl
Y3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vuc2UgVmVyc2lvbgorICogMS4xICh0aGUgIkxp
Y2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3
aXRoCisgKiB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNl
IGF0CisgKiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL01QTC8KKyAqCisgKiBTb2Z0d2FyZSBkaXN0
cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIGJh
c2lzLAorICogV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3Ig
aW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlCisgKiBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdv
dmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZQorICogTGljZW5zZS4KKyAq
CisgKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBNb3ppbGxhIENvbW11bmljYXRvciBjbGllbnQgY29k
ZSwgcmVsZWFzZWQgTWFyY2ggMzEsIDE5OTguCisgKgorICogVGhlIEluaXRpYWwgRGV2ZWxvcGVy
IG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCisgKiBOZXRzY2FwZSBDb21tdW5pY2F0aW9ucyBDb3Jw
b3JhdGlvbi4KKyAqIFBvcnRpb25zIGNyZWF0ZWQgYnkgTmV0c2NhcGUgYXJlIENvcHlyaWdodCAo
QykgMTk5OC0xOTk5CisgKiBOZXRzY2FwZSBDb21tdW5pY2F0aW9ucyBDb3Jwb3JhdGlvbi4gIEFs
bCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogQ29udHJpYnV0b3Iocyk6CisgKgorICogSUJNCisg
KiAtICBCaW5kaW5nIHRvIHBlcm1pdCBpbnRlcmZhY2luZyBiZXR3ZWVuIE1vemlsbGEgYW5kIFNX
VAorICogLSAgQ29weXJpZ2h0IChDKSAyMDAzLCAyMDA5IElCTSBDb3JwLiAgQWxsIFJpZ2h0cyBS
ZXNlcnZlZC4KKyAqCisgKiAqKioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqLworcGFja2Fn
ZSBvcmcuZWNsaXBzZS5zd3QuaW50ZXJuYWwubW96aWxsYTsKKworcHVibGljIGNsYXNzIG5zSVNT
TFN0YXR1cyBleHRlbmRzIG5zSVN1cHBvcnRzIHsKKworCXN0YXRpYyBmaW5hbCBpbnQgTEFTVF9N
RVRIT0RfSUQgPSBuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDc7CisKKwlwdWJsaWMgc3Rh
dGljIGZpbmFsIFN0cmluZyBOU19JU1NMU1RBVFVTX0lJRF9TVFIgPQorCQkiY2ZlZGU5MzktZGVm
MS00OWJlLTgxZWQtZDQwMWIzYTA3ZDFjIjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgbnNJRCBO
U19JU1NMU1RBVFVTX0lJRCA9CisJCW5ldyBuc0lEKE5TX0lTU0xTVEFUVVNfSUlEX1NUUik7CisK
KwlwdWJsaWMgIG5zSVNTTFN0YXR1cyhpbnQgLypsb25nKi8gYWRkcmVzcykgeworCQlzdXBlcihh
ZGRyZXNzKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldFNlcnZlckNlcnQoaW50IC8qbG9uZyovW10g
YVNlcnZlckNlcnQpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1Rf
TUVUSE9EX0lEICsgMSwgZ2V0QWRkcmVzcygpLCBhU2VydmVyQ2VydCk7CisJfQorCisJcHVibGlj
IGludCBHZXRDaXBoZXJOYW1lKGludCAvKmxvbmcqL1tdIGFDaXBoZXJOYW1lKSB7CisJCXJldHVy
biBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDIsIGdldEFkZHJl
c3MoKSwgYUNpcGhlck5hbWUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0S2V5TGVuZ3RoKGludFtd
IGFLZXlMZW5ndGgpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1Rf
TUVUSE9EX0lEICsgMywgZ2V0QWRkcmVzcygpLCBhS2V5TGVuZ3RoKTsKKwl9CisKKwlwdWJsaWMg
aW50IEdldFNlY3JldEtleUxlbmd0aChpbnRbXSBhU2VjcmV0S2V5TGVuZ3RoKSB7CisJCXJldHVy
biBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDQsIGdldEFkZHJl
c3MoKSwgYVNlY3JldEtleUxlbmd0aCk7CisJfQorCisJcHVibGljIGludCBHZXRJc0RvbWFpbk1p
c21hdGNoKGludFtdIGFJc0RvbWFpbk1pc21hdGNoKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2Fs
bChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDUsIGdldEFkZHJlc3MoKSwgYUlzRG9tYWlu
TWlzbWF0Y2gpOworCX0KKworCXB1YmxpYyBpbnQgR2V0SXNOb3RWYWxpZEF0VGhpc1RpbWUoaW50
W10gYUlzTm90VmFsaWRBdFRoaXNUaW1lKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lT
dXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDYsIGdldEFkZHJlc3MoKSwgYUlzTm90VmFsaWRBdFRo
aXNUaW1lKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldElzVW50cnVzdGVkKGludFtdIGFJc1VudHJ1
c3RlZCkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0Rf
SUQgKyA3LCBnZXRBZGRyZXNzKCksIGFJc1VudHJ1c3RlZCk7CisJfQorfQpcIE5vIG5ld2xpbmUg
YXQgZW5kIG9mIGZpbGUKSW5kZXg6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xp
cHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSVg1MDlDZXJ0LmphdmEKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFs
L21vemlsbGEvbnNJWDUwOUNlcnQuamF2YQpkaWZmIC1OIEVjbGlwc2UgU1dUIE1vemlsbGEvY29t
bW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSVg1MDlDZXJ0LmphdmEKLS0t
IC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwCisrKyBFY2xpcHNlIFNXVCBNb3pp
bGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwvbW96aWxsYS9uc0lYNTA5Q2VydC5q
YXZhCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDAKQEAgLTAsMCArMSwyMDMgQEAKKy8qICoqKioq
IEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioKKyAqIFZlcnNpb246IE1QTCAxLjEKKyAqCisgKiBU
aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIGFyZSBzdWJqZWN0IHRvIHRoZSBNb3ppbGxhIFB1Ymxp
YyBMaWNlbnNlIFZlcnNpb24KKyAqIDEuMSAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVz
ZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aAorICogdGhlIExpY2Vuc2UuIFlv
dSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAorICogaHR0cDovL3d3dy5tb3pp
bGxhLm9yZy9NUEwvCisgKgorICogU29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vu
c2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBiYXNpcywKKyAqIFdJVEhPVVQgV0FSUkFO
VFkgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5z
ZQorICogZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcmlnaHRzIGFuZCBsaW1p
dGF0aW9ucyB1bmRlciB0aGUKKyAqIExpY2Vuc2UuCisgKgorICogVGhlIE9yaWdpbmFsIENvZGUg
aXMgTW96aWxsYSBDb21tdW5pY2F0b3IgY2xpZW50IGNvZGUsIHJlbGVhc2VkIE1hcmNoIDMxLCAx
OTk4LgorICoKKyAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2luYWwgQ29kZSBp
cworICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24uCisgKiBQb3J0aW9ucyBj
cmVhdGVkIGJ5IE5ldHNjYXBlIGFyZSBDb3B5cmlnaHQgKEMpIDE5OTgtMTk5OQorICogTmV0c2Nh
cGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24uICBBbGwgUmlnaHRzIFJlc2VydmVkLgorICoK
KyAqIENvbnRyaWJ1dG9yKHMpOgorICoKKyAqIElCTQorICogLSAgQmluZGluZyB0byBwZXJtaXQg
aW50ZXJmYWNpbmcgYmV0d2VlbiBNb3ppbGxhIGFuZCBTV1QKKyAqIC0gIENvcHlyaWdodCAoQykg
MjAwMywgMjAwOSBJQk0gQ29ycC4gIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogKioqKiog
RU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi8KK3BhY2thZ2Ugb3JnLmVjbGlwc2Uuc3d0LmludGVy
bmFsLm1vemlsbGE7CisKK3B1YmxpYyBjbGFzcyBuc0lYNTA5Q2VydCBleHRlbmRzIG5zSVN1cHBv
cnRzIHsKKworCXN0YXRpYyBmaW5hbCBpbnQgTEFTVF9NRVRIT0RfSUQgPSBuc0lTdXBwb3J0cy5M
QVNUX01FVEhPRF9JRCArIDI3OworCisJcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgTlNfSVg1
MDlDRVJUX0lJRF9TVFIgPQorCQkiZjA5ODBmNjAtZWUzZC0xMWQ0LTk5OGItMDBiMGQwMjM1NGEw
IjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgbnNJRCBOU19JWDUwOUNFUlRfSUlEID0KKwkJbmV3
IG5zSUQoTlNfSVg1MDlDRVJUX0lJRF9TVFIpOworCisJcHVibGljICBuc0lYNTA5Q2VydChpbnQg
Lypsb25nKi8gYWRkcmVzcykgeworCQlzdXBlcihhZGRyZXNzKTsKKwl9CisKKwlwdWJsaWMgaW50
IEdldE5pY2tuYW1lKGludCAvKmxvbmcqLyBhTmlja25hbWUpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0
YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMSwgZ2V0QWRkcmVzcygpLCBhTmlj
a25hbWUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0RW1haWxBZGRyZXNzKGludCAvKmxvbmcqLyBh
RW1haWxBZGRyZXNzKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNU
X01FVEhPRF9JRCArIDIsIGdldEFkZHJlc3MoKSwgYUVtYWlsQWRkcmVzcyk7CisJfQorCisJcHVi
bGljIGludCBHZXRFbWFpbEFkZHJlc3NlcyhpbnRbXSBsZW5ndGgsIGludCAvKmxvbmcqL1tdIGFk
ZHJlc3NlcykgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRI
T0RfSUQgKyAzLCBnZXRBZGRyZXNzKCksIGxlbmd0aCwgYWRkcmVzc2VzKTsKKwl9CisKKwlwdWJs
aWMgaW50IENvbnRhaW5zRW1haWxBZGRyZXNzKGludCAvKmxvbmcqLyBhRW1haWxBZGRyZXNzLCBp
bnRbXSBfcmV0dmFsKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNU
X01FVEhPRF9JRCArIDQsIGdldEFkZHJlc3MoKSwgYUVtYWlsQWRkcmVzcywgX3JldHZhbCk7CisJ
fQorCisJcHVibGljIGludCBHZXRTdWJqZWN0TmFtZShpbnQgLypsb25nKi8gYVN1YmplY3ROYW1l
KSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCAr
IDUsIGdldEFkZHJlc3MoKSwgYVN1YmplY3ROYW1lKTsKKwl9CisKKwlwdWJsaWMgaW50IEdldENv
bW1vbk5hbWUoaW50IC8qbG9uZyovIGFDb21tb25OYW1lKSB7CisJCXJldHVybiBYUENPTS5WdGJs
Q2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDYsIGdldEFkZHJlc3MoKSwgYUNvbW1v
bk5hbWUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0T3JnYW5pemF0aW9uKGludCAvKmxvbmcqLyBh
T3JnYW5pemF0aW9uKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNU
X01FVEhPRF9JRCArIDcsIGdldEFkZHJlc3MoKSwgYU9yZ2FuaXphdGlvbik7CisJfQorCisJcHVi
bGljIGludCBHZXRPcmdhbml6YXRpb25hbFVuaXQoaW50IC8qbG9uZyovIGFPcmdhbml6YXRpb25h
bFVuaXQpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9E
X0lEICsgOCwgZ2V0QWRkcmVzcygpLCBhT3JnYW5pemF0aW9uYWxVbml0KTsKKwl9CisKKwlwdWJs
aWMgaW50IEdldFNoYTFGaW5nZXJwcmludChpbnQgLypsb25nKi8gYVNoYTFGaW5nZXJwcmludCkg
eworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyA5
LCBnZXRBZGRyZXNzKCksIGFTaGExRmluZ2VycHJpbnQpOworCX0KKworCXB1YmxpYyBpbnQgR2V0
TWQ1RmluZ2VycHJpbnQoaW50IC8qbG9uZyovIGFNZDVGaW5nZXJwcmludCkgeworCQlyZXR1cm4g
WFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAxMCwgZ2V0QWRkcmVz
cygpLCBhTWQ1RmluZ2VycHJpbnQpOworCX0KKworCXB1YmxpYyBpbnQgR2V0VG9rZW5OYW1lKGlu
dCAvKmxvbmcqLyBhVG9rZW5OYW1lKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBw
b3J0cy5MQVNUX01FVEhPRF9JRCArIDExLCBnZXRBZGRyZXNzKCksIGFUb2tlbk5hbWUpOworCX0K
KworCXB1YmxpYyBpbnQgR2V0SXNzdWVyTmFtZShpbnQgLypsb25nKi8gYUlzc3Vlck5hbWUpIHsK
KwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMTIs
IGdldEFkZHJlc3MoKSwgYUlzc3Vlck5hbWUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0U2VyaWFs
TnVtYmVyKGludCAvKmxvbmcqLyBhU2VyaWFsTnVtYmVyKSB7CisJCXJldHVybiBYUENPTS5WdGJs
Q2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDEzLCBnZXRBZGRyZXNzKCksIGFTZXJp
YWxOdW1iZXIpOworCX0KKworCXB1YmxpYyBpbnQgR2V0SXNzdWVyQ29tbW9uTmFtZShpbnQgLyps
b25nKi8gYUlzc3VlckNvbW1vbk5hbWUpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1
cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMTQsIGdldEFkZHJlc3MoKSwgYUlzc3VlckNvbW1vbk5h
bWUpOworCX0KKworCXB1YmxpYyBpbnQgR2V0SXNzdWVyT3JnYW5pemF0aW9uKGludCAvKmxvbmcq
LyBhSXNzdWVyT3JnYW5pemF0aW9uKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBw
b3J0cy5MQVNUX01FVEhPRF9JRCArIDE1LCBnZXRBZGRyZXNzKCksIGFJc3N1ZXJPcmdhbml6YXRp
b24pOworCX0KKworCXB1YmxpYyBpbnQgR2V0SXNzdWVyT3JnYW5pemF0aW9uVW5pdChpbnQgLyps
b25nKi8gYUlzc3Vlck9yZ2FuaXphdGlvblVuaXQpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxs
KG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMTYsIGdldEFkZHJlc3MoKSwgYUlzc3Vlck9y
Z2FuaXphdGlvblVuaXQpOworCX0KKworCXB1YmxpYyBpbnQgR2V0SXNzdWVyKGludCAvKmxvbmcq
L1tdIGFJc3N1ZXIpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1Rf
TUVUSE9EX0lEICsgMTcsIGdldEFkZHJlc3MoKSwgYUlzc3Vlcik7CisJfQorCisJcHVibGljIGlu
dCBHZXRWYWxpZGl0eShpbnQgLypsb25nKi9bXSBhVmFsaWRpdHkpIHsKKwkJcmV0dXJuIFhQQ09N
LlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMTgsIGdldEFkZHJlc3MoKSwg
YVZhbGlkaXR5KTsKKwl9CisKKwlwdWJsaWMgaW50IEdldERiS2V5KGludCAvKmxvbmcqL1tdIGFE
YktleSkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0Rf
SUQgKyAxOSwgZ2V0QWRkcmVzcygpLCBhRGJLZXkpOworCX0KKworCXB1YmxpYyBpbnQgR2V0V2lu
ZG93VGl0bGUoaW50IC8qbG9uZyovW10gYVdpbmRvd1RpdGxlKSB7CisJCXJldHVybiBYUENPTS5W
dGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDIwLCBnZXRBZGRyZXNzKCksIGFX
aW5kb3dUaXRsZSk7CisJfQorCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgVU5LTk9XTl9DRVJU
ID0gMDsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IENBX0NFUlQgPSAxOworCisJcHVibGlj
IHN0YXRpYyBmaW5hbCBpbnQgVVNFUl9DRVJUID0gMjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwg
aW50IEVNQUlMX0NFUlQgPSA0OworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgU0VSVkVSX0NF
UlQgPSA4OworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgVkVSSUZJRURfT0sgPSAwOworCisJ
cHVibGljIHN0YXRpYyBmaW5hbCBpbnQgTk9UX1ZFUklGSUVEX1VOS05PV04gPSAxOworCisJcHVi
bGljIHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9SRVZPS0VEID0gMjsKKworCXB1YmxpYyBzdGF0aWMg
ZmluYWwgaW50IENFUlRfRVhQSVJFRCA9IDQ7CisKKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBD
RVJUX05PVF9UUlVTVEVEID0gODsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IElTU1VFUl9O
T1RfVFJVU1RFRCA9IDE2OworCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgSVNTVUVSX1VOS05P
V04gPSAzMjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IElOVkFMSURfQ0EgPSA2NDsKKwor
CXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFVTQUdFX05PVF9BTExPV0VEID0gMTI4OworCisJcHVi
bGljIHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9TU0xDbGllbnQgPSAwOworCisJcHVibGlj
IHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9TU0xTZXJ2ZXIgPSAxOworCisJcHVibGljIHN0
YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9TU0xTZXJ2ZXJXaXRoU3RlcFVwID0gMjsKKworCXB1
YmxpYyBzdGF0aWMgZmluYWwgaW50IENFUlRfVVNBR0VfU1NMQ0EgPSAzOworCisJcHVibGljIHN0
YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9FbWFpbFNpZ25lciA9IDQ7CisKKwlwdWJsaWMgc3Rh
dGljIGZpbmFsIGludCBDRVJUX1VTQUdFX0VtYWlsUmVjaXBpZW50ID0gNTsKKworCXB1YmxpYyBz
dGF0aWMgZmluYWwgaW50IENFUlRfVVNBR0VfT2JqZWN0U2lnbmVyID0gNjsKKworCXB1YmxpYyBz
dGF0aWMgZmluYWwgaW50IENFUlRfVVNBR0VfVXNlckNlcnRJbXBvcnQgPSA3OworCisJcHVibGlj
IHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9WZXJpZnlDQSA9IDg7CisKKwlwdWJsaWMgc3Rh
dGljIGZpbmFsIGludCBDRVJUX1VTQUdFX1Byb3RlY3RlZE9iamVjdFNpZ25lciA9IDk7CisKKwlw
dWJsaWMgc3RhdGljIGZpbmFsIGludCBDRVJUX1VTQUdFX1N0YXR1c1Jlc3BvbmRlciA9IDEwOwor
CisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQ0VSVF9VU0FHRV9BbnlDQSA9IDExOworCisJcHVi
bGljIGludCBHZXRDaGFpbihpbnQgLypsb25nKi9bXSBfcmV0dmFsKSB7CisJCXJldHVybiBYUENP
TS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDIxLCBnZXRBZGRyZXNzKCks
IF9yZXR2YWwpOworCX0KKworCXB1YmxpYyBpbnQgR2V0VXNhZ2VzQXJyYXkoaW50IGlnbm9yZU9j
c3AsIGludFtdIHZlcmlmaWVkLCBpbnRbXSBjb3VudCwgaW50IC8qbG9uZyovW10gdXNhZ2VzKSB7
CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDIy
LCBnZXRBZGRyZXNzKCksIGlnbm9yZU9jc3AsIHZlcmlmaWVkLCBjb3VudCwgdXNhZ2VzKTsKKwl9
CisKKwlwdWJsaWMgaW50IEdldFVzYWdlc1N0cmluZyhpbnQgaWdub3JlT2NzcCwgaW50W10gdmVy
aWZpZWQsIGludCAvKmxvbmcqLyB1c2FnZXMpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5z
SVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMjMsIGdldEFkZHJlc3MoKSwgaWdub3JlT2NzcCwg
dmVyaWZpZWQsIHVzYWdlcyk7CisJfQorCisJcHVibGljIGludCBWZXJpZnlGb3JVc2FnZShpbnQg
dXNhZ2UsIGludFtdIF9yZXR2YWwpIHsKKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBv
cnRzLkxBU1RfTUVUSE9EX0lEICsgMjQsIGdldEFkZHJlc3MoKSwgdXNhZ2UsIF9yZXR2YWwpOwor
CX0KKworCXB1YmxpYyBpbnQgR2V0QVNOMVN0cnVjdHVyZShpbnQgLypsb25nKi9bXSBhQVNOMVN0
cnVjdHVyZSkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRI
T0RfSUQgKyAyNSwgZ2V0QWRkcmVzcygpLCBhQVNOMVN0cnVjdHVyZSk7CisJfQorCisJcHVibGlj
IGludCBHZXRSYXdERVIoaW50W10gbGVuZ3RoLCBpbnQgLypsb25nKi9bXSBkYXRhKSB7CisJCXJl
dHVybiBYUENPTS5WdGJsQ2FsbChuc0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDI2LCBnZXRB
ZGRyZXNzKCksIGxlbmd0aCwgZGF0YSk7CisJfQorCisJcHVibGljIGludCBFcXVhbHMoaW50IC8q
bG9uZyovIG90aGVyLCBpbnRbXSBfcmV0dmFsKSB7CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChu
c0lTdXBwb3J0cy5MQVNUX01FVEhPRF9JRCArIDI3LCBnZXRBZGRyZXNzKCksIG90aGVyLCBfcmV0
dmFsKTsKKwl9Cit9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2YgZmlsZQpJbmRleDogRWNsaXBzZSBT
V1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJQmFk
Q2VydExpc3RlbmVyMi5qYXZhCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IEVjbGlwc2UgU1dUIE1vemls
bGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSUJhZENlcnRMaXN0
ZW5lcjIuamF2YQpkaWZmIC1OIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNl
L3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSUJhZENlcnRMaXN0ZW5lcjIuamF2YQotLS0gL2Rldi9u
dWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDAKKysrIEVjbGlwc2UgU1dUIE1vemlsbGEvY29t
bW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSUJhZENlcnRMaXN0ZW5lcjIu
amF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwCkBAIC0wLDAgKzEsNDcgQEAKKy8qICoqKioq
IEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKioKKyAqIFZlcnNpb246IE1QTCAxLjEKKyAqCisgKiBU
aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIGFyZSBzdWJqZWN0IHRvIHRoZSBNb3ppbGxhIFB1Ymxp
YyBMaWNlbnNlIFZlcnNpb24KKyAqIDEuMSAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVz
ZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aAorICogdGhlIExpY2Vuc2UuIFlv
dSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAorICogaHR0cDovL3d3dy5tb3pp
bGxhLm9yZy9NUEwvCisgKgorICogU29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vu
c2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBiYXNpcywKKyAqIFdJVEhPVVQgV0FSUkFO
VFkgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5z
ZQorICogZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcmlnaHRzIGFuZCBsaW1p
dGF0aW9ucyB1bmRlciB0aGUKKyAqIExpY2Vuc2UuCisgKgorICogVGhlIE9yaWdpbmFsIENvZGUg
aXMgTW96aWxsYSBDb21tdW5pY2F0b3IgY2xpZW50IGNvZGUsIHJlbGVhc2VkIE1hcmNoIDMxLCAx
OTk4LgorICoKKyAqIFRoZSBJbml0aWFsIERldmVsb3BlciBvZiB0aGUgT3JpZ2luYWwgQ29kZSBp
cworICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24uCisgKiBQb3J0aW9ucyBj
cmVhdGVkIGJ5IE5ldHNjYXBlIGFyZSBDb3B5cmlnaHQgKEMpIDE5OTgtMTk5OQorICogTmV0c2Nh
cGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24uICBBbGwgUmlnaHRzIFJlc2VydmVkLgorICoK
KyAqIENvbnRyaWJ1dG9yKHMpOgorICoKKyAqIElCTQorICogLSAgQmluZGluZyB0byBwZXJtaXQg
aW50ZXJmYWNpbmcgYmV0d2VlbiBNb3ppbGxhIGFuZCBTV1QKKyAqIC0gIENvcHlyaWdodCAoQykg
MjAwMywgMjAwOSBJQk0gQ29ycC4gIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogKioqKiog
RU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi8KK3BhY2thZ2Ugb3JnLmVjbGlwc2Uuc3d0LmludGVy
bmFsLm1vemlsbGE7CisKK3B1YmxpYyBjbGFzcyBuc0lCYWRDZXJ0TGlzdGVuZXIyIGV4dGVuZHMg
bnNJU3VwcG9ydHMgeworCisJc3RhdGljIGZpbmFsIGludCBMQVNUX01FVEhPRF9JRCA9IG5zSVN1
cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMTsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5n
IE5TX0lCQURDRVJUTElTVEVORVIyX0lJRF9TVFIgPQorCQkiMmMzZDI2OGMtYWQ4Mi00OWYzLTk5
YWEtZTlmZmRkZDdhMGRjIjsKKworCXB1YmxpYyBzdGF0aWMgZmluYWwgbnNJRCBOU19JQkFEQ0VS
VExJU1RFTkVSMl9JSUQgPQorCQluZXcgbnNJRChOU19JQkFEQ0VSVExJU1RFTkVSMl9JSURfU1RS
KTsKKworCXB1YmxpYyAgbnNJQmFkQ2VydExpc3RlbmVyMihpbnQgLypsb25nKi8gYWRkcmVzcykg
eworCQlzdXBlcihhZGRyZXNzKTsKKwl9CisKKwlwdWJsaWMgaW50IE5vdGlmeUNlcnRQcm9ibGVt
KGludCAvKmxvbmcqLyBzb2NrZXRJbmZvLCBpbnQgLypsb25nKi8gc3RhdHVzLCBpbnQgLypsb25n
Ki8gdGFyZ2V0U2l0ZSwgaW50W10gX3JldHZhbCkgeworCQlyZXR1cm4gWFBDT00uVnRibENhbGwo
bnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyAxLCBnZXRBZGRyZXNzKCksIHNvY2tldEluZm8s
IHN0YXR1cywgdGFyZ2V0U2l0ZSwgX3JldHZhbCk7CisJfQorfQpcIE5vIG5ld2xpbmUgYXQgZW5k
IG9mIGZpbGUK
</data>

          </attachment>
      

    </bug>

</bugzilla>