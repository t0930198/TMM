<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.1"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>214802</bug_id>
          
          <creation_ts>2008-01-09 15:31:00 -0500</creation_ts>
          <short_desc>[browser] xulrunner 1.9 uses new interface for authentication</short_desc>
          <delta_ts>2008-01-29 15:21:07 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>Platform</product>
          <component>SWT</component>
          <version>3.4</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>3.4 M5</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Grant Gayed">grant_gayed</reporter>
          <assigned_to name="Grant Gayed">grant_gayed</assigned_to>
          
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1128422</commentid>
    <comment_count>0</comment_count>
      <attachid>86502</attachid>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2008-01-09 15:31:25 -0500</bug_when>
    <thetext>Created attachment 86502
patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1144708</commentid>
    <comment_count>1</comment_count>
    <who name="Grant Gayed">grant_gayed</who>
    <bug_when>2008-01-29 15:21:07 -0500</bug_when>
    <thetext>fix released &gt; 0129
</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>86502</attachid>
            <date>2008-01-09 15:31:00 -0500</date>
            <delta_ts>2008-01-09 15:31:25 -0500</delta_ts>
            <desc>patch</desc>
            <filename>patch</filename>
            <type>text/plain</type>
            <size>78120</size>
            <attacher name="Grant Gayed">grant_gayed</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2Uuc3d0DQpJbmRl
eDogRWNsaXBzZSBTV1QvY29tbW9uX2oyc2Uvb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL1NXVE1l
c3NhZ2VzLnByb3BlcnRpZXMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNl
L29yZy5lY2xpcHNlLnN3dC9FY2xpcHNlIFNXVC9jb21tb25fajJzZS9vcmcvZWNsaXBzZS9zd3Qv
aW50ZXJuYWwvU1dUTWVzc2FnZXMucHJvcGVydGllcyx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEu
MjcNCmRpZmYgLXUgLXIxLjI3IFNXVE1lc3NhZ2VzLnByb3BlcnRpZXMNCi0tLSBFY2xpcHNlIFNX
VC9jb21tb25fajJzZS9vcmcvZWNsaXBzZS9zd3QvaW50ZXJuYWwvU1dUTWVzc2FnZXMucHJvcGVy
dGllcwkzMSBNYXkgMjAwNyAyMjowNDoyOSAtMDAwMAkxLjI3DQorKysgRWNsaXBzZSBTV1QvY29t
bW9uX2oyc2Uvb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL1NXVE1lc3NhZ2VzLnByb3BlcnRpZXMJ
OSBKYW4gMjAwOCAyMDoyOTowMCAtMDAwMA0KQEAgLTcxLDMgKzcxLDUgQEANCiBTV1RfRG93bmxv
YWRfTG9jYXRpb249U2F2aW5nIHswfSBmcm9tIHsxfQ0KIFNXVF9Eb3dubG9hZF9TdGFydGVkPURv
d25sb2FkaW5nLi4uDQogU1dUX0Rvd25sb2FkX1N0YXR1cz1Eb3dubG9hZDogezAsbnVtYmVyLGlu
dGVnZXJ9IEtCIG9mIHsxLG51bWJlcixpbnRlZ2VyfSBLQg0KK1NXVF9BdXRoZW50aWNhdGlvbl9S
ZXF1aXJlZD1BdXRoZW50aWNhdGlvbiBSZXF1aXJlZA0KK1NXVF9FbnRlcl9Vc2VybmFtZV9hbmRf
UGFzc3dvcmQ9RW50ZXIgdXNlciBuYW1lIGFuZCBwYXNzd29yZCBmb3IgezB9IGF0IHsxfQ0KSW5k
ZXg6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93c2VyL01v
emlsbGEuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVj
bGlwc2Uuc3d0L0VjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93
c2VyL01vemlsbGEuamF2YSx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNzQNCmRpZmYgLXUgLXIx
Ljc0IE1vemlsbGEuamF2YQ0KLS0tIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xp
cHNlL3N3dC9icm93c2VyL01vemlsbGEuamF2YQkzIEphbiAyMDA4IDE4OjE2OjQyIC0wMDAwCTEu
NzQNCisrKyBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nl
ci9Nb3ppbGxhLmphdmEJOSBKYW4gMjAwOCAyMDoyOTowMCAtMDAwMA0KQEAgLTk3NSw3ICs5NzUs
NyBAQA0KIA0KIAkJcHJlZkJyYW5jaC5SZWxlYXNlICgpOw0KIA0KLQkJUHJvbXB0U2VydmljZUZh
Y3RvcnkgZmFjdG9yeSA9IG5ldyBQcm9tcHRTZXJ2aWNlRmFjdG9yeSAoKTsNCisJCVByb21wdFNl
cnZpY2UyRmFjdG9yeSBmYWN0b3J5ID0gbmV3IFByb21wdFNlcnZpY2UyRmFjdG9yeSAoKTsNCiAJ
CWZhY3RvcnkuQWRkUmVmICgpOw0KIA0KIAkJcmMgPSBjb21wb25lbnRNYW5hZ2VyLlF1ZXJ5SW50
ZXJmYWNlIChuc0lDb21wb25lbnRSZWdpc3RyYXIuTlNfSUNPTVBPTkVOVFJFR0lTVFJBUl9JSUQs
IHJlc3VsdCk7DQpJbmRleDogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uv
c3d0L2Jyb3dzZXIvUHJvbXB0U2VydmljZUZhY3RvcnkuamF2YQ0KPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZp
bGU6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93c2VyL1By
b21wdFNlcnZpY2VGYWN0b3J5LmphdmENCmRpZmYgLU4gRWNsaXBzZSBTV1QgTW96aWxsYS9jb21t
b24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dzZXIvUHJvbXB0U2VydmljZUZhY3RvcnkuamF2YQ0KLS0t
IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93c2VyL1Byb21w
dFNlcnZpY2VGYWN0b3J5LmphdmEJMSBBdWcgMjAwNyAxOTo1NzoyNCAtMDAwMAkxLjMNCisrKyAv
ZGV2L251bGwJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KQEAgLTEsMTAwICswLDAgQEANCi0v
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKg0KLSAqIENvcHlyaWdodCAoYykgMjAwMywgMjAwNyBJQk0g
Q29ycG9yYXRpb24gYW5kIG90aGVycy4NCi0gKiBBbGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHBy
b2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzDQotICogYXJlIG1hZGUgYXZhaWxh
YmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wDQot
ICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBhdmFpbGFibGUg
YXQNCi0gKiBodHRwOi8vd3d3LmVjbGlwc2Uub3JnL2xlZ2FsL2VwbC12MTAuaHRtbA0KLSAqDQot
ICogQ29udHJpYnV0b3JzOg0KLSAqICAgICBJQk0gQ29ycG9yYXRpb24gLSBpbml0aWFsIEFQSSBh
bmQgaW1wbGVtZW50YXRpb24NCi0gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8NCi1wYWNrYWdlIG9y
Zy5lY2xpcHNlLnN3dC5icm93c2VyOw0KLQ0KLWltcG9ydCBvcmcuZWNsaXBzZS5zd3QuaW50ZXJu
YWwuQzsNCi1pbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmludGVybmFsLm1vemlsbGEuKjsNCi0NCi1j
bGFzcyBQcm9tcHRTZXJ2aWNlRmFjdG9yeSB7DQotCVhQQ09NT2JqZWN0IHN1cHBvcnRzOw0KLQlY
UENPTU9iamVjdCBmYWN0b3J5Ow0KLQlpbnQgcmVmQ291bnQgPSAwOw0KLQ0KLVByb21wdFNlcnZp
Y2VGYWN0b3J5ICgpIHsNCi0JY3JlYXRlQ09NSW50ZXJmYWNlcyAoKTsNCi19DQotDQotaW50IEFk
ZFJlZiAoKSB7DQotCXJlZkNvdW50Kys7DQotCXJldHVybiByZWZDb3VudDsNCi19DQotDQotdm9p
ZCBjcmVhdGVDT01JbnRlcmZhY2VzICgpIHsNCi0JLyogQ3JlYXRlIGVhY2ggb2YgdGhlIGludGVy
ZmFjZXMgdGhhdCB0aGlzIG9iamVjdCBpbXBsZW1lbnRzICovDQotCXN1cHBvcnRzID0gbmV3IFhQ
Q09NT2JqZWN0IChuZXcgaW50W10gezIsIDAsIDB9KSB7DQotCQlwdWJsaWMgaW50IC8qbG9uZyov
IG1ldGhvZDAgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gUXVlcnlJbnRlcmZhY2UgKGFy
Z3NbMF0sIGFyZ3NbMV0pO30NCi0JCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kMSAoaW50IC8q
bG9uZyovW10gYXJncykge3JldHVybiBBZGRSZWYgKCk7fQ0KLQkJcHVibGljIGludCAvKmxvbmcq
LyBtZXRob2QyIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFJlbGVhc2UgKCk7fQ0KLQl9
Ow0KLQkNCi0JZmFjdG9yeSA9IG5ldyBYUENPTU9iamVjdCAobmV3IGludFtdIHsyLCAwLCAwLCAz
LCAxfSkgew0KLQkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2QwIChpbnQgLypsb25nKi9bXSBh
cmdzKSB7cmV0dXJuIFF1ZXJ5SW50ZXJmYWNlIChhcmdzWzBdLCBhcmdzWzFdKTt9DQotCQlwdWJs
aWMgaW50IC8qbG9uZyovIG1ldGhvZDEgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gQWRk
UmVmICgpO30NCi0JCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kMiAoaW50IC8qbG9uZyovW10g
YXJncykge3JldHVybiBSZWxlYXNlICgpO30NCi0JCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9k
MyAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBDcmVhdGVJbnN0YW5jZSAoYXJnc1swXSwg
YXJnc1sxXSwgYXJnc1syXSk7fQ0KLQkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2Q0IChpbnQg
Lypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIExvY2tGYWN0b3J5ICgoaW50KS8qNjQqL2FyZ3NbMF0p
O30NCi0JfTsNCi19DQotDQotdm9pZCBkaXNwb3NlQ09NSW50ZXJmYWNlcyAoKSB7DQotCWlmIChz
dXBwb3J0cyAhPSBudWxsKSB7DQotCQlzdXBwb3J0cy5kaXNwb3NlICgpOw0KLQkJc3VwcG9ydHMg
PSBudWxsOw0KLQl9CQ0KLQlpZiAoZmFjdG9yeSAhPSBudWxsKSB7DQotCQlmYWN0b3J5LmRpc3Bv
c2UgKCk7DQotCQlmYWN0b3J5ID0gbnVsbDsJDQotCX0NCi19DQotDQotaW50IC8qbG9uZyovIGdl
dEFkZHJlc3MgKCkgew0KLQlyZXR1cm4gZmFjdG9yeS5nZXRBZGRyZXNzICgpOw0KLX0NCi0NCi1p
bnQgUXVlcnlJbnRlcmZhY2UgKGludCAvKmxvbmcqLyByaWlkLCBpbnQgLypsb25nKi8gcHB2T2Jq
ZWN0KSB7DQotCWlmIChyaWlkID09IDAgfHwgcHB2T2JqZWN0ID09IDApIHJldHVybiBYUENPTS5O
U19FUlJPUl9OT19JTlRFUkZBQ0U7DQotCW5zSUQgZ3VpZCA9IG5ldyBuc0lEICgpOw0KLQlYUENP
TS5tZW1tb3ZlIChndWlkLCByaWlkLCBuc0lELnNpemVvZik7DQotCQ0KLQlpZiAoZ3VpZC5FcXVh
bHMgKG5zSVN1cHBvcnRzLk5TX0lTVVBQT1JUU19JSUQpKSB7DQotCQlYUENPTS5tZW1tb3ZlIChw
cHZPYmplY3QsIG5ldyBpbnQgLypsb25nKi9bXSB7c3VwcG9ydHMuZ2V0QWRkcmVzcyAoKX0sIEMu
UFRSX1NJWkVPRik7DQotCQlBZGRSZWYgKCk7DQotCQlyZXR1cm4gWFBDT00uTlNfT0s7DQotCX0N
Ci0JaWYgKGd1aWQuRXF1YWxzIChuc0lGYWN0b3J5Lk5TX0lGQUNUT1JZX0lJRCkpIHsNCi0JCVhQ
Q09NLm1lbW1vdmUgKHBwdk9iamVjdCwgbmV3IGludCAvKmxvbmcqL1tdIHtmYWN0b3J5LmdldEFk
ZHJlc3MgKCl9LCBDLlBUUl9TSVpFT0YpOw0KLQkJQWRkUmVmICgpOw0KLQkJcmV0dXJuIFhQQ09N
Lk5TX09LOw0KLQl9DQotCQ0KLQlYUENPTS5tZW1tb3ZlIChwcHZPYmplY3QsIG5ldyBpbnQgLyps
b25nKi9bXSB7MH0sIEMuUFRSX1NJWkVPRik7DQotCXJldHVybiBYUENPTS5OU19FUlJPUl9OT19J
TlRFUkZBQ0U7DQotfQ0KLSAgICAgICAgCQ0KLWludCBSZWxlYXNlICgpIHsNCi0JcmVmQ291bnQt
LTsNCi0JaWYgKHJlZkNvdW50ID09IDApIGRpc3Bvc2VDT01JbnRlcmZhY2VzICgpOw0KLQlyZXR1
cm4gcmVmQ291bnQ7DQotfQ0KLQkNCi0vKiBuc0lGYWN0b3J5ICovDQotDQotaW50IENyZWF0ZUlu
c3RhbmNlIChpbnQgLypsb25nKi8gYU91dGVyLCBpbnQgLypsb25nKi8gaWlkLCBpbnQgLypsb25n
Ki8gcmVzdWx0KSB7DQotCVByb21wdFNlcnZpY2UgcHJvbXB0U2VydmljZSA9IG5ldyBQcm9tcHRT
ZXJ2aWNlICgpOw0KLQlwcm9tcHRTZXJ2aWNlLkFkZFJlZiAoKTsNCi0JWFBDT00ubWVtbW92ZSAo
cmVzdWx0LCBuZXcgaW50IC8qbG9uZyovW10ge3Byb21wdFNlcnZpY2UuZ2V0QWRkcmVzcyAoKX0s
IEMuUFRSX1NJWkVPRik7DQotCXJldHVybiBYUENPTS5OU19PSzsNCi19DQotDQotaW50IExvY2tG
YWN0b3J5IChpbnQgbG9jaykgew0KLQlyZXR1cm4gWFBDT00uTlNfT0s7DQotfQ0KLX0NCkluZGV4
OiBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nlci9Qcm9t
cHRTZXJ2aWNlLmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiBFY2xpcHNlIFNXVCBNb3ppbGxh
L2NvbW1vbi9vcmcvZWNsaXBzZS9zd3QvYnJvd3Nlci9Qcm9tcHRTZXJ2aWNlLmphdmENCmRpZmYg
LU4gRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dzZXIvUHJv
bXB0U2VydmljZS5qYXZhDQotLS0gRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlw
c2Uvc3d0L2Jyb3dzZXIvUHJvbXB0U2VydmljZS5qYXZhCTEgQXVnIDIwMDcgMTk6NTc6MjQgLTAw
MDAJMS45DQorKysgL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCkBAIC0xLDQ5
OCArMCwwIEBADQotLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCi0gKiBDb3B5cmlnaHQgKGMpIDIw
MDMsIDIwMDcgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuDQotICogQWxsIHJpZ2h0cyByZXNl
cnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscw0KLSAqIGFy
ZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExp
Y2Vuc2UgdjEuMA0KLSAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQg
aXMgYXZhaWxhYmxlIGF0DQotICogaHR0cDovL3d3dy5lY2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEw
Lmh0bWwNCi0gKg0KLSAqIENvbnRyaWJ1dG9yczoNCi0gKiAgICAgSUJNIENvcnBvcmF0aW9uIC0g
aW5pdGlhbCBBUEkgYW5kIGltcGxlbWVudGF0aW9uDQotICoqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiov
DQotcGFja2FnZSBvcmcuZWNsaXBzZS5zd3QuYnJvd3NlcjsNCi0NCi1pbXBvcnQgb3JnLmVjbGlw
c2Uuc3d0Lio7DQotaW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5pbnRlcm5hbC4qOw0KLWltcG9ydCBv
cmcuZWNsaXBzZS5zd3QuaW50ZXJuYWwubW96aWxsYS4qOw0KLWltcG9ydCBvcmcuZWNsaXBzZS5z
d3Qud2lkZ2V0cy4qOw0KLQ0KLWNsYXNzIFByb21wdFNlcnZpY2Ugew0KLQlYUENPTU9iamVjdCBz
dXBwb3J0czsNCi0JWFBDT01PYmplY3QgcHJvbXB0U2VydmljZTsNCi0JaW50IHJlZkNvdW50ID0g
MDsNCi0NCi1Qcm9tcHRTZXJ2aWNlICgpIHsNCi0JY3JlYXRlQ09NSW50ZXJmYWNlcyAoKTsNCi19
DQotDQotaW50IEFkZFJlZiAoKSB7DQotCXJlZkNvdW50Kys7DQotCXJldHVybiByZWZDb3VudDsN
Ci19DQotDQotdm9pZCBjcmVhdGVDT01JbnRlcmZhY2VzICgpIHsNCi0JLyogQ3JlYXRlIGVhY2gg
b2YgdGhlIGludGVyZmFjZXMgdGhhdCB0aGlzIG9iamVjdCBpbXBsZW1lbnRzICovDQotCXN1cHBv
cnRzID0gbmV3IFhQQ09NT2JqZWN0IChuZXcgaW50W10gezIsIDAsIDB9KSB7DQotCQlwdWJsaWMg
aW50IC8qbG9uZyovIG1ldGhvZDAgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gUXVlcnlJ
bnRlcmZhY2UgKGFyZ3NbMF0sIGFyZ3NbMV0pO30NCi0JCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0
aG9kMSAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBBZGRSZWYgKCk7fQ0KLQkJcHVibGlj
IGludCAvKmxvbmcqLyBtZXRob2QyIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFJlbGVh
c2UgKCk7fQ0KLQl9Ow0KLQkNCi0JcHJvbXB0U2VydmljZSA9IG5ldyBYUENPTU9iamVjdCAobmV3
IGludFtdIHsyLCAwLCAwLCAzLCA1LCA0LCA2LCAxMCwgNywgOCwgNywgN30pIHsNCi0JCXB1Ymxp
YyBpbnQgLypsb25nKi8gbWV0aG9kMCAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBRdWVy
eUludGVyZmFjZSAoYXJnc1swXSwgYXJnc1sxXSk7fQ0KLQkJcHVibGljIGludCAvKmxvbmcqLyBt
ZXRob2QxIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIEFkZFJlZiAoKTt9DQotCQlwdWJs
aWMgaW50IC8qbG9uZyovIG1ldGhvZDIgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gUmVs
ZWFzZSAoKTt9DQotCQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDMgKGludCAvKmxvbmcqL1td
IGFyZ3MpIHtyZXR1cm4gQWxlcnQgKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pO30NCi0JCXB1
YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kNCAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBB
bGVydENoZWNrIChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdLCBhcmdzWzRdKTt9
DQotCQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDUgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHty
ZXR1cm4gQ29uZmlybSAoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSk7fQ0KLQkJ
cHVibGljIGludCAvKmxvbmcqLyBtZXRob2Q2IChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJu
IENvbmZpcm1DaGVjayAoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSwgYXJnc1s0
XSwgYXJnc1s1XSk7fQ0KLQkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2Q3IChpbnQgLypsb25n
Ki9bXSBhcmdzKSB7cmV0dXJuIENvbmZpcm1FeCAoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwg
KGludCkvKjY0Ki9hcmdzWzNdLCBhcmdzWzRdLCBhcmdzWzVdLCBhcmdzWzZdLCBhcmdzWzddLCBh
cmdzWzhdLCBhcmdzWzldKTt9DQotCQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDggKGludCAv
KmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gUHJvbXB0IChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJd
LCBhcmdzWzNdLCBhcmdzWzRdLCBhcmdzWzVdLCBhcmdzWzZdKTt9DQotCQlwdWJsaWMgaW50IC8q
bG9uZyovIG1ldGhvZDkgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gUHJvbXB0VXNlcm5h
bWVBbmRQYXNzd29yZCAoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSwgYXJnc1s0
XSwgYXJnc1s1XSwgYXJnc1s2XSwgYXJnc1s3XSk7fQ0KLQkJcHVibGljIGludCAvKmxvbmcqLyBt
ZXRob2QxMCAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBQcm9tcHRQYXNzd29yZCAoYXJn
c1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSwgYXJnc1s0XSwgYXJnc1s1XSwgYXJnc1s2
XSk7fQ0KLQkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2QxMSAoaW50IC8qbG9uZyovW10gYXJn
cykge3JldHVybiBTZWxlY3QgKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIChpbnQpLyo2NCov
YXJnc1szXSwgYXJnc1s0XSwgYXJnc1s1XSwgYXJnc1s2XSk7fQ0KLQl9OwkJDQotfQ0KLQ0KLXZv
aWQgZGlzcG9zZUNPTUludGVyZmFjZXMgKCkgew0KLQlpZiAoc3VwcG9ydHMgIT0gbnVsbCkgew0K
LQkJc3VwcG9ydHMuZGlzcG9zZSAoKTsNCi0JCXN1cHBvcnRzID0gbnVsbDsNCi0JfQkNCi0JaWYg
KHByb21wdFNlcnZpY2UgIT0gbnVsbCkgew0KLQkJcHJvbXB0U2VydmljZS5kaXNwb3NlICgpOw0K
LQkJcHJvbXB0U2VydmljZSA9IG51bGw7CQ0KLQl9DQotfQ0KLQ0KLWludCAvKmxvbmcqLyBnZXRB
ZGRyZXNzICgpIHsNCi0JcmV0dXJuIHByb21wdFNlcnZpY2UuZ2V0QWRkcmVzcyAoKTsNCi19DQot
DQotaW50IFF1ZXJ5SW50ZXJmYWNlIChpbnQgLypsb25nKi8gcmlpZCwgaW50IC8qbG9uZyovIHBw
dk9iamVjdCkgew0KLQlpZiAocmlpZCA9PSAwIHx8IHBwdk9iamVjdCA9PSAwKSByZXR1cm4gWFBD
T00uTlNfRVJST1JfTk9fSU5URVJGQUNFOw0KLQluc0lEIGd1aWQgPSBuZXcgbnNJRCAoKTsNCi0J
WFBDT00ubWVtbW92ZSAoZ3VpZCwgcmlpZCwgbnNJRC5zaXplb2YpOw0KLQkNCi0JaWYgKGd1aWQu
RXF1YWxzIChuc0lTdXBwb3J0cy5OU19JU1VQUE9SVFNfSUlEKSkgew0KLQkJWFBDT00ubWVtbW92
ZSAocHB2T2JqZWN0LCBuZXcgaW50IC8qbG9uZyovW10ge3N1cHBvcnRzLmdldEFkZHJlc3MgKCl9
LCBDLlBUUl9TSVpFT0YpOw0KLQkJQWRkUmVmICgpOw0KLQkJcmV0dXJuIFhQQ09NLk5TX09LOw0K
LQl9DQotCWlmIChndWlkLkVxdWFscyAobnNJUHJvbXB0U2VydmljZS5OU19JUFJPTVBUU0VSVklD
RV9JSUQpKSB7DQotCQlYUENPTS5tZW1tb3ZlIChwcHZPYmplY3QsIG5ldyBpbnQgLypsb25nKi9b
XSB7cHJvbXB0U2VydmljZS5nZXRBZGRyZXNzICgpfSwgQy5QVFJfU0laRU9GKTsNCi0JCUFkZFJl
ZiAoKTsNCi0JCXJldHVybiBYUENPTS5OU19PSzsNCi0JfQ0KLQkNCi0JWFBDT00ubWVtbW92ZSAo
cHB2T2JqZWN0LCBuZXcgaW50IC8qbG9uZyovW10gezB9LCBDLlBUUl9TSVpFT0YpOw0KLQlyZXR1
cm4gWFBDT00uTlNfRVJST1JfTk9fSU5URVJGQUNFOw0KLX0NCi0gICAgICAgIAkNCi1pbnQgUmVs
ZWFzZSAoKSB7DQotCXJlZkNvdW50LS07DQotCWlmIChyZWZDb3VudCA9PSAwKSBkaXNwb3NlQ09N
SW50ZXJmYWNlcyAoKTsNCi0JcmV0dXJuIHJlZkNvdW50Ow0KLX0NCi0NCi1Ccm93c2VyIGdldEJy
b3dzZXIgKGludCAvKmxvbmcqLyBhRE9NV2luZG93KSB7DQotCWlmIChhRE9NV2luZG93ID09IDAp
IHJldHVybiBudWxsOw0KLQ0KLQlpbnQgLypsb25nKi9bXSByZXN1bHQgPSBuZXcgaW50IC8qbG9u
ZyovWzFdOw0KLQlpbnQgcmMgPSBYUENPTS5OU19HZXRTZXJ2aWNlTWFuYWdlciAocmVzdWx0KTsN
Ci0JaWYgKHJjICE9IFhQQ09NLk5TX09LKSBNb3ppbGxhLmVycm9yIChyYyk7DQotCWlmIChyZXN1
bHRbMF0gPT0gMCkgTW96aWxsYS5lcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOw0KLQkNCi0J
bnNJU2VydmljZU1hbmFnZXIgc2VydmljZU1hbmFnZXIgPSBuZXcgbnNJU2VydmljZU1hbmFnZXIg
KHJlc3VsdFswXSk7DQotCXJlc3VsdFswXSA9IDA7DQotCWJ5dGVbXSBhQ29udHJhY3RJRCA9IE1v
emlsbGFEZWxlZ2F0ZS53Y3NUb01iY3MgKG51bGwsIFhQQ09NLk5TX1dJTkRPV1dBVENIRVJfQ09O
VFJBQ1RJRCwgdHJ1ZSk7DQotCXJjID0gc2VydmljZU1hbmFnZXIuR2V0U2VydmljZUJ5Q29udHJh
Y3RJRCAoYUNvbnRyYWN0SUQsIG5zSVdpbmRvd1dhdGNoZXIuTlNfSVdJTkRPV1dBVENIRVJfSUlE
LCByZXN1bHQpOw0KLQlpZiAocmMgIT0gWFBDT00uTlNfT0spIE1vemlsbGEuZXJyb3IocmMpOw0K
LQlpZiAocmVzdWx0WzBdID09IDApIE1vemlsbGEuZXJyb3IgKFhQQ09NLk5TX05PSU5URVJGQUNF
KTsJCQ0KLQlzZXJ2aWNlTWFuYWdlci5SZWxlYXNlICgpOw0KLQkNCi0JbnNJV2luZG93V2F0Y2hl
ciB3aW5kb3dXYXRjaGVyID0gbmV3IG5zSVdpbmRvd1dhdGNoZXIgKHJlc3VsdFswXSk7DQotCXJl
c3VsdFswXSA9IDA7DQotCS8qIHRoZSBjaHJvbWUgd2lsbCBvbmx5IGJlIGFuc3dlcmVkIGZvciB0
aGUgdG9wLWxldmVsIG5zSURPTVdpbmRvdyAqLw0KLQluc0lET01XaW5kb3cgd2luZG93ID0gbmV3
IG5zSURPTVdpbmRvdyAoYURPTVdpbmRvdyk7DQotCXJjID0gd2luZG93LkdldFRvcCAocmVzdWx0
KTsNCi0JaWYgKHJjICE9IFhQQ09NLk5TX09LKSBNb3ppbGxhLmVycm9yIChyYyk7DQotCWlmIChy
ZXN1bHRbMF0gPT0gMCkgTW96aWxsYS5lcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOw0KLQlh
RE9NV2luZG93ID0gcmVzdWx0WzBdOw0KLQlyZXN1bHRbMF0gPSAwOw0KLQlyYyA9IHdpbmRvd1dh
dGNoZXIuR2V0Q2hyb21lRm9yV2luZG93IChhRE9NV2luZG93LCByZXN1bHQpOw0KLQlpZiAocmMg
IT0gWFBDT00uTlNfT0spIE1vemlsbGEuZXJyb3IgKHJjKTsNCi0JaWYgKHJlc3VsdFswXSA9PSAw
KSBNb3ppbGxhLmVycm9yIChYUENPTS5OU19OT0lOVEVSRkFDRSk7CQkNCi0Jd2luZG93V2F0Y2hl
ci5SZWxlYXNlICgpOwkNCi0JDQotCW5zSVdlYkJyb3dzZXJDaHJvbWUgd2ViQnJvd3NlckNocm9t
ZSA9IG5ldyBuc0lXZWJCcm93c2VyQ2hyb21lIChyZXN1bHRbMF0pOw0KLQlyZXN1bHRbMF0gPSAw
Ow0KLQlyYyA9IHdlYkJyb3dzZXJDaHJvbWUuUXVlcnlJbnRlcmZhY2UgKG5zSUVtYmVkZGluZ1Np
dGVXaW5kb3cuTlNfSUVNQkVERElOR1NJVEVXSU5ET1dfSUlELCByZXN1bHQpOw0KLQlpZiAocmMg
IT0gWFBDT00uTlNfT0spIE1vemlsbGEuZXJyb3IgKHJjKTsNCi0JaWYgKHJlc3VsdFswXSA9PSAw
KSBNb3ppbGxhLmVycm9yIChYUENPTS5OU19OT0lOVEVSRkFDRSk7CQkNCi0Jd2ViQnJvd3NlckNo
cm9tZS5SZWxlYXNlICgpOw0KLQkNCi0JbnNJRW1iZWRkaW5nU2l0ZVdpbmRvdyBlbWJlZGRpbmdT
aXRlV2luZG93ID0gbmV3IG5zSUVtYmVkZGluZ1NpdGVXaW5kb3cgKHJlc3VsdFswXSk7DQotCXJl
c3VsdFswXSA9IDA7DQotCXJjID0gZW1iZWRkaW5nU2l0ZVdpbmRvdy5HZXRTaXRlV2luZG93IChy
ZXN1bHQpOw0KLQlpZiAocmMgIT0gWFBDT00uTlNfT0spIE1vemlsbGEuZXJyb3IgKHJjKTsNCi0J
aWYgKHJlc3VsdFswXSA9PSAwKSBNb3ppbGxhLmVycm9yIChYUENPTS5OU19OT0lOVEVSRkFDRSk7
CQkNCi0JZW1iZWRkaW5nU2l0ZVdpbmRvdy5SZWxlYXNlICgpOw0KLQkNCi0JcmV0dXJuIE1vemls
bGEuZmluZEJyb3dzZXIgKHJlc3VsdFswXSk7IA0KLX0NCi0NCi1TdHJpbmcgZ2V0TGFiZWwgKGlu
dCBidXR0b25GbGFnLCBpbnQgaW5kZXgsIGludCAvKmxvbmcqLyBidXR0b25UaXRsZSkgew0KLQlT
dHJpbmcgbGFiZWwgPSBudWxsOw0KLQlpbnQgZmxhZyA9IChidXR0b25GbGFnICYgKDB4ZmYgKiBp
bmRleCkpIC8gaW5kZXg7DQotCXN3aXRjaCAoZmxhZykgew0KLQkJY2FzZSBuc0lQcm9tcHRTZXJ2
aWNlLkJVVFRPTl9USVRMRV9DQU5DRUwgOiBsYWJlbCA9IFNXVC5nZXRNZXNzYWdlICgiU1dUX0Nh
bmNlbCIpOyBicmVhazsgLy8kTk9OLU5MUy0xJA0KLQkJY2FzZSBuc0lQcm9tcHRTZXJ2aWNlLkJV
VFRPTl9USVRMRV9OTyA6IGxhYmVsID0gU1dULmdldE1lc3NhZ2UgKCJTV1RfTm8iKTsgYnJlYWs7
IC8vJE5PTi1OTFMtMSQNCi0JCWNhc2UgbnNJUHJvbXB0U2VydmljZS5CVVRUT05fVElUTEVfT0sg
OiBsYWJlbCA9IFNXVC5nZXRNZXNzYWdlICgiU1dUX09LIik7IGJyZWFrOyAvLyROT04tTkxTLTEk
DQotCQljYXNlIG5zSVByb21wdFNlcnZpY2UuQlVUVE9OX1RJVExFX1NBVkUgOiBsYWJlbCA9IFNX
VC5nZXRNZXNzYWdlICgiU1dUX1NhdmUiKTsgYnJlYWs7IC8vJE5PTi1OTFMtMSQNCi0JCWNhc2Ug
bnNJUHJvbXB0U2VydmljZS5CVVRUT05fVElUTEVfWUVTIDogbGFiZWwgPSBTV1QuZ2V0TWVzc2Fn
ZSAoIlNXVF9ZZXMiKTsgYnJlYWs7IC8vJE5PTi1OTFMtMSQNCi0JCWNhc2UgbnNJUHJvbXB0U2Vy
dmljZS5CVVRUT05fVElUTEVfSVNfU1RSSU5HIDogew0KLQkJCWludCBsZW5ndGggPSBYUENPTS5z
dHJsZW5fUFJVbmljaGFyIChidXR0b25UaXRsZSk7DQotCQkJY2hhcltdIGRlc3QgPSBuZXcgY2hh
cltsZW5ndGhdOw0KLQkJCVhQQ09NLm1lbW1vdmUgKGRlc3QsIGJ1dHRvblRpdGxlLCBsZW5ndGgg
KiAyKTsNCi0JCQlsYWJlbCA9IG5ldyBTdHJpbmcgKGRlc3QpOw0KLQkJfQ0KLQl9DQotCXJldHVy
biBsYWJlbDsNCi19DQotDQotLyogbnNJUHJvbXB0U2VydmljZSAqLw0KLQ0KLWludCBBbGVydCAo
aW50IC8qbG9uZyovIGFQYXJlbnQsIGludCAvKmxvbmcqLyBhRGlhbG9nVGl0bGUsIGludCAvKmxv
bmcqLyBhVGV4dCkgew0KLQlCcm93c2VyIGJyb3dzZXIgPSBnZXRCcm93c2VyIChhUGFyZW50KTsN
Ci0JDQotCWludCBsZW5ndGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFyIChhRGlhbG9nVGl0bGUp
Ow0KLQljaGFyW10gZGVzdCA9IG5ldyBjaGFyW2xlbmd0aF07DQotCVhQQ09NLm1lbW1vdmUgKGRl
c3QsIGFEaWFsb2dUaXRsZSwgbGVuZ3RoICogMik7DQotCVN0cmluZyB0aXRsZUxhYmVsID0gbmV3
IFN0cmluZyAoZGVzdCk7DQotDQotCWxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFU
ZXh0KTsNCi0JZGVzdCA9IG5ldyBjaGFyW2xlbmd0aF07DQotCVhQQ09NLm1lbW1vdmUgKGRlc3Qs
IGFUZXh0LCBsZW5ndGggKiAyKTsNCi0JU3RyaW5nIHRleHRMYWJlbCA9IG5ldyBTdHJpbmcgKGRl
c3QpOw0KLQ0KLQlTaGVsbCBzaGVsbCA9IGJyb3dzZXIgPT0gbnVsbCA/IG5ldyBTaGVsbCAoKSA6
IGJyb3dzZXIuZ2V0U2hlbGwgKCk7IA0KLQlNZXNzYWdlQm94IG1lc3NhZ2VCb3ggPSBuZXcgTWVz
c2FnZUJveCAoc2hlbGwsIFNXVC5PSyB8IFNXVC5JQ09OX1dBUk5JTkcpOw0KLQltZXNzYWdlQm94
LnNldFRleHQgKHRpdGxlTGFiZWwpOw0KLQltZXNzYWdlQm94LnNldE1lc3NhZ2UgKHRleHRMYWJl
bCk7DQotCW1lc3NhZ2VCb3gub3BlbiAoKTsNCi0JcmV0dXJuIFhQQ09NLk5TX09LOw0KLX0NCi0N
Ci1pbnQgQWxlcnRDaGVjayAoaW50IC8qbG9uZyovIGFQYXJlbnQsIGludCAvKmxvbmcqLyBhRGlh
bG9nVGl0bGUsIGludCAvKmxvbmcqLyBhVGV4dCwgaW50IC8qbG9uZyovIGFDaGVja01zZywgaW50
IC8qbG9uZyovIGFDaGVja1N0YXRlKSB7DQotCUJyb3dzZXIgYnJvd3NlciA9IGdldEJyb3dzZXIg
KGFQYXJlbnQpOw0KLQkNCi0JaW50IGxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFE
aWFsb2dUaXRsZSk7DQotCWNoYXJbXSBkZXN0ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCi0JWFBDT00u
bWVtbW92ZSAoZGVzdCwgYURpYWxvZ1RpdGxlLCBsZW5ndGggKiAyKTsNCi0JU3RyaW5nIHRpdGxl
TGFiZWwgPSBuZXcgU3RyaW5nIChkZXN0KTsNCi0NCi0JbGVuZ3RoID0gWFBDT00uc3RybGVuX1BS
VW5pY2hhciAoYVRleHQpOw0KLQlkZXN0ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCi0JWFBDT00ubWVt
bW92ZSAoZGVzdCwgYVRleHQsIGxlbmd0aCAqIDIpOw0KLQlTdHJpbmcgdGV4dExhYmVsID0gbmV3
IFN0cmluZyAoZGVzdCk7DQotDQotCWxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFD
aGVja01zZyk7DQotCWRlc3QgPSBuZXcgY2hhcltsZW5ndGhdOw0KLQlYUENPTS5tZW1tb3ZlIChk
ZXN0LCBhQ2hlY2tNc2csIGxlbmd0aCAqIDIpOw0KLQlTdHJpbmcgY2hlY2tMYWJlbCA9IG5ldyBT
dHJpbmcgKGRlc3QpOw0KLQ0KLQlTaGVsbCBzaGVsbCA9IGJyb3dzZXIgPT0gbnVsbCA/IG5ldyBT
aGVsbCAoKSA6IGJyb3dzZXIuZ2V0U2hlbGwgKCk7DQotCVByb21wdERpYWxvZyBkaWFsb2cgPSBu
ZXcgUHJvbXB0RGlhbG9nIChzaGVsbCk7DQotCWludFtdIGNoZWNrID0gbmV3IGludFsxXTsNCi0J
aWYgKGFDaGVja1N0YXRlICE9IDApIFhQQ09NLm1lbW1vdmUgKGNoZWNrLCBhQ2hlY2tTdGF0ZSwg
NCk7IC8qIFBSQm9vbCAqLw0KLQlkaWFsb2cuYWxlcnRDaGVjayAodGl0bGVMYWJlbCwgdGV4dExh
YmVsLCBjaGVja0xhYmVsLCBjaGVjayk7DQotCWlmIChhQ2hlY2tTdGF0ZSAhPSAwKSBYUENPTS5t
ZW1tb3ZlIChhQ2hlY2tTdGF0ZSwgY2hlY2ssIDQpOyAvKiBQUkJvb2wgKi8NCi0JcmV0dXJuIFhQ
Q09NLk5TX09LOw0KLX0NCi0NCi1pbnQgQ29uZmlybSAoaW50IC8qbG9uZyovIGFQYXJlbnQsIGlu
dCAvKmxvbmcqLyBhRGlhbG9nVGl0bGUsIGludCAvKmxvbmcqLyBhVGV4dCwgaW50IC8qbG9uZyov
IF9yZXR2YWwpIHsNCi0JQnJvd3NlciBicm93c2VyID0gZ2V0QnJvd3NlciAoYVBhcmVudCk7DQot
CQ0KLQlpbnQgbGVuZ3RoID0gWFBDT00uc3RybGVuX1BSVW5pY2hhciAoYURpYWxvZ1RpdGxlKTsN
Ci0JY2hhcltdIGRlc3QgPSBuZXcgY2hhcltsZW5ndGhdOw0KLQlYUENPTS5tZW1tb3ZlIChkZXN0
LCBhRGlhbG9nVGl0bGUsIGxlbmd0aCAqIDIpOw0KLQlTdHJpbmcgdGl0bGVMYWJlbCA9IG5ldyBT
dHJpbmcgKGRlc3QpOw0KLQ0KLQlsZW5ndGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFyIChhVGV4
dCk7DQotCWRlc3QgPSBuZXcgY2hhcltsZW5ndGhdOw0KLQlYUENPTS5tZW1tb3ZlIChkZXN0LCBh
VGV4dCwgbGVuZ3RoICogMik7DQotCVN0cmluZyB0ZXh0TGFiZWwgPSBuZXcgU3RyaW5nIChkZXN0
KTsNCi0NCi0JU2hlbGwgc2hlbGwgPSBicm93c2VyID09IG51bGwgPyBuZXcgU2hlbGwgKCkgOiBi
cm93c2VyLmdldFNoZWxsICgpOw0KLQlNZXNzYWdlQm94IG1lc3NhZ2VCb3ggPSBuZXcgTWVzc2Fn
ZUJveCAoc2hlbGwsIFNXVC5PSyB8IFNXVC5DQU5DRUwgfCBTV1QuSUNPTl9RVUVTVElPTik7DQot
CW1lc3NhZ2VCb3guc2V0VGV4dCAodGl0bGVMYWJlbCk7DQotCW1lc3NhZ2VCb3guc2V0TWVzc2Fn
ZSAodGV4dExhYmVsKTsNCi0JaW50IGlkID0gbWVzc2FnZUJveC5vcGVuICgpOw0KLQlpbnRbXSBy
ZXN1bHQgPSB7aWQgPT0gU1dULk9LID8gMSA6IDB9Ow0KLQlYUENPTS5tZW1tb3ZlIChfcmV0dmFs
LCByZXN1bHQsIDQpOw0KLQlyZXR1cm4gWFBDT00uTlNfT0s7DQotfQ0KLQ0KLWludCBDb25maXJt
Q2hlY2sgKGludCAvKmxvbmcqLyBhUGFyZW50LCBpbnQgLypsb25nKi8gYURpYWxvZ1RpdGxlLCBp
bnQgLypsb25nKi8gYVRleHQsIGludCAvKmxvbmcqLyBhQ2hlY2tNc2csIGludCAvKmxvbmcqLyBh
Q2hlY2tTdGF0ZSwgaW50IC8qbG9uZyovIF9yZXR2YWwpIHsNCi0JcmV0dXJuIFhQQ09NLk5TX0VS
Uk9SX05PVF9JTVBMRU1FTlRFRDsNCi19DQotDQotaW50IENvbmZpcm1FeCAoaW50IC8qbG9uZyov
IGFQYXJlbnQsIGludCAvKmxvbmcqLyBhRGlhbG9nVGl0bGUsIGludCAvKmxvbmcqLyBhVGV4dCwg
aW50IGFCdXR0b25GbGFncywgaW50IC8qbG9uZyovIGFCdXR0b24wVGl0bGUsIGludCAvKmxvbmcq
LyBhQnV0dG9uMVRpdGxlLCBpbnQgLypsb25nKi8gYUJ1dHRvbjJUaXRsZSwgaW50IC8qbG9uZyov
IGFDaGVja01zZywgaW50IC8qbG9uZyovIGFDaGVja1N0YXRlLCBpbnQgLypsb25nKi8gX3JldHZh
bCkgew0KLQlCcm93c2VyIGJyb3dzZXIgPSBnZXRCcm93c2VyIChhUGFyZW50KTsNCi0JDQotCWlu
dCBsZW5ndGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFyIChhRGlhbG9nVGl0bGUpOw0KLQljaGFy
W10gZGVzdCA9IG5ldyBjaGFyW2xlbmd0aF07DQotCVhQQ09NLm1lbW1vdmUgKGRlc3QsIGFEaWFs
b2dUaXRsZSwgbGVuZ3RoICogMik7DQotCVN0cmluZyB0aXRsZUxhYmVsID0gbmV3IFN0cmluZyAo
ZGVzdCk7DQotDQotCWxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFUZXh0KTsNCi0J
ZGVzdCA9IG5ldyBjaGFyW2xlbmd0aF07DQotCVhQQ09NLm1lbW1vdmUgKGRlc3QsIGFUZXh0LCBs
ZW5ndGggKiAyKTsNCi0JU3RyaW5nIHRleHRMYWJlbCA9IG5ldyBTdHJpbmcgKGRlc3QpOw0KLQkN
Ci0JU3RyaW5nIGNoZWNrTGFiZWwgPSBudWxsOw0KLQlpZiAoYUNoZWNrTXNnICE9IDApIHsNCi0J
CWxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFDaGVja01zZyk7DQotCQlkZXN0ID0g
bmV3IGNoYXJbbGVuZ3RoXTsNCi0JCVhQQ09NLm1lbW1vdmUgKGRlc3QsIGFDaGVja01zZywgbGVu
Z3RoICogMik7DQotCQljaGVja0xhYmVsID0gbmV3IFN0cmluZyAoZGVzdCk7DQotCX0NCi0JDQot
CVN0cmluZyBidXR0b24wTGFiZWwgPSBnZXRMYWJlbCAoYUJ1dHRvbkZsYWdzLCBuc0lQcm9tcHRT
ZXJ2aWNlLkJVVFRPTl9QT1NfMCwgYUJ1dHRvbjBUaXRsZSk7DQotCVN0cmluZyBidXR0b24xTGFi
ZWwgPSBnZXRMYWJlbCAoYUJ1dHRvbkZsYWdzLCBuc0lQcm9tcHRTZXJ2aWNlLkJVVFRPTl9QT1Nf
MSwgYUJ1dHRvbjFUaXRsZSk7DQotCVN0cmluZyBidXR0b24yTGFiZWwgPSBnZXRMYWJlbCAoYUJ1
dHRvbkZsYWdzLCBuc0lQcm9tcHRTZXJ2aWNlLkJVVFRPTl9QT1NfMiwgYUJ1dHRvbjJUaXRsZSk7
DQotCQ0KLQlpbnQgZGVmYXVsdEluZGV4ID0gMDsNCi0JaWYgKChhQnV0dG9uRmxhZ3MgJiBuc0lQ
cm9tcHRTZXJ2aWNlLkJVVFRPTl9QT1NfMV9ERUZBVUxUKSAhPSAwKSB7DQotCQlkZWZhdWx0SW5k
ZXggPSAxOw0KLQl9IGVsc2UgaWYgKChhQnV0dG9uRmxhZ3MgJiBuc0lQcm9tcHRTZXJ2aWNlLkJV
VFRPTl9QT1NfMl9ERUZBVUxUKSAhPSAwKSB7DQotCQlkZWZhdWx0SW5kZXggPSAyOw0KLQl9DQot
CQ0KLQlTaGVsbCBzaGVsbCA9IGJyb3dzZXIgPT0gbnVsbCA/IG5ldyBTaGVsbCAoKSA6IGJyb3dz
ZXIuZ2V0U2hlbGwgKCk7DQotCVByb21wdERpYWxvZyBkaWFsb2cgPSBuZXcgUHJvbXB0RGlhbG9n
IChzaGVsbCk7DQotCWludFtdIGNoZWNrID0gbmV3IGludFsxXSwgcmVzdWx0ID0gbmV3IGludFsx
XTsNCi0JaWYgKGFDaGVja1N0YXRlICE9IDApIFhQQ09NLm1lbW1vdmUgKGNoZWNrLCBhQ2hlY2tT
dGF0ZSwgNCk7DQotCWRpYWxvZy5jb25maXJtRXggKHRpdGxlTGFiZWwsIHRleHRMYWJlbCwgY2hl
Y2tMYWJlbCwgYnV0dG9uMExhYmVsLCBidXR0b24xTGFiZWwsIGJ1dHRvbjJMYWJlbCwgZGVmYXVs
dEluZGV4LCBjaGVjaywgcmVzdWx0KTsNCi0JaWYgKGFDaGVja1N0YXRlICE9IDApIFhQQ09NLm1l
bW1vdmUgKGFDaGVja1N0YXRlLCBjaGVjaywgNCk7DQotCVhQQ09NLm1lbW1vdmUgKF9yZXR2YWws
IHJlc3VsdCwgNCk7DQotCXJldHVybiBYUENPTS5OU19PSzsNCi19DQotDQotaW50IFByb21wdCAo
aW50IC8qbG9uZyovIGFQYXJlbnQsIGludCAvKmxvbmcqLyBhRGlhbG9nVGl0bGUsIGludCAvKmxv
bmcqLyBhVGV4dCwgaW50IC8qbG9uZyovIGFWYWx1ZSwgaW50IC8qbG9uZyovIGFDaGVja01zZywg
aW50IC8qbG9uZyovIGFDaGVja1N0YXRlLCBpbnQgLypsb25nKi8gX3JldHZhbCkgew0KLQlCcm93
c2VyIGJyb3dzZXIgPSBnZXRCcm93c2VyIChhUGFyZW50KTsNCi0JU3RyaW5nIHRpdGxlTGFiZWwg
PSBudWxsLCB0ZXh0TGFiZWwsIGNoZWNrTGFiZWwgPSBudWxsOw0KLQlTdHJpbmdbXSB2YWx1ZUxh
YmVsID0gbmV3IFN0cmluZ1sxXTsNCi0JY2hhcltdIGRlc3Q7DQotCWludCBsZW5ndGg7DQotCWlm
IChhRGlhbG9nVGl0bGUgIT0gMCkgew0KLQkJbGVuZ3RoID0gWFBDT00uc3RybGVuX1BSVW5pY2hh
ciAoYURpYWxvZ1RpdGxlKTsNCi0JCWRlc3QgPSBuZXcgY2hhcltsZW5ndGhdOw0KLQkJWFBDT00u
bWVtbW92ZSAoZGVzdCwgYURpYWxvZ1RpdGxlLCBsZW5ndGggKiAyKTsNCi0JCXRpdGxlTGFiZWwg
PSBuZXcgU3RyaW5nIChkZXN0KTsNCi0JfQ0KLQkNCi0JbGVuZ3RoID0gWFBDT00uc3RybGVuX1BS
VW5pY2hhciAoYVRleHQpOw0KLQlkZXN0ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCi0JWFBDT00ubWVt
bW92ZSAoZGVzdCwgYVRleHQsIGxlbmd0aCAqIDIpOw0KLQl0ZXh0TGFiZWwgPSBuZXcgU3RyaW5n
IChkZXN0KTsNCi0JDQotCWludCAvKmxvbmcqL1tdIHZhbHVlQWRkciA9IG5ldyBpbnQgLypsb25n
Ki9bMV07DQotCVhQQ09NLm1lbW1vdmUgKHZhbHVlQWRkciwgYVZhbHVlLCBDLlBUUl9TSVpFT0Yp
Ow0KLQlpZiAodmFsdWVBZGRyWzBdICE9IDApIHsNCi0JCWxlbmd0aCA9IFhQQ09NLnN0cmxlbl9Q
UlVuaWNoYXIgKHZhbHVlQWRkclswXSk7DQotCQlkZXN0ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCi0J
CVhQQ09NLm1lbW1vdmUgKGRlc3QsIHZhbHVlQWRkclswXSwgbGVuZ3RoICogMik7DQotCQl2YWx1
ZUxhYmVsWzBdID0gbmV3IFN0cmluZyAoZGVzdCk7CQkNCi0JfQ0KLQkNCi0JaWYgKGFDaGVja01z
ZyAhPSAwKSB7DQotCQlsZW5ndGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFyIChhQ2hlY2tNc2cp
Ow0KLQkJaWYgKGxlbmd0aCA+IDApIHsNCi0JCQlkZXN0ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCi0J
CQlYUENPTS5tZW1tb3ZlIChkZXN0LCBhQ2hlY2tNc2csIGxlbmd0aCAqIDIpOw0KLQkJCWNoZWNr
TGFiZWwgPSBuZXcgU3RyaW5nIChkZXN0KTsNCi0JCX0NCi0JfQ0KLQ0KLQlTaGVsbCBzaGVsbCA9
IGJyb3dzZXIgPT0gbnVsbCA/IG5ldyBTaGVsbCAoKSA6IGJyb3dzZXIuZ2V0U2hlbGwgKCk7DQot
CVByb21wdERpYWxvZyBkaWFsb2cgPSBuZXcgUHJvbXB0RGlhbG9nIChzaGVsbCk7DQotCWludFtd
IGNoZWNrID0gbmV3IGludFsxXSwgcmVzdWx0ID0gbmV3IGludFsxXTsNCi0JaWYgKGFDaGVja1N0
YXRlICE9IDApIFhQQ09NLm1lbW1vdmUgKGNoZWNrLCBhQ2hlY2tTdGF0ZSwgNCk7DQotCWRpYWxv
Zy5wcm9tcHQgKHRpdGxlTGFiZWwsIHRleHRMYWJlbCwgY2hlY2tMYWJlbCwgdmFsdWVMYWJlbCwg
Y2hlY2ssIHJlc3VsdCk7DQotDQotCVhQQ09NLm1lbW1vdmUgKF9yZXR2YWwsIHJlc3VsdCwgNCk7
DQotCWlmIChyZXN1bHRbMF0gPT0gMSkgew0KLQkJLyogDQotCQkqIFVzZXIgc2VsZWN0ZWQgT0su
IFVzZXIgbmFtZSBhbmQgcGFzc3dvcmQgYXJlIHJldHVybmVkIGFzIFBSVW5pY2hhciB2YWx1ZXMu
IEFueSBkZWZhdWx0DQotCQkqIHZhbHVlIHRoYXQgd2Ugb3ZlcnJpZGUgbXVzdCBiZSBmcmVlZCB1
c2luZyB0aGUgbnNJTWVtb3J5IHNlcnZpY2UuDQotCQkqLw0KLQkJaW50IGNudCwgc2l6ZTsNCi0J
CWludCAvKmxvbmcqLyBwdHI7DQotCQljaGFyW10gYnVmZmVyOw0KLQkJaW50IC8qbG9uZyovW10g
cmVzdWx0MiA9IG5ldyBpbnQgLypsb25nKi9bMV07DQotCQlpZiAodmFsdWVMYWJlbFswXSAhPSBu
dWxsKSB7DQotCQkJY250ID0gdmFsdWVMYWJlbFswXS5sZW5ndGggKCk7DQotCQkJYnVmZmVyID0g
bmV3IGNoYXJbY250ICsgMV07DQotCQkJdmFsdWVMYWJlbFswXS5nZXRDaGFycyAoMCwgY250LCBi
dWZmZXIsIDApOw0KLQkJCXNpemUgPSBidWZmZXIubGVuZ3RoICogMjsNCi0JCQlwdHIgPSBDLm1h
bGxvYyAoc2l6ZSk7DQotCQkJWFBDT00ubWVtbW92ZSAocHRyLCBidWZmZXIsIHNpemUpOw0KLQkJ
CVhQQ09NLm1lbW1vdmUgKGFWYWx1ZSwgbmV3IGludCAvKmxvbmcqL1tdIHtwdHJ9LCBDLlBUUl9T
SVpFT0YpOw0KLQ0KLQkJCWlmICh2YWx1ZUFkZHJbMF0gIT0gMCkgew0KLQkJCQlpbnQgcmMgPSBY
UENPTS5OU19HZXRTZXJ2aWNlTWFuYWdlciAocmVzdWx0Mik7DQotCQkJCWlmIChyYyAhPSBYUENP
TS5OU19PSykgU1dULmVycm9yIChyYyk7DQotCQkJCWlmIChyZXN1bHQyWzBdID09IDApIFNXVC5l
cnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOw0KLQkJCQ0KLQkJCQluc0lTZXJ2aWNlTWFuYWdl
ciBzZXJ2aWNlTWFuYWdlciA9IG5ldyBuc0lTZXJ2aWNlTWFuYWdlciAocmVzdWx0MlswXSk7DQot
CQkJCXJlc3VsdDJbMF0gPSAwOw0KLQkJCQlieXRlW10gYUNvbnRyYWN0SUQgPSBNb3ppbGxhRGVs
ZWdhdGUud2NzVG9NYmNzIChudWxsLCBYUENPTS5OU19NRU1PUllfQ09OVFJBQ1RJRCwgdHJ1ZSk7
DQotCQkJCXJjID0gc2VydmljZU1hbmFnZXIuR2V0U2VydmljZUJ5Q29udHJhY3RJRCAoYUNvbnRy
YWN0SUQsIG5zSU1lbW9yeS5OU19JTUVNT1JZX0lJRCwgcmVzdWx0Mik7DQotCQkJCWlmIChyYyAh
PSBYUENPTS5OU19PSykgU1dULmVycm9yIChyYyk7DQotCQkJCWlmIChyZXN1bHQyWzBdID09IDAp
IFNXVC5lcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOwkJDQotCQkJCXNlcnZpY2VNYW5hZ2Vy
LlJlbGVhc2UgKCk7DQotCQkJCQ0KLQkJCQluc0lNZW1vcnkgbWVtb3J5ID0gbmV3IG5zSU1lbW9y
eSAocmVzdWx0MlswXSk7DQotCQkJCXJlc3VsdDJbMF0gPSAwOw0KLQkJCQltZW1vcnkuRnJlZSAo
dmFsdWVBZGRyWzBdKTsNCi0JCQkJbWVtb3J5LlJlbGVhc2UgKCk7DQotCQkJfQ0KLQkJfQ0KLQl9
DQotCWlmIChhQ2hlY2tTdGF0ZSAhPSAwKSBYUENPTS5tZW1tb3ZlIChhQ2hlY2tTdGF0ZSwgY2hl
Y2ssIDQpOw0KLQlyZXR1cm4gWFBDT00uTlNfT0s7DQotfQ0KLQ0KLWludCBQcm9tcHRVc2VybmFt
ZUFuZFBhc3N3b3JkIChpbnQgLypsb25nKi8gYVBhcmVudCwgaW50IC8qbG9uZyovIGFEaWFsb2dU
aXRsZSwgaW50IC8qbG9uZyovIGFUZXh0LCBpbnQgLypsb25nKi8gYVVzZXJuYW1lLCBpbnQgLyps
b25nKi8gYVBhc3N3b3JkLCBpbnQgLypsb25nKi8gYUNoZWNrTXNnLCBpbnQgLypsb25nKi8gYUNo
ZWNrU3RhdGUsIGludCAvKmxvbmcqLyBfcmV0dmFsKSB7DQotCUJyb3dzZXIgYnJvd3NlciA9IGdl
dEJyb3dzZXIgKGFQYXJlbnQpOw0KLQlTdHJpbmcgdGl0bGVMYWJlbCwgdGV4dExhYmVsLCBjaGVj
a0xhYmVsID0gbnVsbDsNCi0JU3RyaW5nW10gdXNlckxhYmVsID0gbmV3IFN0cmluZ1sxXSwgcGFz
c0xhYmVsID0gbmV3IFN0cmluZ1sxXTsNCi0JY2hhcltdIGRlc3Q7DQotCWludCBsZW5ndGg7DQot
CWlmIChhRGlhbG9nVGl0bGUgIT0gMCkgew0KLQkJbGVuZ3RoID0gWFBDT00uc3RybGVuX1BSVW5p
Y2hhciAoYURpYWxvZ1RpdGxlKTsNCi0JCWRlc3QgPSBuZXcgY2hhcltsZW5ndGhdOw0KLQkJWFBD
T00ubWVtbW92ZSAoZGVzdCwgYURpYWxvZ1RpdGxlLCBsZW5ndGggKiAyKTsNCi0JCXRpdGxlTGFi
ZWwgPSBuZXcgU3RyaW5nIChkZXN0KTsNCi0JfSBlbHNlIHsNCi0JCXRpdGxlTGFiZWwgPSAiIjsJ
Ly8kTk9OLU5MUy0xJA0KLQl9DQotCQ0KLQlsZW5ndGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFy
IChhVGV4dCk7DQotCWRlc3QgPSBuZXcgY2hhcltsZW5ndGhdOw0KLQlYUENPTS5tZW1tb3ZlIChk
ZXN0LCBhVGV4dCwgbGVuZ3RoICogMik7DQotCXRleHRMYWJlbCA9IG5ldyBTdHJpbmcgKGRlc3Qp
Ow0KLQkNCi0JaW50IC8qbG9uZyovW10gdXNlckFkZHIgPSBuZXcgaW50IC8qbG9uZyovWzFdOw0K
LQlYUENPTS5tZW1tb3ZlICh1c2VyQWRkciwgYVVzZXJuYW1lLCBDLlBUUl9TSVpFT0YpOw0KLQlp
ZiAodXNlckFkZHJbMF0gIT0gMCkgew0KLQkJbGVuZ3RoID0gWFBDT00uc3RybGVuX1BSVW5pY2hh
ciAodXNlckFkZHJbMF0pOw0KLQkJZGVzdCA9IG5ldyBjaGFyW2xlbmd0aF07DQotCQlYUENPTS5t
ZW1tb3ZlIChkZXN0LCB1c2VyQWRkclswXSwgbGVuZ3RoICogMik7DQotCQl1c2VyTGFiZWxbMF0g
PSBuZXcgU3RyaW5nIChkZXN0KTsJCQ0KLQl9DQotCQ0KLQlpbnQgLypsb25nKi9bXSBwYXNzQWRk
ciA9IG5ldyBpbnQgLypsb25nKi9bMV07DQotCVhQQ09NLm1lbW1vdmUgKHBhc3NBZGRyLCBhUGFz
c3dvcmQsIEMuUFRSX1NJWkVPRik7DQotCWlmIChwYXNzQWRkclswXSAhPSAwKSB7DQotCQlsZW5n
dGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFyIChwYXNzQWRkclswXSk7DQotCQlkZXN0ID0gbmV3
IGNoYXJbbGVuZ3RoXTsNCi0JCVhQQ09NLm1lbW1vdmUgKGRlc3QsIHBhc3NBZGRyWzBdLCBsZW5n
dGggKiAyKTsNCi0JCXBhc3NMYWJlbFswXSA9IG5ldyBTdHJpbmcgKGRlc3QpOwkJDQotCX0NCi0J
DQotCWlmIChhQ2hlY2tNc2cgIT0gMCkgew0KLQkJbGVuZ3RoID0gWFBDT00uc3RybGVuX1BSVW5p
Y2hhciAoYUNoZWNrTXNnKTsNCi0JCWlmIChsZW5ndGggPiAwKSB7DQotCQkJZGVzdCA9IG5ldyBj
aGFyW2xlbmd0aF07DQotCQkJWFBDT00ubWVtbW92ZSAoZGVzdCwgYUNoZWNrTXNnLCBsZW5ndGgg
KiAyKTsNCi0JCQljaGVja0xhYmVsID0gbmV3IFN0cmluZyAoZGVzdCk7DQotCQl9DQotCX0NCi0N
Ci0JU2hlbGwgc2hlbGwgPSBicm93c2VyID09IG51bGwgPyBuZXcgU2hlbGwgKCkgOiBicm93c2Vy
LmdldFNoZWxsICgpOw0KLQlQcm9tcHREaWFsb2cgZGlhbG9nID0gbmV3IFByb21wdERpYWxvZyAo
c2hlbGwpOw0KLQlpbnRbXSBjaGVjayA9IG5ldyBpbnRbMV0sIHJlc3VsdCA9IG5ldyBpbnRbMV07
DQotCWlmIChhQ2hlY2tTdGF0ZSAhPSAwKSBYUENPTS5tZW1tb3ZlIChjaGVjaywgYUNoZWNrU3Rh
dGUsIDQpOw0KLQlkaWFsb2cucHJvbXB0VXNlcm5hbWVBbmRQYXNzd29yZCAodGl0bGVMYWJlbCwg
dGV4dExhYmVsLCBjaGVja0xhYmVsLCB1c2VyTGFiZWwsIHBhc3NMYWJlbCwgY2hlY2ssIHJlc3Vs
dCk7DQotDQotCVhQQ09NLm1lbW1vdmUgKF9yZXR2YWwsIHJlc3VsdCwgNCk7DQotCWlmIChyZXN1
bHRbMF0gPT0gMSkgew0KLQkJLyogDQotCQkqIFVzZXIgc2VsZWN0ZWQgT0suIFVzZXIgbmFtZSBh
bmQgcGFzc3dvcmQgYXJlIHJldHVybmVkIGFzIFBSVW5pY2hhciB2YWx1ZXMuIEFueSBkZWZhdWx0
DQotCQkqIHZhbHVlIHRoYXQgd2Ugb3ZlcnJpZGUgbXVzdCBiZSBmcmVlZCB1c2luZyB0aGUgbnNJ
TWVtb3J5IHNlcnZpY2UuDQotCQkqLw0KLQkJaW50IGNudCwgc2l6ZTsNCi0JCWludCAvKmxvbmcq
LyBwdHI7DQotCQljaGFyW10gYnVmZmVyOw0KLQkJaW50IC8qbG9uZyovW10gcmVzdWx0MiA9IG5l
dyBpbnQgLypsb25nKi9bMV07DQotCQlpZiAodXNlckxhYmVsWzBdICE9IG51bGwpIHsNCi0JCQlj
bnQgPSB1c2VyTGFiZWxbMF0ubGVuZ3RoICgpOw0KLQkJCWJ1ZmZlciA9IG5ldyBjaGFyW2NudCAr
IDFdOw0KLQkJCXVzZXJMYWJlbFswXS5nZXRDaGFycyAoMCwgY250LCBidWZmZXIsIDApOw0KLQkJ
CXNpemUgPSBidWZmZXIubGVuZ3RoICogMjsNCi0JCQlwdHIgPSBDLm1hbGxvYyAoc2l6ZSk7DQot
CQkJWFBDT00ubWVtbW92ZSAocHRyLCBidWZmZXIsIHNpemUpOw0KLQkJCVhQQ09NLm1lbW1vdmUg
KGFVc2VybmFtZSwgbmV3IGludCAvKmxvbmcqL1tdIHtwdHJ9LCBDLlBUUl9TSVpFT0YpOw0KLQ0K
LQkJCWlmICh1c2VyQWRkclswXSAhPSAwKSB7DQotCQkJCWludCByYyA9IFhQQ09NLk5TX0dldFNl
cnZpY2VNYW5hZ2VyIChyZXN1bHQyKTsNCi0JCQkJaWYgKHJjICE9IFhQQ09NLk5TX09LKSBTV1Qu
ZXJyb3IgKHJjKTsNCi0JCQkJaWYgKHJlc3VsdDJbMF0gPT0gMCkgU1dULmVycm9yIChYUENPTS5O
U19OT0lOVEVSRkFDRSk7DQotCQkJDQotCQkJCW5zSVNlcnZpY2VNYW5hZ2VyIHNlcnZpY2VNYW5h
Z2VyID0gbmV3IG5zSVNlcnZpY2VNYW5hZ2VyIChyZXN1bHQyWzBdKTsNCi0JCQkJcmVzdWx0Mlsw
XSA9IDA7DQotCQkJCWJ5dGVbXSBhQ29udHJhY3RJRCA9IE1vemlsbGFEZWxlZ2F0ZS53Y3NUb01i
Y3MgKG51bGwsIFhQQ09NLk5TX01FTU9SWV9DT05UUkFDVElELCB0cnVlKTsNCi0JCQkJcmMgPSBz
ZXJ2aWNlTWFuYWdlci5HZXRTZXJ2aWNlQnlDb250cmFjdElEIChhQ29udHJhY3RJRCwgbnNJTWVt
b3J5Lk5TX0lNRU1PUllfSUlELCByZXN1bHQyKTsNCi0JCQkJaWYgKHJjICE9IFhQQ09NLk5TX09L
KSBTV1QuZXJyb3IgKHJjKTsNCi0JCQkJaWYgKHJlc3VsdFswXSA9PSAwKSBTV1QuZXJyb3IgKFhQ
Q09NLk5TX05PSU5URVJGQUNFKTsJCQ0KLQkJCQlzZXJ2aWNlTWFuYWdlci5SZWxlYXNlICgpOw0K
LQkJCQkNCi0JCQkJbnNJTWVtb3J5IG1lbW9yeSA9IG5ldyBuc0lNZW1vcnkgKHJlc3VsdDJbMF0p
Ow0KLQkJCQlyZXN1bHQyWzBdID0gMDsNCi0JCQkJbWVtb3J5LkZyZWUgKHVzZXJBZGRyWzBdKTsN
Ci0JCQkJbWVtb3J5LlJlbGVhc2UgKCk7DQotCQkJfQ0KLQkJfQ0KLQkJaWYgKHBhc3NMYWJlbFsw
XSAhPSBudWxsKSB7DQotCQkJY250ID0gcGFzc0xhYmVsWzBdLmxlbmd0aCAoKTsNCi0JCQlidWZm
ZXIgPSBuZXcgY2hhcltjbnQgKyAxXTsNCi0JCQlwYXNzTGFiZWxbMF0uZ2V0Q2hhcnMgKDAsIGNu
dCwgYnVmZmVyLCAwKTsNCi0JCQlzaXplID0gYnVmZmVyLmxlbmd0aCAqIDI7DQotCQkJcHRyID0g
Qy5tYWxsb2MgKHNpemUpOw0KLQkJCVhQQ09NLm1lbW1vdmUgKHB0ciwgYnVmZmVyLCBzaXplKTsN
Ci0JCQlYUENPTS5tZW1tb3ZlIChhUGFzc3dvcmQsIG5ldyBpbnQgLypsb25nKi9bXSB7cHRyfSwg
Qy5QVFJfU0laRU9GKTsNCi0JCQkNCi0JCQlpZiAocGFzc0FkZHJbMF0gIT0gMCkgew0KLQkJCQlp
bnQgcmMgPSBYUENPTS5OU19HZXRTZXJ2aWNlTWFuYWdlciAocmVzdWx0Mik7DQotCQkJCWlmIChy
YyAhPSBYUENPTS5OU19PSykgU1dULmVycm9yIChyYyk7DQotCQkJCWlmIChyZXN1bHQyWzBdID09
IDApIFNXVC5lcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOw0KLQ0KLQkJCQluc0lTZXJ2aWNl
TWFuYWdlciBzZXJ2aWNlTWFuYWdlciA9IG5ldyBuc0lTZXJ2aWNlTWFuYWdlciAocmVzdWx0Mlsw
XSk7DQotCQkJCXJlc3VsdDJbMF0gPSAwOw0KLQkJCQlieXRlW10gYUNvbnRyYWN0SUQgPSBNb3pp
bGxhRGVsZWdhdGUud2NzVG9NYmNzIChudWxsLCBYUENPTS5OU19NRU1PUllfQ09OVFJBQ1RJRCwg
dHJ1ZSk7DQotCQkJCXJjID0gc2VydmljZU1hbmFnZXIuR2V0U2VydmljZUJ5Q29udHJhY3RJRCAo
YUNvbnRyYWN0SUQsIG5zSU1lbW9yeS5OU19JTUVNT1JZX0lJRCwgcmVzdWx0Mik7DQotCQkJCWlm
IChyYyAhPSBYUENPTS5OU19PSykgU1dULmVycm9yIChyYyk7DQotCQkJCWlmIChyZXN1bHQyWzBd
ID09IDApIFNXVC5lcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOwkJDQotCQkJCXNlcnZpY2VN
YW5hZ2VyLlJlbGVhc2UgKCk7DQotDQotCQkJCW5zSU1lbW9yeSBtZW1vcnkgPSBuZXcgbnNJTWVt
b3J5IChyZXN1bHQyWzBdKTsNCi0JCQkJcmVzdWx0MlswXSA9IDA7DQotCQkJCW1lbW9yeS5GcmVl
IChwYXNzQWRkclswXSk7DQotCQkJCW1lbW9yeS5SZWxlYXNlICgpOw0KLQkJCX0NCi0JCX0NCi0J
fQ0KLQlpZiAoYUNoZWNrU3RhdGUgIT0gMCkgWFBDT00ubWVtbW92ZSAoYUNoZWNrU3RhdGUsIGNo
ZWNrLCA0KTsNCi0JcmV0dXJuIFhQQ09NLk5TX09LOw0KLX0NCi0NCi1pbnQgUHJvbXB0UGFzc3dv
cmQgKGludCAvKmxvbmcqLyBhUGFyZW50LCBpbnQgLypsb25nKi8gYURpYWxvZ1RpdGxlLCBpbnQg
Lypsb25nKi8gYVRleHQsIGludCAvKmxvbmcqLyBhUGFzc3dvcmQsIGludCAvKmxvbmcqLyBhQ2hl
Y2tNc2csIGludCAvKmxvbmcqLyBhQ2hlY2tTdGF0ZSwgaW50IC8qbG9uZyovIF9yZXR2YWwpIHsN
Ci0JcmV0dXJuIFhQQ09NLk5TX0VSUk9SX05PVF9JTVBMRU1FTlRFRDsNCi19DQotDQotaW50IFNl
bGVjdCAoaW50IC8qbG9uZyovIGFQYXJlbnQsIGludCAvKmxvbmcqLyBhRGlhbG9nVGl0bGUsIGlu
dCAvKmxvbmcqLyBhVGV4dCwgaW50IGFDb3VudCwgaW50IC8qbG9uZyovIGFTZWxlY3RMaXN0LCBp
bnQgLypsb25nKi8gYU91dFNlbGVjdGlvbiwgaW50IC8qbG9uZyovIF9yZXR2YWwpIHsNCi0JcmV0
dXJuIFhQQ09NLk5TX0VSUk9SX05PVF9JTVBMRU1FTlRFRDsNCi19DQotfQ0KSW5kZXg6IEVjbGlw
c2UgU1dUIE1vemlsbGEvY29tbW9uL2xpYnJhcnkveHBjb21fc3RhdHMuY3BwDQo9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
DQpSQ1MgZmlsZTogL2N2c3Jvb3QvZWNsaXBzZS9vcmcuZWNsaXBzZS5zd3QvRWNsaXBzZSBTV1Qg
TW96aWxsYS9jb21tb24vbGlicmFyeS94cGNvbV9zdGF0cy5jcHAsdg0KcmV0cmlldmluZyByZXZp
c2lvbiAxLjM1DQpkaWZmIC11IC1yMS4zNSB4cGNvbV9zdGF0cy5jcHANCi0tLSBFY2xpcHNlIFNX
VCBNb3ppbGxhL2NvbW1vbi9saWJyYXJ5L3hwY29tX3N0YXRzLmNwcAkyMCBOb3YgMjAwNyAxNjoy
MzoxNyAtMDAwMAkxLjM1DQorKysgRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vbGlicmFyeS94
cGNvbV9zdGF0cy5jcHAJOSBKYW4gMjAwOCAyMDoyODo1OSAtMDAwMA0KQEAgLTE0LDggKzE0LDgg
QEANCiANCiAjaWZkZWYgTkFUSVZFX1NUQVRTDQogDQotaW50IFhQQ09NX25hdGl2ZUZ1bmN0aW9u
Q291bnQgPSAxMzI7DQotaW50IFhQQ09NX25hdGl2ZUZ1bmN0aW9uQ2FsbENvdW50WzEzMl07DQor
aW50IFhQQ09NX25hdGl2ZUZ1bmN0aW9uQ291bnQgPSAxMzQ7DQoraW50IFhQQ09NX25hdGl2ZUZ1
bmN0aW9uQ2FsbENvdW50WzEzNF07DQogY2hhciAqIFhQQ09NX25hdGl2ZUZ1bmN0aW9uTmFtZXNb
XSA9IHsNCiAJIkNhbGwiLA0KIAkiTlNfMUdldENvbXBvbmVudE1hbmFnZXIiLA0KQEAgLTMwLDkg
KzMwLDExIEBADQogCSJWdGJsQ2FsbF9fSUlJSUlJIiwNCiAJIlZ0YmxDYWxsX19JSUlJSUlJIiwN
CiAJIlZ0YmxDYWxsX19JSUlJSUlJSSIsDQorCSJWdGJsQ2FsbF9fSUlJSUlJSUlfM0NfM1pfM0ki
LA0KIAkiVnRibENhbGxfX0lJSUlJSUpJSSIsDQogCSJWdGJsQ2FsbF9fSUlJSUlJWiIsDQogCSJW
dGJsQ2FsbF9fSUlJSUlJXzNDXzNCSUlJSVpfM0lfM0kiLA0KKwkiVnRibENhbGxfX0lJSUlJSV8z
Q18zWl8zWiIsDQogCSJWdGJsQ2FsbF9fSUlJSUlJXzNaXzNJIiwNCiAJIlZ0YmxDYWxsX19JSUlJ
SVoiLA0KIAkiVnRibENhbGxfX0lJSUlJWl8zQ0lJSUlaXzNJXzNJIiwNCkluZGV4OiBFY2xpcHNl
IFNXVCBNb3ppbGxhL2NvbW1vbi9saWJyYXJ5L3hwY29tLmNwcA0KPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZp
bGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVjbGlwc2Uuc3d0L0VjbGlwc2UgU1dUIE1vemlsbGEv
Y29tbW9uL2xpYnJhcnkveHBjb20uY3BwLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS41MA0KZGlm
ZiAtdSAtcjEuNTAgeHBjb20uY3BwDQotLS0gRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vbGli
cmFyeS94cGNvbS5jcHAJMjAgTm92IDIwMDcgMTY6MjM6MTcgLTAwMDAJMS41MA0KKysrIEVjbGlw
c2UgU1dUIE1vemlsbGEvY29tbW9uL2xpYnJhcnkveHBjb20uY3BwCTkgSmFuIDIwMDggMjA6Mjg6
NTkgLTAwMDANCkBAIC0yMDMsNiArMjAzLDI5IEBADQogfQ0KICNlbmRpZg0KIA0KKyNpZm5kZWYg
Tk9fVnRibENhbGxfX0lJSUlJSUlJXzNDXzNaXzNJDQorZXh0ZXJuICJDIiBKTklFWFBPUlQgamlu
dCBKTklDQUxMIFhQQ09NX05BVElWRShWdGJsQ2FsbF9fSUlJSUlJSUlfM0NfM1pfM0kpKEpOSUVu
diAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50IGFyZzEsIGppbnQgYXJnMiwgamlu
dCBhcmczLCBqaW50IGFyZzQsIGppbnQgYXJnNSwgamludCBhcmc2LCBqaW50IGFyZzcsIGpjaGFy
QXJyYXkgYXJnOCwgamJvb2xlYW5BcnJheSBhcmc5LCBqaW50QXJyYXkgYXJnMTApOw0KK0pOSUVY
UE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKFZ0YmxDYWxsX19JSUlJSUlJSV8zQ18zWl8z
SSkNCisJKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcwLCBqaW50IGFyZzEsIGpp
bnQgYXJnMiwgamludCBhcmczLCBqaW50IGFyZzQsIGppbnQgYXJnNSwgamludCBhcmc2LCBqaW50
IGFyZzcsIGpjaGFyQXJyYXkgYXJnOCwgamJvb2xlYW5BcnJheSBhcmc5LCBqaW50QXJyYXkgYXJn
MTApDQorew0KKwlqY2hhciAqbHBhcmc4PU5VTEw7DQorCWpib29sZWFuICpscGFyZzk9TlVMTDsN
CisJamludCAqbHBhcmcxMD1OVUxMOw0KKwlqaW50IHJjID0gMDsNCisJWFBDT01fTkFUSVZFX0VO
VEVSKGVudiwgdGhhdCwgVnRibENhbGxfX0lJSUlJSUlJXzNDXzNaXzNJX0ZVTkMpOw0KKwlpZiAo
YXJnOCkgaWYgKChscGFyZzggPSBlbnYtPkdldENoYXJBcnJheUVsZW1lbnRzKGFyZzgsIE5VTEwp
KSA9PSBOVUxMKSBnb3RvIGZhaWw7DQorCWlmIChhcmc5KSBpZiAoKGxwYXJnOSA9IGVudi0+R2V0
Qm9vbGVhbkFycmF5RWxlbWVudHMoYXJnOSwgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsNCisJ
aWYgKGFyZzEwKSBpZiAoKGxwYXJnMTAgPSBlbnYtPkdldEludEFycmF5RWxlbWVudHMoYXJnMTAs
IE5VTEwpKSA9PSBOVUxMKSBnb3RvIGZhaWw7DQorCXJjID0gKGppbnQpKChqaW50IChTVERNRVRI
T0RDQUxMVFlQRSAqKShqaW50LCBqaW50LCBqaW50LCBqaW50LCBqaW50LCBqaW50LCBqaW50LCBq
Y2hhciAqLCBqYm9vbGVhbiAqLCBqaW50ICopKSgqKGppbnQgKiopYXJnMSlbYXJnMF0pKGFyZzEs
IGFyZzIsIGFyZzMsIGFyZzQsIGFyZzUsIGFyZzYsIGFyZzcsIGxwYXJnOCwgbHBhcmc5LCBscGFy
ZzEwKTsNCitmYWlsOg0KKwlpZiAoYXJnMTAgJiYgbHBhcmcxMCkgZW52LT5SZWxlYXNlSW50QXJy
YXlFbGVtZW50cyhhcmcxMCwgbHBhcmcxMCwgMCk7DQorCWlmIChhcmc5ICYmIGxwYXJnOSkgZW52
LT5SZWxlYXNlQm9vbGVhbkFycmF5RWxlbWVudHMoYXJnOSwgbHBhcmc5LCAwKTsNCisJaWYgKGFy
ZzggJiYgbHBhcmc4KSBlbnYtPlJlbGVhc2VDaGFyQXJyYXlFbGVtZW50cyhhcmc4LCBscGFyZzgs
IDApOw0KKwlYUENPTV9OQVRJVkVfRVhJVChlbnYsIHRoYXQsIFZ0YmxDYWxsX19JSUlJSUlJSV8z
Q18zWl8zSV9GVU5DKTsNCisJcmV0dXJuIHJjOw0KK30NCisjZW5kaWYNCisNCiAjaWZuZGVmIE5P
X1Z0YmxDYWxsX19JSUlJSUlKSUkNCiBleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwg
WFBDT01fTkFUSVZFKFZ0YmxDYWxsX19JSUlJSUlKSUkpKEpOSUVudiAqZW52LCBqY2xhc3MgdGhh
dCwgamludCBhcmcwLCBqaW50IGFyZzEsIGppbnQgYXJnMiwgamludCBhcmczLCBqaW50IGFyZzQs
IGppbnQgYXJnNSwgamxvbmcgYXJnNiwgamludCBhcmc3LCBqaW50IGFyZzgpOw0KIEpOSUVYUE9S
VCBqaW50IEpOSUNBTEwgWFBDT01fTkFUSVZFKFZ0YmxDYWxsX19JSUlJSUlKSUkpDQpAQCAtMjU1
LDYgKzI3OCwyOSBAQA0KIH0NCiAjZW5kaWYNCiANCisjaWZuZGVmIE5PX1Z0YmxDYWxsX19JSUlJ
SUlfM0NfM1pfM1oNCitleHRlcm4gIkMiIEpOSUVYUE9SVCBqaW50IEpOSUNBTEwgWFBDT01fTkFU
SVZFKFZ0YmxDYWxsX19JSUlJSUlfM0NfM1pfM1opKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwg
amludCBhcmcwLCBqaW50IGFyZzEsIGppbnQgYXJnMiwgamludCBhcmczLCBqaW50IGFyZzQsIGpp
bnQgYXJnNSwgamNoYXJBcnJheSBhcmc2LCBqYm9vbGVhbkFycmF5IGFyZzcsIGpib29sZWFuQXJy
YXkgYXJnOCk7DQorSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoVnRibENhbGxf
X0lJSUlJSV8zQ18zWl8zWikNCisJKEpOSUVudiAqZW52LCBqY2xhc3MgdGhhdCwgamludCBhcmcw
LCBqaW50IGFyZzEsIGppbnQgYXJnMiwgamludCBhcmczLCBqaW50IGFyZzQsIGppbnQgYXJnNSwg
amNoYXJBcnJheSBhcmc2LCBqYm9vbGVhbkFycmF5IGFyZzcsIGpib29sZWFuQXJyYXkgYXJnOCkN
Cit7DQorCWpjaGFyICpscGFyZzY9TlVMTDsNCisJamJvb2xlYW4gKmxwYXJnNz1OVUxMOw0KKwlq
Ym9vbGVhbiAqbHBhcmc4PU5VTEw7DQorCWppbnQgcmMgPSAwOw0KKwlYUENPTV9OQVRJVkVfRU5U
RVIoZW52LCB0aGF0LCBWdGJsQ2FsbF9fSUlJSUlJXzNDXzNaXzNaX0ZVTkMpOw0KKwlpZiAoYXJn
NikgaWYgKChscGFyZzYgPSBlbnYtPkdldENoYXJBcnJheUVsZW1lbnRzKGFyZzYsIE5VTEwpKSA9
PSBOVUxMKSBnb3RvIGZhaWw7DQorCWlmIChhcmc3KSBpZiAoKGxwYXJnNyA9IGVudi0+R2V0Qm9v
bGVhbkFycmF5RWxlbWVudHMoYXJnNywgTlVMTCkpID09IE5VTEwpIGdvdG8gZmFpbDsNCisJaWYg
KGFyZzgpIGlmICgobHBhcmc4ID0gZW52LT5HZXRCb29sZWFuQXJyYXlFbGVtZW50cyhhcmc4LCBO
VUxMKSkgPT0gTlVMTCkgZ290byBmYWlsOw0KKwlyYyA9IChqaW50KSgoamludCAoU1RETUVUSE9E
Q0FMTFRZUEUgKikoamludCwgamludCwgamludCwgamludCwgamludCwgamNoYXIgKiwgamJvb2xl
YW4gKiwgamJvb2xlYW4gKikpKCooamludCAqKilhcmcxKVthcmcwXSkoYXJnMSwgYXJnMiwgYXJn
MywgYXJnNCwgYXJnNSwgbHBhcmc2LCBscGFyZzcsIGxwYXJnOCk7DQorZmFpbDoNCisJaWYgKGFy
ZzggJiYgbHBhcmc4KSBlbnYtPlJlbGVhc2VCb29sZWFuQXJyYXlFbGVtZW50cyhhcmc4LCBscGFy
ZzgsIDApOw0KKwlpZiAoYXJnNyAmJiBscGFyZzcpIGVudi0+UmVsZWFzZUJvb2xlYW5BcnJheUVs
ZW1lbnRzKGFyZzcsIGxwYXJnNywgMCk7DQorCWlmIChhcmc2ICYmIGxwYXJnNikgZW52LT5SZWxl
YXNlQ2hhckFycmF5RWxlbWVudHMoYXJnNiwgbHBhcmc2LCAwKTsNCisJWFBDT01fTkFUSVZFX0VY
SVQoZW52LCB0aGF0LCBWdGJsQ2FsbF9fSUlJSUlJXzNDXzNaXzNaX0ZVTkMpOw0KKwlyZXR1cm4g
cmM7DQorfQ0KKyNlbmRpZg0KKw0KICNpZm5kZWYgTk9fVnRibENhbGxfX0lJSUlJSV8zWl8zSQ0K
IGV4dGVybiAiQyIgSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBYUENPTV9OQVRJVkUoVnRibENhbGxf
X0lJSUlJSV8zWl8zSSkoSk5JRW52ICplbnYsIGpjbGFzcyB0aGF0LCBqaW50IGFyZzAsIGppbnQg
YXJnMSwgamludCBhcmcyLCBqaW50IGFyZzMsIGppbnQgYXJnNCwgamludCBhcmc1LCBqYm9vbGVh
bkFycmF5IGFyZzYsIGppbnRBcnJheSBhcmc3KTsNCiBKTklFWFBPUlQgamludCBKTklDQUxMIFhQ
Q09NX05BVElWRShWdGJsQ2FsbF9fSUlJSUlJXzNaXzNJKQ0KSW5kZXg6IEVjbGlwc2UgU1dUIE1v
emlsbGEvY29tbW9uL2xpYnJhcnkveHBjb21fc3RhdHMuaA0KPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6
IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVjbGlwc2Uuc3d0L0VjbGlwc2UgU1dUIE1vemlsbGEvY29t
bW9uL2xpYnJhcnkveHBjb21fc3RhdHMuaCx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMzUNCmRp
ZmYgLXUgLXIxLjM1IHhwY29tX3N0YXRzLmgNCi0tLSBFY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1v
bi9saWJyYXJ5L3hwY29tX3N0YXRzLmgJMjAgTm92IDIwMDcgMTY6MjM6MTcgLTAwMDAJMS4zNQ0K
KysrIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL2xpYnJhcnkveHBjb21fc3RhdHMuaAk5IEph
biAyMDA4IDIwOjI4OjU5IC0wMDAwDQpAQCAtMzgsOSArMzgsMTEgQEANCiAJVnRibENhbGxfX0lJ
SUlJSV9GVU5DLA0KIAlWdGJsQ2FsbF9fSUlJSUlJSV9GVU5DLA0KIAlWdGJsQ2FsbF9fSUlJSUlJ
SUlfRlVOQywNCisJVnRibENhbGxfX0lJSUlJSUlJXzNDXzNaXzNJX0ZVTkMsDQogCVZ0YmxDYWxs
X19JSUlJSUlKSUlfRlVOQywNCiAJVnRibENhbGxfX0lJSUlJSVpfRlVOQywNCiAJVnRibENhbGxf
X0lJSUlJSV8zQ18zQklJSUlaXzNJXzNJX0ZVTkMsDQorCVZ0YmxDYWxsX19JSUlJSUlfM0NfM1pf
M1pfRlVOQywNCiAJVnRibENhbGxfX0lJSUlJSV8zWl8zSV9GVU5DLA0KIAlWdGJsQ2FsbF9fSUlJ
SUlaX0ZVTkMsDQogCVZ0YmxDYWxsX19JSUlJSVpfM0NJSUlJWl8zSV8zSV9GVU5DLA0KSW5kZXg6
IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3pp
bGxhL1hQQ09NLmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29y
Zy5lY2xpcHNlLnN3dC9FY2xpcHNlIFNXVCBNb3ppbGxhL2NvbW1vbi9vcmcvZWNsaXBzZS9zd3Qv
aW50ZXJuYWwvbW96aWxsYS9YUENPTS5qYXZhLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS44MA0K
ZGlmZiAtdSAtcjEuODAgWFBDT00uamF2YQ0KLS0tIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9u
L29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL1hQQ09NLmphdmEJNyBOb3YgMjAwNyAx
OToxNjoyNCAtMDAwMAkxLjgwDQorKysgRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2Vj
bGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvWFBDT00uamF2YQk5IEphbiAyMDA4IDIwOjI5OjAw
IC0wMDAwDQpAQCAtMjU2LDQgKzI1Niw2IEBADQogc3RhdGljIGZpbmFsIG5hdGl2ZSBpbnQgVnRi
bENhbGwoaW50IGZuTnVtYmVyLCBpbnQgLypsb25nKi8gcHBWdGJsLCBpbnQgLypsb25nKi8gYXJn
MCwgaW50IC8qbG9uZyovIGFyZzEsIGludCAvKmxvbmcqLyBhcmcyLCBpbnQgYXJnMywgY2hhcltd
IGFyZzQsIGJ5dGVbXSBhcmc1LCBpbnQgLypsb25nKi8gYXJnNiwgaW50IC8qbG9uZyovIGFyZzcs
IGludCBhcmc4LCBpbnQgLypsb25nKi8gYXJnOSwgYm9vbGVhbiBhcmcxMCwgaW50IC8qbG9uZyov
W10gYXJnMTEsIGludCAvKmxvbmcqL1tdIGFyZzEyKTsNCiBzdGF0aWMgZmluYWwgbmF0aXZlIGlu
dCBWdGJsQ2FsbChpbnQgZm5OdW1iZXIsIGludCAvKmxvbmcqLyBwcFZ0YmwsIGludCAvKmxvbmcq
LyBhcmcwLCBpbnQgLypsb25nKi8gYXJnMSwgYnl0ZVtdIGFyZzIpOw0KIHN0YXRpYyBmaW5hbCBu
YXRpdmUgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50
IC8qbG9uZyovIGFyZzAsIGJvb2xlYW4gYXJnMSwgYm9vbGVhbiBhcmcyLCBpbnQgLypsb25nKi8g
YXJnMywgYm9vbGVhbiBhcmc0LCBib29sZWFuIGFyZzUsIGJvb2xlYW4gYXJnNiwgYm9vbGVhbiBh
cmc3LCBpbnQgYXJnOCwgaW50IGFyZzkpOw0KK3N0YXRpYyBmaW5hbCBuYXRpdmUgaW50IFZ0YmxD
YWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50IC8qbG9uZyovIGFyZzAs
IGludCAvKmxvbmcqLyBhcmcxLCBpbnQgYXJnMiwgaW50IC8qbG9uZyovIGFyZzMsIGNoYXJbXSBh
cmc0LCBib29sZWFuW10gYXJnNSwgYm9vbGVhbltdIGFyZzYpOw0KK3N0YXRpYyBmaW5hbCBuYXRp
dmUgaW50IFZ0YmxDYWxsKGludCBmbk51bWJlciwgaW50IC8qbG9uZyovIHBwVnRibCwgaW50IC8q
bG9uZyovIGFyZzAsIGludCAvKmxvbmcqLyBhcmcxLCBpbnQgLypsb25nKi8gYXJnMiwgaW50IC8q
bG9uZyovIGFyZzMsIGludCBhcmc0LCBpbnQgLypsb25nKi8gYXJnNSwgY2hhcltdIGFyZzYsIGJv
b2xlYW5bXSBhcmc3LCBpbnQgLypsb25nKi9bXSBhcmc4KTsNCiB9DQpJbmRleDogRWNsaXBzZSBT
V1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dzZXIvUHJvbXB0U2VydmljZTIu
amF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29y
Zy9lY2xpcHNlL3N3dC9icm93c2VyL1Byb21wdFNlcnZpY2UyLmphdmENCmRpZmYgLU4gRWNsaXBz
ZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dzZXIvUHJvbXB0U2Vydmlj
ZTIuamF2YQ0KLS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQorKysgRWNs
aXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dzZXIvUHJvbXB0U2Vy
dmljZTIuamF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDYzMCBAQA0K
Ky8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqDQorICogQ29weXJpZ2h0IChjKSAyMDAzLCAyMDA3IElC
TSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLg0KKyAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMg
cHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMNCisgKiBhcmUgbWFkZSBhdmFp
bGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAN
CisgKiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJs
ZSBhdA0KKyAqIGh0dHA6Ly93d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYxMC5odG1sDQorICoN
CisgKiBDb250cmlidXRvcnM6DQorICogICAgIElCTSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwgQVBJ
IGFuZCBpbXBsZW1lbnRhdGlvbg0KKyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KK3BhY2thZ2Ug
b3JnLmVjbGlwc2Uuc3d0LmJyb3dzZXI7DQorDQoraW1wb3J0IG9yZy5lY2xpcHNlLnN3dC4qOw0K
K2ltcG9ydCBvcmcuZWNsaXBzZS5zd3QuaW50ZXJuYWwuKjsNCitpbXBvcnQgb3JnLmVjbGlwc2Uu
c3d0LmludGVybmFsLm1vemlsbGEuKjsNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMu
KjsNCisNCitjbGFzcyBQcm9tcHRTZXJ2aWNlMiB7DQorCVhQQ09NT2JqZWN0IHN1cHBvcnRzOw0K
KwlYUENPTU9iamVjdCBwcm9tcHRTZXJ2aWNlOw0KKwlYUENPTU9iamVjdCBwcm9tcHRTZXJ2aWNl
MjsNCisJaW50IHJlZkNvdW50ID0gMDsNCisNCitQcm9tcHRTZXJ2aWNlMiAoKSB7DQorCWNyZWF0
ZUNPTUludGVyZmFjZXMgKCk7DQorfQ0KKw0KK2ludCBBZGRSZWYgKCkgew0KKwlyZWZDb3VudCsr
Ow0KKwlyZXR1cm4gcmVmQ291bnQ7DQorfQ0KKw0KK3ZvaWQgY3JlYXRlQ09NSW50ZXJmYWNlcyAo
KSB7DQorCS8qIENyZWF0ZSBlYWNoIG9mIHRoZSBpbnRlcmZhY2VzIHRoYXQgdGhpcyBvYmplY3Qg
aW1wbGVtZW50cyAqLw0KKwlzdXBwb3J0cyA9IG5ldyBYUENPTU9iamVjdCAobmV3IGludFtdIHsy
LCAwLCAwfSkgew0KKwkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2QwIChpbnQgLypsb25nKi9b
XSBhcmdzKSB7cmV0dXJuIFF1ZXJ5SW50ZXJmYWNlIChhcmdzWzBdLCBhcmdzWzFdKTt9DQorCQlw
dWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDEgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4g
QWRkUmVmICgpO30NCisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kMiAoaW50IC8qbG9uZyov
W10gYXJncykge3JldHVybiBSZWxlYXNlICgpO30NCisJfTsNCisJDQorCXByb21wdFNlcnZpY2Ug
PSBuZXcgWFBDT01PYmplY3QgKG5ldyBpbnRbXSB7MiwgMCwgMCwgMywgNSwgNCwgNiwgMTAsIDcs
IDgsIDcsIDd9KSB7DQorCQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDAgKGludCAvKmxvbmcq
L1tdIGFyZ3MpIHtyZXR1cm4gUXVlcnlJbnRlcmZhY2UgKGFyZ3NbMF0sIGFyZ3NbMV0pO30NCisJ
CXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kMSAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVy
biBBZGRSZWYgKCk7fQ0KKwkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2QyIChpbnQgLypsb25n
Ki9bXSBhcmdzKSB7cmV0dXJuIFJlbGVhc2UgKCk7fQ0KKwkJcHVibGljIGludCAvKmxvbmcqLyBt
ZXRob2QzIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIEFsZXJ0IChhcmdzWzBdLCBhcmdz
WzFdLCBhcmdzWzJdKTt9DQorCQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDQgKGludCAvKmxv
bmcqL1tdIGFyZ3MpIHtyZXR1cm4gQWxlcnRDaGVjayAoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1sy
XSwgYXJnc1szXSwgYXJnc1s0XSk7fQ0KKwkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2Q1IChp
bnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIENvbmZpcm0gKGFyZ3NbMF0sIGFyZ3NbMV0sIGFy
Z3NbMl0sIGFyZ3NbM10pO30NCisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kNiAoaW50IC8q
bG9uZyovW10gYXJncykge3JldHVybiBDb25maXJtQ2hlY2sgKGFyZ3NbMF0sIGFyZ3NbMV0sIGFy
Z3NbMl0sIGFyZ3NbM10sIGFyZ3NbNF0sIGFyZ3NbNV0pO30NCisJCXB1YmxpYyBpbnQgLypsb25n
Ki8gbWV0aG9kNyAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBDb25maXJtRXggKGFyZ3Nb
MF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIChpbnQpLyo2NCovYXJnc1szXSwgYXJnc1s0XSwgYXJnc1s1
XSwgYXJnc1s2XSwgYXJnc1s3XSwgYXJnc1s4XSwgYXJnc1s5XSk7fQ0KKwkJcHVibGljIGludCAv
KmxvbmcqLyBtZXRob2Q4IChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFByb21wdCAoYXJn
c1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSwgYXJnc1s0XSwgYXJnc1s1XSwgYXJnc1s2
XSk7fQ0KKwkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2Q5IChpbnQgLypsb25nKi9bXSBhcmdz
KSB7cmV0dXJuIFByb21wdFVzZXJuYW1lQW5kUGFzc3dvcmQgKGFyZ3NbMF0sIGFyZ3NbMV0sIGFy
Z3NbMl0sIGFyZ3NbM10sIGFyZ3NbNF0sIGFyZ3NbNV0sIGFyZ3NbNl0sIGFyZ3NbN10pO30NCisJ
CXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kMTAgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1
cm4gUHJvbXB0UGFzc3dvcmQgKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10sIGFy
Z3NbNF0sIGFyZ3NbNV0sIGFyZ3NbNl0pO30NCisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9k
MTEgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gU2VsZWN0IChhcmdzWzBdLCBhcmdzWzFd
LCBhcmdzWzJdLCAoaW50KS8qNjQqL2FyZ3NbM10sIGFyZ3NbNF0sIGFyZ3NbNV0sIGFyZ3NbNl0p
O30NCisJfTsNCisJDQorCXByb21wdFNlcnZpY2UyID0gbmV3IFhQQ09NT2JqZWN0IChuZXcgaW50
W10gezIsIDAsIDAsIDMsIDUsIDQsIDYsIDEwLCA3LCA4LCA3LCA3LCA3LCA5fSkgew0KKwkJcHVi
bGljIGludCAvKmxvbmcqLyBtZXRob2QwIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFF1
ZXJ5SW50ZXJmYWNlIChhcmdzWzBdLCBhcmdzWzFdKTt9DQorCQlwdWJsaWMgaW50IC8qbG9uZyov
IG1ldGhvZDEgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gQWRkUmVmICgpO30NCisJCXB1
YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kMiAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBS
ZWxlYXNlICgpO30NCisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kMyAoaW50IC8qbG9uZyov
W10gYXJncykge3JldHVybiBBbGVydCAoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSk7fQ0KKwkJ
cHVibGljIGludCAvKmxvbmcqLyBtZXRob2Q0IChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJu
IEFsZXJ0Q2hlY2sgKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10sIGFyZ3NbNF0p
O30NCisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kNSAoaW50IC8qbG9uZyovW10gYXJncykg
e3JldHVybiBDb25maXJtIChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKTt9DQor
CQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDYgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1
cm4gQ29uZmlybUNoZWNrIChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdLCBhcmdz
WzRdLCBhcmdzWzVdKTt9DQorCQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDcgKGludCAvKmxv
bmcqL1tdIGFyZ3MpIHtyZXR1cm4gQ29uZmlybUV4IChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJd
LCAoaW50KS8qNjQqL2FyZ3NbM10sIGFyZ3NbNF0sIGFyZ3NbNV0sIGFyZ3NbNl0sIGFyZ3NbN10s
IGFyZ3NbOF0sIGFyZ3NbOV0pO30NCisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kOCAoaW50
IC8qbG9uZyovW10gYXJncykge3JldHVybiBQcm9tcHQgKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3Nb
Ml0sIGFyZ3NbM10sIGFyZ3NbNF0sIGFyZ3NbNV0sIGFyZ3NbNl0pO30NCisJCXB1YmxpYyBpbnQg
Lypsb25nKi8gbWV0aG9kOSAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBQcm9tcHRVc2Vy
bmFtZUFuZFBhc3N3b3JkIChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdLCBhcmdz
WzRdLCBhcmdzWzVdLCBhcmdzWzZdLCBhcmdzWzddKTt9DQorCQlwdWJsaWMgaW50IC8qbG9uZyov
IG1ldGhvZDEwIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFByb21wdFBhc3N3b3JkIChh
cmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdLCBhcmdzWzRdLCBhcmdzWzVdLCBhcmdz
WzZdKTt9DQorCQlwdWJsaWMgaW50IC8qbG9uZyovIG1ldGhvZDExIChpbnQgLypsb25nKi9bXSBh
cmdzKSB7cmV0dXJuIFNlbGVjdCAoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgKGludCkvKjY0
Ki9hcmdzWzNdLCBhcmdzWzRdLCBhcmdzWzVdLCBhcmdzWzZdKTt9DQorCQlwdWJsaWMgaW50IC8q
bG9uZyovIG1ldGhvZDEyIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFByb21wdEF1dGgg
KGFyZ3NbMF0sIGFyZ3NbMV0sIChpbnQpLyo2NCovYXJnc1syXSwgYXJnc1szXSwgYXJnc1s0XSwg
YXJnc1s1XSwgYXJnc1s2XSk7fQ0KKwkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2QxMyAoaW50
IC8qbG9uZyovW10gYXJncykge3JldHVybiBBc3luY1Byb21wdEF1dGggKGFyZ3NbMF0sIGFyZ3Nb
MV0sIGFyZ3NbMl0sIGFyZ3NbM10sIChpbnQpLyo2NCovYXJnc1s0XSwgYXJnc1s1XSwgYXJnc1s2
XSwgYXJnc1s3XSwgYXJnc1s4XSk7fQ0KKwl9Ow0KK30NCisNCit2b2lkIGRpc3Bvc2VDT01JbnRl
cmZhY2VzICgpIHsNCisJaWYgKHN1cHBvcnRzICE9IG51bGwpIHsNCisJCXN1cHBvcnRzLmRpc3Bv
c2UgKCk7DQorCQlzdXBwb3J0cyA9IG51bGw7DQorCX0JDQorCWlmIChwcm9tcHRTZXJ2aWNlICE9
IG51bGwpIHsNCisJCXByb21wdFNlcnZpY2UuZGlzcG9zZSAoKTsNCisJCXByb21wdFNlcnZpY2Ug
PSBudWxsOwkNCisJfQ0KKwlpZiAocHJvbXB0U2VydmljZTIgIT0gbnVsbCkgew0KKwkJcHJvbXB0
U2VydmljZTIuZGlzcG9zZSAoKTsNCisJCXByb21wdFNlcnZpY2UyID0gbnVsbDsJDQorCX0NCit9
DQorDQoraW50IC8qbG9uZyovIGdldEFkZHJlc3MgKCkgew0KKwlyZXR1cm4gcHJvbXB0U2Vydmlj
ZTIuZ2V0QWRkcmVzcyAoKTsNCit9DQorDQoraW50IFF1ZXJ5SW50ZXJmYWNlIChpbnQgLypsb25n
Ki8gcmlpZCwgaW50IC8qbG9uZyovIHBwdk9iamVjdCkgew0KKwlpZiAocmlpZCA9PSAwIHx8IHBw
dk9iamVjdCA9PSAwKSByZXR1cm4gWFBDT00uTlNfRVJST1JfTk9fSU5URVJGQUNFOw0KKwluc0lE
IGd1aWQgPSBuZXcgbnNJRCAoKTsNCisJWFBDT00ubWVtbW92ZSAoZ3VpZCwgcmlpZCwgbnNJRC5z
aXplb2YpOw0KKwkNCisJaWYgKGd1aWQuRXF1YWxzIChuc0lTdXBwb3J0cy5OU19JU1VQUE9SVFNf
SUlEKSkgew0KKwkJWFBDT00ubWVtbW92ZSAocHB2T2JqZWN0LCBuZXcgaW50IC8qbG9uZyovW10g
e3N1cHBvcnRzLmdldEFkZHJlc3MgKCl9LCBDLlBUUl9TSVpFT0YpOw0KKwkJQWRkUmVmICgpOw0K
KwkJcmV0dXJuIFhQQ09NLk5TX09LOw0KKwl9DQorCWlmIChndWlkLkVxdWFscyAobnNJUHJvbXB0
U2VydmljZS5OU19JUFJPTVBUU0VSVklDRV9JSUQpKSB7DQorCQlYUENPTS5tZW1tb3ZlIChwcHZP
YmplY3QsIG5ldyBpbnQgLypsb25nKi9bXSB7cHJvbXB0U2VydmljZS5nZXRBZGRyZXNzICgpfSwg
Qy5QVFJfU0laRU9GKTsNCisJCUFkZFJlZiAoKTsNCisJCXJldHVybiBYUENPTS5OU19PSzsNCisJ
fQ0KKwlpZiAoZ3VpZC5FcXVhbHMgKG5zSVByb21wdFNlcnZpY2UyLk5TX0lQUk9NUFRTRVJWSUNF
Ml9JSUQpKSB7DQorCQlYUENPTS5tZW1tb3ZlIChwcHZPYmplY3QsIG5ldyBpbnQgLypsb25nKi9b
XSB7cHJvbXB0U2VydmljZTIuZ2V0QWRkcmVzcyAoKX0sIEMuUFRSX1NJWkVPRik7DQorCQlBZGRS
ZWYgKCk7DQorCQlyZXR1cm4gWFBDT00uTlNfT0s7DQorCX0NCisNCisJWFBDT00ubWVtbW92ZSAo
cHB2T2JqZWN0LCBuZXcgaW50IC8qbG9uZyovW10gezB9LCBDLlBUUl9TSVpFT0YpOw0KKwlyZXR1
cm4gWFBDT00uTlNfRVJST1JfTk9fSU5URVJGQUNFOw0KK30NCisgICAgICAgIAkNCitpbnQgUmVs
ZWFzZSAoKSB7DQorCXJlZkNvdW50LS07DQorCWlmIChyZWZDb3VudCA9PSAwKSBkaXNwb3NlQ09N
SW50ZXJmYWNlcyAoKTsNCisJcmV0dXJuIHJlZkNvdW50Ow0KK30NCisNCitCcm93c2VyIGdldEJy
b3dzZXIgKGludCAvKmxvbmcqLyBhRE9NV2luZG93KSB7DQorCWlmIChhRE9NV2luZG93ID09IDAp
IHJldHVybiBudWxsOw0KKw0KKwlpbnQgLypsb25nKi9bXSByZXN1bHQgPSBuZXcgaW50IC8qbG9u
ZyovWzFdOw0KKwlpbnQgcmMgPSBYUENPTS5OU19HZXRTZXJ2aWNlTWFuYWdlciAocmVzdWx0KTsN
CisJaWYgKHJjICE9IFhQQ09NLk5TX09LKSBNb3ppbGxhLmVycm9yIChyYyk7DQorCWlmIChyZXN1
bHRbMF0gPT0gMCkgTW96aWxsYS5lcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOw0KKwkNCisJ
bnNJU2VydmljZU1hbmFnZXIgc2VydmljZU1hbmFnZXIgPSBuZXcgbnNJU2VydmljZU1hbmFnZXIg
KHJlc3VsdFswXSk7DQorCXJlc3VsdFswXSA9IDA7DQorCWJ5dGVbXSBhQ29udHJhY3RJRCA9IE1v
emlsbGFEZWxlZ2F0ZS53Y3NUb01iY3MgKG51bGwsIFhQQ09NLk5TX1dJTkRPV1dBVENIRVJfQ09O
VFJBQ1RJRCwgdHJ1ZSk7DQorCXJjID0gc2VydmljZU1hbmFnZXIuR2V0U2VydmljZUJ5Q29udHJh
Y3RJRCAoYUNvbnRyYWN0SUQsIG5zSVdpbmRvd1dhdGNoZXIuTlNfSVdJTkRPV1dBVENIRVJfSUlE
LCByZXN1bHQpOw0KKwlpZiAocmMgIT0gWFBDT00uTlNfT0spIE1vemlsbGEuZXJyb3IocmMpOw0K
KwlpZiAocmVzdWx0WzBdID09IDApIE1vemlsbGEuZXJyb3IgKFhQQ09NLk5TX05PSU5URVJGQUNF
KTsJCQ0KKwlzZXJ2aWNlTWFuYWdlci5SZWxlYXNlICgpOw0KKwkNCisJbnNJV2luZG93V2F0Y2hl
ciB3aW5kb3dXYXRjaGVyID0gbmV3IG5zSVdpbmRvd1dhdGNoZXIgKHJlc3VsdFswXSk7DQorCXJl
c3VsdFswXSA9IDA7DQorCS8qIHRoZSBjaHJvbWUgd2lsbCBvbmx5IGJlIGFuc3dlcmVkIGZvciB0
aGUgdG9wLWxldmVsIG5zSURPTVdpbmRvdyAqLw0KKwluc0lET01XaW5kb3cgd2luZG93ID0gbmV3
IG5zSURPTVdpbmRvdyAoYURPTVdpbmRvdyk7DQorCXJjID0gd2luZG93LkdldFRvcCAocmVzdWx0
KTsNCisJaWYgKHJjICE9IFhQQ09NLk5TX09LKSBNb3ppbGxhLmVycm9yIChyYyk7DQorCWlmIChy
ZXN1bHRbMF0gPT0gMCkgTW96aWxsYS5lcnJvciAoWFBDT00uTlNfTk9JTlRFUkZBQ0UpOw0KKwlh
RE9NV2luZG93ID0gcmVzdWx0WzBdOw0KKwlyZXN1bHRbMF0gPSAwOw0KKwlyYyA9IHdpbmRvd1dh
dGNoZXIuR2V0Q2hyb21lRm9yV2luZG93IChhRE9NV2luZG93LCByZXN1bHQpOw0KKwlpZiAocmMg
IT0gWFBDT00uTlNfT0spIE1vemlsbGEuZXJyb3IgKHJjKTsNCisJaWYgKHJlc3VsdFswXSA9PSAw
KSBNb3ppbGxhLmVycm9yIChYUENPTS5OU19OT0lOVEVSRkFDRSk7CQkNCisJd2luZG93V2F0Y2hl
ci5SZWxlYXNlICgpOwkNCisJDQorCW5zSVdlYkJyb3dzZXJDaHJvbWUgd2ViQnJvd3NlckNocm9t
ZSA9IG5ldyBuc0lXZWJCcm93c2VyQ2hyb21lIChyZXN1bHRbMF0pOw0KKwlyZXN1bHRbMF0gPSAw
Ow0KKwlyYyA9IHdlYkJyb3dzZXJDaHJvbWUuUXVlcnlJbnRlcmZhY2UgKG5zSUVtYmVkZGluZ1Np
dGVXaW5kb3cuTlNfSUVNQkVERElOR1NJVEVXSU5ET1dfSUlELCByZXN1bHQpOw0KKwlpZiAocmMg
IT0gWFBDT00uTlNfT0spIE1vemlsbGEuZXJyb3IgKHJjKTsNCisJaWYgKHJlc3VsdFswXSA9PSAw
KSBNb3ppbGxhLmVycm9yIChYUENPTS5OU19OT0lOVEVSRkFDRSk7CQkNCisJd2ViQnJvd3NlckNo
cm9tZS5SZWxlYXNlICgpOw0KKwkNCisJbnNJRW1iZWRkaW5nU2l0ZVdpbmRvdyBlbWJlZGRpbmdT
aXRlV2luZG93ID0gbmV3IG5zSUVtYmVkZGluZ1NpdGVXaW5kb3cgKHJlc3VsdFswXSk7DQorCXJl
c3VsdFswXSA9IDA7DQorCXJjID0gZW1iZWRkaW5nU2l0ZVdpbmRvdy5HZXRTaXRlV2luZG93IChy
ZXN1bHQpOw0KKwlpZiAocmMgIT0gWFBDT00uTlNfT0spIE1vemlsbGEuZXJyb3IgKHJjKTsNCisJ
aWYgKHJlc3VsdFswXSA9PSAwKSBNb3ppbGxhLmVycm9yIChYUENPTS5OU19OT0lOVEVSRkFDRSk7
CQkNCisJZW1iZWRkaW5nU2l0ZVdpbmRvdy5SZWxlYXNlICgpOw0KKwkNCisJcmV0dXJuIE1vemls
bGEuZmluZEJyb3dzZXIgKHJlc3VsdFswXSk7IA0KK30NCisNCitTdHJpbmcgZ2V0TGFiZWwgKGlu
dCBidXR0b25GbGFnLCBpbnQgaW5kZXgsIGludCAvKmxvbmcqLyBidXR0b25UaXRsZSkgew0KKwlT
dHJpbmcgbGFiZWwgPSBudWxsOw0KKwlpbnQgZmxhZyA9IChidXR0b25GbGFnICYgKDB4ZmYgKiBp
bmRleCkpIC8gaW5kZXg7DQorCXN3aXRjaCAoZmxhZykgew0KKwkJY2FzZSBuc0lQcm9tcHRTZXJ2
aWNlLkJVVFRPTl9USVRMRV9DQU5DRUwgOiBsYWJlbCA9IFNXVC5nZXRNZXNzYWdlICgiU1dUX0Nh
bmNlbCIpOyBicmVhazsgLy8kTk9OLU5MUy0xJA0KKwkJY2FzZSBuc0lQcm9tcHRTZXJ2aWNlLkJV
VFRPTl9USVRMRV9OTyA6IGxhYmVsID0gU1dULmdldE1lc3NhZ2UgKCJTV1RfTm8iKTsgYnJlYWs7
IC8vJE5PTi1OTFMtMSQNCisJCWNhc2UgbnNJUHJvbXB0U2VydmljZS5CVVRUT05fVElUTEVfT0sg
OiBsYWJlbCA9IFNXVC5nZXRNZXNzYWdlICgiU1dUX09LIik7IGJyZWFrOyAvLyROT04tTkxTLTEk
DQorCQljYXNlIG5zSVByb21wdFNlcnZpY2UuQlVUVE9OX1RJVExFX1NBVkUgOiBsYWJlbCA9IFNX
VC5nZXRNZXNzYWdlICgiU1dUX1NhdmUiKTsgYnJlYWs7IC8vJE5PTi1OTFMtMSQNCisJCWNhc2Ug
bnNJUHJvbXB0U2VydmljZS5CVVRUT05fVElUTEVfWUVTIDogbGFiZWwgPSBTV1QuZ2V0TWVzc2Fn
ZSAoIlNXVF9ZZXMiKTsgYnJlYWs7IC8vJE5PTi1OTFMtMSQNCisJCWNhc2UgbnNJUHJvbXB0U2Vy
dmljZS5CVVRUT05fVElUTEVfSVNfU1RSSU5HIDogew0KKwkJCWludCBsZW5ndGggPSBYUENPTS5z
dHJsZW5fUFJVbmljaGFyIChidXR0b25UaXRsZSk7DQorCQkJY2hhcltdIGRlc3QgPSBuZXcgY2hh
cltsZW5ndGhdOw0KKwkJCVhQQ09NLm1lbW1vdmUgKGRlc3QsIGJ1dHRvblRpdGxlLCBsZW5ndGgg
KiAyKTsNCisJCQlsYWJlbCA9IG5ldyBTdHJpbmcgKGRlc3QpOw0KKwkJfQ0KKwl9DQorCXJldHVy
biBsYWJlbDsNCit9DQorDQorLyogbnNJUHJvbXB0U2VydmljZSAqLw0KKw0KK2ludCBBbGVydCAo
aW50IC8qbG9uZyovIGFQYXJlbnQsIGludCAvKmxvbmcqLyBhRGlhbG9nVGl0bGUsIGludCAvKmxv
bmcqLyBhVGV4dCkgew0KKwlCcm93c2VyIGJyb3dzZXIgPSBnZXRCcm93c2VyIChhUGFyZW50KTsN
CisJDQorCWludCBsZW5ndGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFyIChhRGlhbG9nVGl0bGUp
Ow0KKwljaGFyW10gZGVzdCA9IG5ldyBjaGFyW2xlbmd0aF07DQorCVhQQ09NLm1lbW1vdmUgKGRl
c3QsIGFEaWFsb2dUaXRsZSwgbGVuZ3RoICogMik7DQorCVN0cmluZyB0aXRsZUxhYmVsID0gbmV3
IFN0cmluZyAoZGVzdCk7DQorDQorCWxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFU
ZXh0KTsNCisJZGVzdCA9IG5ldyBjaGFyW2xlbmd0aF07DQorCVhQQ09NLm1lbW1vdmUgKGRlc3Qs
IGFUZXh0LCBsZW5ndGggKiAyKTsNCisJU3RyaW5nIHRleHRMYWJlbCA9IG5ldyBTdHJpbmcgKGRl
c3QpOw0KKw0KKwlTaGVsbCBzaGVsbCA9IGJyb3dzZXIgPT0gbnVsbCA/IG5ldyBTaGVsbCAoKSA6
IGJyb3dzZXIuZ2V0U2hlbGwgKCk7IA0KKwlNZXNzYWdlQm94IG1lc3NhZ2VCb3ggPSBuZXcgTWVz
c2FnZUJveCAoc2hlbGwsIFNXVC5PSyB8IFNXVC5JQ09OX1dBUk5JTkcpOw0KKwltZXNzYWdlQm94
LnNldFRleHQgKHRpdGxlTGFiZWwpOw0KKwltZXNzYWdlQm94LnNldE1lc3NhZ2UgKHRleHRMYWJl
bCk7DQorCW1lc3NhZ2VCb3gub3BlbiAoKTsNCisJcmV0dXJuIFhQQ09NLk5TX09LOw0KK30NCisN
CitpbnQgQWxlcnRDaGVjayAoaW50IC8qbG9uZyovIGFQYXJlbnQsIGludCAvKmxvbmcqLyBhRGlh
bG9nVGl0bGUsIGludCAvKmxvbmcqLyBhVGV4dCwgaW50IC8qbG9uZyovIGFDaGVja01zZywgaW50
IC8qbG9uZyovIGFDaGVja1N0YXRlKSB7DQorCUJyb3dzZXIgYnJvd3NlciA9IGdldEJyb3dzZXIg
KGFQYXJlbnQpOw0KKwkNCisJaW50IGxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFE
aWFsb2dUaXRsZSk7DQorCWNoYXJbXSBkZXN0ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCisJWFBDT00u
bWVtbW92ZSAoZGVzdCwgYURpYWxvZ1RpdGxlLCBsZW5ndGggKiAyKTsNCisJU3RyaW5nIHRpdGxl
TGFiZWwgPSBuZXcgU3RyaW5nIChkZXN0KTsNCisNCisJbGVuZ3RoID0gWFBDT00uc3RybGVuX1BS
VW5pY2hhciAoYVRleHQpOw0KKwlkZXN0ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCisJWFBDT00ubWVt
bW92ZSAoZGVzdCwgYVRleHQsIGxlbmd0aCAqIDIpOw0KKwlTdHJpbmcgdGV4dExhYmVsID0gbmV3
IFN0cmluZyAoZGVzdCk7DQorDQorCWxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFD
aGVja01zZyk7DQorCWRlc3QgPSBuZXcgY2hhcltsZW5ndGhdOw0KKwlYUENPTS5tZW1tb3ZlIChk
ZXN0LCBhQ2hlY2tNc2csIGxlbmd0aCAqIDIpOw0KKwlTdHJpbmcgY2hlY2tMYWJlbCA9IG5ldyBT
dHJpbmcgKGRlc3QpOw0KKw0KKwlTaGVsbCBzaGVsbCA9IGJyb3dzZXIgPT0gbnVsbCA/IG5ldyBT
aGVsbCAoKSA6IGJyb3dzZXIuZ2V0U2hlbGwgKCk7DQorCVByb21wdERpYWxvZyBkaWFsb2cgPSBu
ZXcgUHJvbXB0RGlhbG9nIChzaGVsbCk7DQorCWludFtdIGNoZWNrID0gbmV3IGludFsxXTsNCisJ
aWYgKGFDaGVja1N0YXRlICE9IDApIFhQQ09NLm1lbW1vdmUgKGNoZWNrLCBhQ2hlY2tTdGF0ZSwg
NCk7IC8qIFBSQm9vbCAqLw0KKwlkaWFsb2cuYWxlcnRDaGVjayAodGl0bGVMYWJlbCwgdGV4dExh
YmVsLCBjaGVja0xhYmVsLCBjaGVjayk7DQorCWlmIChhQ2hlY2tTdGF0ZSAhPSAwKSBYUENPTS5t
ZW1tb3ZlIChhQ2hlY2tTdGF0ZSwgY2hlY2ssIDQpOyAvKiBQUkJvb2wgKi8NCisJcmV0dXJuIFhQ
Q09NLk5TX09LOw0KK30NCisNCitpbnQgQXN5bmNQcm9tcHRBdXRoKGludCAvKmxvbmcqLyBhUGFy
ZW50LCBpbnQgLypsb25nKi8gYUNoYW5uZWwsIGludCAvKmxvbmcqLyBhQ2FsbGJhY2ssIGludCAv
KmxvbmcqLyBhQ29udGV4dCwgaW50IGxldmVsLCBpbnQgLypsb25nKi8gYXV0aEluZm8sIGludCAv
KmxvbmcqLyBjaGVja2JveExhYmVsLCBpbnQgLypsb25nKi8gY2hlY2tWYWx1ZSwgaW50IC8qbG9u
ZyovIF9yZXR2YWwpIHsNCisJcmV0dXJuIFhQQ09NLk5TX0VSUk9SX05PVF9JTVBMRU1FTlRFRDsN
Cit9DQorDQoraW50IENvbmZpcm0gKGludCAvKmxvbmcqLyBhUGFyZW50LCBpbnQgLypsb25nKi8g
YURpYWxvZ1RpdGxlLCBpbnQgLypsb25nKi8gYVRleHQsIGludCAvKmxvbmcqLyBfcmV0dmFsKSB7
DQorCUJyb3dzZXIgYnJvd3NlciA9IGdldEJyb3dzZXIgKGFQYXJlbnQpOw0KKwkNCisJaW50IGxl
bmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFEaWFsb2dUaXRsZSk7DQorCWNoYXJbXSBk
ZXN0ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCisJWFBDT00ubWVtbW92ZSAoZGVzdCwgYURpYWxvZ1Rp
dGxlLCBsZW5ndGggKiAyKTsNCisJU3RyaW5nIHRpdGxlTGFiZWwgPSBuZXcgU3RyaW5nIChkZXN0
KTsNCisNCisJbGVuZ3RoID0gWFBDT00uc3RybGVuX1BSVW5pY2hhciAoYVRleHQpOw0KKwlkZXN0
ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCisJWFBDT00ubWVtbW92ZSAoZGVzdCwgYVRleHQsIGxlbmd0
aCAqIDIpOw0KKwlTdHJpbmcgdGV4dExhYmVsID0gbmV3IFN0cmluZyAoZGVzdCk7DQorDQorCVNo
ZWxsIHNoZWxsID0gYnJvd3NlciA9PSBudWxsID8gbmV3IFNoZWxsICgpIDogYnJvd3Nlci5nZXRT
aGVsbCAoKTsNCisJTWVzc2FnZUJveCBtZXNzYWdlQm94ID0gbmV3IE1lc3NhZ2VCb3ggKHNoZWxs
LCBTV1QuT0sgfCBTV1QuQ0FOQ0VMIHwgU1dULklDT05fUVVFU1RJT04pOw0KKwltZXNzYWdlQm94
LnNldFRleHQgKHRpdGxlTGFiZWwpOw0KKwltZXNzYWdlQm94LnNldE1lc3NhZ2UgKHRleHRMYWJl
bCk7DQorCWludCBpZCA9IG1lc3NhZ2VCb3gub3BlbiAoKTsNCisJaW50W10gcmVzdWx0ID0ge2lk
ID09IFNXVC5PSyA/IDEgOiAwfTsNCisJWFBDT00ubWVtbW92ZSAoX3JldHZhbCwgcmVzdWx0LCA0
KTsNCisJcmV0dXJuIFhQQ09NLk5TX09LOw0KK30NCisNCitpbnQgQ29uZmlybUNoZWNrIChpbnQg
Lypsb25nKi8gYVBhcmVudCwgaW50IC8qbG9uZyovIGFEaWFsb2dUaXRsZSwgaW50IC8qbG9uZyov
IGFUZXh0LCBpbnQgLypsb25nKi8gYUNoZWNrTXNnLCBpbnQgLypsb25nKi8gYUNoZWNrU3RhdGUs
IGludCAvKmxvbmcqLyBfcmV0dmFsKSB7DQorCXJldHVybiBYUENPTS5OU19FUlJPUl9OT1RfSU1Q
TEVNRU5URUQ7DQorfQ0KKw0KK2ludCBDb25maXJtRXggKGludCAvKmxvbmcqLyBhUGFyZW50LCBp
bnQgLypsb25nKi8gYURpYWxvZ1RpdGxlLCBpbnQgLypsb25nKi8gYVRleHQsIGludCBhQnV0dG9u
RmxhZ3MsIGludCAvKmxvbmcqLyBhQnV0dG9uMFRpdGxlLCBpbnQgLypsb25nKi8gYUJ1dHRvbjFU
aXRsZSwgaW50IC8qbG9uZyovIGFCdXR0b24yVGl0bGUsIGludCAvKmxvbmcqLyBhQ2hlY2tNc2cs
IGludCAvKmxvbmcqLyBhQ2hlY2tTdGF0ZSwgaW50IC8qbG9uZyovIF9yZXR2YWwpIHsNCisJQnJv
d3NlciBicm93c2VyID0gZ2V0QnJvd3NlciAoYVBhcmVudCk7DQorCQ0KKwlpbnQgbGVuZ3RoID0g
WFBDT00uc3RybGVuX1BSVW5pY2hhciAoYURpYWxvZ1RpdGxlKTsNCisJY2hhcltdIGRlc3QgPSBu
ZXcgY2hhcltsZW5ndGhdOw0KKwlYUENPTS5tZW1tb3ZlIChkZXN0LCBhRGlhbG9nVGl0bGUsIGxl
bmd0aCAqIDIpOw0KKwlTdHJpbmcgdGl0bGVMYWJlbCA9IG5ldyBTdHJpbmcgKGRlc3QpOw0KKw0K
KwlsZW5ndGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFyIChhVGV4dCk7DQorCWRlc3QgPSBuZXcg
Y2hhcltsZW5ndGhdOw0KKwlYUENPTS5tZW1tb3ZlIChkZXN0LCBhVGV4dCwgbGVuZ3RoICogMik7
DQorCVN0cmluZyB0ZXh0TGFiZWwgPSBuZXcgU3RyaW5nIChkZXN0KTsNCisJDQorCVN0cmluZyBj
aGVja0xhYmVsID0gbnVsbDsNCisJaWYgKGFDaGVja01zZyAhPSAwKSB7DQorCQlsZW5ndGggPSBY
UENPTS5zdHJsZW5fUFJVbmljaGFyIChhQ2hlY2tNc2cpOw0KKwkJZGVzdCA9IG5ldyBjaGFyW2xl
bmd0aF07DQorCQlYUENPTS5tZW1tb3ZlIChkZXN0LCBhQ2hlY2tNc2csIGxlbmd0aCAqIDIpOw0K
KwkJY2hlY2tMYWJlbCA9IG5ldyBTdHJpbmcgKGRlc3QpOw0KKwl9DQorCQ0KKwlTdHJpbmcgYnV0
dG9uMExhYmVsID0gZ2V0TGFiZWwgKGFCdXR0b25GbGFncywgbnNJUHJvbXB0U2VydmljZS5CVVRU
T05fUE9TXzAsIGFCdXR0b24wVGl0bGUpOw0KKwlTdHJpbmcgYnV0dG9uMUxhYmVsID0gZ2V0TGFi
ZWwgKGFCdXR0b25GbGFncywgbnNJUHJvbXB0U2VydmljZS5CVVRUT05fUE9TXzEsIGFCdXR0b24x
VGl0bGUpOw0KKwlTdHJpbmcgYnV0dG9uMkxhYmVsID0gZ2V0TGFiZWwgKGFCdXR0b25GbGFncywg
bnNJUHJvbXB0U2VydmljZS5CVVRUT05fUE9TXzIsIGFCdXR0b24yVGl0bGUpOw0KKwkNCisJaW50
IGRlZmF1bHRJbmRleCA9IDA7DQorCWlmICgoYUJ1dHRvbkZsYWdzICYgbnNJUHJvbXB0U2Vydmlj
ZS5CVVRUT05fUE9TXzFfREVGQVVMVCkgIT0gMCkgew0KKwkJZGVmYXVsdEluZGV4ID0gMTsNCisJ
fSBlbHNlIGlmICgoYUJ1dHRvbkZsYWdzICYgbnNJUHJvbXB0U2VydmljZS5CVVRUT05fUE9TXzJf
REVGQVVMVCkgIT0gMCkgew0KKwkJZGVmYXVsdEluZGV4ID0gMjsNCisJfQ0KKwkNCisJU2hlbGwg
c2hlbGwgPSBicm93c2VyID09IG51bGwgPyBuZXcgU2hlbGwgKCkgOiBicm93c2VyLmdldFNoZWxs
ICgpOw0KKwlQcm9tcHREaWFsb2cgZGlhbG9nID0gbmV3IFByb21wdERpYWxvZyAoc2hlbGwpOw0K
KwlpbnRbXSBjaGVjayA9IG5ldyBpbnRbMV0sIHJlc3VsdCA9IG5ldyBpbnRbMV07DQorCWlmIChh
Q2hlY2tTdGF0ZSAhPSAwKSBYUENPTS5tZW1tb3ZlIChjaGVjaywgYUNoZWNrU3RhdGUsIDQpOw0K
KwlkaWFsb2cuY29uZmlybUV4ICh0aXRsZUxhYmVsLCB0ZXh0TGFiZWwsIGNoZWNrTGFiZWwsIGJ1
dHRvbjBMYWJlbCwgYnV0dG9uMUxhYmVsLCBidXR0b24yTGFiZWwsIGRlZmF1bHRJbmRleCwgY2hl
Y2ssIHJlc3VsdCk7DQorCWlmIChhQ2hlY2tTdGF0ZSAhPSAwKSBYUENPTS5tZW1tb3ZlIChhQ2hl
Y2tTdGF0ZSwgY2hlY2ssIDQpOw0KKwlYUENPTS5tZW1tb3ZlIChfcmV0dmFsLCByZXN1bHQsIDQp
Ow0KKwlyZXR1cm4gWFBDT00uTlNfT0s7DQorfQ0KKw0KK2ludCBQcm9tcHQgKGludCAvKmxvbmcq
LyBhUGFyZW50LCBpbnQgLypsb25nKi8gYURpYWxvZ1RpdGxlLCBpbnQgLypsb25nKi8gYVRleHQs
IGludCAvKmxvbmcqLyBhVmFsdWUsIGludCAvKmxvbmcqLyBhQ2hlY2tNc2csIGludCAvKmxvbmcq
LyBhQ2hlY2tTdGF0ZSwgaW50IC8qbG9uZyovIF9yZXR2YWwpIHsNCisJQnJvd3NlciBicm93c2Vy
ID0gZ2V0QnJvd3NlciAoYVBhcmVudCk7DQorCVN0cmluZyB0aXRsZUxhYmVsID0gbnVsbCwgdGV4
dExhYmVsLCBjaGVja0xhYmVsID0gbnVsbDsNCisJU3RyaW5nW10gdmFsdWVMYWJlbCA9IG5ldyBT
dHJpbmdbMV07DQorCWNoYXJbXSBkZXN0Ow0KKwlpbnQgbGVuZ3RoOw0KKwlpZiAoYURpYWxvZ1Rp
dGxlICE9IDApIHsNCisJCWxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFEaWFsb2dU
aXRsZSk7DQorCQlkZXN0ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCisJCVhQQ09NLm1lbW1vdmUgKGRl
c3QsIGFEaWFsb2dUaXRsZSwgbGVuZ3RoICogMik7DQorCQl0aXRsZUxhYmVsID0gbmV3IFN0cmlu
ZyAoZGVzdCk7DQorCX0NCisJDQorCWxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFU
ZXh0KTsNCisJZGVzdCA9IG5ldyBjaGFyW2xlbmd0aF07DQorCVhQQ09NLm1lbW1vdmUgKGRlc3Qs
IGFUZXh0LCBsZW5ndGggKiAyKTsNCisJdGV4dExhYmVsID0gbmV3IFN0cmluZyAoZGVzdCk7DQor
CQ0KKwlpbnQgLypsb25nKi9bXSB2YWx1ZUFkZHIgPSBuZXcgaW50IC8qbG9uZyovWzFdOw0KKwlY
UENPTS5tZW1tb3ZlICh2YWx1ZUFkZHIsIGFWYWx1ZSwgQy5QVFJfU0laRU9GKTsNCisJaWYgKHZh
bHVlQWRkclswXSAhPSAwKSB7DQorCQlsZW5ndGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFyICh2
YWx1ZUFkZHJbMF0pOw0KKwkJZGVzdCA9IG5ldyBjaGFyW2xlbmd0aF07DQorCQlYUENPTS5tZW1t
b3ZlIChkZXN0LCB2YWx1ZUFkZHJbMF0sIGxlbmd0aCAqIDIpOw0KKwkJdmFsdWVMYWJlbFswXSA9
IG5ldyBTdHJpbmcgKGRlc3QpOwkJDQorCX0NCisJDQorCWlmIChhQ2hlY2tNc2cgIT0gMCkgew0K
KwkJbGVuZ3RoID0gWFBDT00uc3RybGVuX1BSVW5pY2hhciAoYUNoZWNrTXNnKTsNCisJCWlmIChs
ZW5ndGggPiAwKSB7DQorCQkJZGVzdCA9IG5ldyBjaGFyW2xlbmd0aF07DQorCQkJWFBDT00ubWVt
bW92ZSAoZGVzdCwgYUNoZWNrTXNnLCBsZW5ndGggKiAyKTsNCisJCQljaGVja0xhYmVsID0gbmV3
IFN0cmluZyAoZGVzdCk7DQorCQl9DQorCX0NCisNCisJU2hlbGwgc2hlbGwgPSBicm93c2VyID09
IG51bGwgPyBuZXcgU2hlbGwgKCkgOiBicm93c2VyLmdldFNoZWxsICgpOw0KKwlQcm9tcHREaWFs
b2cgZGlhbG9nID0gbmV3IFByb21wdERpYWxvZyAoc2hlbGwpOw0KKwlpbnRbXSBjaGVjayA9IG5l
dyBpbnRbMV0sIHJlc3VsdCA9IG5ldyBpbnRbMV07DQorCWlmIChhQ2hlY2tTdGF0ZSAhPSAwKSBY
UENPTS5tZW1tb3ZlIChjaGVjaywgYUNoZWNrU3RhdGUsIDQpOw0KKwlkaWFsb2cucHJvbXB0ICh0
aXRsZUxhYmVsLCB0ZXh0TGFiZWwsIGNoZWNrTGFiZWwsIHZhbHVlTGFiZWwsIGNoZWNrLCByZXN1
bHQpOw0KKw0KKwlYUENPTS5tZW1tb3ZlIChfcmV0dmFsLCByZXN1bHQsIDQpOw0KKwlpZiAocmVz
dWx0WzBdID09IDEpIHsNCisJCS8qIA0KKwkJKiBVc2VyIHNlbGVjdGVkIE9LLiBVc2VyIG5hbWUg
YW5kIHBhc3N3b3JkIGFyZSByZXR1cm5lZCBhcyBQUlVuaWNoYXIgdmFsdWVzLiBBbnkgZGVmYXVs
dA0KKwkJKiB2YWx1ZSB0aGF0IHdlIG92ZXJyaWRlIG11c3QgYmUgZnJlZWQgdXNpbmcgdGhlIG5z
SU1lbW9yeSBzZXJ2aWNlLg0KKwkJKi8NCisJCWludCBjbnQsIHNpemU7DQorCQlpbnQgLypsb25n
Ki8gcHRyOw0KKwkJY2hhcltdIGJ1ZmZlcjsNCisJCWludCAvKmxvbmcqL1tdIHJlc3VsdDIgPSBu
ZXcgaW50IC8qbG9uZyovWzFdOw0KKwkJaWYgKHZhbHVlTGFiZWxbMF0gIT0gbnVsbCkgew0KKwkJ
CWNudCA9IHZhbHVlTGFiZWxbMF0ubGVuZ3RoICgpOw0KKwkJCWJ1ZmZlciA9IG5ldyBjaGFyW2Nu
dCArIDFdOw0KKwkJCXZhbHVlTGFiZWxbMF0uZ2V0Q2hhcnMgKDAsIGNudCwgYnVmZmVyLCAwKTsN
CisJCQlzaXplID0gYnVmZmVyLmxlbmd0aCAqIDI7DQorCQkJcHRyID0gQy5tYWxsb2MgKHNpemUp
Ow0KKwkJCVhQQ09NLm1lbW1vdmUgKHB0ciwgYnVmZmVyLCBzaXplKTsNCisJCQlYUENPTS5tZW1t
b3ZlIChhVmFsdWUsIG5ldyBpbnQgLypsb25nKi9bXSB7cHRyfSwgQy5QVFJfU0laRU9GKTsNCisN
CisJCQlpZiAodmFsdWVBZGRyWzBdICE9IDApIHsNCisJCQkJaW50IHJjID0gWFBDT00uTlNfR2V0
U2VydmljZU1hbmFnZXIgKHJlc3VsdDIpOw0KKwkJCQlpZiAocmMgIT0gWFBDT00uTlNfT0spIFNX
VC5lcnJvciAocmMpOw0KKwkJCQlpZiAocmVzdWx0MlswXSA9PSAwKSBTV1QuZXJyb3IgKFhQQ09N
Lk5TX05PSU5URVJGQUNFKTsNCisJCQkNCisJCQkJbnNJU2VydmljZU1hbmFnZXIgc2VydmljZU1h
bmFnZXIgPSBuZXcgbnNJU2VydmljZU1hbmFnZXIgKHJlc3VsdDJbMF0pOw0KKwkJCQlyZXN1bHQy
WzBdID0gMDsNCisJCQkJYnl0ZVtdIGFDb250cmFjdElEID0gTW96aWxsYURlbGVnYXRlLndjc1Rv
TWJjcyAobnVsbCwgWFBDT00uTlNfTUVNT1JZX0NPTlRSQUNUSUQsIHRydWUpOw0KKwkJCQlyYyA9
IHNlcnZpY2VNYW5hZ2VyLkdldFNlcnZpY2VCeUNvbnRyYWN0SUQgKGFDb250cmFjdElELCBuc0lN
ZW1vcnkuTlNfSU1FTU9SWV9JSUQsIHJlc3VsdDIpOw0KKwkJCQlpZiAocmMgIT0gWFBDT00uTlNf
T0spIFNXVC5lcnJvciAocmMpOw0KKwkJCQlpZiAocmVzdWx0MlswXSA9PSAwKSBTV1QuZXJyb3Ig
KFhQQ09NLk5TX05PSU5URVJGQUNFKTsJCQ0KKwkJCQlzZXJ2aWNlTWFuYWdlci5SZWxlYXNlICgp
Ow0KKwkJCQkNCisJCQkJbnNJTWVtb3J5IG1lbW9yeSA9IG5ldyBuc0lNZW1vcnkgKHJlc3VsdDJb
MF0pOw0KKwkJCQlyZXN1bHQyWzBdID0gMDsNCisJCQkJbWVtb3J5LkZyZWUgKHZhbHVlQWRkclsw
XSk7DQorCQkJCW1lbW9yeS5SZWxlYXNlICgpOw0KKwkJCX0NCisJCX0NCisJfQ0KKwlpZiAoYUNo
ZWNrU3RhdGUgIT0gMCkgWFBDT00ubWVtbW92ZSAoYUNoZWNrU3RhdGUsIGNoZWNrLCA0KTsNCisJ
cmV0dXJuIFhQQ09NLk5TX09LOw0KK30NCisNCitpbnQgUHJvbXB0QXV0aChpbnQgLypsb25nKi8g
YVBhcmVudCwgaW50IC8qbG9uZyovIGFDaGFubmVsLCBpbnQgbGV2ZWwsIGludCAvKmxvbmcqLyBh
dXRoSW5mbywgaW50IC8qbG9uZyovIGNoZWNrYm94TGFiZWwsIGludCAvKmxvbmcqLyBjaGVja2Jv
eFZhbHVlLCBpbnQgLypsb25nKi8gX3JldHZhbCkgew0KKwlCcm93c2VyIGJyb3dzZXIgPSBnZXRC
cm93c2VyIChhUGFyZW50KTsNCisJU3RyaW5nIGNoZWNrTGFiZWwgPSBudWxsOw0KKwlpbnRbXSBj
aGVja1ZhbHVlID0gbmV3IGludFsxXTsNCisJU3RyaW5nW10gdXNlckxhYmVsID0gbmV3IFN0cmlu
Z1sxXSwgcGFzc0xhYmVsID0gbmV3IFN0cmluZ1sxXTsNCisNCisJU3RyaW5nIHRpdGxlID0gU1dU
LmdldE1lc3NhZ2UgKCJTV1RfQXV0aGVudGljYXRpb25fUmVxdWlyZWQiKTsgLy8kTk9OLU5MUy0x
JA0KKw0KKwlpZiAoY2hlY2tib3hMYWJlbCAhPSAwICYmIGNoZWNrYm94VmFsdWUgIT0gMCkgew0K
KwkJaW50IGxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGNoZWNrYm94TGFiZWwpOw0K
KwkJY2hhcltdIGRlc3QgPSBuZXcgY2hhcltsZW5ndGhdOw0KKwkJWFBDT00ubWVtbW92ZSAoZGVz
dCwgY2hlY2tib3hMYWJlbCwgbGVuZ3RoICogMik7DQorCQljaGVja0xhYmVsID0gbmV3IFN0cmlu
ZyAoZGVzdCk7DQorCQlYUENPTS5tZW1tb3ZlIChjaGVja1ZhbHVlLCBjaGVja2JveFZhbHVlLCA0
KTsgLyogUFJCb29sICovDQorCX0NCisNCisJLyogZ2V0IGluaXRpYWwgdXNlcm5hbWUgYW5kIHBh
c3N3b3JkIHZhbHVlcyAqLw0KKw0KKwluc0lBdXRoSW5mb3JtYXRpb24gYXV0aCA9IG5ldyBuc0lB
dXRoSW5mb3JtYXRpb24gKGF1dGhJbmZvKTsNCisNCisJaW50IC8qbG9uZyovIHB0ciA9IFhQQ09N
Lm5zRW1iZWRTdHJpbmdfbmV3ICgpOw0KKwlpbnQgcmMgPSBhdXRoLkdldFVzZXJuYW1lIChwdHIp
Ow0KKwlpZiAocmMgIT0gWFBDT00uTlNfT0spIFNXVC5lcnJvciAocmMpOw0KKwlpbnQgbGVuZ3Ro
ID0gWFBDT00ubnNFbWJlZFN0cmluZ19MZW5ndGggKHB0cik7DQorCWludCAvKmxvbmcqLyBidWZm
ZXIgPSBYUENPTS5uc0VtYmVkU3RyaW5nX2dldCAocHRyKTsNCisJY2hhcltdIGNoYXJzID0gbmV3
IGNoYXJbbGVuZ3RoXTsNCisJWFBDT00ubWVtbW92ZSAoY2hhcnMsIGJ1ZmZlciwgbGVuZ3RoICog
Mik7DQorCXVzZXJMYWJlbFswXSA9IG5ldyBTdHJpbmcgKGNoYXJzKTsNCisJWFBDT00ubnNFbWJl
ZFN0cmluZ19kZWxldGUgKHB0cik7DQorDQorCXB0ciA9IFhQQ09NLm5zRW1iZWRTdHJpbmdfbmV3
ICgpOw0KKwlyYyA9IGF1dGguR2V0UGFzc3dvcmQgKHB0cik7DQorCWlmIChyYyAhPSBYUENPTS5O
U19PSykgU1dULmVycm9yIChyYyk7DQorCWxlbmd0aCA9IFhQQ09NLm5zRW1iZWRTdHJpbmdfTGVu
Z3RoIChwdHIpOw0KKwlidWZmZXIgPSBYUENPTS5uc0VtYmVkU3RyaW5nX2dldCAocHRyKTsNCisJ
Y2hhcnMgPSBuZXcgY2hhcltsZW5ndGhdOw0KKwlYUENPTS5tZW1tb3ZlIChjaGFycywgYnVmZmVy
LCBsZW5ndGggKiAyKTsNCisJcGFzc0xhYmVsWzBdID0gbmV3IFN0cmluZyAoY2hhcnMpOw0KKwlY
UENPTS5uc0VtYmVkU3RyaW5nX2RlbGV0ZSAocHRyKTsNCisNCisJLyogY29tcHV0ZSB0aGUgbWVz
c2FnZSB0ZXh0ICovDQorDQorCXB0ciA9IFhQQ09NLm5zRW1iZWRTdHJpbmdfbmV3ICgpOw0KKwly
YyA9IGF1dGguR2V0UmVhbG0gKHB0cik7DQorCWlmIChyYyAhPSBYUENPTS5OU19PSykgU1dULmVy
cm9yIChyYyk7DQorCWxlbmd0aCA9IFhQQ09NLm5zRW1iZWRTdHJpbmdfTGVuZ3RoIChwdHIpOw0K
KwlidWZmZXIgPSBYUENPTS5uc0VtYmVkU3RyaW5nX2dldCAocHRyKTsNCisJY2hhcnMgPSBuZXcg
Y2hhcltsZW5ndGhdOw0KKwlYUENPTS5tZW1tb3ZlIChjaGFycywgYnVmZmVyLCBsZW5ndGggKiAy
KTsNCisJU3RyaW5nIHJlYWxtID0gbmV3IFN0cmluZyAoY2hhcnMpOw0KKwlYUENPTS5uc0VtYmVk
U3RyaW5nX2RlbGV0ZSAocHRyKTsNCisNCisJbnNJQ2hhbm5lbCBjaGFubmVsID0gbmV3IG5zSUNo
YW5uZWwgKGFDaGFubmVsKTsNCisJaW50IC8qbG9uZyovW10gdXJpID0gbmV3IGludCAvKmxvbmcq
L1sxXTsNCisJcmMgPSBjaGFubmVsLkdldFVSSSAodXJpKTsNCisJaWYgKHJjICE9IFhQQ09NLk5T
X09LKSBTV1QuZXJyb3IgKHJjKTsNCisJaWYgKHVyaVswXSA9PSAwKSBNb3ppbGxhLmVycm9yIChY
UENPTS5OU19OT0lOVEVSRkFDRSk7DQorDQorCW5zSVVSSSBuc1VSSSA9IG5ldyBuc0lVUkkgKHVy
aVswXSk7DQorCWludCAvKmxvbmcqLyBhU3BlYyA9IFhQQ09NLm5zRW1iZWRDU3RyaW5nX25ldyAo
KTsNCisJcmMgPSBuc1VSSS5HZXRIb3N0IChhU3BlYyk7DQorCWlmIChyYyAhPSBYUENPTS5OU19P
SykgU1dULmVycm9yIChyYyk7DQorCWxlbmd0aCA9IFhQQ09NLm5zRW1iZWRDU3RyaW5nX0xlbmd0
aCAoYVNwZWMpOw0KKwlidWZmZXIgPSBYUENPTS5uc0VtYmVkQ1N0cmluZ19nZXQgKGFTcGVjKTsN
CisJYnl0ZVtdIGJ5dGVzID0gbmV3IGJ5dGVbbGVuZ3RoXTsNCisJWFBDT00ubWVtbW92ZSAoYnl0
ZXMsIGJ1ZmZlciwgbGVuZ3RoKTsNCisJWFBDT00ubnNFbWJlZENTdHJpbmdfZGVsZXRlIChhU3Bl
Yyk7DQorCVN0cmluZyBob3N0ID0gbmV3IFN0cmluZyAoYnl0ZXMpOw0KKwluc1VSSS5SZWxlYXNl
ICgpOw0KKw0KKwlTdHJpbmcgbWVzc2FnZTsNCisJaWYgKHJlYWxtLmxlbmd0aCAoKSA+IDAgJiYg
aG9zdC5sZW5ndGggKCkgPiAwKSB7DQorCQltZXNzYWdlID0gQ29tcGF0aWJpbGl0eS5nZXRNZXNz
YWdlICgiU1dUX0VudGVyX1VzZXJuYW1lX2FuZF9QYXNzd29yZCIsIG5ldyBTdHJpbmdbXSB7cmVh
bG0sIGhvc3R9KTsgLy8kTk9OLU5MUy0xJA0KKwl9IGVsc2Ugew0KKwkJbWVzc2FnZSA9ICIiOyAv
LyROT04tTkxTLTEkDQorCX0NCisNCisJLyogb3BlbiB0aGUgcHJvbXB0ZXIgKi8NCisJU2hlbGwg
c2hlbGwgPSBicm93c2VyID09IG51bGwgPyBuZXcgU2hlbGwgKCkgOiBicm93c2VyLmdldFNoZWxs
ICgpOw0KKwlQcm9tcHREaWFsb2cgZGlhbG9nID0gbmV3IFByb21wdERpYWxvZyAoc2hlbGwpOw0K
KwlpbnRbXSByZXN1bHQgPSBuZXcgaW50WzFdOw0KKwlkaWFsb2cucHJvbXB0VXNlcm5hbWVBbmRQ
YXNzd29yZCAodGl0bGUsIG1lc3NhZ2UsIGNoZWNrTGFiZWwsIHVzZXJMYWJlbCwgcGFzc0xhYmVs
LCBjaGVja1ZhbHVlLCByZXN1bHQpOw0KKw0KKwlYUENPTS5tZW1tb3ZlIChfcmV0dmFsLCByZXN1
bHQsIDQpOwkvKiBQUkJvb2wgKi8NCisJaWYgKHJlc3VsdFswXSA9PSAxKSB7CS8qIFVzZXIgc2Vs
ZWN0ZWQgT0sgKi8NCisJCW5zRW1iZWRTdHJpbmcgc3RyaW5nID0gbmV3IG5zRW1iZWRTdHJpbmcg
KHVzZXJMYWJlbFswXSk7DQorCQlyYyA9IGF1dGguU2V0VXNlcm5hbWUoc3RyaW5nLmdldEFkZHJl
c3MgKCkpOw0KKwkJaWYgKHJjICE9IFhQQ09NLk5TX09LKSBTV1QuZXJyb3IgKHJjKTsNCisJCXN0
cmluZy5kaXNwb3NlICgpOw0KKwkJDQorCQlzdHJpbmcgPSBuZXcgbnNFbWJlZFN0cmluZyAocGFz
c0xhYmVsWzBdKTsNCisJCXJjID0gYXV0aC5TZXRQYXNzd29yZChzdHJpbmcuZ2V0QWRkcmVzcyAo
KSk7DQorCQlpZiAocmMgIT0gWFBDT00uTlNfT0spIFNXVC5lcnJvciAocmMpOw0KKwkJc3RyaW5n
LmRpc3Bvc2UgKCk7DQorCX0NCisNCisJaWYgKGNoZWNrYm94VmFsdWUgIT0gMCkgWFBDT00ubWVt
bW92ZSAoY2hlY2tib3hWYWx1ZSwgY2hlY2tWYWx1ZSwgNCk7IC8qIFBSQm9vbCAqLw0KKwlyZXR1
cm4gWFBDT00uTlNfT0s7DQorfQ0KKw0KK2ludCBQcm9tcHRVc2VybmFtZUFuZFBhc3N3b3JkIChp
bnQgLypsb25nKi8gYVBhcmVudCwgaW50IC8qbG9uZyovIGFEaWFsb2dUaXRsZSwgaW50IC8qbG9u
ZyovIGFUZXh0LCBpbnQgLypsb25nKi8gYVVzZXJuYW1lLCBpbnQgLypsb25nKi8gYVBhc3N3b3Jk
LCBpbnQgLypsb25nKi8gYUNoZWNrTXNnLCBpbnQgLypsb25nKi8gYUNoZWNrU3RhdGUsIGludCAv
KmxvbmcqLyBfcmV0dmFsKSB7DQorCUJyb3dzZXIgYnJvd3NlciA9IGdldEJyb3dzZXIgKGFQYXJl
bnQpOw0KKwlTdHJpbmcgdGl0bGVMYWJlbCwgdGV4dExhYmVsLCBjaGVja0xhYmVsID0gbnVsbDsN
CisJU3RyaW5nW10gdXNlckxhYmVsID0gbmV3IFN0cmluZ1sxXSwgcGFzc0xhYmVsID0gbmV3IFN0
cmluZ1sxXTsNCisJY2hhcltdIGRlc3Q7DQorCWludCBsZW5ndGg7DQorCWlmIChhRGlhbG9nVGl0
bGUgIT0gMCkgew0KKwkJbGVuZ3RoID0gWFBDT00uc3RybGVuX1BSVW5pY2hhciAoYURpYWxvZ1Rp
dGxlKTsNCisJCWRlc3QgPSBuZXcgY2hhcltsZW5ndGhdOw0KKwkJWFBDT00ubWVtbW92ZSAoZGVz
dCwgYURpYWxvZ1RpdGxlLCBsZW5ndGggKiAyKTsNCisJCXRpdGxlTGFiZWwgPSBuZXcgU3RyaW5n
IChkZXN0KTsNCisJfSBlbHNlIHsNCisJCXRpdGxlTGFiZWwgPSBTV1QuZ2V0TWVzc2FnZSAoIlNX
VF9BdXRoZW50aWNhdGlvbl9SZXF1aXJlZCIpOwkvLyROT04tTkxTLTEkDQorCX0NCisJDQorCWxl
bmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIgKGFUZXh0KTsNCisJZGVzdCA9IG5ldyBjaGFy
W2xlbmd0aF07DQorCVhQQ09NLm1lbW1vdmUgKGRlc3QsIGFUZXh0LCBsZW5ndGggKiAyKTsNCisJ
dGV4dExhYmVsID0gbmV3IFN0cmluZyAoZGVzdCk7DQorCQ0KKwlpbnQgLypsb25nKi9bXSB1c2Vy
QWRkciA9IG5ldyBpbnQgLypsb25nKi9bMV07DQorCVhQQ09NLm1lbW1vdmUgKHVzZXJBZGRyLCBh
VXNlcm5hbWUsIEMuUFRSX1NJWkVPRik7DQorCWlmICh1c2VyQWRkclswXSAhPSAwKSB7DQorCQls
ZW5ndGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFyICh1c2VyQWRkclswXSk7DQorCQlkZXN0ID0g
bmV3IGNoYXJbbGVuZ3RoXTsNCisJCVhQQ09NLm1lbW1vdmUgKGRlc3QsIHVzZXJBZGRyWzBdLCBs
ZW5ndGggKiAyKTsNCisJCXVzZXJMYWJlbFswXSA9IG5ldyBTdHJpbmcgKGRlc3QpOwkJDQorCX0N
CisJDQorCWludCAvKmxvbmcqL1tdIHBhc3NBZGRyID0gbmV3IGludCAvKmxvbmcqL1sxXTsNCisJ
WFBDT00ubWVtbW92ZSAocGFzc0FkZHIsIGFQYXNzd29yZCwgQy5QVFJfU0laRU9GKTsNCisJaWYg
KHBhc3NBZGRyWzBdICE9IDApIHsNCisJCWxlbmd0aCA9IFhQQ09NLnN0cmxlbl9QUlVuaWNoYXIg
KHBhc3NBZGRyWzBdKTsNCisJCWRlc3QgPSBuZXcgY2hhcltsZW5ndGhdOw0KKwkJWFBDT00ubWVt
bW92ZSAoZGVzdCwgcGFzc0FkZHJbMF0sIGxlbmd0aCAqIDIpOw0KKwkJcGFzc0xhYmVsWzBdID0g
bmV3IFN0cmluZyAoZGVzdCk7CQkNCisJfQ0KKwkNCisJaWYgKGFDaGVja01zZyAhPSAwKSB7DQor
CQlsZW5ndGggPSBYUENPTS5zdHJsZW5fUFJVbmljaGFyIChhQ2hlY2tNc2cpOw0KKwkJaWYgKGxl
bmd0aCA+IDApIHsNCisJCQlkZXN0ID0gbmV3IGNoYXJbbGVuZ3RoXTsNCisJCQlYUENPTS5tZW1t
b3ZlIChkZXN0LCBhQ2hlY2tNc2csIGxlbmd0aCAqIDIpOw0KKwkJCWNoZWNrTGFiZWwgPSBuZXcg
U3RyaW5nIChkZXN0KTsNCisJCX0NCisJfQ0KKw0KKwlTaGVsbCBzaGVsbCA9IGJyb3dzZXIgPT0g
bnVsbCA/IG5ldyBTaGVsbCAoKSA6IGJyb3dzZXIuZ2V0U2hlbGwgKCk7DQorCVByb21wdERpYWxv
ZyBkaWFsb2cgPSBuZXcgUHJvbXB0RGlhbG9nIChzaGVsbCk7DQorCWludFtdIGNoZWNrID0gbmV3
IGludFsxXSwgcmVzdWx0ID0gbmV3IGludFsxXTsNCisJaWYgKGFDaGVja1N0YXRlICE9IDApIFhQ
Q09NLm1lbW1vdmUgKGNoZWNrLCBhQ2hlY2tTdGF0ZSwgNCk7CS8qIFBSQm9vbCAqLw0KKwlkaWFs
b2cucHJvbXB0VXNlcm5hbWVBbmRQYXNzd29yZCAodGl0bGVMYWJlbCwgdGV4dExhYmVsLCBjaGVj
a0xhYmVsLCB1c2VyTGFiZWwsIHBhc3NMYWJlbCwgY2hlY2ssIHJlc3VsdCk7DQorDQorCVhQQ09N
Lm1lbW1vdmUgKF9yZXR2YWwsIHJlc3VsdCwgNCk7CS8qIFBSQm9vbCAqLw0KKwlpZiAocmVzdWx0
WzBdID09IDEpIHsNCisJCS8qIA0KKwkJKiBVc2VyIHNlbGVjdGVkIE9LLiBVc2VyIG5hbWUgYW5k
IHBhc3N3b3JkIGFyZSByZXR1cm5lZCBhcyBQUlVuaWNoYXIgdmFsdWVzLiBBbnkgZGVmYXVsdA0K
KwkJKiB2YWx1ZSB0aGF0IHdlIG92ZXJyaWRlIG11c3QgYmUgZnJlZWQgdXNpbmcgdGhlIG5zSU1l
bW9yeSBzZXJ2aWNlLg0KKwkJKi8NCisJCWludCBjbnQsIHNpemU7DQorCQlpbnQgLypsb25nKi8g
cHRyOw0KKwkJY2hhcltdIGJ1ZmZlcjsNCisJCWludCAvKmxvbmcqL1tdIHJlc3VsdDIgPSBuZXcg
aW50IC8qbG9uZyovWzFdOw0KKwkJaWYgKHVzZXJMYWJlbFswXSAhPSBudWxsKSB7DQorCQkJY250
ID0gdXNlckxhYmVsWzBdLmxlbmd0aCAoKTsNCisJCQlidWZmZXIgPSBuZXcgY2hhcltjbnQgKyAx
XTsNCisJCQl1c2VyTGFiZWxbMF0uZ2V0Q2hhcnMgKDAsIGNudCwgYnVmZmVyLCAwKTsNCisJCQlz
aXplID0gYnVmZmVyLmxlbmd0aCAqIDI7DQorCQkJcHRyID0gQy5tYWxsb2MgKHNpemUpOw0KKwkJ
CVhQQ09NLm1lbW1vdmUgKHB0ciwgYnVmZmVyLCBzaXplKTsNCisJCQlYUENPTS5tZW1tb3ZlIChh
VXNlcm5hbWUsIG5ldyBpbnQgLypsb25nKi9bXSB7cHRyfSwgQy5QVFJfU0laRU9GKTsNCisNCisJ
CQlpZiAodXNlckFkZHJbMF0gIT0gMCkgew0KKwkJCQlpbnQgcmMgPSBYUENPTS5OU19HZXRTZXJ2
aWNlTWFuYWdlciAocmVzdWx0Mik7DQorCQkJCWlmIChyYyAhPSBYUENPTS5OU19PSykgU1dULmVy
cm9yIChyYyk7DQorCQkJCWlmIChyZXN1bHQyWzBdID09IDApIFNXVC5lcnJvciAoWFBDT00uTlNf
Tk9JTlRFUkZBQ0UpOw0KKwkJCQ0KKwkJCQluc0lTZXJ2aWNlTWFuYWdlciBzZXJ2aWNlTWFuYWdl
ciA9IG5ldyBuc0lTZXJ2aWNlTWFuYWdlciAocmVzdWx0MlswXSk7DQorCQkJCXJlc3VsdDJbMF0g
PSAwOw0KKwkJCQlieXRlW10gYUNvbnRyYWN0SUQgPSBNb3ppbGxhRGVsZWdhdGUud2NzVG9NYmNz
IChudWxsLCBYUENPTS5OU19NRU1PUllfQ09OVFJBQ1RJRCwgdHJ1ZSk7DQorCQkJCXJjID0gc2Vy
dmljZU1hbmFnZXIuR2V0U2VydmljZUJ5Q29udHJhY3RJRCAoYUNvbnRyYWN0SUQsIG5zSU1lbW9y
eS5OU19JTUVNT1JZX0lJRCwgcmVzdWx0Mik7DQorCQkJCWlmIChyYyAhPSBYUENPTS5OU19PSykg
U1dULmVycm9yIChyYyk7DQorCQkJCWlmIChyZXN1bHRbMF0gPT0gMCkgU1dULmVycm9yIChYUENP
TS5OU19OT0lOVEVSRkFDRSk7CQkNCisJCQkJc2VydmljZU1hbmFnZXIuUmVsZWFzZSAoKTsNCisJ
CQkJDQorCQkJCW5zSU1lbW9yeSBtZW1vcnkgPSBuZXcgbnNJTWVtb3J5IChyZXN1bHQyWzBdKTsN
CisJCQkJcmVzdWx0MlswXSA9IDA7DQorCQkJCW1lbW9yeS5GcmVlICh1c2VyQWRkclswXSk7DQor
CQkJCW1lbW9yeS5SZWxlYXNlICgpOw0KKwkJCX0NCisJCX0NCisJCWlmIChwYXNzTGFiZWxbMF0g
IT0gbnVsbCkgew0KKwkJCWNudCA9IHBhc3NMYWJlbFswXS5sZW5ndGggKCk7DQorCQkJYnVmZmVy
ID0gbmV3IGNoYXJbY250ICsgMV07DQorCQkJcGFzc0xhYmVsWzBdLmdldENoYXJzICgwLCBjbnQs
IGJ1ZmZlciwgMCk7DQorCQkJc2l6ZSA9IGJ1ZmZlci5sZW5ndGggKiAyOw0KKwkJCXB0ciA9IEMu
bWFsbG9jIChzaXplKTsNCisJCQlYUENPTS5tZW1tb3ZlIChwdHIsIGJ1ZmZlciwgc2l6ZSk7DQor
CQkJWFBDT00ubWVtbW92ZSAoYVBhc3N3b3JkLCBuZXcgaW50IC8qbG9uZyovW10ge3B0cn0sIEMu
UFRSX1NJWkVPRik7DQorCQkJDQorCQkJaWYgKHBhc3NBZGRyWzBdICE9IDApIHsNCisJCQkJaW50
IHJjID0gWFBDT00uTlNfR2V0U2VydmljZU1hbmFnZXIgKHJlc3VsdDIpOw0KKwkJCQlpZiAocmMg
IT0gWFBDT00uTlNfT0spIFNXVC5lcnJvciAocmMpOw0KKwkJCQlpZiAocmVzdWx0MlswXSA9PSAw
KSBTV1QuZXJyb3IgKFhQQ09NLk5TX05PSU5URVJGQUNFKTsNCisNCisJCQkJbnNJU2VydmljZU1h
bmFnZXIgc2VydmljZU1hbmFnZXIgPSBuZXcgbnNJU2VydmljZU1hbmFnZXIgKHJlc3VsdDJbMF0p
Ow0KKwkJCQlyZXN1bHQyWzBdID0gMDsNCisJCQkJYnl0ZVtdIGFDb250cmFjdElEID0gTW96aWxs
YURlbGVnYXRlLndjc1RvTWJjcyAobnVsbCwgWFBDT00uTlNfTUVNT1JZX0NPTlRSQUNUSUQsIHRy
dWUpOw0KKwkJCQlyYyA9IHNlcnZpY2VNYW5hZ2VyLkdldFNlcnZpY2VCeUNvbnRyYWN0SUQgKGFD
b250cmFjdElELCBuc0lNZW1vcnkuTlNfSU1FTU9SWV9JSUQsIHJlc3VsdDIpOw0KKwkJCQlpZiAo
cmMgIT0gWFBDT00uTlNfT0spIFNXVC5lcnJvciAocmMpOw0KKwkJCQlpZiAocmVzdWx0MlswXSA9
PSAwKSBTV1QuZXJyb3IgKFhQQ09NLk5TX05PSU5URVJGQUNFKTsJCQ0KKwkJCQlzZXJ2aWNlTWFu
YWdlci5SZWxlYXNlICgpOw0KKw0KKwkJCQluc0lNZW1vcnkgbWVtb3J5ID0gbmV3IG5zSU1lbW9y
eSAocmVzdWx0MlswXSk7DQorCQkJCXJlc3VsdDJbMF0gPSAwOw0KKwkJCQltZW1vcnkuRnJlZSAo
cGFzc0FkZHJbMF0pOw0KKwkJCQltZW1vcnkuUmVsZWFzZSAoKTsNCisJCQl9DQorCQl9DQorCX0N
CisJaWYgKGFDaGVja1N0YXRlICE9IDApIFhQQ09NLm1lbW1vdmUgKGFDaGVja1N0YXRlLCBjaGVj
aywgNCk7IC8qIFBSQm9vbCAqLw0KKwlyZXR1cm4gWFBDT00uTlNfT0s7DQorfQ0KKw0KK2ludCBQ
cm9tcHRQYXNzd29yZCAoaW50IC8qbG9uZyovIGFQYXJlbnQsIGludCAvKmxvbmcqLyBhRGlhbG9n
VGl0bGUsIGludCAvKmxvbmcqLyBhVGV4dCwgaW50IC8qbG9uZyovIGFQYXNzd29yZCwgaW50IC8q
bG9uZyovIGFDaGVja01zZywgaW50IC8qbG9uZyovIGFDaGVja1N0YXRlLCBpbnQgLypsb25nKi8g
X3JldHZhbCkgew0KKwlyZXR1cm4gWFBDT00uTlNfRVJST1JfTk9UX0lNUExFTUVOVEVEOw0KK30N
CisNCitpbnQgU2VsZWN0IChpbnQgLypsb25nKi8gYVBhcmVudCwgaW50IC8qbG9uZyovIGFEaWFs
b2dUaXRsZSwgaW50IC8qbG9uZyovIGFUZXh0LCBpbnQgYUNvdW50LCBpbnQgLypsb25nKi8gYVNl
bGVjdExpc3QsIGludCAvKmxvbmcqLyBhT3V0U2VsZWN0aW9uLCBpbnQgLypsb25nKi8gX3JldHZh
bCkgew0KKwlyZXR1cm4gWFBDT00uTlNfRVJST1JfTk9UX0lNUExFTUVOVEVEOw0KK30NCisNCit9
DQpJbmRleDogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVy
bmFsL21vemlsbGEvbnNJQ2hhbm5lbC5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogRWNsaXBz
ZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJ
Q2hhbm5lbC5qYXZhDQpkaWZmIC1OIEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xp
cHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSUNoYW5uZWwuamF2YQ0KLS0tIC9kZXYvbnVsbAkx
IEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQorKysgRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24v
b3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJQ2hhbm5lbC5qYXZhCTEgSmFuIDE5
NzAgMDA6MDA6MDAgLTAwMDANCkBAIC0wLDAgKzEsMTE5IEBADQorLyogKioqKiogQkVHSU4gTElD
RU5TRSBCTE9DSyAqKioqKg0KKyAqIFZlcnNpb246IE1QTCAxLjENCisgKg0KKyAqIFRoZSBjb250
ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhlIE1vemlsbGEgUHVibGljIExpY2Vu
c2UgVmVyc2lvbg0KKyAqIDEuMSAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlz
IGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aA0KKyAqIHRoZSBMaWNlbnNlLiBZb3UgbWF5
IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCisgKiBodHRwOi8vd3d3Lm1vemlsbGEu
b3JnL01QTC8NCisgKg0KKyAqIFNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl
IGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFzaXMsDQorICogV0lUSE9VVCBXQVJSQU5U
WSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNl
DQorICogZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcmlnaHRzIGFuZCBsaW1p
dGF0aW9ucyB1bmRlciB0aGUNCisgKiBMaWNlbnNlLg0KKyAqDQorICogVGhlIE9yaWdpbmFsIENv
ZGUgaXMgTW96aWxsYSBDb21tdW5pY2F0b3IgY2xpZW50IGNvZGUsIHJlbGVhc2VkIE1hcmNoIDMx
LCAxOTk4Lg0KKyAqDQorICogVGhlIEluaXRpYWwgRGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBD
b2RlIGlzDQorICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24uDQorICogUG9y
dGlvbnMgY3JlYXRlZCBieSBOZXRzY2FwZSBhcmUgQ29weXJpZ2h0IChDKSAxOTk4LTE5OTkNCisg
KiBOZXRzY2FwZSBDb21tdW5pY2F0aW9ucyBDb3Jwb3JhdGlvbi4gIEFsbCBSaWdodHMgUmVzZXJ2
ZWQuDQorICoNCisgKiBDb250cmlidXRvcihzKToNCisgKg0KKyAqIElCTQ0KKyAqIC0gIEJpbmRp
bmcgdG8gcGVybWl0IGludGVyZmFjaW5nIGJldHdlZW4gTW96aWxsYSBhbmQgU1dUDQorICogLSAg
Q29weXJpZ2h0IChDKSAyMDA4IElCTSBDb3JwLiAgQWxsIFJpZ2h0cyBSZXNlcnZlZC4NCisgKg0K
KyAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICovDQorcGFja2FnZSBvcmcuZWNsaXBz
ZS5zd3QuaW50ZXJuYWwubW96aWxsYTsNCisNCitwdWJsaWMgY2xhc3MgbnNJQ2hhbm5lbCBleHRl
bmRzIG5zSVJlcXVlc3Qgew0KKw0KKwlzdGF0aWMgZmluYWwgaW50IExBU1RfTUVUSE9EX0lEID0g
bnNJUmVxdWVzdC5MQVNUX01FVEhPRF9JRCArIDE2Ow0KKw0KKwlwdWJsaWMgc3RhdGljIGZpbmFs
IFN0cmluZyBOU19JQ0hBTk5FTF9JSURfU1RSID0NCisJCSJjNjNhMDU1YS1hNjc2LTRlNzEtYmYz
Yy02Y2ZhMTEwODIwMTgiOw0KKw0KKwlwdWJsaWMgc3RhdGljIGZpbmFsIG5zSUQgTlNfSUNIQU5O
RUxfSUlEID0NCisJCW5ldyBuc0lEKE5TX0lDSEFOTkVMX0lJRF9TVFIpOw0KKw0KKwlwdWJsaWMg
bnNJQ2hhbm5lbChpbnQgLypsb25nKi8gYWRkcmVzcykgew0KKwkJc3VwZXIoYWRkcmVzcyk7DQor
CX0NCisNCisJcHVibGljIGludCBHZXRPcmlnaW5hbFVSSShpbnQgLypsb25nKi9bXSBhT3JpZ2lu
YWxVUkkpIHsNCisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lSZXF1ZXN0LkxBU1RfTUVUSE9E
X0lEICsgMSwgZ2V0QWRkcmVzcygpLCBhT3JpZ2luYWxVUkkpOw0KKwl9DQorDQorCXB1YmxpYyBp
bnQgU2V0T3JpZ2luYWxVUkkoaW50IC8qbG9uZyovIGFPcmlnaW5hbFVSSSkgew0KKwkJcmV0dXJu
IFhQQ09NLlZ0YmxDYWxsKG5zSVJlcXVlc3QuTEFTVF9NRVRIT0RfSUQgKyAyLCBnZXRBZGRyZXNz
KCksIGFPcmlnaW5hbFVSSSk7DQorCX0NCisNCisJcHVibGljIGludCBHZXRVUkkoaW50IC8qbG9u
ZyovW10gYVVSSSkgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVJlcXVlc3QuTEFTVF9N
RVRIT0RfSUQgKyAzLCBnZXRBZGRyZXNzKCksIGFVUkkpOw0KKwl9DQorDQorCXB1YmxpYyBpbnQg
R2V0T3duZXIoaW50IC8qbG9uZyovW10gYU93bmVyKSB7DQorCQlyZXR1cm4gWFBDT00uVnRibENh
bGwobnNJUmVxdWVzdC5MQVNUX01FVEhPRF9JRCArIDQsIGdldEFkZHJlc3MoKSwgYU93bmVyKTsN
CisJfQ0KKw0KKwlwdWJsaWMgaW50IFNldE93bmVyKGludCAvKmxvbmcqLyBhT3duZXIpIHsNCisJ
CXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lSZXF1ZXN0LkxBU1RfTUVUSE9EX0lEICsgNSwgZ2V0
QWRkcmVzcygpLCBhT3duZXIpOw0KKwl9DQorDQorCXB1YmxpYyBpbnQgR2V0Tm90aWZpY2F0aW9u
Q2FsbGJhY2tzKGludCAvKmxvbmcqL1tdIGFOb3RpZmljYXRpb25DYWxsYmFja3MpIHsNCisJCXJl
dHVybiBYUENPTS5WdGJsQ2FsbChuc0lSZXF1ZXN0LkxBU1RfTUVUSE9EX0lEICsgNiwgZ2V0QWRk
cmVzcygpLCBhTm90aWZpY2F0aW9uQ2FsbGJhY2tzKTsNCisJfQ0KKw0KKwlwdWJsaWMgaW50IFNl
dE5vdGlmaWNhdGlvbkNhbGxiYWNrcyhpbnQgLypsb25nKi8gYU5vdGlmaWNhdGlvbkNhbGxiYWNr
cykgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVJlcXVlc3QuTEFTVF9NRVRIT0RfSUQg
KyA3LCBnZXRBZGRyZXNzKCksIGFOb3RpZmljYXRpb25DYWxsYmFja3MpOw0KKwl9DQorDQorCXB1
YmxpYyBpbnQgR2V0U2VjdXJpdHlJbmZvKGludCAvKmxvbmcqL1tdIGFTZWN1cml0eUluZm8pIHsN
CisJCXJldHVybiBYUENPTS5WdGJsQ2FsbChuc0lSZXF1ZXN0LkxBU1RfTUVUSE9EX0lEICsgOCwg
Z2V0QWRkcmVzcygpLCBhU2VjdXJpdHlJbmZvKTsNCisJfQ0KKw0KKwlwdWJsaWMgaW50IEdldENv
bnRlbnRUeXBlKGludCAvKmxvbmcqLyBhQ29udGVudFR5cGUpIHsNCisJCXJldHVybiBYUENPTS5W
dGJsQ2FsbChuc0lSZXF1ZXN0LkxBU1RfTUVUSE9EX0lEICsgOSwgZ2V0QWRkcmVzcygpLCBhQ29u
dGVudFR5cGUpOw0KKwl9DQorDQorCXB1YmxpYyBpbnQgU2V0Q29udGVudFR5cGUoaW50IC8qbG9u
ZyovIGFDb250ZW50VHlwZSkgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVJlcXVlc3Qu
TEFTVF9NRVRIT0RfSUQgKyAxMCwgZ2V0QWRkcmVzcygpLCBhQ29udGVudFR5cGUpOw0KKwl9DQor
DQorCXB1YmxpYyBpbnQgR2V0Q29udGVudENoYXJzZXQoaW50IC8qbG9uZyovIGFDb250ZW50Q2hh
cnNldCkgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVJlcXVlc3QuTEFTVF9NRVRIT0Rf
SUQgKyAxMSwgZ2V0QWRkcmVzcygpLCBhQ29udGVudENoYXJzZXQpOw0KKwl9DQorDQorCXB1Ymxp
YyBpbnQgU2V0Q29udGVudENoYXJzZXQoaW50IC8qbG9uZyovIGFDb250ZW50Q2hhcnNldCkgew0K
KwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVJlcXVlc3QuTEFTVF9NRVRIT0RfSUQgKyAxMiwg
Z2V0QWRkcmVzcygpLCBhQ29udGVudENoYXJzZXQpOw0KKwl9DQorDQorCXB1YmxpYyBpbnQgR2V0
Q29udGVudExlbmd0aChpbnRbXSBhQ29udGVudExlbmd0aCkgew0KKwkJcmV0dXJuIFhQQ09NLlZ0
YmxDYWxsKG5zSVJlcXVlc3QuTEFTVF9NRVRIT0RfSUQgKyAxMywgZ2V0QWRkcmVzcygpLCBhQ29u
dGVudExlbmd0aCk7DQorCX0NCisNCisJcHVibGljIGludCBTZXRDb250ZW50TGVuZ3RoKGludCBh
Q29udGVudExlbmd0aCkgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVJlcXVlc3QuTEFT
VF9NRVRIT0RfSUQgKyAxNCwgZ2V0QWRkcmVzcygpLCBhQ29udGVudExlbmd0aCk7DQorCX0NCisN
CisJcHVibGljIGludCBPcGVuKGludCAvKmxvbmcqL1tdIF9yZXR2YWwpIHsNCisJCXJldHVybiBY
UENPTS5WdGJsQ2FsbChuc0lSZXF1ZXN0LkxBU1RfTUVUSE9EX0lEICsgMTUsIGdldEFkZHJlc3Mo
KSwgX3JldHZhbCk7DQorCX0NCisNCisJcHVibGljIGludCBBc3luY09wZW4oaW50IC8qbG9uZyov
IGFMaXN0ZW5lciwgaW50IC8qbG9uZyovIGFDb250ZXh0KSB7DQorCQlyZXR1cm4gWFBDT00uVnRi
bENhbGwobnNJUmVxdWVzdC5MQVNUX01FVEhPRF9JRCArIDE2LCBnZXRBZGRyZXNzKCksIGFMaXN0
ZW5lciwgYUNvbnRleHQpOw0KKwl9DQorDQorCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IExPQURf
RE9DVU1FTlRfVVJJID0gNjU1MzY7DQorDQorCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IExPQURf
UkVUQVJHRVRFRF9ET0NVTUVOVF9VUkkgPSAxMzEwNzI7DQorDQorCXB1YmxpYyBzdGF0aWMgZmlu
YWwgaW50IExPQURfUkVQTEFDRSA9IDI2MjE0NDsNCisNCisJcHVibGljIHN0YXRpYyBmaW5hbCBp
bnQgTE9BRF9JTklUSUFMX0RPQ1VNRU5UX1VSSSA9IDUyNDI4ODsNCisNCisJcHVibGljIHN0YXRp
YyBmaW5hbCBpbnQgTE9BRF9UQVJHRVRFRCA9IDEwNDg1NzY7DQorDQorCXB1YmxpYyBzdGF0aWMg
ZmluYWwgaW50IExPQURfQ0FMTF9DT05URU5UX1NOSUZGRVJTID0gMjA5NzE1MjsNCit9DQpJbmRl
eDogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21v
emlsbGEvbnNJUHJvbXB0U2VydmljZTIuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IEVjbGlw
c2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25z
SVByb21wdFNlcnZpY2UyLmphdmENCmRpZmYgLU4gRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24v
b3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJUHJvbXB0U2VydmljZTIuamF2YQ0K
LS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQorKysgRWNsaXBzZSBTV1Qg
TW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJUHJvbXB0
U2VydmljZTIuamF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDUxIEBA
DQorLyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKg0KKyAqIFZlcnNpb246IE1QTCAx
LjENCisgKg0KKyAqIFRoZSBjb250ZW50cyBvZiB0aGlzIGZpbGUgYXJlIHN1YmplY3QgdG8gdGhl
IE1vemlsbGEgUHVibGljIExpY2Vuc2UgVmVyc2lvbg0KKyAqIDEuMSAodGhlICJMaWNlbnNlIik7
IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aA0KKyAq
IHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCisg
KiBodHRwOi8vd3d3Lm1vemlsbGEub3JnL01QTC8NCisgKg0KKyAqIFNvZnR3YXJlIGRpc3RyaWJ1
dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgYmFzaXMs
DQorICogV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1w
bGllZC4gU2VlIHRoZSBMaWNlbnNlDQorICogZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zl
cm5pbmcgcmlnaHRzIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUNCisgKiBMaWNlbnNlLg0KKyAq
DQorICogVGhlIE9yaWdpbmFsIENvZGUgaXMgTW96aWxsYSBDb21tdW5pY2F0b3IgY2xpZW50IGNv
ZGUsIHJlbGVhc2VkIE1hcmNoIDMxLCAxOTk4Lg0KKyAqDQorICogVGhlIEluaXRpYWwgRGV2ZWxv
cGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzDQorICogTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMg
Q29ycG9yYXRpb24uDQorICogUG9ydGlvbnMgY3JlYXRlZCBieSBOZXRzY2FwZSBhcmUgQ29weXJp
Z2h0IChDKSAxOTk4LTE5OTkNCisgKiBOZXRzY2FwZSBDb21tdW5pY2F0aW9ucyBDb3Jwb3JhdGlv
bi4gIEFsbCBSaWdodHMgUmVzZXJ2ZWQuDQorICoNCisgKiBDb250cmlidXRvcihzKToNCisgKg0K
KyAqIElCTQ0KKyAqIC0gIEJpbmRpbmcgdG8gcGVybWl0IGludGVyZmFjaW5nIGJldHdlZW4gTW96
aWxsYSBhbmQgU1dUDQorICogLSAgQ29weXJpZ2h0IChDKSAyMDA4IElCTSBDb3JwLiAgQWxsIFJp
Z2h0cyBSZXNlcnZlZC4NCisgKg0KKyAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICov
DQorcGFja2FnZSBvcmcuZWNsaXBzZS5zd3QuaW50ZXJuYWwubW96aWxsYTsNCisNCitwdWJsaWMg
Y2xhc3MgbnNJUHJvbXB0U2VydmljZTIgZXh0ZW5kcyBuc0lQcm9tcHRTZXJ2aWNlIHsNCisNCisJ
c3RhdGljIGZpbmFsIGludCBMQVNUX01FVEhPRF9JRCA9IG5zSVByb21wdFNlcnZpY2UuTEFTVF9N
RVRIT0RfSUQgKyAyOw0KKw0KKwlwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBOU19JUFJPTVBU
U0VSVklDRTJfSUlEX1NUUiA9DQorCQkiY2Y4NmQxOTYtZGJlZS00NDgyLTlkZmEtMzQ3N2FhMTI4
MzE5IjsNCisNCisJcHVibGljIHN0YXRpYyBmaW5hbCBuc0lEIE5TX0lQUk9NUFRTRVJWSUNFMl9J
SUQgPQ0KKwkJbmV3IG5zSUQoTlNfSVBST01QVFNFUlZJQ0UyX0lJRF9TVFIpOw0KKw0KKwlwdWJs
aWMgbnNJUHJvbXB0U2VydmljZTIoaW50IC8qbG9uZyovIGFkZHJlc3MpIHsNCisJCXN1cGVyKGFk
ZHJlc3MpOw0KKwl9DQorDQorCXB1YmxpYyBpbnQgUHJvbXB0QXV0aChpbnQgLypsb25nKi8gYVBh
cmVudCwgaW50IC8qbG9uZyovIGFDaGFubmVsLCBpbnQgbGV2ZWwsIGludCAvKmxvbmcqLyBhdXRo
SW5mbywgY2hhcltdIGNoZWNrYm94TGFiZWwsIGJvb2xlYW5bXSBjaGVja1ZhbHVlLCBib29sZWFu
W10gX3JldHZhbCkgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVByb21wdFNlcnZpY2Uu
TEFTVF9NRVRIT0RfSUQgKyAxLCBnZXRBZGRyZXNzKCksIGFQYXJlbnQsIGFDaGFubmVsLCBsZXZl
bCwgYXV0aEluZm8sIGNoZWNrYm94TGFiZWwsIGNoZWNrVmFsdWUsIF9yZXR2YWwpOw0KKwl9DQor
DQorCXB1YmxpYyBpbnQgQXN5bmNQcm9tcHRBdXRoKGludCAvKmxvbmcqLyBhUGFyZW50LCBpbnQg
Lypsb25nKi8gYUNoYW5uZWwsIGludCAvKmxvbmcqLyBhQ2FsbGJhY2ssIGludCAvKmxvbmcqLyBh
Q29udGV4dCwgaW50IGxldmVsLCBpbnQgLypsb25nKi8gYXV0aEluZm8sIGNoYXJbXSBjaGVja2Jv
eExhYmVsLCBib29sZWFuW10gY2hlY2tWYWx1ZSwgaW50IC8qbG9uZyovW10gX3JldHZhbCkgew0K
KwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVByb21wdFNlcnZpY2UuTEFTVF9NRVRIT0RfSUQg
KyAyLCBnZXRBZGRyZXNzKCksIGFQYXJlbnQsIGFDaGFubmVsLCBhQ2FsbGJhY2ssIGFDb250ZXh0
LCBsZXZlbCwgYXV0aEluZm8sIGNoZWNrYm94TGFiZWwsIGNoZWNrVmFsdWUsIF9yZXR2YWwpOw0K
Kwl9DQorfQ0KSW5kZXg6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3
dC9icm93c2VyL1Byb21wdFNlcnZpY2UyRmFjdG9yeS5qYXZhDQo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmls
ZTogRWNsaXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dzZXIvUHJv
bXB0U2VydmljZTJGYWN0b3J5LmphdmENCmRpZmYgLU4gRWNsaXBzZSBTV1QgTW96aWxsYS9jb21t
b24vb3JnL2VjbGlwc2Uvc3d0L2Jyb3dzZXIvUHJvbXB0U2VydmljZTJGYWN0b3J5LmphdmENCi0t
LSAvZGV2L251bGwJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KKysrIEVjbGlwc2UgU1dUIE1v
emlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9icm93c2VyL1Byb21wdFNlcnZpY2UyRmFjdG9y
eS5qYXZhCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCkBAIC0wLDAgKzEsMTAwIEBADQorLyoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioNCisgKiBDb3B5cmlnaHQgKGMpIDIwMDMsIDIwMDcgSUJNIENv
cnBvcmF0aW9uIGFuZCBvdGhlcnMuDQorICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9n
cmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscw0KKyAqIGFyZSBtYWRlIGF2YWlsYWJs
ZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMA0KKyAq
IHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0
DQorICogaHR0cDovL3d3dy5lY2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEwLmh0bWwNCisgKg0KKyAq
IENvbnRyaWJ1dG9yczoNCisgKiAgICAgSUJNIENvcnBvcmF0aW9uIC0gaW5pdGlhbCBBUEkgYW5k
IGltcGxlbWVudGF0aW9uDQorICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovDQorcGFja2FnZSBvcmcu
ZWNsaXBzZS5zd3QuYnJvd3NlcjsNCisNCitpbXBvcnQgb3JnLmVjbGlwc2Uuc3d0LmludGVybmFs
LkM7DQoraW1wb3J0IG9yZy5lY2xpcHNlLnN3dC5pbnRlcm5hbC5tb3ppbGxhLio7DQorDQorY2xh
c3MgUHJvbXB0U2VydmljZTJGYWN0b3J5IHsNCisJWFBDT01PYmplY3Qgc3VwcG9ydHM7DQorCVhQ
Q09NT2JqZWN0IGZhY3Rvcnk7DQorCWludCByZWZDb3VudCA9IDA7DQorDQorUHJvbXB0U2Vydmlj
ZTJGYWN0b3J5ICgpIHsNCisJY3JlYXRlQ09NSW50ZXJmYWNlcyAoKTsNCit9DQorDQoraW50IEFk
ZFJlZiAoKSB7DQorCXJlZkNvdW50Kys7DQorCXJldHVybiByZWZDb3VudDsNCit9DQorDQordm9p
ZCBjcmVhdGVDT01JbnRlcmZhY2VzICgpIHsNCisJLyogQ3JlYXRlIGVhY2ggb2YgdGhlIGludGVy
ZmFjZXMgdGhhdCB0aGlzIG9iamVjdCBpbXBsZW1lbnRzICovDQorCXN1cHBvcnRzID0gbmV3IFhQ
Q09NT2JqZWN0IChuZXcgaW50W10gezIsIDAsIDB9KSB7DQorCQlwdWJsaWMgaW50IC8qbG9uZyov
IG1ldGhvZDAgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gUXVlcnlJbnRlcmZhY2UgKGFy
Z3NbMF0sIGFyZ3NbMV0pO30NCisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kMSAoaW50IC8q
bG9uZyovW10gYXJncykge3JldHVybiBBZGRSZWYgKCk7fQ0KKwkJcHVibGljIGludCAvKmxvbmcq
LyBtZXRob2QyIChpbnQgLypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIFJlbGVhc2UgKCk7fQ0KKwl9
Ow0KKwkNCisJZmFjdG9yeSA9IG5ldyBYUENPTU9iamVjdCAobmV3IGludFtdIHsyLCAwLCAwLCAz
LCAxfSkgew0KKwkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2QwIChpbnQgLypsb25nKi9bXSBh
cmdzKSB7cmV0dXJuIFF1ZXJ5SW50ZXJmYWNlIChhcmdzWzBdLCBhcmdzWzFdKTt9DQorCQlwdWJs
aWMgaW50IC8qbG9uZyovIG1ldGhvZDEgKGludCAvKmxvbmcqL1tdIGFyZ3MpIHtyZXR1cm4gQWRk
UmVmICgpO30NCisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9kMiAoaW50IC8qbG9uZyovW10g
YXJncykge3JldHVybiBSZWxlYXNlICgpO30NCisJCXB1YmxpYyBpbnQgLypsb25nKi8gbWV0aG9k
MyAoaW50IC8qbG9uZyovW10gYXJncykge3JldHVybiBDcmVhdGVJbnN0YW5jZSAoYXJnc1swXSwg
YXJnc1sxXSwgYXJnc1syXSk7fQ0KKwkJcHVibGljIGludCAvKmxvbmcqLyBtZXRob2Q0IChpbnQg
Lypsb25nKi9bXSBhcmdzKSB7cmV0dXJuIExvY2tGYWN0b3J5ICgoaW50KS8qNjQqL2FyZ3NbMF0p
O30NCisJfTsNCit9DQorDQordm9pZCBkaXNwb3NlQ09NSW50ZXJmYWNlcyAoKSB7DQorCWlmIChz
dXBwb3J0cyAhPSBudWxsKSB7DQorCQlzdXBwb3J0cy5kaXNwb3NlICgpOw0KKwkJc3VwcG9ydHMg
PSBudWxsOw0KKwl9CQ0KKwlpZiAoZmFjdG9yeSAhPSBudWxsKSB7DQorCQlmYWN0b3J5LmRpc3Bv
c2UgKCk7DQorCQlmYWN0b3J5ID0gbnVsbDsJDQorCX0NCit9DQorDQoraW50IC8qbG9uZyovIGdl
dEFkZHJlc3MgKCkgew0KKwlyZXR1cm4gZmFjdG9yeS5nZXRBZGRyZXNzICgpOw0KK30NCisNCitp
bnQgUXVlcnlJbnRlcmZhY2UgKGludCAvKmxvbmcqLyByaWlkLCBpbnQgLypsb25nKi8gcHB2T2Jq
ZWN0KSB7DQorCWlmIChyaWlkID09IDAgfHwgcHB2T2JqZWN0ID09IDApIHJldHVybiBYUENPTS5O
U19FUlJPUl9OT19JTlRFUkZBQ0U7DQorCW5zSUQgZ3VpZCA9IG5ldyBuc0lEICgpOw0KKwlYUENP
TS5tZW1tb3ZlIChndWlkLCByaWlkLCBuc0lELnNpemVvZik7DQorCQ0KKwlpZiAoZ3VpZC5FcXVh
bHMgKG5zSVN1cHBvcnRzLk5TX0lTVVBQT1JUU19JSUQpKSB7DQorCQlYUENPTS5tZW1tb3ZlIChw
cHZPYmplY3QsIG5ldyBpbnQgLypsb25nKi9bXSB7c3VwcG9ydHMuZ2V0QWRkcmVzcyAoKX0sIEMu
UFRSX1NJWkVPRik7DQorCQlBZGRSZWYgKCk7DQorCQlyZXR1cm4gWFBDT00uTlNfT0s7DQorCX0N
CisJaWYgKGd1aWQuRXF1YWxzIChuc0lGYWN0b3J5Lk5TX0lGQUNUT1JZX0lJRCkpIHsNCisJCVhQ
Q09NLm1lbW1vdmUgKHBwdk9iamVjdCwgbmV3IGludCAvKmxvbmcqL1tdIHtmYWN0b3J5LmdldEFk
ZHJlc3MgKCl9LCBDLlBUUl9TSVpFT0YpOw0KKwkJQWRkUmVmICgpOw0KKwkJcmV0dXJuIFhQQ09N
Lk5TX09LOw0KKwl9DQorCQ0KKwlYUENPTS5tZW1tb3ZlIChwcHZPYmplY3QsIG5ldyBpbnQgLyps
b25nKi9bXSB7MH0sIEMuUFRSX1NJWkVPRik7DQorCXJldHVybiBYUENPTS5OU19FUlJPUl9OT19J
TlRFUkZBQ0U7DQorfQ0KKyAgICAgICAgCQ0KK2ludCBSZWxlYXNlICgpIHsNCisJcmVmQ291bnQt
LTsNCisJaWYgKHJlZkNvdW50ID09IDApIGRpc3Bvc2VDT01JbnRlcmZhY2VzICgpOw0KKwlyZXR1
cm4gcmVmQ291bnQ7DQorfQ0KKwkNCisvKiBuc0lGYWN0b3J5ICovDQorDQoraW50IENyZWF0ZUlu
c3RhbmNlIChpbnQgLypsb25nKi8gYU91dGVyLCBpbnQgLypsb25nKi8gaWlkLCBpbnQgLypsb25n
Ki8gcmVzdWx0KSB7DQorCVByb21wdFNlcnZpY2UyIHByb21wdFNlcnZpY2UgPSBuZXcgUHJvbXB0
U2VydmljZTIgKCk7DQorCXByb21wdFNlcnZpY2UuQWRkUmVmICgpOw0KKwlYUENPTS5tZW1tb3Zl
IChyZXN1bHQsIG5ldyBpbnQgLypsb25nKi9bXSB7cHJvbXB0U2VydmljZS5nZXRBZGRyZXNzICgp
fSwgQy5QVFJfU0laRU9GKTsNCisJcmV0dXJuIFhQQ09NLk5TX09LOw0KK30NCisNCitpbnQgTG9j
a0ZhY3RvcnkgKGludCBsb2NrKSB7DQorCXJldHVybiBYUENPTS5OU19PSzsNCit9DQorfQ0KSW5k
ZXg6IEVjbGlwc2UgU1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9t
b3ppbGxhL25zSUF1dGhJbmZvcm1hdGlvbi5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogRWNs
aXBzZSBTV1QgTW96aWxsYS9jb21tb24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEv
bnNJQXV0aEluZm9ybWF0aW9uLmphdmENCmRpZmYgLU4gRWNsaXBzZSBTV1QgTW96aWxsYS9jb21t
b24vb3JnL2VjbGlwc2Uvc3d0L2ludGVybmFsL21vemlsbGEvbnNJQXV0aEluZm9ybWF0aW9uLmph
dmENCi0tLSAvZGV2L251bGwJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KKysrIEVjbGlwc2Ug
U1dUIE1vemlsbGEvY29tbW9uL29yZy9lY2xpcHNlL3N3dC9pbnRlcm5hbC9tb3ppbGxhL25zSUF1
dGhJbmZvcm1hdGlvbi5qYXZhCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCkBAIC0wLDAgKzEs
ODcgQEANCisvKiAqKioqKiBCRUdJTiBMSUNFTlNFIEJMT0NLICoqKioqDQorICogVmVyc2lvbjog
TVBMIDEuMQ0KKyAqDQorICogVGhlIGNvbnRlbnRzIG9mIHRoaXMgZmlsZSBhcmUgc3ViamVjdCB0
byB0aGUgTW96aWxsYSBQdWJsaWMgTGljZW5zZSBWZXJzaW9uDQorICogMS4xICh0aGUgIkxpY2Vu
c2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRo
DQorICogdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBh
dA0KKyAqIGh0dHA6Ly93d3cubW96aWxsYS5vcmcvTVBMLw0KKyAqDQorICogU29mdHdhcmUgZGlz
dHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBi
YXNpcywNCisgKiBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBv
ciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UNCisgKiBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdl
IGdvdmVybmluZyByaWdodHMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZQ0KKyAqIExpY2Vuc2Uu
DQorICoNCisgKiBUaGUgT3JpZ2luYWwgQ29kZSBpcyBNb3ppbGxhIENvbW11bmljYXRvciBjbGll
bnQgY29kZSwgcmVsZWFzZWQgTWFyY2ggMzEsIDE5OTguDQorICoNCisgKiBUaGUgSW5pdGlhbCBE
ZXZlbG9wZXIgb2YgdGhlIE9yaWdpbmFsIENvZGUgaXMNCisgKiBOZXRzY2FwZSBDb21tdW5pY2F0
aW9ucyBDb3Jwb3JhdGlvbi4NCisgKiBQb3J0aW9ucyBjcmVhdGVkIGJ5IE5ldHNjYXBlIGFyZSBD
b3B5cmlnaHQgKEMpIDE5OTgtMTk5OQ0KKyAqIE5ldHNjYXBlIENvbW11bmljYXRpb25zIENvcnBv
cmF0aW9uLiAgQWxsIFJpZ2h0cyBSZXNlcnZlZC4NCisgKg0KKyAqIENvbnRyaWJ1dG9yKHMpOg0K
KyAqDQorICogSUJNDQorICogLSAgQmluZGluZyB0byBwZXJtaXQgaW50ZXJmYWNpbmcgYmV0d2Vl
biBNb3ppbGxhIGFuZCBTV1QNCisgKiAtICBDb3B5cmlnaHQgKEMpIDIwMDggSUJNIENvcnAuICBB
bGwgUmlnaHRzIFJlc2VydmVkLg0KKyAqDQorICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioq
KiogKi8NCitwYWNrYWdlIG9yZy5lY2xpcHNlLnN3dC5pbnRlcm5hbC5tb3ppbGxhOw0KKw0KK3B1
YmxpYyBjbGFzcyBuc0lBdXRoSW5mb3JtYXRpb24gZXh0ZW5kcyBuc0lTdXBwb3J0cyB7DQorDQor
CXN0YXRpYyBmaW5hbCBpbnQgTEFTVF9NRVRIT0RfSUQgPSBuc0lTdXBwb3J0cy5MQVNUX01FVEhP
RF9JRCArIDk7DQorDQorCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIE5TX0lBVVRISU5GT1JN
QVRJT05fSUlEX1NUUiA9DQorCQkiMGQ3MzYzOWMtMmE5Mi00NTE4LTlmOTItMjhmNzFmZWE1ZjIw
IjsNCisNCisJcHVibGljIHN0YXRpYyBmaW5hbCBuc0lEIE5TX0lBVVRISU5GT1JNQVRJT05fSUlE
ID0NCisJCW5ldyBuc0lEKE5TX0lBVVRISU5GT1JNQVRJT05fSUlEX1NUUik7DQorDQorCXB1Ymxp
YyBuc0lBdXRoSW5mb3JtYXRpb24oaW50IC8qbG9uZyovIGFkZHJlc3MpIHsNCisJCXN1cGVyKGFk
ZHJlc3MpOw0KKwl9DQorDQorCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEFVVEhfSE9TVCA9IDE7
DQorDQorCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEFVVEhfUFJPWFkgPSAyOw0KKw0KKwlwdWJs
aWMgc3RhdGljIGZpbmFsIGludCBORUVEX0RPTUFJTiA9IDQ7DQorDQorCXB1YmxpYyBzdGF0aWMg
ZmluYWwgaW50IE9OTFlfUEFTU1dPUkQgPSA4Ow0KKw0KKwlwdWJsaWMgaW50IEdldEZsYWdzKGlu
dFtdIGFGbGFncykgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1Rf
TUVUSE9EX0lEICsgMSwgZ2V0QWRkcmVzcygpLCBhRmxhZ3MpOw0KKwl9DQorDQorCXB1YmxpYyBp
bnQgR2V0UmVhbG0oaW50IC8qbG9uZyovIGFSZWFsbSkgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxD
YWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMiwgZ2V0QWRkcmVzcygpLCBhUmVhbG0p
Ow0KKwl9DQorDQorCXB1YmxpYyBpbnQgR2V0QXV0aGVudGljYXRpb25TY2hlbWUoaW50IC8qbG9u
ZyovIGFBdXRoZW50aWNhdGlvblNjaGVtZSkgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5z
SVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgMywgZ2V0QWRkcmVzcygpLCBhQXV0aGVudGljYXRp
b25TY2hlbWUpOw0KKwl9DQorDQorCXB1YmxpYyBpbnQgR2V0VXNlcm5hbWUoaW50IC8qbG9uZyov
IGFVc2VybmFtZSkgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1Rf
TUVUSE9EX0lEICsgNCwgZ2V0QWRkcmVzcygpLCBhVXNlcm5hbWUpOw0KKwl9DQorDQorCXB1Ymxp
YyBpbnQgU2V0VXNlcm5hbWUoaW50IC8qbG9uZyovIGFVc2VybmFtZSkgew0KKwkJcmV0dXJuIFhQ
Q09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgNSwgZ2V0QWRkcmVzcygp
LCBhVXNlcm5hbWUpOw0KKwl9DQorDQorCXB1YmxpYyBpbnQgR2V0UGFzc3dvcmQoaW50IC8qbG9u
ZyovIGFQYXNzd29yZCkgew0KKwkJcmV0dXJuIFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxB
U1RfTUVUSE9EX0lEICsgNiwgZ2V0QWRkcmVzcygpLCBhUGFzc3dvcmQpOw0KKwl9DQorDQorCXB1
YmxpYyBpbnQgU2V0UGFzc3dvcmQoaW50IC8qbG9uZyovIGFQYXNzd29yZCkgew0KKwkJcmV0dXJu
IFhQQ09NLlZ0YmxDYWxsKG5zSVN1cHBvcnRzLkxBU1RfTUVUSE9EX0lEICsgNywgZ2V0QWRkcmVz
cygpLCBhUGFzc3dvcmQpOw0KKwl9DQorDQorCXB1YmxpYyBpbnQgR2V0RG9tYWluKGludCAvKmxv
bmcqLyBhRG9tYWluKSB7DQorCQlyZXR1cm4gWFBDT00uVnRibENhbGwobnNJU3VwcG9ydHMuTEFT
VF9NRVRIT0RfSUQgKyA4LCBnZXRBZGRyZXNzKCksIGFEb21haW4pOw0KKwl9DQorDQorCXB1Ymxp
YyBpbnQgU2V0RG9tYWluKGludCAvKmxvbmcqLyBhRG9tYWluKSB7DQorCQlyZXR1cm4gWFBDT00u
VnRibENhbGwobnNJU3VwcG9ydHMuTEFTVF9NRVRIT0RfSUQgKyA5LCBnZXRBZGRyZXNzKCksIGFE
b21haW4pOw0KKwl9DQorfQ0KI1Agb3JnLmVjbGlwc2Uuc3d0LnRvb2xzDQpJbmRleDogSk5JIEdl
bmVyYXRpb24vb3JnL2VjbGlwc2Uvc3d0L3Rvb2xzL2ludGVybmFsL29yZy5lY2xpcHNlLnN3dC5p
bnRlcm5hbC5tb3ppbGxhLlhQQ09NLnByb3BlcnRpZXMNCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAv
Y3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xpcHNlLnN3dC50b29scy9KTkkgR2VuZXJhdGlvbi9vcmcv
ZWNsaXBzZS9zd3QvdG9vbHMvaW50ZXJuYWwvb3JnLmVjbGlwc2Uuc3d0LmludGVybmFsLm1vemls
bGEuWFBDT00ucHJvcGVydGllcyx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMzQNCmRpZmYgLXUg
LXIxLjM0IG9yZy5lY2xpcHNlLnN3dC5pbnRlcm5hbC5tb3ppbGxhLlhQQ09NLnByb3BlcnRpZXMN
Ci0tLSBKTkkgR2VuZXJhdGlvbi9vcmcvZWNsaXBzZS9zd3QvdG9vbHMvaW50ZXJuYWwvb3JnLmVj
bGlwc2Uuc3d0LmludGVybmFsLm1vemlsbGEuWFBDT00ucHJvcGVydGllcwkyMCBOb3YgMjAwNyAx
NjoyMzoxNSAtMDAwMAkxLjM0DQorKysgSk5JIEdlbmVyYXRpb24vb3JnL2VjbGlwc2Uvc3d0L3Rv
b2xzL2ludGVybmFsL29yZy5lY2xpcHNlLnN3dC5pbnRlcm5hbC5tb3ppbGxhLlhQQ09NLnByb3Bl
cnRpZXMJOSBKYW4gMjAwOCAyMDoyOTowMSAtMDAwMA0KQEAgLTk0LDYgKzk0LDE5IEBADQogWFBD
T01fVnRibENhbGxfX0lJSUlJSUlJXzY9DQogWFBDT01fVnRibENhbGxfX0lJSUlJSUlJXzc9DQog
DQorWFBDT01fVnRibENhbGxfX0lJSUlJSUlJXzNDXzNaXzNJPQ0KK1hQQ09NX1Z0YmxDYWxsX19J
SUlJSUlJSV8zQ18zWl8zSV8wPQ0KK1hQQ09NX1Z0YmxDYWxsX19JSUlJSUlJSV8zQ18zWl8zSV8x
PQ0KK1hQQ09NX1Z0YmxDYWxsX19JSUlJSUlJSV8zQ18zWl8zSV8yPQ0KK1hQQ09NX1Z0YmxDYWxs
X19JSUlJSUlJSV8zQ18zWl8zSV8zPQ0KK1hQQ09NX1Z0YmxDYWxsX19JSUlJSUlJSV8zQ18zWl8z
SV80PQ0KK1hQQ09NX1Z0YmxDYWxsX19JSUlJSUlJSV8zQ18zWl8zSV81PQ0KK1hQQ09NX1Z0YmxD
YWxsX19JSUlJSUlJSV8zQ18zWl8zSV82PQ0KK1hQQ09NX1Z0YmxDYWxsX19JSUlJSUlJSV8zQ18z
Wl8zSV83PQ0KK1hQQ09NX1Z0YmxDYWxsX19JSUlJSUlJSV8zQ18zWl8zSV84PQ0KK1hQQ09NX1Z0
YmxDYWxsX19JSUlJSUlJSV8zQ18zWl8zSV85PQ0KK1hQQ09NX1Z0YmxDYWxsX19JSUlJSUlJSV8z
Q18zWl8zSV8xMD0NCisNCiBYUENPTV9WdGJsQ2FsbF9fSUlJSUlJSklJPQ0KIFhQQ09NX1Z0YmxD
YWxsX19JSUlJSUlKSUlfMD0NCiBYUENPTV9WdGJsQ2FsbF9fSUlJSUlJSklJXzE9DQpAQCAtMTMx
LDYgKzE0NCwxNyBAQA0KIFhQQ09NX1Z0YmxDYWxsX19JSUlJSUlfM0NfM0JJSUlJWl8zSV8zSV8x
Mz0NCiBYUENPTV9WdGJsQ2FsbF9fSUlJSUlJXzNDXzNCSUlJSVpfM0lfM0lfMTQ9DQogDQorWFBD
T01fVnRibENhbGxfX0lJSUlJSV8zQ18zWl8zWj0NCitYUENPTV9WdGJsQ2FsbF9fSUlJSUlJXzND
XzNaXzNaXzA9DQorWFBDT01fVnRibENhbGxfX0lJSUlJSV8zQ18zWl8zWl8xPQ0KK1hQQ09NX1Z0
YmxDYWxsX19JSUlJSUlfM0NfM1pfM1pfMj0NCitYUENPTV9WdGJsQ2FsbF9fSUlJSUlJXzNDXzNa
XzNaXzM9DQorWFBDT01fVnRibENhbGxfX0lJSUlJSV8zQ18zWl8zWl80PQ0KK1hQQ09NX1Z0YmxD
YWxsX19JSUlJSUlfM0NfM1pfM1pfNT0NCitYUENPTV9WdGJsQ2FsbF9fSUlJSUlJXzNDXzNaXzNa
XzY9DQorWFBDT01fVnRibENhbGxfX0lJSUlJSV8zQ18zWl8zWl83PQ0KK1hQQ09NX1Z0YmxDYWxs
X19JSUlJSUlfM0NfM1pfM1pfOD0NCisNCiBYUENPTV9WdGJsQ2FsbF9fSUlJSUlJXzNaXzNJPQ0K
IFhQQ09NX1Z0YmxDYWxsX19JSUlJSUlfM1pfM0lfMD0NCiBYUENPTV9WdGJsQ2FsbF9fSUlJSUlJ
XzNaXzNJXzE9DQpAQCAtOTQ2LDYgKzk3MCw4IEBADQogDQogb3JnX2VjbGlwc2Vfc3d0X2ludGVy
bmFsX21vemlsbGFfbnNJQXBwU2hlbGw9DQogDQorb3JnX2VjbGlwc2Vfc3d0X2ludGVybmFsX21v
emlsbGFfbnNJQXV0aEluZm9ybWF0aW9uPQ0KKw0KIG9yZ19lY2xpcHNlX3N3dF9pbnRlcm5hbF9t
b3ppbGxhX25zSUJhc2VXaW5kb3c9DQogDQogb3JnX2VjbGlwc2Vfc3d0X2ludGVybmFsX21vemls
bGFfbnNJQ2FuY2VsYWJsZT0NCkBAIC0xMDQyLDYgKzEwNjgsOCBAQA0KIA0KIG9yZ19lY2xpcHNl
X3N3dF9pbnRlcm5hbF9tb3ppbGxhX25zSVByb21wdFNlcnZpY2U9DQogDQorb3JnX2VjbGlwc2Vf
c3d0X2ludGVybmFsX21vemlsbGFfbnNJUHJvbXB0U2VydmljZTI9DQorDQogb3JnX2VjbGlwc2Vf
c3d0X2ludGVybmFsX21vemlsbGFfbnNJUHJvcGVydGllcz0NCiANCiBvcmdfZWNsaXBzZV9zd3Rf
aW50ZXJuYWxfbW96aWxsYV9uc0lSZXF1ZXN0PQ0K
</data>

          </attachment>
      

    </bug>

</bugzilla>